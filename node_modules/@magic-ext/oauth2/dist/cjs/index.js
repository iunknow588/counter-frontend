"use strict";var p=Object.defineProperty,A=Object.defineProperties,I=Object.getOwnPropertyDescriptor,O=Object.getOwnPropertyDescriptors,w=Object.getOwnPropertyNames,R=Object.getOwnPropertySymbols;var f=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var m=(t,r,e)=>r in t?p(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e,v=(t,r)=>{for(var e in r||(r={}))f.call(r,e)&&m(t,e,r[e]);if(R)for(var e of R(r))U.call(r,e)&&m(t,e,r[e]);return t},y=(t,r)=>A(t,O(r));var x=(t,r)=>{for(var e in r)p(t,e,{get:r[e],enumerable:!0})},k=(t,r,e,s)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of w(r))!f.call(t,o)&&o!==e&&p(t,o,{get:()=>r[o],enumerable:!(s=I(r,o))||s.enumerable});return t};var D=t=>k(p({},"__esModule",{value:!0}),t);var l=(t,r,e)=>new Promise((s,o)=>{var c=n=>{try{i(e.next(n))}catch(d){o(d)}},u=n=>{try{i(e.throw(n))}catch(d){o(d)}},i=n=>n.done?s(n.value):Promise.resolve(n.value).then(c,u);i((e=e.apply(t,r)).next())});var S={};x(S,{OAuthErrorCode:()=>_,OAuthExtension:()=>h,OAuthPayloadMethods:()=>g});module.exports=D(S);var b=require("@magic-sdk/commons");var g=(e=>(e.Start="magic_oauth_login_with_redirect_start",e.Verify="magic_oauth_login_with_redirect_verify",e))(g||{}),_=(a=>(a.InvalidRequest="invalid_request",a.InvalidClient="invalid_client",a.InvalidScope="invalid_scope",a.InvalidGrant="invalid_grant",a.UnauthorizedClient="unauthorized_client",a.UnsupportedResponseType="unsupported_response_type",a.UnsupportedGrantType="unsupported_grant_type",a.UnsupportedTokenType="unsupported_token_type",a.AccessDenied="access_denied",a.ServerError="server_error",a.TemporarilyUnavailable="temporarily_unavailable",a))(_||{});var h=class extends b.Extension.Internal{constructor(){super(...arguments);this.name="oauth2";this.config={};this.compat={"magic-sdk":">=2.4.6","@magic-sdk/react-native":!1,"@magic-sdk/react-native-bare":!1,"@magic-sdk/react-native-expo":!1}}loginWithRedirect(e){return this.utils.createPromiEvent((s,o)=>l(this,null,function*(){var d;let c=this.utils.createJsonRpcRequestPayload("magic_oauth_login_with_redirect_start",[y(v({},e),{apiKey:this.sdk.apiKey,platform:"web"})]),u=yield this.request(c),i=u,n=u;n.error&&o(this.createError(n.error,(d=n.error_description)!=null?d:"An error occurred.",{errorURI:n.error_uri,provider:n.provider})),i!=null&&i.oauthAuthoriationURI&&(window.location.href=i.useMagicServerCallback?new URL(i.oauthAuthoriationURI,this.sdk.endpoint).href:i.oauthAuthoriationURI),s()}))}getRedirectResult(e){let s=window.location.search,o=window.location.origin+window.location.pathname;return window.history.replaceState(null,"",o),P.call(this,s,e)}};function P(t,r){return this.utils.createPromiEvent((e,s)=>l(this,null,function*(){var n;let o=this.utils.createJsonRpcRequestPayload("magic_oauth_login_with_redirect_verify",[{authorizationResponseParams:t,magicApiKey:this.sdk.apiKey,platform:"web",lifespan:r}]),c=yield this.request(o),u=c,i=c;i.error&&s(this.createError(i.error,(n=i.error_description)!=null?n:"An error occurred.",{errorURI:i.error_uri,provider:i.provider})),e(u)}))}
//# sourceMappingURL=index.js.map
