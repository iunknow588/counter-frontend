var v=Object.defineProperty,y=Object.defineProperties;var _=Object.getOwnPropertyDescriptors;var l=Object.getOwnPropertySymbols;var b=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var g=(n,r,e)=>r in n?v(n,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[r]=e,h=(n,r)=>{for(var e in r||(r={}))b.call(r,e)&&g(n,e,r[e]);if(l)for(var e of l(r))A.call(r,e)&&g(n,e,r[e]);return n},R=(n,r)=>y(n,_(r));var p=(n,r,e)=>new Promise((s,a)=>{var c=i=>{try{t(e.next(i))}catch(d){a(d)}},u=i=>{try{t(e.throw(i))}catch(d){a(d)}},t=i=>i.done?s(i.value):Promise.resolve(i.value).then(c,u);t((e=e.apply(n,r)).next())});import{Extension as O}from"@magic-sdk/commons";var m=(e=>(e.Start="magic_oauth_login_with_redirect_start",e.Verify="magic_oauth_login_with_redirect_verify",e))(m||{}),I=(o=>(o.InvalidRequest="invalid_request",o.InvalidClient="invalid_client",o.InvalidScope="invalid_scope",o.InvalidGrant="invalid_grant",o.UnauthorizedClient="unauthorized_client",o.UnsupportedResponseType="unsupported_response_type",o.UnsupportedGrantType="unsupported_grant_type",o.UnsupportedTokenType="unsupported_token_type",o.AccessDenied="access_denied",o.ServerError="server_error",o.TemporarilyUnavailable="temporarily_unavailable",o))(I||{});var f=class extends O.Internal{constructor(){super(...arguments);this.name="oauth2";this.config={};this.compat={"magic-sdk":">=2.4.6","@magic-sdk/react-native":!1,"@magic-sdk/react-native-bare":!1,"@magic-sdk/react-native-expo":!1}}loginWithRedirect(e){return this.utils.createPromiEvent((s,a)=>p(this,null,function*(){var d;let c=this.utils.createJsonRpcRequestPayload("magic_oauth_login_with_redirect_start",[R(h({},e),{apiKey:this.sdk.apiKey,platform:"web"})]),u=yield this.request(c),t=u,i=u;i.error&&a(this.createError(i.error,(d=i.error_description)!=null?d:"An error occurred.",{errorURI:i.error_uri,provider:i.provider})),t!=null&&t.oauthAuthoriationURI&&(window.location.href=t.useMagicServerCallback?new URL(t.oauthAuthoriationURI,this.sdk.endpoint).href:t.oauthAuthoriationURI),s()}))}getRedirectResult(e){let s=window.location.search,a=window.location.origin+window.location.pathname;return window.history.replaceState(null,"",a),w.call(this,s,e)}};function w(n,r){return this.utils.createPromiEvent((e,s)=>p(this,null,function*(){var i;let a=this.utils.createJsonRpcRequestPayload("magic_oauth_login_with_redirect_verify",[{authorizationResponseParams:n,magicApiKey:this.sdk.apiKey,platform:"web",lifespan:r}]),c=yield this.request(a),u=c,t=c;t.error&&s(this.createError(t.error,(i=t.error_description)!=null?i:"An error occurred.",{errorURI:t.error_uri,provider:t.provider})),e(u)}))}export{I as OAuthErrorCode,f as OAuthExtension,m as OAuthPayloadMethods};
//# sourceMappingURL=index.js.map
