"use strict";var MagicOAuth2Extension=(()=>{var U=Object.create;var d=Object.defineProperty,k=Object.defineProperties,D=Object.getOwnPropertyDescriptor,P=Object.getOwnPropertyDescriptors,S=Object.getOwnPropertyNames,f=Object.getOwnPropertySymbols,E=Object.getPrototypeOf,y=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var v=(t,e,r)=>e in t?d(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,g=(t,e)=>{for(var r in e||(e={}))y.call(e,r)&&v(t,r,e[r]);if(f)for(var r of f(e))q.call(e,r)&&v(t,r,e[r]);return t},_=(t,e)=>k(t,P(e));var C=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),b=(t,e)=>{for(var r in e)d(t,r,{get:e[r],enumerable:!0})},A=(t,e,r,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of S(e))!y.call(t,o)&&o!==r&&d(t,o,{get:()=>e[o],enumerable:!(s=D(e,o))||s.enumerable});return t};var M=(t,e,r)=>(r=t!=null?U(E(t)):{},A(e||!t||!t.__esModule?d(r,"default",{value:t,enumerable:!0}):r,t)),T=t=>A(d({},"__esModule",{value:!0}),t);var h=(t,e,r)=>new Promise((s,o)=>{var c=n=>{try{i(r.next(n))}catch(p){o(p)}},u=n=>{try{i(r.throw(n))}catch(p){o(p)}},i=n=>n.done?s(n.value):Promise.resolve(n.value).then(c,u);i((r=r.apply(t,e)).next())});var I=C((G,O)=>{O.exports=Magic});var K={};b(K,{default:()=>z});var w=M(I());var m={};b(m,{OAuthErrorCode:()=>x,OAuthPayloadMethods:()=>R});var R=(r=>(r.Start="magic_oauth_login_with_redirect_start",r.Verify="magic_oauth_login_with_redirect_verify",r))(R||{}),x=(a=>(a.InvalidRequest="invalid_request",a.InvalidClient="invalid_client",a.InvalidScope="invalid_scope",a.InvalidGrant="invalid_grant",a.UnauthorizedClient="unauthorized_client",a.UnsupportedResponseType="unsupported_response_type",a.UnsupportedGrantType="unsupported_grant_type",a.UnsupportedTokenType="unsupported_token_type",a.AccessDenied="access_denied",a.ServerError="server_error",a.TemporarilyUnavailable="temporarily_unavailable",a))(x||{});var l=class extends w.Extension.Internal{constructor(){super(...arguments);this.name="oauth2";this.config={};this.compat={"magic-sdk":">=2.4.6","@magic-sdk/react-native":!1,"@magic-sdk/react-native-bare":!1,"@magic-sdk/react-native-expo":!1}}loginWithRedirect(r){return this.utils.createPromiEvent((s,o)=>h(this,null,function*(){var p;let c=this.utils.createJsonRpcRequestPayload("magic_oauth_login_with_redirect_start",[_(g({},r),{apiKey:this.sdk.apiKey,platform:"web"})]),u=yield this.request(c),i=u,n=u;n.error&&o(this.createError(n.error,(p=n.error_description)!=null?p:"An error occurred.",{errorURI:n.error_uri,provider:n.provider})),i!=null&&i.oauthAuthoriationURI&&(window.location.href=i.useMagicServerCallback?new URL(i.oauthAuthoriationURI,this.sdk.endpoint).href:i.oauthAuthoriationURI),s()}))}getRedirectResult(r){let s=window.location.search,o=window.location.origin+window.location.pathname;return window.history.replaceState(null,"",o),N.call(this,s,r)}};function N(t,e){return this.utils.createPromiEvent((r,s)=>h(this,null,function*(){var n;let o=this.utils.createJsonRpcRequestPayload("magic_oauth_login_with_redirect_verify",[{authorizationResponseParams:t,magicApiKey:this.sdk.apiKey,platform:"web",lifespan:e}]),c=yield this.request(o),u=c,i=c;i.error&&s(this.createError(i.error,(n=i.error_description)!=null?n:"An error occurred.",{errorURI:i.error_uri,provider:i.provider})),r(u)}))}Object.assign(l,g({},m));var z=l;return T(K);})();
if (MagicOAuth2Extension && MagicOAuth2Extension.default != null) { MagicOAuth2Extension = Object.assign(MagicOAuth2Extension.default, MagicOAuth2Extension); delete MagicOAuth2Extension.default; }
