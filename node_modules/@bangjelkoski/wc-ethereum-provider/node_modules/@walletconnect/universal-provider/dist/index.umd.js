(function(xn,yt){typeof exports=="object"&&typeof module<"u"?yt(exports):typeof define=="function"&&define.amd?define(["exports"],yt):(xn=typeof globalThis<"u"?globalThis:xn||self,yt(xn["@walletconnect/universal-provider"]={}))})(this,function(xn){"use strict";var yt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Bv(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function bc(t){var e=t.default;if(typeof e=="function"){var r=function(){return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var n=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(r,i,n.get?n:{enumerable:!0,get:function(){return t[i]}})}),r}var er={exports:{}},Zn=typeof Reflect=="object"?Reflect:null,Wh=Zn&&typeof Zn.apply=="function"?Zn.apply:function(e,r,i){return Function.prototype.apply.call(e,r,i)},Ko;Zn&&typeof Zn.ownKeys=="function"?Ko=Zn.ownKeys:Object.getOwnPropertySymbols?Ko=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Ko=function(e){return Object.getOwnPropertyNames(e)};function qv(t){console&&console.warn&&console.warn(t)}var Jh=Number.isNaN||function(e){return e!==e};function ut(){ut.init.call(this)}er.exports=ut,er.exports.once=zv,ut.EventEmitter=ut,ut.prototype._events=void 0,ut.prototype._eventsCount=0,ut.prototype._maxListeners=void 0;var Yh=10;function Vo(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(ut,"defaultMaxListeners",{enumerable:!0,get:function(){return Yh},set:function(t){if(typeof t!="number"||t<0||Jh(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Yh=t}}),ut.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},ut.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Jh(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Zh(t){return t._maxListeners===void 0?ut.defaultMaxListeners:t._maxListeners}ut.prototype.getMaxListeners=function(){return Zh(this)},ut.prototype.emit=function(e){for(var r=[],i=1;i<arguments.length;i++)r.push(arguments[i]);var n=e==="error",s=this._events;if(s!==void 0)n=n&&s.error===void 0;else if(!n)return!1;if(n){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var h=s[e];if(h===void 0)return!1;if(typeof h=="function")Wh(h,this,r);else for(var u=h.length,p=ru(h,u),i=0;i<u;++i)Wh(p[i],this,r);return!0};function Xh(t,e,r,i){var n,s,o;if(Vo(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=i?[r,o]:[o,r]:i?o.unshift(r):o.push(r),n=Zh(t),n>0&&o.length>n&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,qv(a)}return t}ut.prototype.addListener=function(e,r){return Xh(this,e,r,!1)},ut.prototype.on=ut.prototype.addListener,ut.prototype.prependListener=function(e,r){return Xh(this,e,r,!0)};function Lv(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Qh(t,e,r){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},n=Lv.bind(i);return n.listener=r,i.wrapFn=n,n}ut.prototype.once=function(e,r){return Vo(r),this.on(e,Qh(this,e,r)),this},ut.prototype.prependOnceListener=function(e,r){return Vo(r),this.prependListener(e,Qh(this,e,r)),this},ut.prototype.removeListener=function(e,r){var i,n,s,o,a;if(Vo(r),n=this._events,n===void 0)return this;if(i=n[e],i===void 0)return this;if(i===r||i.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||r));else if(typeof i!="function"){for(s=-1,o=i.length-1;o>=0;o--)if(i[o]===r||i[o].listener===r){a=i[o].listener,s=o;break}if(s<0)return this;s===0?i.shift():Uv(i,s),i.length===1&&(n[e]=i[0]),n.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this},ut.prototype.off=ut.prototype.removeListener,ut.prototype.removeAllListeners=function(e){var r,i,n;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),o;for(n=0;n<s.length;++n)o=s[n],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=i[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(n=r.length-1;n>=0;n--)this.removeListener(e,r[n]);return this};function eu(t,e,r){var i=t._events;if(i===void 0)return[];var n=i[e];return n===void 0?[]:typeof n=="function"?r?[n.listener||n]:[n]:r?jv(n):ru(n,n.length)}ut.prototype.listeners=function(e){return eu(this,e,!0)},ut.prototype.rawListeners=function(e){return eu(this,e,!1)},ut.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):tu.call(t,e)},ut.prototype.listenerCount=tu;function tu(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}ut.prototype.eventNames=function(){return this._eventsCount>0?Ko(this._events):[]};function ru(t,e){for(var r=new Array(e),i=0;i<e;++i)r[i]=t[i];return r}function Uv(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function jv(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function zv(t,e){return new Promise(function(r,i){function n(o){t.removeListener(e,s),i(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",n),r([].slice.call(arguments))}iu(t,e,s,{once:!0}),e!=="error"&&kv(t,n,{once:!0})})}function kv(t,e,r){typeof t.on=="function"&&iu(t,"error",e,r)}function iu(t,e,r,i){if(typeof t.on=="function")i.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function n(s){i.once&&t.removeEventListener(e,n),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var Z={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var mc=function(t,e){return mc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},mc(t,e)};function Hv(t,e){mc(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var yc=function(){return yc=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},yc.apply(this,arguments)};function Kv(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function Vv(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(n<3?o(s):n>3?o(e,r,s):o(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function Gv(t,e){return function(r,i){e(r,i,t)}}function Wv(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Jv(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(p){try{u(i.next(p))}catch(b){o(b)}}function h(p){try{u(i.throw(p))}catch(b){o(b)}}function u(p){p.done?s(p.value):n(p.value).then(a,h)}u((i=i.apply(t,e||[])).next())})}function Yv(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(p){return h([u,p])}}function h(u){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=u[0]&2?n.return:u[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,u[1])).done)return s;switch(n=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,n=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(p){u=[6,p],n=0}finally{i=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function Zv(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function Xv(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function wc(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function nu(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],o;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(a){o={error:a}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function Qv(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(nu(arguments[e]));return t}function eg(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,n++)i[n]=s[o];return i}function Ws(t){return this instanceof Ws?(this.v=t,this):new Ws(t)}function tg(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(S){i[S]&&(n[S]=function(A){return new Promise(function(I,P){s.push([S,A,I,P])>1||a(S,A)})})}function a(S,A){try{h(i[S](A))}catch(I){b(s[0][3],I)}}function h(S){S.value instanceof Ws?Promise.resolve(S.value.v).then(u,p):b(s[0][2],S)}function u(S){a("next",S)}function p(S){a("throw",S)}function b(S,A){S(A),s.shift(),s.length&&a(s[0][0],s[0][1])}}function rg(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(o){return(r=!r)?{value:Ws(t[n](o)),done:n==="return"}:s?s(o):o}:s}}function ig(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof wc=="function"?wc(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(o){return new Promise(function(a,h){o=t[s](o),n(a,h,o.done,o.value)})}}function n(s,o,a,h){Promise.resolve(h).then(function(u){s({value:u,done:a})},o)}}function ng(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function sg(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function og(t){return t&&t.__esModule?t:{default:t}}function ag(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function cg(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var fg=Object.freeze({__proto__:null,__extends:Hv,get __assign(){return yc},__rest:Kv,__decorate:Vv,__param:Gv,__metadata:Wv,__awaiter:Jv,__generator:Yv,__createBinding:Zv,__exportStar:Xv,__values:wc,__read:nu,__spread:Qv,__spreadArrays:eg,__await:Ws,__asyncGenerator:tg,__asyncDelegator:rg,__asyncValues:ig,__makeTemplateObject:ng,__importStar:sg,__importDefault:og,__classPrivateFieldGet:ag,__classPrivateFieldSet:cg}),Go=bc(fg),_c={},Js={},su;function hg(){if(su)return Js;su=1,Object.defineProperty(Js,"__esModule",{value:!0}),Js.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return Js.delay=t,Js}var En={},xc={},Sn={},ou;function ug(){return ou||(ou=1,Object.defineProperty(Sn,"__esModule",{value:!0}),Sn.ONE_THOUSAND=Sn.ONE_HUNDRED=void 0,Sn.ONE_HUNDRED=100,Sn.ONE_THOUSAND=1e3),Sn}var Ec={},au;function dg(){return au||(au=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(Ec)),Ec}var cu;function fu(){return cu||(cu=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Go;e.__exportStar(ug(),t),e.__exportStar(dg(),t)}(xc)),xc}var hu;function lg(){if(hu)return En;hu=1,Object.defineProperty(En,"__esModule",{value:!0}),En.fromMiliseconds=En.toMiliseconds=void 0;const t=fu();function e(i){return i*t.ONE_THOUSAND}En.toMiliseconds=e;function r(i){return Math.floor(i/t.ONE_THOUSAND)}return En.fromMiliseconds=r,En}var uu;function pg(){return uu||(uu=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Go;e.__exportStar(hg(),t),e.__exportStar(lg(),t)}(_c)),_c}var Xn={},du;function vg(){if(du)return Xn;du=1,Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const i=this.get(r);if(typeof i.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const n=Date.now()-i.started;this.timestamps.set(r,{started:i.started,elapsed:n})}get(r){const i=this.timestamps.get(r);if(typeof i>"u")throw new Error(`No timestamp found for label: ${r}`);return i}elapsed(r){const i=this.get(r);return i.elapsed||Date.now()-i.started}}return Xn.Watch=t,Xn.default=t,Xn}var Sc={},Ys={},lu;function gg(){if(lu)return Ys;lu=1,Object.defineProperty(Ys,"__esModule",{value:!0}),Ys.IWatch=void 0;class t{}return Ys.IWatch=t,Ys}var pu;function bg(){return pu||(pu=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Go.__exportStar(gg(),t)}(Sc)),Sc}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Go;e.__exportStar(pg(),t),e.__exportStar(vg(),t),e.__exportStar(bg(),t),e.__exportStar(fu(),t)})(Z);class In{}class mg extends In{constructor(e){super()}}const vu=Z.FIVE_SECONDS,Qn={pulse:"heartbeat_pulse"};class Ic extends mg{constructor(e){super(e),this.events=new er.exports.EventEmitter,this.interval=vu,this.interval=e?.interval||vu}static async init(e){const r=new Ic(e);return await r.init(),r}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),Z.toMiliseconds(this.interval))}pulse(){this.events.emit(Qn.pulse)}}const yg=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,wg=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,_g=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function xg(t,e){if(t==="__proto__"||t==="constructor"&&e&&typeof e=="object"&&"prototype"in e){Eg(t);return}return e}function Eg(t){console.warn(`[destr] Dropping "${t}" key to prevent prototype pollution.`)}function Wo(t,e={}){if(typeof t!="string")return t;const r=t.trim();if(t[0]==='"'&&t.endsWith('"')&&!t.includes("\\"))return r.slice(1,-1);if(r.length<=9){const i=r.toLowerCase();if(i==="true")return!0;if(i==="false")return!1;if(i==="undefined")return;if(i==="null")return null;if(i==="nan")return Number.NaN;if(i==="infinity")return Number.POSITIVE_INFINITY;if(i==="-infinity")return Number.NEGATIVE_INFINITY}if(!_g.test(t)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return t}try{if(yg.test(t)||wg.test(t)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(t,xg)}return JSON.parse(t)}catch(i){if(e.strict)throw i;return t}}function Sg(t){return!t||typeof t.then!="function"?Promise.resolve(t):t}function Ct(t,...e){try{return Sg(t(...e))}catch(r){return Promise.reject(r)}}function Ig(t){const e=typeof t;return t===null||e!=="object"&&e!=="function"}function Ag(t){const e=Object.getPrototypeOf(t);return!e||e.isPrototypeOf(Object)}function Jo(t){if(Ig(t))return String(t);if(Ag(t)||Array.isArray(t))return JSON.stringify(t);if(typeof t.toJSON=="function")return Jo(t.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const Ac="base64:";function Mg(t){return typeof t=="string"?t:Ac+$g(t)}function Pg(t){return typeof t!="string"||!t.startsWith(Ac)?t:Dg(t.slice(Ac.length))}function Dg(t){return globalThis.Buffer?Buffer.from(t,"base64"):Uint8Array.from(globalThis.atob(t),e=>e.codePointAt(0))}function $g(t){return globalThis.Buffer?Buffer.from(t).toString("base64"):globalThis.btoa(String.fromCodePoint(...t))}function lr(t){return t&&t.split("?")[0]?.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,"")||""}function Og(...t){return lr(t.join(":"))}function Yo(t){return t=lr(t),t?t+":":""}function iN(t){return t}const Rg="memory",Ng=()=>{const t=new Map;return{name:Rg,getInstance:()=>t,hasItem(e){return t.has(e)},getItem(e){return t.get(e)??null},getItemRaw(e){return t.get(e)??null},setItem(e,r){t.set(e,r)},setItemRaw(e,r){t.set(e,r)},removeItem(e){t.delete(e)},getKeys(){return[...t.keys()]},clear(){t.clear()},dispose(){t.clear()}}};function Cg(t={}){const e={mounts:{"":t.driver||Ng()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=u=>{for(const p of e.mountpoints)if(u.startsWith(p))return{base:p,relativeKey:u.slice(p.length),driver:e.mounts[p]};return{base:"",relativeKey:u,driver:e.mounts[""]}},i=(u,p)=>e.mountpoints.filter(b=>b.startsWith(u)||p&&u.startsWith(b)).map(b=>({relativeBase:u.length>b.length?u.slice(b.length):void 0,mountpoint:b,driver:e.mounts[b]})),n=(u,p)=>{if(e.watching){p=lr(p);for(const b of e.watchListeners)b(u,p)}},s=async()=>{if(!e.watching){e.watching=!0;for(const u in e.mounts)e.unwatch[u]=await gu(e.mounts[u],n,u)}},o=async()=>{if(e.watching){for(const u in e.unwatch)await e.unwatch[u]();e.unwatch={},e.watching=!1}},a=(u,p,b)=>{const S=new Map,A=I=>{let P=S.get(I.base);return P||(P={driver:I.driver,base:I.base,items:[]},S.set(I.base,P)),P};for(const I of u){const P=typeof I=="string",R=lr(P?I:I.key),O=P?void 0:I.value,N=P||!I.options?p:{...p,...I.options},F=r(R);A(F).items.push({key:R,value:O,relativeKey:F.relativeKey,options:N})}return Promise.all([...S.values()].map(I=>b(I))).then(I=>I.flat())},h={hasItem(u,p={}){u=lr(u);const{relativeKey:b,driver:S}=r(u);return Ct(S.hasItem,b,p)},getItem(u,p={}){u=lr(u);const{relativeKey:b,driver:S}=r(u);return Ct(S.getItem,b,p).then(A=>Wo(A))},getItems(u,p={}){return a(u,p,b=>b.driver.getItems?Ct(b.driver.getItems,b.items.map(S=>({key:S.relativeKey,options:S.options})),p).then(S=>S.map(A=>({key:Og(b.base,A.key),value:Wo(A.value)}))):Promise.all(b.items.map(S=>Ct(b.driver.getItem,S.relativeKey,S.options).then(A=>({key:S.key,value:Wo(A)})))))},getItemRaw(u,p={}){u=lr(u);const{relativeKey:b,driver:S}=r(u);return S.getItemRaw?Ct(S.getItemRaw,b,p):Ct(S.getItem,b,p).then(A=>Pg(A))},async setItem(u,p,b={}){if(p===void 0)return h.removeItem(u);u=lr(u);const{relativeKey:S,driver:A}=r(u);A.setItem&&(await Ct(A.setItem,S,Jo(p),b),A.watch||n("update",u))},async setItems(u,p){await a(u,p,async b=>{if(b.driver.setItems)return Ct(b.driver.setItems,b.items.map(S=>({key:S.relativeKey,value:Jo(S.value),options:S.options})),p);b.driver.setItem&&await Promise.all(b.items.map(S=>Ct(b.driver.setItem,S.relativeKey,Jo(S.value),S.options)))})},async setItemRaw(u,p,b={}){if(p===void 0)return h.removeItem(u,b);u=lr(u);const{relativeKey:S,driver:A}=r(u);if(A.setItemRaw)await Ct(A.setItemRaw,S,p,b);else if(A.setItem)await Ct(A.setItem,S,Mg(p),b);else return;A.watch||n("update",u)},async removeItem(u,p={}){typeof p=="boolean"&&(p={removeMeta:p}),u=lr(u);const{relativeKey:b,driver:S}=r(u);S.removeItem&&(await Ct(S.removeItem,b,p),(p.removeMeta||p.removeMata)&&await Ct(S.removeItem,b+"$",p),S.watch||n("remove",u))},async getMeta(u,p={}){typeof p=="boolean"&&(p={nativeOnly:p}),u=lr(u);const{relativeKey:b,driver:S}=r(u),A=Object.create(null);if(S.getMeta&&Object.assign(A,await Ct(S.getMeta,b,p)),!p.nativeOnly){const I=await Ct(S.getItem,b+"$",p).then(P=>Wo(P));I&&typeof I=="object"&&(typeof I.atime=="string"&&(I.atime=new Date(I.atime)),typeof I.mtime=="string"&&(I.mtime=new Date(I.mtime)),Object.assign(A,I))}return A},setMeta(u,p,b={}){return this.setItem(u+"$",p,b)},removeMeta(u,p={}){return this.removeItem(u+"$",p)},async getKeys(u,p={}){u=Yo(u);const b=i(u,!0);let S=[];const A=[];for(const I of b){const P=await Ct(I.driver.getKeys,I.relativeBase,p);for(const R of P){const O=I.mountpoint+lr(R);S.some(N=>O.startsWith(N))||A.push(O)}S=[I.mountpoint,...S.filter(R=>!R.startsWith(I.mountpoint))]}return u?A.filter(I=>I.startsWith(u)&&I[I.length-1]!=="$"):A.filter(I=>I[I.length-1]!=="$")},async clear(u,p={}){u=Yo(u),await Promise.all(i(u,!1).map(async b=>{if(b.driver.clear)return Ct(b.driver.clear,b.relativeBase,p);if(b.driver.removeItem){const S=await b.driver.getKeys(b.relativeBase||"",p);return Promise.all(S.map(A=>b.driver.removeItem(A,p)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(u=>bu(u)))},async watch(u){return await s(),e.watchListeners.push(u),async()=>{e.watchListeners=e.watchListeners.filter(p=>p!==u),e.watchListeners.length===0&&await o()}},async unwatch(){e.watchListeners=[],await o()},mount(u,p){if(u=Yo(u),u&&e.mounts[u])throw new Error(`already mounted at ${u}`);return u&&(e.mountpoints.push(u),e.mountpoints.sort((b,S)=>S.length-b.length)),e.mounts[u]=p,e.watching&&Promise.resolve(gu(p,n,u)).then(b=>{e.unwatch[u]=b}).catch(console.error),h},async unmount(u,p=!0){u=Yo(u),!(!u||!e.mounts[u])&&(e.watching&&u in e.unwatch&&(e.unwatch[u]?.(),delete e.unwatch[u]),p&&await bu(e.mounts[u]),e.mountpoints=e.mountpoints.filter(b=>b!==u),delete e.mounts[u])},getMount(u=""){u=lr(u)+":";const p=r(u);return{driver:p.driver,base:p.base}},getMounts(u="",p={}){return u=lr(u),i(u,p.parents).map(S=>({driver:S.driver,base:S.mountpoint}))},keys:(u,p={})=>h.getKeys(u,p),get:(u,p={})=>h.getItem(u,p),set:(u,p,b={})=>h.setItem(u,p,b),has:(u,p={})=>h.hasItem(u,p),del:(u,p={})=>h.removeItem(u,p),remove:(u,p={})=>h.removeItem(u,p)};return h}function gu(t,e,r){return t.watch?t.watch((i,n)=>e(i,r+n)):()=>{}}async function bu(t){typeof t.dispose=="function"&&await Ct(t.dispose)}function An(t){return new Promise((e,r)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>r(t.error)})}function mu(t,e){const r=indexedDB.open(t);r.onupgradeneeded=()=>r.result.createObjectStore(e);const i=An(r);return(n,s)=>i.then(o=>s(o.transaction(e,n).objectStore(e)))}let Mc;function Zs(){return Mc||(Mc=mu("keyval-store","keyval")),Mc}function yu(t,e=Zs()){return e("readonly",r=>An(r.get(t)))}function Tg(t,e,r=Zs()){return r("readwrite",i=>(i.put(e,t),An(i.transaction)))}function Fg(t,e=Zs()){return e("readwrite",r=>(r.delete(t),An(r.transaction)))}function Bg(t=Zs()){return t("readwrite",e=>(e.clear(),An(e.transaction)))}function qg(t,e){return t.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},An(t.transaction)}function Lg(t=Zs()){return t("readonly",e=>{if(e.getAllKeys)return An(e.getAllKeys());const r=[];return qg(e,i=>r.push(i.key)).then(()=>r)})}const Ug=t=>JSON.stringify(t,(e,r)=>typeof r=="bigint"?r.toString()+"n":r),jg=t=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=t.replace(e,'$1"$2n"$3');return JSON.parse(r,(i,n)=>typeof n=="string"&&n.match(/^\d+n$/)?BigInt(n.substring(0,n.length-1)):n)};function Mn(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return jg(t)}catch{return t}}function $i(t){return typeof t=="string"?t:Ug(t)||""}const zg="idb-keyval";var kg=(t={})=>{const e=t.base&&t.base.length>0?`${t.base}:`:"",r=n=>e+n;let i;return t.dbName&&t.storeName&&(i=mu(t.dbName,t.storeName)),{name:zg,options:t,async hasItem(n){return!(typeof await yu(r(n),i)>"u")},async getItem(n){return await yu(r(n),i)??null},setItem(n,s){return Tg(r(n),s,i)},removeItem(n){return Fg(r(n),i)},getKeys(){return Lg(i)},clear(){return Bg(i)}}};const Hg="WALLET_CONNECT_V2_INDEXED_DB",Kg="keyvaluestorage";class Vg{constructor(){this.indexedDb=Cg({driver:kg({dbName:Hg,storeName:Kg})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const r=await this.indexedDb.getItem(e);if(r!==null)return r}async setItem(e,r){await this.indexedDb.setItem(e,$i(r))}async removeItem(e){await this.indexedDb.removeItem(e)}}var Pc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Zo={exports:{}};(function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,i){this[r]=String(i)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(i){r[i]=void 0,delete r[i]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Pc<"u"&&Pc.localStorage?Zo.exports=Pc.localStorage:typeof window<"u"&&window.localStorage?Zo.exports=window.localStorage:Zo.exports=new e})();function Gg(t){var e;return[t[0],Mn((e=t[1])!=null?e:"")]}class Wg{constructor(){this.localStorage=Zo.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(Gg)}async getItem(e){const r=this.localStorage.getItem(e);if(r!==null)return Mn(r)}async setItem(e,r){this.localStorage.setItem(e,$i(r))}async removeItem(e){this.localStorage.removeItem(e)}}const Jg="wc_storage_version",wu=1,Yg=async(t,e,r)=>{const i=Jg,n=await e.getItem(i);if(n&&n>=wu){r(e);return}const s=await t.getKeys();if(!s.length){r(e);return}const o=[];for(;s.length;){const a=s.shift();if(!a)continue;const h=a.toLowerCase();if(h.includes("wc@")||h.includes("walletconnect")||h.includes("wc_")||h.includes("wallet_connect")){const u=await t.getItem(a);await e.setItem(a,u),o.push(a)}}await e.setItem(i,wu),r(e),Zg(t,o)},Zg=async(t,e)=>{e.length&&e.forEach(async r=>{await t.removeItem(r)})};class Xg{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const e=new Wg;this.storage=e;try{const r=new Vg;Yg(e,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,r){return await this.initialize(),this.storage.setItem(e,r)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),e())},20)})}}function Qg(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}var eb=tb;function tb(t,e,r){var i=r&&r.stringify||Qg,n=1;if(typeof t=="object"&&t!==null){var s=e.length+n;if(s===1)return t;var o=new Array(s);o[0]=i(t);for(var a=1;a<s;a++)o[a]=i(e[a]);return o.join(" ")}if(typeof t!="string")return t;var h=e.length;if(h===0)return t;for(var u="",p=1-n,b=-1,S=t&&t.length||0,A=0;A<S;){if(t.charCodeAt(A)===37&&A+1<S){switch(b=b>-1?b:0,t.charCodeAt(A+1)){case 100:case 102:if(p>=h||e[p]==null)break;b<A&&(u+=t.slice(b,A)),u+=Number(e[p]),b=A+2,A++;break;case 105:if(p>=h||e[p]==null)break;b<A&&(u+=t.slice(b,A)),u+=Math.floor(Number(e[p])),b=A+2,A++;break;case 79:case 111:case 106:if(p>=h||e[p]===void 0)break;b<A&&(u+=t.slice(b,A));var I=typeof e[p];if(I==="string"){u+="'"+e[p]+"'",b=A+2,A++;break}if(I==="function"){u+=e[p].name||"<anonymous>",b=A+2,A++;break}u+=i(e[p]),b=A+2,A++;break;case 115:if(p>=h)break;b<A&&(u+=t.slice(b,A)),u+=String(e[p]),b=A+2,A++;break;case 37:b<A&&(u+=t.slice(b,A)),u+="%",b=A+2,A++,p--;break}++p}++A}return b===-1?t:(b<S&&(u+=t.slice(b)),u)}const _u=eb;var hi=ui;const Xs=ub().console||{},rb={mapHttpRequest:Qo,mapHttpResponse:Qo,wrapRequestSerializer:$c,wrapResponseSerializer:$c,wrapErrorSerializer:$c,req:Qo,res:Qo,err:ab};function ib(t,e){return Array.isArray(t)?t.filter(function(i){return i!=="!stdSerializers.err"}):t===!0?Object.keys(e):!1}function ui(t){t=t||{},t.browser=t.browser||{};const e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const r=t.browser.write||Xs;t.browser.write&&(t.browser.asObject=!0);const i=t.serializers||{},n=ib(t.browser.serialize,i);let s=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(s=!1);const o=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),t.enabled===!1&&(t.level="silent");const a=t.level||"info",h=Object.create(r);h.log||(h.log=Qs),Object.defineProperty(h,"levelVal",{get:p}),Object.defineProperty(h,"level",{get:b,set:S});const u={transmit:e,serialize:n,asObject:t.browser.asObject,levels:o,timestamp:cb(t)};h.levels=ui.levels,h.level=a,h.setMaxListeners=h.getMaxListeners=h.emit=h.addListener=h.on=h.prependListener=h.once=h.prependOnceListener=h.removeListener=h.removeAllListeners=h.listeners=h.listenerCount=h.eventNames=h.write=h.flush=Qs,h.serializers=i,h._serialize=n,h._stdErrSerialize=s,h.child=A,e&&(h._logEvent=Dc());function p(){return this.level==="silent"?1/0:this.levels.values[this.level]}function b(){return this._level}function S(I){if(I!=="silent"&&!this.levels.values[I])throw Error("unknown level "+I);this._level=I,es(u,h,"error","log"),es(u,h,"fatal","error"),es(u,h,"warn","error"),es(u,h,"info","log"),es(u,h,"debug","log"),es(u,h,"trace","log")}function A(I,P){if(!I)throw new Error("missing bindings for child Pino");P=P||{},n&&I.serializers&&(P.serializers=I.serializers);const R=P.serializers;if(n&&R){var O=Object.assign({},i,R),N=t.browser.serialize===!0?Object.keys(O):n;delete I.serializers,Xo([I],N,O,this._stdErrSerialize)}function F(L){this._childLevel=(L._childLevel|0)+1,this.error=ts(L,I,"error"),this.fatal=ts(L,I,"fatal"),this.warn=ts(L,I,"warn"),this.info=ts(L,I,"info"),this.debug=ts(L,I,"debug"),this.trace=ts(L,I,"trace"),O&&(this.serializers=O,this._serialize=N),e&&(this._logEvent=Dc([].concat(L._logEvent.bindings,I)))}return F.prototype=this,new F(this)}return h}ui.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},ui.stdSerializers=rb,ui.stdTimeFunctions=Object.assign({},{nullTime:xu,epochTime:Eu,unixTime:fb,isoTime:hb});function es(t,e,r,i){const n=Object.getPrototypeOf(e);e[r]=e.levelVal>e.levels.values[r]?Qs:n[r]?n[r]:Xs[r]||Xs[i]||Qs,nb(t,e,r)}function nb(t,e,r){!t.transmit&&e[r]===Qs||(e[r]=function(i){return function(){const s=t.timestamp(),o=new Array(arguments.length),a=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Xs?Xs:this;for(var h=0;h<o.length;h++)o[h]=arguments[h];if(t.serialize&&!t.asObject&&Xo(o,this._serialize,this.serializers,this._stdErrSerialize),t.asObject?i.call(a,sb(this,r,o,s)):i.apply(a,o),t.transmit){const u=t.transmit.level||e.level,p=ui.levels.values[u],b=ui.levels.values[r];if(b<p)return;ob(this,{ts:s,methodLevel:r,methodValue:b,transmitLevel:u,transmitValue:ui.levels.values[t.transmit.level||e.level],send:t.transmit.send,val:e.levelVal},o)}}}(e[r]))}function sb(t,e,r,i){t._serialize&&Xo(r,t._serialize,t.serializers,t._stdErrSerialize);const n=r.slice();let s=n[0];const o={};i&&(o.time=i),o.level=ui.levels.values[e];let a=(t._childLevel|0)+1;if(a<1&&(a=1),s!==null&&typeof s=="object"){for(;a--&&typeof n[0]=="object";)Object.assign(o,n.shift());s=n.length?_u(n.shift(),n):void 0}else typeof s=="string"&&(s=_u(n.shift(),n));return s!==void 0&&(o.msg=s),o}function Xo(t,e,r,i){for(const n in t)if(i&&t[n]instanceof Error)t[n]=ui.stdSerializers.err(t[n]);else if(typeof t[n]=="object"&&!Array.isArray(t[n]))for(const s in t[n])e&&e.indexOf(s)>-1&&s in r&&(t[n][s]=r[s](t[n][s]))}function ts(t,e,r){return function(){const i=new Array(1+arguments.length);i[0]=e;for(var n=1;n<i.length;n++)i[n]=arguments[n-1];return t[r].apply(this,i)}}function ob(t,e,r){const i=e.send,n=e.ts,s=e.methodLevel,o=e.methodValue,a=e.val,h=t._logEvent.bindings;Xo(r,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=n,t._logEvent.messages=r.filter(function(u){return h.indexOf(u)===-1}),t._logEvent.level.label=s,t._logEvent.level.value=o,i(s,t._logEvent,a),t._logEvent=Dc(h)}function Dc(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function ab(t){const e={type:t.constructor.name,msg:t.message,stack:t.stack};for(const r in t)e[r]===void 0&&(e[r]=t[r]);return e}function cb(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?xu:Eu}function Qo(){return{}}function $c(t){return t}function Qs(){}function xu(){return!1}function Eu(){return Date.now()}function fb(){return Math.round(Date.now()/1e3)}function hb(){return new Date(Date.now()).toISOString()}function ub(){function t(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}const db={level:"info"},eo="custom_context",Oc=1e3*1024;class lb{constructor(e){this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}}class Su{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const r=new lb(e);if(r.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${r.size}`);for(;this.size+r.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=r),this.tail=r):(this.head=r,this.tail=r),this.lengthInNodes++,this.sizeInBytes+=r.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let r=this.head;for(;r!==null;)e.push(r.value),r=r.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const r=e.value;return e=e.next,{done:!1,value:r}}}}}class Iu{constructor(e,r=Oc){this.level=e??"error",this.levelValue=hi.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=r,this.logs=new Su(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,r){r===hi.levels.values.error?console.error(e):r===hi.levels.values.warn?console.warn(e):r===hi.levels.values.debug?console.debug(e):r===hi.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append($i({timestamp:new Date().toISOString(),log:e}));const r=typeof e=="string"?JSON.parse(e).level:e.level;r>=this.levelValue&&this.forwardToConsole(e,r)}getLogs(){return this.logs}clearLogs(){this.logs=new Su(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const r=this.getLogArray();return r.push($i({extraMetadata:e})),new Blob(r,{type:"application/json"})}}class pb{constructor(e,r=Oc){this.baseChunkLogger=new Iu(e,r)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const r=URL.createObjectURL(this.logsToBlob(e)),i=document.createElement("a");i.href=r,i.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r)}}class vb{constructor(e,r=Oc){this.baseChunkLogger=new Iu(e,r)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}}var gb=Object.defineProperty,bb=Object.defineProperties,mb=Object.getOwnPropertyDescriptors,Au=Object.getOwnPropertySymbols,yb=Object.prototype.hasOwnProperty,wb=Object.prototype.propertyIsEnumerable,Mu=(t,e,r)=>e in t?gb(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ea=(t,e)=>{for(var r in e||(e={}))yb.call(e,r)&&Mu(t,r,e[r]);if(Au)for(var r of Au(e))wb.call(e,r)&&Mu(t,r,e[r]);return t},ta=(t,e)=>bb(t,mb(e));function ra(t){return ta(ea({},t),{level:t?.level||db.level})}function _b(t,e=eo){return t[e]||""}function xb(t,e,r=eo){return t[r]=e,t}function pr(t,e=eo){let r="";return typeof t.bindings>"u"?r=_b(t,e):r=t.bindings().context||"",r}function Eb(t,e,r=eo){const i=pr(t,r);return i.trim()?`${i}/${e}`:e}function ar(t,e,r=eo){const i=Eb(t,e,r),n=t.child({context:i});return xb(n,i,r)}function Sb(t){var e,r;const i=new pb((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:hi(ta(ea({},t.opts),{level:"trace",browser:ta(ea({},(r=t.opts)==null?void 0:r.browser),{write:n=>i.write(n)})})),chunkLoggerController:i}}function Ib(t){var e;const r=new vb((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:hi(ta(ea({},t.opts),{level:"trace"})),chunkLoggerController:r}}function Ab(t){return typeof t.loggerOverride<"u"&&typeof t.loggerOverride!="string"?{logger:t.loggerOverride,chunkLoggerController:null}:typeof window<"u"?Sb(t):Ib(t)}var Mb=Object.defineProperty,Pb=(t,e,r)=>e in t?Mb(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Pu=(t,e,r)=>Pb(t,typeof e!="symbol"?e+"":e,r);class Db extends In{constructor(e){super(),this.opts=e,Pu(this,"protocol","wc"),Pu(this,"version",2)}}var $b=Object.defineProperty,Ob=(t,e,r)=>e in t?$b(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Rb=(t,e,r)=>Ob(t,typeof e!="symbol"?e+"":e,r);class Nb extends In{constructor(e,r){super(),this.core=e,this.logger=r,Rb(this,"records",new Map)}}class Cb{constructor(e,r){this.logger=e,this.core=r}}class Tb extends In{constructor(e,r){super(),this.relayer=e,this.logger=r}}class Fb extends In{constructor(e){super()}}class Bb{constructor(e,r,i,n){this.core=e,this.logger=r,this.name=i}}class qb extends In{constructor(e,r){super(),this.relayer=e,this.logger=r}}class Lb extends In{constructor(e,r){super(),this.core=e,this.logger=r}}class Ub{constructor(e,r,i){this.core=e,this.logger=r,this.store=i}}class jb{constructor(e,r){this.projectId=e,this.logger=r}}class zb{constructor(e,r,i){this.core=e,this.logger=r,this.telemetryEnabled=i}}var kb=Object.defineProperty,Hb=(t,e,r)=>e in t?kb(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Du=(t,e,r)=>Hb(t,typeof e!="symbol"?e+"":e,r);class Kb{constructor(e){this.opts=e,Du(this,"protocol","wc"),Du(this,"version",2)}}class Vb{constructor(e){this.client=e}}function Gb(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function $u(t,...e){if(!Gb(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function Ou(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Wb(t,e){$u(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const rs=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Rc=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);function Jb(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function Ru(t){return typeof t=="string"&&(t=Jb(t)),$u(t),t}class Yb{clone(){return this._cloneInto()}}function Zb(t){const e=i=>t().update(Ru(i)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function Nu(t=32){if(rs&&typeof rs.getRandomValues=="function")return rs.getRandomValues(new Uint8Array(t));if(rs&&typeof rs.randomBytes=="function")return rs.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}function Xb(t,e,r,i){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,i);const n=BigInt(32),s=BigInt(4294967295),o=Number(r>>n&s),a=Number(r&s),h=i?4:0,u=i?0:4;t.setUint32(e+h,o,i),t.setUint32(e+u,a,i)}class Qb extends Yb{constructor(e,r,i,n){super(),this.blockLen=e,this.outputLen=r,this.padOffset=i,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Rc(this.buffer)}update(e){Ou(this);const{view:r,buffer:i,blockLen:n}=this;e=Ru(e);const s=e.length;for(let o=0;o<s;){const a=Math.min(n-this.pos,s-o);if(a===n){const h=Rc(e);for(;n<=s-o;o+=n)this.process(h,o);continue}i.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===n&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Ou(this),Wb(e,this),this.finished=!0;const{buffer:r,view:i,blockLen:n,isLE:s}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>n-o&&(this.process(i,0),o=0);for(let b=o;b<n;b++)r[b]=0;Xb(i,n-8,BigInt(this.length*8),s),this.process(i,0);const a=Rc(e),h=this.outputLen;if(h%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=h/4,p=this.get();if(u>p.length)throw new Error("_sha2: outputLen bigger than state");for(let b=0;b<u;b++)a.setUint32(4*b,p[b],s)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const i=e.slice(0,r);return this.destroy(),i}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:i,length:n,finished:s,destroyed:o,pos:a}=this;return e.length=n,e.pos=a,e.finished=s,e.destroyed=o,n%r&&e.buffer.set(i),e}}const ia=BigInt(2**32-1),Nc=BigInt(32);function Cu(t,e=!1){return e?{h:Number(t&ia),l:Number(t>>Nc&ia)}:{h:Number(t>>Nc&ia)|0,l:Number(t&ia)|0}}function em(t,e=!1){let r=new Uint32Array(t.length),i=new Uint32Array(t.length);for(let n=0;n<t.length;n++){const{h:s,l:o}=Cu(t[n],e);[r[n],i[n]]=[s,o]}return[r,i]}const tm=(t,e)=>BigInt(t>>>0)<<Nc|BigInt(e>>>0),rm=(t,e,r)=>t>>>r,im=(t,e,r)=>t<<32-r|e>>>r,nm=(t,e,r)=>t>>>r|e<<32-r,sm=(t,e,r)=>t<<32-r|e>>>r,om=(t,e,r)=>t<<64-r|e>>>r-32,am=(t,e,r)=>t>>>r-32|e<<64-r,cm=(t,e)=>e,fm=(t,e)=>t,hm=(t,e,r)=>t<<r|e>>>32-r,um=(t,e,r)=>e<<r|t>>>32-r,dm=(t,e,r)=>e<<r-32|t>>>64-r,lm=(t,e,r)=>t<<r-32|e>>>64-r;function pm(t,e,r,i){const n=(e>>>0)+(i>>>0);return{h:t+r+(n/2**32|0)|0,l:n|0}}const vm=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),gm=(t,e,r,i)=>e+r+i+(t/2**32|0)|0,bm=(t,e,r,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(i>>>0),mm=(t,e,r,i,n)=>e+r+i+n+(t/2**32|0)|0,ym=(t,e,r,i,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(i>>>0)+(n>>>0),wm=(t,e,r,i,n,s)=>e+r+i+n+s+(t/2**32|0)|0,xe={fromBig:Cu,split:em,toBig:tm,shrSH:rm,shrSL:im,rotrSH:nm,rotrSL:sm,rotrBH:om,rotrBL:am,rotr32H:cm,rotr32L:fm,rotlSH:hm,rotlSL:um,rotlBH:dm,rotlBL:lm,add:pm,add3L:vm,add3H:gm,add4L:bm,add4H:mm,add5H:wm,add5L:ym},[_m,xm]=xe.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),rn=new Uint32Array(80),nn=new Uint32Array(80);class Em extends Qb{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:r,Bh:i,Bl:n,Ch:s,Cl:o,Dh:a,Dl:h,Eh:u,El:p,Fh:b,Fl:S,Gh:A,Gl:I,Hh:P,Hl:R}=this;return[e,r,i,n,s,o,a,h,u,p,b,S,A,I,P,R]}set(e,r,i,n,s,o,a,h,u,p,b,S,A,I,P,R){this.Ah=e|0,this.Al=r|0,this.Bh=i|0,this.Bl=n|0,this.Ch=s|0,this.Cl=o|0,this.Dh=a|0,this.Dl=h|0,this.Eh=u|0,this.El=p|0,this.Fh=b|0,this.Fl=S|0,this.Gh=A|0,this.Gl=I|0,this.Hh=P|0,this.Hl=R|0}process(e,r){for(let F=0;F<16;F++,r+=4)rn[F]=e.getUint32(r),nn[F]=e.getUint32(r+=4);for(let F=16;F<80;F++){const L=rn[F-15]|0,z=nn[F-15]|0,k=xe.rotrSH(L,z,1)^xe.rotrSH(L,z,8)^xe.shrSH(L,z,7),G=xe.rotrSL(L,z,1)^xe.rotrSL(L,z,8)^xe.shrSL(L,z,7),K=rn[F-2]|0,H=nn[F-2]|0,ie=xe.rotrSH(K,H,19)^xe.rotrBH(K,H,61)^xe.shrSH(K,H,6),D=xe.rotrSL(K,H,19)^xe.rotrBL(K,H,61)^xe.shrSL(K,H,6),g=xe.add4L(G,D,nn[F-7],nn[F-16]),v=xe.add4H(g,k,ie,rn[F-7],rn[F-16]);rn[F]=v|0,nn[F]=g|0}let{Ah:i,Al:n,Bh:s,Bl:o,Ch:a,Cl:h,Dh:u,Dl:p,Eh:b,El:S,Fh:A,Fl:I,Gh:P,Gl:R,Hh:O,Hl:N}=this;for(let F=0;F<80;F++){const L=xe.rotrSH(b,S,14)^xe.rotrSH(b,S,18)^xe.rotrBH(b,S,41),z=xe.rotrSL(b,S,14)^xe.rotrSL(b,S,18)^xe.rotrBL(b,S,41),k=b&A^~b&P,G=S&I^~S&R,K=xe.add5L(N,z,G,xm[F],nn[F]),H=xe.add5H(K,O,L,k,_m[F],rn[F]),ie=K|0,D=xe.rotrSH(i,n,28)^xe.rotrBH(i,n,34)^xe.rotrBH(i,n,39),g=xe.rotrSL(i,n,28)^xe.rotrBL(i,n,34)^xe.rotrBL(i,n,39),v=i&s^i&a^s&a,c=n&o^n&h^o&h;O=P|0,N=R|0,P=A|0,R=I|0,A=b|0,I=S|0,{h:b,l:S}=xe.add(u|0,p|0,H|0,ie|0),u=a|0,p=h|0,a=s|0,h=o|0,s=i|0,o=n|0;const f=xe.add3L(ie,g,c);i=xe.add3H(f,H,D,v),n=f|0}({h:i,l:n}=xe.add(this.Ah|0,this.Al|0,i|0,n|0)),{h:s,l:o}=xe.add(this.Bh|0,this.Bl|0,s|0,o|0),{h:a,l:h}=xe.add(this.Ch|0,this.Cl|0,a|0,h|0),{h:u,l:p}=xe.add(this.Dh|0,this.Dl|0,u|0,p|0),{h:b,l:S}=xe.add(this.Eh|0,this.El|0,b|0,S|0),{h:A,l:I}=xe.add(this.Fh|0,this.Fl|0,A|0,I|0),{h:P,l:R}=xe.add(this.Gh|0,this.Gl|0,P|0,R|0),{h:O,l:N}=xe.add(this.Hh|0,this.Hl|0,O|0,N|0),this.set(i,n,s,o,a,h,u,p,b,S,A,I,P,R,O,N)}roundClean(){rn.fill(0),nn.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Sm=Zb(()=>new Em);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Cc=BigInt(0),Tu=BigInt(1),Im=BigInt(2);function Tc(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Fc(t){if(!Tc(t))throw new Error("Uint8Array expected")}function Bc(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const Am=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function qc(t){Fc(t);let e="";for(let r=0;r<t.length;r++)e+=Am[t[r]];return e}function Fu(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Cc:BigInt("0x"+t)}const Oi={_0:48,_9:57,A:65,F:70,a:97,f:102};function Bu(t){if(t>=Oi._0&&t<=Oi._9)return t-Oi._0;if(t>=Oi.A&&t<=Oi.F)return t-(Oi.A-10);if(t>=Oi.a&&t<=Oi.f)return t-(Oi.a-10)}function qu(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const i=new Uint8Array(r);for(let n=0,s=0;n<r;n++,s+=2){const o=Bu(t.charCodeAt(s)),a=Bu(t.charCodeAt(s+1));if(o===void 0||a===void 0){const h=t[s]+t[s+1];throw new Error('hex string expected, got non-hex character "'+h+'" at index '+s)}i[n]=o*16+a}return i}function Mm(t){return Fu(qc(t))}function na(t){return Fc(t),Fu(qc(Uint8Array.from(t).reverse()))}function Lu(t,e){return qu(t.toString(16).padStart(e*2,"0"))}function Lc(t,e){return Lu(t,e).reverse()}function Ri(t,e,r){let i;if(typeof e=="string")try{i=qu(e)}catch(s){throw new Error(t+" must be hex string or Uint8Array, cause: "+s)}else if(Tc(e))i=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const n=i.length;if(typeof r=="number"&&n!==r)throw new Error(t+" of length "+r+" expected, got "+n);return i}function Uu(...t){let e=0;for(let i=0;i<t.length;i++){const n=t[i];Fc(n),e+=n.length}const r=new Uint8Array(e);for(let i=0,n=0;i<t.length;i++){const s=t[i];r.set(s,n),n+=s.length}return r}const Uc=t=>typeof t=="bigint"&&Cc<=t;function Pm(t,e,r){return Uc(t)&&Uc(e)&&Uc(r)&&e<=t&&t<r}function to(t,e,r,i){if(!Pm(e,r,i))throw new Error("expected valid "+t+": "+r+" <= n < "+i+", got "+e)}function Dm(t){let e;for(e=0;t>Cc;t>>=Tu,e+=1);return e}const $m=t=>(Im<<BigInt(t-1))-Tu,Om={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||Tc(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function jc(t,e,r={}){const i=(n,s,o)=>{const a=Om[s];if(typeof a!="function")throw new Error("invalid validator function");const h=t[n];if(!(o&&h===void 0)&&!a(h,t))throw new Error("param "+String(n)+" is invalid. Expected "+s+", got "+h)};for(const[n,s]of Object.entries(e))i(n,s,!1);for(const[n,s]of Object.entries(r))i(n,s,!0);return t}function ju(t){const e=new WeakMap;return(r,...i)=>{const n=e.get(r);if(n!==void 0)return n;const s=t(r,...i);return e.set(r,s),s}}const Tt=BigInt(0),At=BigInt(1),Pn=BigInt(2),Rm=BigInt(3),zc=BigInt(4),zu=BigInt(5),ku=BigInt(8);function Ot(t,e){const r=t%e;return r>=Tt?r:e+r}function Nm(t,e,r){if(e<Tt)throw new Error("invalid exponent, negatives unsupported");if(r<=Tt)throw new Error("invalid modulus");if(r===At)return Tt;let i=At;for(;e>Tt;)e&At&&(i=i*t%r),t=t*t%r,e>>=At;return i}function di(t,e,r){let i=t;for(;e-- >Tt;)i*=i,i%=r;return i}function Hu(t,e){if(t===Tt)throw new Error("invert: expected non-zero number");if(e<=Tt)throw new Error("invert: expected positive modulus, got "+e);let r=Ot(t,e),i=e,n=Tt,s=At;for(;r!==Tt;){const o=i/r,a=i%r,h=n-s*o;i=r,r=a,n=s,s=h}if(i!==At)throw new Error("invert: does not exist");return Ot(n,e)}function Cm(t){const e=(t-At)/Pn;let r,i,n;for(r=t-At,i=0;r%Pn===Tt;r/=Pn,i++);for(n=Pn;n<t&&Nm(n,e,t)!==t-At;n++)if(n>1e3)throw new Error("Cannot find square root: likely non-prime P");if(i===1){const o=(t+At)/zc;return function(a,h){const u=a.pow(h,o);if(!a.eql(a.sqr(u),h))throw new Error("Cannot find square root");return u}}const s=(r+At)/Pn;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let h=i,u=o.pow(o.mul(o.ONE,n),r),p=o.pow(a,s),b=o.pow(a,r);for(;!o.eql(b,o.ONE);){if(o.eql(b,o.ZERO))return o.ZERO;let S=1;for(let I=o.sqr(b);S<h&&!o.eql(I,o.ONE);S++)I=o.sqr(I);const A=o.pow(u,At<<BigInt(h-S-1));u=o.sqr(A),p=o.mul(p,A),b=o.mul(b,u),h=S}return p}}function Tm(t){if(t%zc===Rm){const e=(t+At)/zc;return function(r,i){const n=r.pow(i,e);if(!r.eql(r.sqr(n),i))throw new Error("Cannot find square root");return n}}if(t%ku===zu){const e=(t-zu)/ku;return function(r,i){const n=r.mul(i,Pn),s=r.pow(n,e),o=r.mul(i,s),a=r.mul(r.mul(o,Pn),s),h=r.mul(o,r.sub(a,r.ONE));if(!r.eql(r.sqr(h),i))throw new Error("Cannot find square root");return h}}return Cm(t)}const Fm=(t,e)=>(Ot(t,e)&At)===At,Bm=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function qm(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=Bm.reduce((i,n)=>(i[n]="function",i),e);return jc(t,r)}function Lm(t,e,r){if(r<Tt)throw new Error("invalid exponent, negatives unsupported");if(r===Tt)return t.ONE;if(r===At)return e;let i=t.ONE,n=e;for(;r>Tt;)r&At&&(i=t.mul(i,n)),n=t.sqr(n),r>>=At;return i}function Um(t,e){const r=new Array(e.length),i=e.reduce((s,o,a)=>t.is0(o)?s:(r[a]=s,t.mul(s,o)),t.ONE),n=t.inv(i);return e.reduceRight((s,o,a)=>t.is0(o)?s:(r[a]=t.mul(s,r[a]),t.mul(s,o)),n),r}function Ku(t,e){const r=e!==void 0?e:t.toString(2).length,i=Math.ceil(r/8);return{nBitLength:r,nByteLength:i}}function Vu(t,e,r=!1,i={}){if(t<=Tt)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:n,nByteLength:s}=Ku(t,e);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:r,BITS:n,BYTES:s,MASK:$m(n),ZERO:Tt,ONE:At,create:h=>Ot(h,t),isValid:h=>{if(typeof h!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof h);return Tt<=h&&h<t},is0:h=>h===Tt,isOdd:h=>(h&At)===At,neg:h=>Ot(-h,t),eql:(h,u)=>h===u,sqr:h=>Ot(h*h,t),add:(h,u)=>Ot(h+u,t),sub:(h,u)=>Ot(h-u,t),mul:(h,u)=>Ot(h*u,t),pow:(h,u)=>Lm(a,h,u),div:(h,u)=>Ot(h*Hu(u,t),t),sqrN:h=>h*h,addN:(h,u)=>h+u,subN:(h,u)=>h-u,mulN:(h,u)=>h*u,inv:h=>Hu(h,t),sqrt:i.sqrt||(h=>(o||(o=Tm(t)),o(a,h))),invertBatch:h=>Um(a,h),cmov:(h,u,p)=>p?u:h,toBytes:h=>r?Lc(h,s):Lu(h,s),fromBytes:h=>{if(h.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+h.length);return r?na(h):Mm(h)}});return Object.freeze(a)}const Gu=BigInt(0),sa=BigInt(1);function kc(t,e){const r=e.negate();return t?r:e}function Wu(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Hc(t,e){Wu(t,e);const r=Math.ceil(e/t)+1,i=2**(t-1);return{windows:r,windowSize:i}}function jm(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,i)=>{if(!(r instanceof e))throw new Error("invalid point at index "+i)})}function zm(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,i)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+i)})}const Kc=new WeakMap,Ju=new WeakMap;function Vc(t){return Ju.get(t)||1}function km(t,e){return{constTimeNegate:kc,hasPrecomputes(r){return Vc(r)!==1},unsafeLadder(r,i,n=t.ZERO){let s=r;for(;i>Gu;)i&sa&&(n=n.add(s)),s=s.double(),i>>=sa;return n},precomputeWindow(r,i){const{windows:n,windowSize:s}=Hc(i,e),o=[];let a=r,h=a;for(let u=0;u<n;u++){h=a,o.push(h);for(let p=1;p<s;p++)h=h.add(a),o.push(h);a=h.double()}return o},wNAF(r,i,n){const{windows:s,windowSize:o}=Hc(r,e);let a=t.ZERO,h=t.BASE;const u=BigInt(2**r-1),p=2**r,b=BigInt(r);for(let S=0;S<s;S++){const A=S*o;let I=Number(n&u);n>>=b,I>o&&(I-=p,n+=sa);const P=A,R=A+Math.abs(I)-1,O=S%2!==0,N=I<0;I===0?h=h.add(kc(O,i[P])):a=a.add(kc(N,i[R]))}return{p:a,f:h}},wNAFUnsafe(r,i,n,s=t.ZERO){const{windows:o,windowSize:a}=Hc(r,e),h=BigInt(2**r-1),u=2**r,p=BigInt(r);for(let b=0;b<o;b++){const S=b*a;if(n===Gu)break;let A=Number(n&h);if(n>>=p,A>a&&(A-=u,n+=sa),A===0)continue;let I=i[S+Math.abs(A)-1];A<0&&(I=I.negate()),s=s.add(I)}return s},getPrecomputes(r,i,n){let s=Kc.get(i);return s||(s=this.precomputeWindow(i,r),r!==1&&Kc.set(i,n(s))),s},wNAFCached(r,i,n){const s=Vc(r);return this.wNAF(s,this.getPrecomputes(s,r,n),i)},wNAFCachedUnsafe(r,i,n,s){const o=Vc(r);return o===1?this.unsafeLadder(r,i,s):this.wNAFUnsafe(o,this.getPrecomputes(o,r,n),i,s)},setWindowSize(r,i){Wu(i,e),Ju.set(r,i),Kc.delete(r)}}}function Hm(t,e,r,i){if(jm(r,t),zm(i,e),r.length!==i.length)throw new Error("arrays of points and scalars must have equal length");const n=t.ZERO,s=Dm(BigInt(r.length)),o=s>12?s-3:s>4?s-2:s?2:1,a=(1<<o)-1,h=new Array(a+1).fill(n),u=Math.floor((e.BITS-1)/o)*o;let p=n;for(let b=u;b>=0;b-=o){h.fill(n);for(let A=0;A<i.length;A++){const I=i[A],P=Number(I>>BigInt(b)&BigInt(a));h[P]=h[P].add(r[A])}let S=n;for(let A=h.length-1,I=n;A>0;A--)I=I.add(h[A]),S=S.add(I);if(p=p.add(S),b!==0)for(let A=0;A<o;A++)p=p.double()}return p}function Km(t){return qm(t.Fp),jc(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Ku(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const Xr=BigInt(0),vr=BigInt(1),oa=BigInt(2),Vm=BigInt(8),Gm={zip215:!0};function Wm(t){const e=Km(t);return jc(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function Jm(t){const e=Wm(t),{Fp:r,n:i,prehash:n,hash:s,randomBytes:o,nByteLength:a,h}=e,u=oa<<BigInt(a*8)-vr,p=r.create,b=Vu(e.n,e.nBitLength),S=e.uvRatio||((f,l)=>{try{return{isValid:!0,value:r.sqrt(f*r.inv(l))}}catch{return{isValid:!1,value:Xr}}}),A=e.adjustScalarBytes||(f=>f),I=e.domain||((f,l,_)=>{if(Bc("phflag",_),l.length||_)throw new Error("Contexts/pre-hash are not supported");return f});function P(f,l){to("coordinate "+f,l,Xr,u)}function R(f){if(!(f instanceof F))throw new Error("ExtendedPoint expected")}const O=ju((f,l)=>{const{ex:_,ey:x,ez:y}=f,d=f.is0();l==null&&(l=d?Vm:r.inv(y));const w=p(_*l),m=p(x*l),M=p(y*l);if(d)return{x:Xr,y:vr};if(M!==vr)throw new Error("invZ was invalid");return{x:w,y:m}}),N=ju(f=>{const{a:l,d:_}=e;if(f.is0())throw new Error("bad point: ZERO");const{ex:x,ey:y,ez:d,et:w}=f,m=p(x*x),M=p(y*y),B=p(d*d),E=p(B*B),C=p(m*l),q=p(B*p(C+M)),U=p(E+p(_*p(m*M)));if(q!==U)throw new Error("bad point: equation left != right (1)");const j=p(x*y),Y=p(d*w);if(j!==Y)throw new Error("bad point: equation left != right (2)");return!0});class F{constructor(l,_,x,y){this.ex=l,this.ey=_,this.ez=x,this.et=y,P("x",l),P("y",_),P("z",x),P("t",y),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(l){if(l instanceof F)throw new Error("extended point not allowed");const{x:_,y:x}=l||{};return P("x",_),P("y",x),new F(_,x,vr,p(_*x))}static normalizeZ(l){const _=r.invertBatch(l.map(x=>x.ez));return l.map((x,y)=>x.toAffine(_[y])).map(F.fromAffine)}static msm(l,_){return Hm(F,b,l,_)}_setWindowSize(l){k.setWindowSize(this,l)}assertValidity(){N(this)}equals(l){R(l);const{ex:_,ey:x,ez:y}=this,{ex:d,ey:w,ez:m}=l,M=p(_*m),B=p(d*y),E=p(x*m),C=p(w*y);return M===B&&E===C}is0(){return this.equals(F.ZERO)}negate(){return new F(p(-this.ex),this.ey,this.ez,p(-this.et))}double(){const{a:l}=e,{ex:_,ey:x,ez:y}=this,d=p(_*_),w=p(x*x),m=p(oa*p(y*y)),M=p(l*d),B=_+x,E=p(p(B*B)-d-w),C=M+w,q=C-m,U=M-w,j=p(E*q),Y=p(C*U),X=p(E*U),W=p(q*C);return new F(j,Y,W,X)}add(l){R(l);const{a:_,d:x}=e,{ex:y,ey:d,ez:w,et:m}=this,{ex:M,ey:B,ez:E,et:C}=l;if(_===BigInt(-1)){const Ne=p((d-y)*(B+M)),Ce=p((d+y)*(B-M)),ce=p(Ce-Ne);if(ce===Xr)return this.double();const Te=p(w*oa*C),Fe=p(m*oa*E),he=Fe+Te,Be=Ce+Ne,qe=Fe-Te,ae=p(he*ce),Oe=p(Be*qe),Le=p(he*qe),ne=p(ce*Be);return new F(ae,Oe,ne,Le)}const q=p(y*M),U=p(d*B),j=p(m*x*C),Y=p(w*E),X=p((y+d)*(M+B)-q-U),W=Y-j,se=Y+j,ee=p(U-_*q),te=p(X*W),ke=p(se*ee),He=p(X*ee),ue=p(W*se);return new F(te,ke,ue,He)}subtract(l){return this.add(l.negate())}wNAF(l){return k.wNAFCached(this,l,F.normalizeZ)}multiply(l){const _=l;to("scalar",_,vr,i);const{p:x,f:y}=this.wNAF(_);return F.normalizeZ([x,y])[0]}multiplyUnsafe(l,_=F.ZERO){const x=l;return to("scalar",x,Xr,i),x===Xr?z:this.is0()||x===vr?this:k.wNAFCachedUnsafe(this,x,F.normalizeZ,_)}isSmallOrder(){return this.multiplyUnsafe(h).is0()}isTorsionFree(){return k.unsafeLadder(this,i).is0()}toAffine(l){return O(this,l)}clearCofactor(){const{h:l}=e;return l===vr?this:this.multiplyUnsafe(l)}static fromHex(l,_=!1){const{d:x,a:y}=e,d=r.BYTES;l=Ri("pointHex",l,d),Bc("zip215",_);const w=l.slice(),m=l[d-1];w[d-1]=m&-129;const M=na(w),B=_?u:r.ORDER;to("pointHex.y",M,Xr,B);const E=p(M*M),C=p(E-vr),q=p(x*E-y);let{isValid:U,value:j}=S(C,q);if(!U)throw new Error("Point.fromHex: invalid y coordinate");const Y=(j&vr)===vr,X=(m&128)!==0;if(!_&&j===Xr&&X)throw new Error("Point.fromHex: x=0 and x_0=1");return X!==Y&&(j=p(-j)),F.fromAffine({x:j,y:M})}static fromPrivateKey(l){return H(l).point}toRawBytes(){const{x:l,y:_}=this.toAffine(),x=Lc(_,r.BYTES);return x[x.length-1]|=l&vr?128:0,x}toHex(){return qc(this.toRawBytes())}}F.BASE=new F(e.Gx,e.Gy,vr,p(e.Gx*e.Gy)),F.ZERO=new F(Xr,vr,vr,Xr);const{BASE:L,ZERO:z}=F,k=km(F,a*8);function G(f){return Ot(f,i)}function K(f){return G(na(f))}function H(f){const l=r.BYTES;f=Ri("private key",f,l);const _=Ri("hashed private key",s(f),2*l),x=A(_.slice(0,l)),y=_.slice(l,2*l),d=K(x),w=L.multiply(d),m=w.toRawBytes();return{head:x,prefix:y,scalar:d,point:w,pointBytes:m}}function ie(f){return H(f).pointBytes}function D(f=new Uint8Array,...l){const _=Uu(...l);return K(s(I(_,Ri("context",f),!!n)))}function g(f,l,_={}){f=Ri("message",f),n&&(f=n(f));const{prefix:x,scalar:y,pointBytes:d}=H(l),w=D(_.context,x,f),m=L.multiply(w).toRawBytes(),M=D(_.context,m,d,f),B=G(w+M*y);to("signature.s",B,Xr,i);const E=Uu(m,Lc(B,r.BYTES));return Ri("result",E,r.BYTES*2)}const v=Gm;function c(f,l,_,x=v){const{context:y,zip215:d}=x,w=r.BYTES;f=Ri("signature",f,2*w),l=Ri("message",l),_=Ri("publicKey",_,w),d!==void 0&&Bc("zip215",d),n&&(l=n(l));const m=na(f.slice(w,2*w));let M,B,E;try{M=F.fromHex(_,d),B=F.fromHex(f.slice(0,w),d),E=L.multiplyUnsafe(m)}catch{return!1}if(!d&&M.isSmallOrder())return!1;const C=D(y,B.toRawBytes(),M.toRawBytes(),l);return B.add(M.multiplyUnsafe(C)).subtract(E).clearCofactor().equals(F.ZERO)}return L._setWindowSize(8),{CURVE:e,getPublicKey:ie,sign:g,verify:c,ExtendedPoint:F,utils:{getExtendedPublicKey:H,randomPrivateKey:()=>o(r.BYTES),precompute(f=8,l=F.BASE){return l._setWindowSize(f),l.multiply(BigInt(3)),l}}}}BigInt(0),BigInt(1);const Gc=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Yu=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const Ym=BigInt(1),Zu=BigInt(2);BigInt(3);const Zm=BigInt(5),Xm=BigInt(8);function Qm(t){const e=BigInt(10),r=BigInt(20),i=BigInt(40),n=BigInt(80),s=Gc,o=t*t%s*t%s,a=di(o,Zu,s)*o%s,h=di(a,Ym,s)*t%s,u=di(h,Zm,s)*h%s,p=di(u,e,s)*u%s,b=di(p,r,s)*p%s,S=di(b,i,s)*b%s,A=di(S,n,s)*S%s,I=di(A,n,s)*S%s,P=di(I,e,s)*u%s;return{pow_p_5_8:di(P,Zu,s)*t%s,b2:o}}function ey(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function ty(t,e){const r=Gc,i=Ot(e*e*e,r),n=Ot(i*i*e,r),s=Qm(t*n).pow_p_5_8;let o=Ot(t*i*s,r);const a=Ot(e*o*o,r),h=o,u=Ot(o*Yu,r),p=a===t,b=a===Ot(-t,r),S=a===Ot(-t*Yu,r);return p&&(o=h),(b||S)&&(o=u),Fm(o,r)&&(o=Ot(-o,r)),{isValid:p||b,value:o}}const ry=Vu(Gc,void 0,!0),iy={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:ry,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:Xm,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Sm,randomBytes:Nu,adjustScalarBytes:ey,uvRatio:ty},Xu=Jm(iy),ny="EdDSA",sy="JWT",aa=".",ca="base64url",Qu="utf8",ed="utf8",oy=":",ay="did",cy="key",td="base58btc",fy="z",hy="K36",uy=32;function Wc(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function rd(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Wc(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function id(t,e){e||(e=t.reduce((n,s)=>n+s.length,0));const r=rd(e);let i=0;for(const n of t)r.set(n,i),i+=n.length;return Wc(r)}function dy(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=n}var a=t.length,h=t.charAt(0),u=Math.log(a)/Math.log(256),p=Math.log(256)/Math.log(a);function b(I){if(I instanceof Uint8Array||(ArrayBuffer.isView(I)?I=new Uint8Array(I.buffer,I.byteOffset,I.byteLength):Array.isArray(I)&&(I=Uint8Array.from(I))),!(I instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(I.length===0)return"";for(var P=0,R=0,O=0,N=I.length;O!==N&&I[O]===0;)O++,P++;for(var F=(N-O)*p+1>>>0,L=new Uint8Array(F);O!==N;){for(var z=I[O],k=0,G=F-1;(z!==0||k<R)&&G!==-1;G--,k++)z+=256*L[G]>>>0,L[G]=z%a>>>0,z=z/a>>>0;if(z!==0)throw new Error("Non-zero carry");R=k,O++}for(var K=F-R;K!==F&&L[K]===0;)K++;for(var H=h.repeat(P);K<F;++K)H+=t.charAt(L[K]);return H}function S(I){if(typeof I!="string")throw new TypeError("Expected String");if(I.length===0)return new Uint8Array;var P=0;if(I[P]!==" "){for(var R=0,O=0;I[P]===h;)R++,P++;for(var N=(I.length-P)*u+1>>>0,F=new Uint8Array(N);I[P];){var L=r[I.charCodeAt(P)];if(L===255)return;for(var z=0,k=N-1;(L!==0||z<O)&&k!==-1;k--,z++)L+=a*F[k]>>>0,F[k]=L%256>>>0,L=L/256>>>0;if(L!==0)throw new Error("Non-zero carry");O=z,P++}if(I[P]!==" "){for(var G=N-O;G!==N&&F[G]===0;)G++;for(var K=new Uint8Array(R+(N-G)),H=R;G!==N;)K[H++]=F[G++];return K}}}function A(I){var P=S(I);if(P)return P;throw new Error(`Non-${e} character`)}return{encode:b,decodeUnsafe:S,decode:A}}var ly=dy,py=ly;const nd=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},vy=t=>new TextEncoder().encode(t),gy=t=>new TextDecoder().decode(t);class by{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class my{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return sd(this,e)}}class yy{constructor(e){this.decoders=e}or(e){return sd(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const sd=(t,e)=>new yy({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class wy{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new by(e,r,i),this.decoder=new my(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const fa=({name:t,prefix:e,encode:r,decode:i})=>new wy(t,e,r,i),ro=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=py(r,e);return fa({prefix:t,name:e,encode:i,decode:s=>nd(n(s))})},_y=(t,e,r,i)=>{const n={};for(let p=0;p<e.length;++p)n[e[p]]=p;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let a=0,h=0,u=0;for(let p=0;p<s;++p){const b=n[t[p]];if(b===void 0)throw new SyntaxError(`Non-${i} character`);h=h<<r|b,a+=r,a>=8&&(a-=8,o[u++]=255&h>>a)}if(a>=r||255&h<<8-a)throw new SyntaxError("Unexpected end of data");return o},xy=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",o=0,a=0;for(let h=0;h<t.length;++h)for(a=a<<8|t[h],o+=8;o>r;)o-=r,s+=e[n&a>>o];if(o&&(s+=e[n&a<<r-o]),i)for(;s.length*r&7;)s+="=";return s},Ht=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>fa({prefix:e,name:t,encode(n){return xy(n,i,r)},decode(n){return _y(n,i,r,t)}}),Ey=fa({prefix:"\0",name:"identity",encode:t=>gy(t),decode:t=>vy(t)});var Sy=Object.freeze({__proto__:null,identity:Ey});const Iy=Ht({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Ay=Object.freeze({__proto__:null,base2:Iy});const My=Ht({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Py=Object.freeze({__proto__:null,base8:My});const Dy=ro({prefix:"9",name:"base10",alphabet:"0123456789"});var $y=Object.freeze({__proto__:null,base10:Dy});const Oy=Ht({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Ry=Ht({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Ny=Object.freeze({__proto__:null,base16:Oy,base16upper:Ry});const Cy=Ht({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ty=Ht({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Fy=Ht({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),By=Ht({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),qy=Ht({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Ly=Ht({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Uy=Ht({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),jy=Ht({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),zy=Ht({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var ky=Object.freeze({__proto__:null,base32:Cy,base32upper:Ty,base32pad:Fy,base32padupper:By,base32hex:qy,base32hexupper:Ly,base32hexpad:Uy,base32hexpadupper:jy,base32z:zy});const Hy=ro({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Ky=ro({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Vy=Object.freeze({__proto__:null,base36:Hy,base36upper:Ky});const Gy=ro({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Wy=ro({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Jy=Object.freeze({__proto__:null,base58btc:Gy,base58flickr:Wy});const Yy=Ht({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Zy=Ht({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Xy=Ht({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Qy=Ht({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var e2=Object.freeze({__proto__:null,base64:Yy,base64pad:Zy,base64url:Xy,base64urlpad:Qy});const od=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),t2=od.reduce((t,e,r)=>(t[r]=e,t),[]),r2=od.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function i2(t){return t.reduce((e,r)=>(e+=t2[r],e),"")}function n2(t){const e=[];for(const r of t){const i=r2[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const s2=fa({prefix:"\u{1F680}",name:"base256emoji",encode:i2,decode:n2});var o2=Object.freeze({__proto__:null,base256emoji:s2}),a2=cd,ad=128,c2=127,f2=~c2,h2=Math.pow(2,31);function cd(t,e,r){e=e||[],r=r||0;for(var i=r;t>=h2;)e[r++]=t&255|ad,t/=128;for(;t&f2;)e[r++]=t&255|ad,t>>>=7;return e[r]=t|0,cd.bytes=r-i+1,e}var u2=Jc,d2=128,fd=127;function Jc(t,i){var r=0,i=i||0,n=0,s=i,o,a=t.length;do{if(s>=a)throw Jc.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=n<28?(o&fd)<<n:(o&fd)*Math.pow(2,n),n+=7}while(o>=d2);return Jc.bytes=s-i,r}var l2=Math.pow(2,7),p2=Math.pow(2,14),v2=Math.pow(2,21),g2=Math.pow(2,28),b2=Math.pow(2,35),m2=Math.pow(2,42),y2=Math.pow(2,49),w2=Math.pow(2,56),_2=Math.pow(2,63),x2=function(t){return t<l2?1:t<p2?2:t<v2?3:t<g2?4:t<b2?5:t<m2?6:t<y2?7:t<w2?8:t<_2?9:10},E2={encode:a2,decode:u2,encodingLength:x2},hd=E2;const ud=(t,e,r=0)=>(hd.encode(t,e,r),e),dd=t=>hd.encodingLength(t),Yc=(t,e)=>{const r=e.byteLength,i=dd(t),n=i+dd(r),s=new Uint8Array(n+r);return ud(t,s,0),ud(r,s,i),s.set(e,n),new S2(t,r,e,s)};class S2{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}const ld=({name:t,code:e,encode:r})=>new I2(t,e,r);class I2{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Yc(this.code,r):r.then(i=>Yc(this.code,i))}else throw Error("Unknown type, must be binary type")}}const pd=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),A2=ld({name:"sha2-256",code:18,encode:pd("SHA-256")}),M2=ld({name:"sha2-512",code:19,encode:pd("SHA-512")});var P2=Object.freeze({__proto__:null,sha256:A2,sha512:M2});const vd=0,D2="identity",gd=nd;var $2=Object.freeze({__proto__:null,identity:{code:vd,name:D2,encode:gd,digest:t=>Yc(vd,gd(t))}});new TextEncoder,new TextDecoder;const bd={...Sy,...Ay,...Py,...$y,...Ny,...ky,...Vy,...Jy,...e2,...o2};({...P2,...$2});function md(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const yd=md("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Zc=md("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=rd(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),wd={utf8:yd,"utf-8":yd,hex:bd.base16,latin1:Zc,ascii:Zc,binary:Zc,...bd};function ha(t,e="utf8"){const r=wd[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function is(t,e="utf8"){const r=wd[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Wc(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function _d(t){return Mn(ha(is(t,ca),Qu))}function ua(t){return ha(is($i(t),Qu),ca)}function xd(t){const e=is(hy,td),r=fy+ha(id([e,t]),td);return[ay,cy,r].join(oy)}function O2(t){return ha(t,ca)}function R2(t){return is(t,ca)}function N2(t){return is([ua(t.header),ua(t.payload)].join(aa),ed)}function C2(t){return[ua(t.header),ua(t.payload),O2(t.signature)].join(aa)}function Xc(t){const e=t.split(aa),r=_d(e[0]),i=_d(e[1]),n=R2(e[2]),s=is(e.slice(0,2).join(aa),ed);return{header:r,payload:i,signature:n,data:s}}function Ed(t=Nu(uy)){const e=Xu.getPublicKey(t);return{secretKey:id([t,e]),publicKey:e}}async function T2(t,e,r,i,n=Z.fromMiliseconds(Date.now())){const s={alg:ny,typ:sy},o=xd(i.publicKey),a=n+r,h={iss:o,sub:t,aud:e,iat:n,exp:a},u=N2({header:s,payload:h}),p=Xu.sign(u,i.secretKey.slice(0,32));return C2({header:s,payload:h,signature:p})}var Sd=function(t,e,r){if(r||arguments.length===2)for(var i=0,n=e.length,s;i<n;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))},F2=function(){function t(e,r,i){this.name=e,this.version=r,this.os=i,this.type="browser"}return t}(),B2=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),q2=function(){function t(e,r,i,n){this.name=e,this.version=r,this.os=i,this.bot=n,this.type="bot-device"}return t}(),L2=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),U2=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),j2=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,z2=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Id=3,k2=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",j2]],Ad=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function H2(t){return t?Md(t):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new U2:typeof navigator<"u"?Md(navigator.userAgent):G2()}function K2(t){return t!==""&&k2.reduce(function(e,r){var i=r[0],n=r[1];if(e)return e;var s=n.exec(t);return!!s&&[i,s]},!1)}function Md(t){var e=K2(t);if(!e)return null;var r=e[0],i=e[1];if(r==="searchbot")return new L2;var n=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);n?n.length<Id&&(n=Sd(Sd([],n,!0),W2(Id-n.length),!0)):n=[];var s=n.join("."),o=V2(t),a=z2.exec(t);return a&&a[1]?new q2(r,s,o,a[1]):new F2(r,s,o)}function V2(t){for(var e=0,r=Ad.length;e<r;e++){var i=Ad[e],n=i[0],s=i[1],o=s.exec(t);if(o)return n}return null}function G2(){var t=typeof process<"u"&&process.version;return t?new B2(process.version.slice(1)):null}function W2(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var pt={};Object.defineProperty(pt,"__esModule",{value:!0}),pt.getLocalStorage=pt.getLocalStorageOrThrow=pt.getCrypto=pt.getCryptoOrThrow=Pd=pt.getLocation=pt.getLocationOrThrow=Qc=pt.getNavigator=pt.getNavigatorOrThrow=io=pt.getDocument=pt.getDocumentOrThrow=pt.getFromWindowOrThrow=pt.getFromWindow=void 0;function Dn(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}pt.getFromWindow=Dn;function ns(t){const e=Dn(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}pt.getFromWindowOrThrow=ns;function J2(){return ns("document")}pt.getDocumentOrThrow=J2;function Y2(){return Dn("document")}var io=pt.getDocument=Y2;function Z2(){return ns("navigator")}pt.getNavigatorOrThrow=Z2;function X2(){return Dn("navigator")}var Qc=pt.getNavigator=X2;function Q2(){return ns("location")}pt.getLocationOrThrow=Q2;function ew(){return Dn("location")}var Pd=pt.getLocation=ew;function tw(){return ns("crypto")}pt.getCryptoOrThrow=tw;function rw(){return Dn("crypto")}pt.getCrypto=rw;function iw(){return ns("localStorage")}pt.getLocalStorageOrThrow=iw;function nw(){return Dn("localStorage")}pt.getLocalStorage=nw;var ef={};Object.defineProperty(ef,"__esModule",{value:!0});var Dd=ef.getWindowMetadata=void 0;const $d=pt;function sw(){let t,e;try{t=$d.getDocumentOrThrow(),e=$d.getLocationOrThrow()}catch{return null}function r(){const b=t.getElementsByTagName("link"),S=[];for(let A=0;A<b.length;A++){const I=b[A],P=I.getAttribute("rel");if(P&&P.toLowerCase().indexOf("icon")>-1){const R=I.getAttribute("href");if(R)if(R.toLowerCase().indexOf("https:")===-1&&R.toLowerCase().indexOf("http:")===-1&&R.indexOf("//")!==0){let O=e.protocol+"//"+e.host;if(R.indexOf("/")===0)O+=R;else{const N=e.pathname.split("/");N.pop();const F=N.join("/");O+=F+"/"+R}S.push(O)}else if(R.indexOf("//")===0){const O=e.protocol+R;S.push(O)}else S.push(R)}}return S}function i(...b){const S=t.getElementsByTagName("meta");for(let A=0;A<S.length;A++){const I=S[A],P=["itemprop","property","name"].map(R=>I.getAttribute(R)).filter(R=>R?b.includes(R):!1);if(P.length&&P){const R=I.getAttribute("content");if(R)return R}}return""}function n(){let b=i("name","og:site_name","og:title","twitter:title");return b||(b=t.title),b}function s(){return i("description","og:description","twitter:description","keywords")}const o=n(),a=s(),h=e.origin,u=r();return{description:a,url:h,icons:u,name:o}}Dd=ef.getWindowMetadata=sw;const ow="logger/5.7.0";let Od=!1,Rd=!1;const da={debug:1,default:2,info:2,warning:3,error:4,off:5};let Nd=da.default,tf=null;function aw(){try{const t=[];if(["NFD","NFC","NFKD","NFKC"].forEach(e=>{try{if("test".normalize(e)!=="test")throw new Error("bad normalize")}catch{t.push(e)}}),t.length)throw new Error("missing "+t.join(", "));if("\xE9".normalize("NFD")!=="e\u0301")throw new Error("broken implementation")}catch(t){return t.message}return null}const Cd=aw();var rf;(function(t){t.DEBUG="DEBUG",t.INFO="INFO",t.WARNING="WARNING",t.ERROR="ERROR",t.OFF="OFF"})(rf||(rf={}));var Qr;(function(t){t.UNKNOWN_ERROR="UNKNOWN_ERROR",t.NOT_IMPLEMENTED="NOT_IMPLEMENTED",t.UNSUPPORTED_OPERATION="UNSUPPORTED_OPERATION",t.NETWORK_ERROR="NETWORK_ERROR",t.SERVER_ERROR="SERVER_ERROR",t.TIMEOUT="TIMEOUT",t.BUFFER_OVERRUN="BUFFER_OVERRUN",t.NUMERIC_FAULT="NUMERIC_FAULT",t.MISSING_NEW="MISSING_NEW",t.INVALID_ARGUMENT="INVALID_ARGUMENT",t.MISSING_ARGUMENT="MISSING_ARGUMENT",t.UNEXPECTED_ARGUMENT="UNEXPECTED_ARGUMENT",t.CALL_EXCEPTION="CALL_EXCEPTION",t.INSUFFICIENT_FUNDS="INSUFFICIENT_FUNDS",t.NONCE_EXPIRED="NONCE_EXPIRED",t.REPLACEMENT_UNDERPRICED="REPLACEMENT_UNDERPRICED",t.UNPREDICTABLE_GAS_LIMIT="UNPREDICTABLE_GAS_LIMIT",t.TRANSACTION_REPLACED="TRANSACTION_REPLACED",t.ACTION_REJECTED="ACTION_REJECTED"})(Qr||(Qr={}));const Td="0123456789abcdef";class Se{constructor(e){Object.defineProperty(this,"version",{enumerable:!0,value:e,writable:!1})}_log(e,r){const i=e.toLowerCase();da[i]==null&&this.throwArgumentError("invalid log level name","logLevel",e),!(Nd>da[i])&&console.log.apply(console,r)}debug(...e){this._log(Se.levels.DEBUG,e)}info(...e){this._log(Se.levels.INFO,e)}warn(...e){this._log(Se.levels.WARNING,e)}makeError(e,r,i){if(Rd)return this.makeError("censored error",r,{});r||(r=Se.errors.UNKNOWN_ERROR),i||(i={});const n=[];Object.keys(i).forEach(h=>{const u=i[h];try{if(u instanceof Uint8Array){let p="";for(let b=0;b<u.length;b++)p+=Td[u[b]>>4],p+=Td[u[b]&15];n.push(h+"=Uint8Array(0x"+p+")")}else n.push(h+"="+JSON.stringify(u))}catch{n.push(h+"="+JSON.stringify(i[h].toString()))}}),n.push(`code=${r}`),n.push(`version=${this.version}`);const s=e;let o="";switch(r){case Qr.NUMERIC_FAULT:{o="NUMERIC_FAULT";const h=e;switch(h){case"overflow":case"underflow":case"division-by-zero":o+="-"+h;break;case"negative-power":case"negative-width":o+="-unsupported";break;case"unbound-bitwise-result":o+="-unbound-result";break}break}case Qr.CALL_EXCEPTION:case Qr.INSUFFICIENT_FUNDS:case Qr.MISSING_NEW:case Qr.NONCE_EXPIRED:case Qr.REPLACEMENT_UNDERPRICED:case Qr.TRANSACTION_REPLACED:case Qr.UNPREDICTABLE_GAS_LIMIT:o=r;break}o&&(e+=" [ See: https://links.ethers.org/v5-errors-"+o+" ]"),n.length&&(e+=" ("+n.join(", ")+")");const a=new Error(e);return a.reason=s,a.code=r,Object.keys(i).forEach(function(h){a[h]=i[h]}),a}throwError(e,r,i){throw this.makeError(e,r,i)}throwArgumentError(e,r,i){return this.throwError(e,Se.errors.INVALID_ARGUMENT,{argument:r,value:i})}assert(e,r,i,n){e||this.throwError(r,i,n)}assertArgument(e,r,i,n){e||this.throwArgumentError(r,i,n)}checkNormalize(e){Cd&&this.throwError("platform missing String.prototype.normalize",Se.errors.UNSUPPORTED_OPERATION,{operation:"String.prototype.normalize",form:Cd})}checkSafeUint53(e,r){typeof e=="number"&&(r==null&&(r="value not safe"),(e<0||e>=9007199254740991)&&this.throwError(r,Se.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"out-of-safe-range",value:e}),e%1&&this.throwError(r,Se.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"non-integer",value:e}))}checkArgumentCount(e,r,i){i?i=": "+i:i="",e<r&&this.throwError("missing argument"+i,Se.errors.MISSING_ARGUMENT,{count:e,expectedCount:r}),e>r&&this.throwError("too many arguments"+i,Se.errors.UNEXPECTED_ARGUMENT,{count:e,expectedCount:r})}checkNew(e,r){(e===Object||e==null)&&this.throwError("missing new",Se.errors.MISSING_NEW,{name:r.name})}checkAbstract(e,r){e===r?this.throwError("cannot instantiate abstract class "+JSON.stringify(r.name)+" directly; use a sub-class",Se.errors.UNSUPPORTED_OPERATION,{name:e.name,operation:"new"}):(e===Object||e==null)&&this.throwError("missing new",Se.errors.MISSING_NEW,{name:r.name})}static globalLogger(){return tf||(tf=new Se(ow)),tf}static setCensorship(e,r){if(!e&&r&&this.globalLogger().throwError("cannot permanently disable censorship",Se.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"}),Od){if(!e)return;this.globalLogger().throwError("error censorship permanent",Se.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"})}Rd=!!e,Od=!!r}static setLogLevel(e){const r=da[e.toLowerCase()];if(r==null){Se.globalLogger().warn("invalid log level - "+e);return}Nd=r}static from(e){return new Se(e)}}Se.errors=Qr,Se.levels=rf;const cw="bytes/5.7.0",Mt=new Se(cw);function Fd(t){return!!t.toHexString}function no(t){return t.slice||(t.slice=function(){const e=Array.prototype.slice.call(arguments);return no(new Uint8Array(Array.prototype.slice.apply(t,e)))}),t}function fw(t){return Ar(t)&&!(t.length%2)||ss(t)}function Bd(t){return typeof t=="number"&&t==t&&t%1===0}function ss(t){if(t==null)return!1;if(t.constructor===Uint8Array)return!0;if(typeof t=="string"||!Bd(t.length)||t.length<0)return!1;for(let e=0;e<t.length;e++){const r=t[e];if(!Bd(r)||r<0||r>=256)return!1}return!0}function Rt(t,e){if(e||(e={}),typeof t=="number"){Mt.checkSafeUint53(t,"invalid arrayify value");const r=[];for(;t;)r.unshift(t&255),t=parseInt(String(t/256));return r.length===0&&r.push(0),no(new Uint8Array(r))}if(e.allowMissingPrefix&&typeof t=="string"&&t.substring(0,2)!=="0x"&&(t="0x"+t),Fd(t)&&(t=t.toHexString()),Ar(t)){let r=t.substring(2);r.length%2&&(e.hexPad==="left"?r="0"+r:e.hexPad==="right"?r+="0":Mt.throwArgumentError("hex data is odd-length","value",t));const i=[];for(let n=0;n<r.length;n+=2)i.push(parseInt(r.substring(n,n+2),16));return no(new Uint8Array(i))}return ss(t)?no(new Uint8Array(t)):Mt.throwArgumentError("invalid arrayify value","value",t)}function hw(t,e){t=Rt(t),t.length>e&&Mt.throwArgumentError("value out of range","value",arguments[0]);const r=new Uint8Array(e);return r.set(t,e-t.length),no(r)}function Ar(t,e){return!(typeof t!="string"||!t.match(/^0x[0-9A-Fa-f]*$/)||e&&t.length!==2+2*e)}const nf="0123456789abcdef";function cr(t,e){if(e||(e={}),typeof t=="number"){Mt.checkSafeUint53(t,"invalid hexlify value");let r="";for(;t;)r=nf[t&15]+r,t=Math.floor(t/16);return r.length?(r.length%2&&(r="0"+r),"0x"+r):"0x00"}if(typeof t=="bigint")return t=t.toString(16),t.length%2?"0x0"+t:"0x"+t;if(e.allowMissingPrefix&&typeof t=="string"&&t.substring(0,2)!=="0x"&&(t="0x"+t),Fd(t))return t.toHexString();if(Ar(t))return t.length%2&&(e.hexPad==="left"?t="0x0"+t.substring(2):e.hexPad==="right"?t+="0":Mt.throwArgumentError("hex data is odd-length","value",t)),t.toLowerCase();if(ss(t)){let r="0x";for(let i=0;i<t.length;i++){let n=t[i];r+=nf[(n&240)>>4]+nf[n&15]}return r}return Mt.throwArgumentError("invalid hexlify value","value",t)}function uw(t){if(typeof t!="string")t=cr(t);else if(!Ar(t)||t.length%2)return null;return(t.length-2)/2}function qd(t,e,r){return typeof t!="string"?t=cr(t):(!Ar(t)||t.length%2)&&Mt.throwArgumentError("invalid hexData","value",t),e=2+2*e,r!=null?"0x"+t.substring(e,2+2*r):"0x"+t.substring(e)}function sn(t,e){for(typeof t!="string"?t=cr(t):Ar(t)||Mt.throwArgumentError("invalid hex string","value",t),t.length>2*e+2&&Mt.throwArgumentError("value out of range","value",arguments[1]);t.length<2*e+2;)t="0x0"+t.substring(2);return t}function Ld(t){const e={r:"0x",s:"0x",_vs:"0x",recoveryParam:0,v:0,yParityAndS:"0x",compact:"0x"};if(fw(t)){let r=Rt(t);r.length===64?(e.v=27+(r[32]>>7),r[32]&=127,e.r=cr(r.slice(0,32)),e.s=cr(r.slice(32,64))):r.length===65?(e.r=cr(r.slice(0,32)),e.s=cr(r.slice(32,64)),e.v=r[64]):Mt.throwArgumentError("invalid signature string","signature",t),e.v<27&&(e.v===0||e.v===1?e.v+=27:Mt.throwArgumentError("signature invalid v byte","signature",t)),e.recoveryParam=1-e.v%2,e.recoveryParam&&(r[32]|=128),e._vs=cr(r.slice(32,64))}else{if(e.r=t.r,e.s=t.s,e.v=t.v,e.recoveryParam=t.recoveryParam,e._vs=t._vs,e._vs!=null){const n=hw(Rt(e._vs),32);e._vs=cr(n);const s=n[0]>=128?1:0;e.recoveryParam==null?e.recoveryParam=s:e.recoveryParam!==s&&Mt.throwArgumentError("signature recoveryParam mismatch _vs","signature",t),n[0]&=127;const o=cr(n);e.s==null?e.s=o:e.s!==o&&Mt.throwArgumentError("signature v mismatch _vs","signature",t)}if(e.recoveryParam==null)e.v==null?Mt.throwArgumentError("signature missing v and recoveryParam","signature",t):e.v===0||e.v===1?e.recoveryParam=e.v:e.recoveryParam=1-e.v%2;else if(e.v==null)e.v=27+e.recoveryParam;else{const n=e.v===0||e.v===1?e.v:1-e.v%2;e.recoveryParam!==n&&Mt.throwArgumentError("signature recoveryParam mismatch v","signature",t)}e.r==null||!Ar(e.r)?Mt.throwArgumentError("signature missing or invalid r","signature",t):e.r=sn(e.r,32),e.s==null||!Ar(e.s)?Mt.throwArgumentError("signature missing or invalid s","signature",t):e.s=sn(e.s,32);const r=Rt(e.s);r[0]>=128&&Mt.throwArgumentError("signature s out of range","signature",t),e.recoveryParam&&(r[0]|=128);const i=cr(r);e._vs&&(Ar(e._vs)||Mt.throwArgumentError("signature invalid _vs","signature",t),e._vs=sn(e._vs,32)),e._vs==null?e._vs=i:e._vs!==i&&Mt.throwArgumentError("signature _vs mismatch v and s","signature",t)}return e.yParityAndS=e._vs,e.compact=e.r+e.yParityAndS.substring(2),e}var Ud={exports:{}},dw={},lw=Object.freeze({__proto__:null,default:dw}),sf=bc(lw);(function(t){(function(e,r){function i(v,c){if(!v)throw new Error(c||"Assertion failed")}function n(v,c){v.super_=c;var f=function(){};f.prototype=c.prototype,v.prototype=new f,v.prototype.constructor=v}function s(v,c,f){if(s.isBN(v))return v;this.negative=0,this.words=null,this.length=0,this.red=null,v!==null&&((c==="le"||c==="be")&&(f=c,c=10),this._init(v||0,c||10,f||"be"))}typeof e=="object"?e.exports=s:r.BN=s,s.BN=s,s.wordSize=26;var o;try{typeof window<"u"&&typeof window.Buffer<"u"?o=window.Buffer:o=sf.Buffer}catch{}s.isBN=function(c){return c instanceof s?!0:c!==null&&typeof c=="object"&&c.constructor.wordSize===s.wordSize&&Array.isArray(c.words)},s.max=function(c,f){return c.cmp(f)>0?c:f},s.min=function(c,f){return c.cmp(f)<0?c:f},s.prototype._init=function(c,f,l){if(typeof c=="number")return this._initNumber(c,f,l);if(typeof c=="object")return this._initArray(c,f,l);f==="hex"&&(f=16),i(f===(f|0)&&f>=2&&f<=36),c=c.toString().replace(/\s+/g,"");var _=0;c[0]==="-"&&(_++,this.negative=1),_<c.length&&(f===16?this._parseHex(c,_,l):(this._parseBase(c,f,_),l==="le"&&this._initArray(this.toArray(),f,l)))},s.prototype._initNumber=function(c,f,l){c<0&&(this.negative=1,c=-c),c<67108864?(this.words=[c&67108863],this.length=1):c<4503599627370496?(this.words=[c&67108863,c/67108864&67108863],this.length=2):(i(c<9007199254740992),this.words=[c&67108863,c/67108864&67108863,1],this.length=3),l==="le"&&this._initArray(this.toArray(),f,l)},s.prototype._initArray=function(c,f,l){if(i(typeof c.length=="number"),c.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(c.length/3),this.words=new Array(this.length);for(var _=0;_<this.length;_++)this.words[_]=0;var x,y,d=0;if(l==="be")for(_=c.length-1,x=0;_>=0;_-=3)y=c[_]|c[_-1]<<8|c[_-2]<<16,this.words[x]|=y<<d&67108863,this.words[x+1]=y>>>26-d&67108863,d+=24,d>=26&&(d-=26,x++);else if(l==="le")for(_=0,x=0;_<c.length;_+=3)y=c[_]|c[_+1]<<8|c[_+2]<<16,this.words[x]|=y<<d&67108863,this.words[x+1]=y>>>26-d&67108863,d+=24,d>=26&&(d-=26,x++);return this._strip()};function a(v,c){var f=v.charCodeAt(c);if(f>=48&&f<=57)return f-48;if(f>=65&&f<=70)return f-55;if(f>=97&&f<=102)return f-87;i(!1,"Invalid character in "+v)}function h(v,c,f){var l=a(v,f);return f-1>=c&&(l|=a(v,f-1)<<4),l}s.prototype._parseHex=function(c,f,l){this.length=Math.ceil((c.length-f)/6),this.words=new Array(this.length);for(var _=0;_<this.length;_++)this.words[_]=0;var x=0,y=0,d;if(l==="be")for(_=c.length-1;_>=f;_-=2)d=h(c,f,_)<<x,this.words[y]|=d&67108863,x>=18?(x-=18,y+=1,this.words[y]|=d>>>26):x+=8;else{var w=c.length-f;for(_=w%2===0?f+1:f;_<c.length;_+=2)d=h(c,f,_)<<x,this.words[y]|=d&67108863,x>=18?(x-=18,y+=1,this.words[y]|=d>>>26):x+=8}this._strip()};function u(v,c,f,l){for(var _=0,x=0,y=Math.min(v.length,f),d=c;d<y;d++){var w=v.charCodeAt(d)-48;_*=l,w>=49?x=w-49+10:w>=17?x=w-17+10:x=w,i(w>=0&&x<l,"Invalid character"),_+=x}return _}s.prototype._parseBase=function(c,f,l){this.words=[0],this.length=1;for(var _=0,x=1;x<=67108863;x*=f)_++;_--,x=x/f|0;for(var y=c.length-l,d=y%_,w=Math.min(y,y-d)+l,m=0,M=l;M<w;M+=_)m=u(c,M,M+_,f),this.imuln(x),this.words[0]+m<67108864?this.words[0]+=m:this._iaddn(m);if(d!==0){var B=1;for(m=u(c,M,c.length,f),M=0;M<d;M++)B*=f;this.imuln(B),this.words[0]+m<67108864?this.words[0]+=m:this._iaddn(m)}this._strip()},s.prototype.copy=function(c){c.words=new Array(this.length);for(var f=0;f<this.length;f++)c.words[f]=this.words[f];c.length=this.length,c.negative=this.negative,c.red=this.red};function p(v,c){v.words=c.words,v.length=c.length,v.negative=c.negative,v.red=c.red}if(s.prototype._move=function(c){p(c,this)},s.prototype.clone=function(){var c=new s(null);return this.copy(c),c},s.prototype._expand=function(c){for(;this.length<c;)this.words[this.length++]=0;return this},s.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},s.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{s.prototype[Symbol.for("nodejs.util.inspect.custom")]=b}catch{s.prototype.inspect=b}else s.prototype.inspect=b;function b(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var S=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],A=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],I=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];s.prototype.toString=function(c,f){c=c||10,f=f|0||1;var l;if(c===16||c==="hex"){l="";for(var _=0,x=0,y=0;y<this.length;y++){var d=this.words[y],w=((d<<_|x)&16777215).toString(16);x=d>>>24-_&16777215,_+=2,_>=26&&(_-=26,y--),x!==0||y!==this.length-1?l=S[6-w.length]+w+l:l=w+l}for(x!==0&&(l=x.toString(16)+l);l.length%f!==0;)l="0"+l;return this.negative!==0&&(l="-"+l),l}if(c===(c|0)&&c>=2&&c<=36){var m=A[c],M=I[c];l="";var B=this.clone();for(B.negative=0;!B.isZero();){var E=B.modrn(M).toString(c);B=B.idivn(M),B.isZero()?l=E+l:l=S[m-E.length]+E+l}for(this.isZero()&&(l="0"+l);l.length%f!==0;)l="0"+l;return this.negative!==0&&(l="-"+l),l}i(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var c=this.words[0];return this.length===2?c+=this.words[1]*67108864:this.length===3&&this.words[2]===1?c+=4503599627370496+this.words[1]*67108864:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-c:c},s.prototype.toJSON=function(){return this.toString(16,2)},o&&(s.prototype.toBuffer=function(c,f){return this.toArrayLike(o,c,f)}),s.prototype.toArray=function(c,f){return this.toArrayLike(Array,c,f)};var P=function(c,f){return c.allocUnsafe?c.allocUnsafe(f):new c(f)};s.prototype.toArrayLike=function(c,f,l){this._strip();var _=this.byteLength(),x=l||Math.max(1,_);i(_<=x,"byte array longer than desired length"),i(x>0,"Requested array length <= 0");var y=P(c,x),d=f==="le"?"LE":"BE";return this["_toArrayLike"+d](y,_),y},s.prototype._toArrayLikeLE=function(c,f){for(var l=0,_=0,x=0,y=0;x<this.length;x++){var d=this.words[x]<<y|_;c[l++]=d&255,l<c.length&&(c[l++]=d>>8&255),l<c.length&&(c[l++]=d>>16&255),y===6?(l<c.length&&(c[l++]=d>>24&255),_=0,y=0):(_=d>>>24,y+=2)}if(l<c.length)for(c[l++]=_;l<c.length;)c[l++]=0},s.prototype._toArrayLikeBE=function(c,f){for(var l=c.length-1,_=0,x=0,y=0;x<this.length;x++){var d=this.words[x]<<y|_;c[l--]=d&255,l>=0&&(c[l--]=d>>8&255),l>=0&&(c[l--]=d>>16&255),y===6?(l>=0&&(c[l--]=d>>24&255),_=0,y=0):(_=d>>>24,y+=2)}if(l>=0)for(c[l--]=_;l>=0;)c[l--]=0},Math.clz32?s.prototype._countBits=function(c){return 32-Math.clz32(c)}:s.prototype._countBits=function(c){var f=c,l=0;return f>=4096&&(l+=13,f>>>=13),f>=64&&(l+=7,f>>>=7),f>=8&&(l+=4,f>>>=4),f>=2&&(l+=2,f>>>=2),l+f},s.prototype._zeroBits=function(c){if(c===0)return 26;var f=c,l=0;return(f&8191)===0&&(l+=13,f>>>=13),(f&127)===0&&(l+=7,f>>>=7),(f&15)===0&&(l+=4,f>>>=4),(f&3)===0&&(l+=2,f>>>=2),(f&1)===0&&l++,l},s.prototype.bitLength=function(){var c=this.words[this.length-1],f=this._countBits(c);return(this.length-1)*26+f};function R(v){for(var c=new Array(v.bitLength()),f=0;f<c.length;f++){var l=f/26|0,_=f%26;c[f]=v.words[l]>>>_&1}return c}s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var c=0,f=0;f<this.length;f++){var l=this._zeroBits(this.words[f]);if(c+=l,l!==26)break}return c},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(c){return this.negative!==0?this.abs().inotn(c).iaddn(1):this.clone()},s.prototype.fromTwos=function(c){return this.testn(c-1)?this.notn(c).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return this.negative!==0},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(c){for(;this.length<c.length;)this.words[this.length++]=0;for(var f=0;f<c.length;f++)this.words[f]=this.words[f]|c.words[f];return this._strip()},s.prototype.ior=function(c){return i((this.negative|c.negative)===0),this.iuor(c)},s.prototype.or=function(c){return this.length>c.length?this.clone().ior(c):c.clone().ior(this)},s.prototype.uor=function(c){return this.length>c.length?this.clone().iuor(c):c.clone().iuor(this)},s.prototype.iuand=function(c){var f;this.length>c.length?f=c:f=this;for(var l=0;l<f.length;l++)this.words[l]=this.words[l]&c.words[l];return this.length=f.length,this._strip()},s.prototype.iand=function(c){return i((this.negative|c.negative)===0),this.iuand(c)},s.prototype.and=function(c){return this.length>c.length?this.clone().iand(c):c.clone().iand(this)},s.prototype.uand=function(c){return this.length>c.length?this.clone().iuand(c):c.clone().iuand(this)},s.prototype.iuxor=function(c){var f,l;this.length>c.length?(f=this,l=c):(f=c,l=this);for(var _=0;_<l.length;_++)this.words[_]=f.words[_]^l.words[_];if(this!==f)for(;_<f.length;_++)this.words[_]=f.words[_];return this.length=f.length,this._strip()},s.prototype.ixor=function(c){return i((this.negative|c.negative)===0),this.iuxor(c)},s.prototype.xor=function(c){return this.length>c.length?this.clone().ixor(c):c.clone().ixor(this)},s.prototype.uxor=function(c){return this.length>c.length?this.clone().iuxor(c):c.clone().iuxor(this)},s.prototype.inotn=function(c){i(typeof c=="number"&&c>=0);var f=Math.ceil(c/26)|0,l=c%26;this._expand(f),l>0&&f--;for(var _=0;_<f;_++)this.words[_]=~this.words[_]&67108863;return l>0&&(this.words[_]=~this.words[_]&67108863>>26-l),this._strip()},s.prototype.notn=function(c){return this.clone().inotn(c)},s.prototype.setn=function(c,f){i(typeof c=="number"&&c>=0);var l=c/26|0,_=c%26;return this._expand(l+1),f?this.words[l]=this.words[l]|1<<_:this.words[l]=this.words[l]&~(1<<_),this._strip()},s.prototype.iadd=function(c){var f;if(this.negative!==0&&c.negative===0)return this.negative=0,f=this.isub(c),this.negative^=1,this._normSign();if(this.negative===0&&c.negative!==0)return c.negative=0,f=this.isub(c),c.negative=1,f._normSign();var l,_;this.length>c.length?(l=this,_=c):(l=c,_=this);for(var x=0,y=0;y<_.length;y++)f=(l.words[y]|0)+(_.words[y]|0)+x,this.words[y]=f&67108863,x=f>>>26;for(;x!==0&&y<l.length;y++)f=(l.words[y]|0)+x,this.words[y]=f&67108863,x=f>>>26;if(this.length=l.length,x!==0)this.words[this.length]=x,this.length++;else if(l!==this)for(;y<l.length;y++)this.words[y]=l.words[y];return this},s.prototype.add=function(c){var f;return c.negative!==0&&this.negative===0?(c.negative=0,f=this.sub(c),c.negative^=1,f):c.negative===0&&this.negative!==0?(this.negative=0,f=c.sub(this),this.negative=1,f):this.length>c.length?this.clone().iadd(c):c.clone().iadd(this)},s.prototype.isub=function(c){if(c.negative!==0){c.negative=0;var f=this.iadd(c);return c.negative=1,f._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(c),this.negative=1,this._normSign();var l=this.cmp(c);if(l===0)return this.negative=0,this.length=1,this.words[0]=0,this;var _,x;l>0?(_=this,x=c):(_=c,x=this);for(var y=0,d=0;d<x.length;d++)f=(_.words[d]|0)-(x.words[d]|0)+y,y=f>>26,this.words[d]=f&67108863;for(;y!==0&&d<_.length;d++)f=(_.words[d]|0)+y,y=f>>26,this.words[d]=f&67108863;if(y===0&&d<_.length&&_!==this)for(;d<_.length;d++)this.words[d]=_.words[d];return this.length=Math.max(this.length,d),_!==this&&(this.negative=1),this._strip()},s.prototype.sub=function(c){return this.clone().isub(c)};function O(v,c,f){f.negative=c.negative^v.negative;var l=v.length+c.length|0;f.length=l,l=l-1|0;var _=v.words[0]|0,x=c.words[0]|0,y=_*x,d=y&67108863,w=y/67108864|0;f.words[0]=d;for(var m=1;m<l;m++){for(var M=w>>>26,B=w&67108863,E=Math.min(m,c.length-1),C=Math.max(0,m-v.length+1);C<=E;C++){var q=m-C|0;_=v.words[q]|0,x=c.words[C]|0,y=_*x+B,M+=y/67108864|0,B=y&67108863}f.words[m]=B|0,w=M|0}return w!==0?f.words[m]=w|0:f.length--,f._strip()}var N=function(c,f,l){var _=c.words,x=f.words,y=l.words,d=0,w,m,M,B=_[0]|0,E=B&8191,C=B>>>13,q=_[1]|0,U=q&8191,j=q>>>13,Y=_[2]|0,X=Y&8191,W=Y>>>13,se=_[3]|0,ee=se&8191,te=se>>>13,ke=_[4]|0,He=ke&8191,ue=ke>>>13,Ne=_[5]|0,Ce=Ne&8191,ce=Ne>>>13,Te=_[6]|0,Fe=Te&8191,he=Te>>>13,Be=_[7]|0,qe=Be&8191,ae=Be>>>13,Oe=_[8]|0,Le=Oe&8191,ne=Oe>>>13,Ye=_[9]|0,Ze=Ye&8191,ve=Ye>>>13,Xe=x[0]|0,Ue=Xe&8191,le=Xe>>>13,Qe=x[1]|0,rt=Qe&8191,oe=Qe>>>13,et=x[2]|0,it=et&8191,ge=et>>>13,Ke=x[3]|0,Re=Ke&8191,de=Ke>>>13,Ve=x[4]|0,Ge=Ve&8191,fe=Ve>>>13,nt=x[5]|0,st=nt&8191,be=nt>>>13,ot=x[6]|0,at=ot&8191,pe=ot>>>13,We=x[7]|0,Pe=We&8191,me=We>>>13,ct=x[8]|0,ft=ct&8191,ye=ct>>>13,ht=x[9]|0,Ee=ht&8191,tt=ht>>>13;l.negative=c.negative^f.negative,l.length=19,w=Math.imul(E,Ue),m=Math.imul(E,le),m=m+Math.imul(C,Ue)|0,M=Math.imul(C,le);var xr=(d+w|0)+((m&8191)<<13)|0;d=(M+(m>>>13)|0)+(xr>>>26)|0,xr&=67108863,w=Math.imul(U,Ue),m=Math.imul(U,le),m=m+Math.imul(j,Ue)|0,M=Math.imul(j,le),w=w+Math.imul(E,rt)|0,m=m+Math.imul(E,oe)|0,m=m+Math.imul(C,rt)|0,M=M+Math.imul(C,oe)|0;var Er=(d+w|0)+((m&8191)<<13)|0;d=(M+(m>>>13)|0)+(Er>>>26)|0,Er&=67108863,w=Math.imul(X,Ue),m=Math.imul(X,le),m=m+Math.imul(W,Ue)|0,M=Math.imul(W,le),w=w+Math.imul(U,rt)|0,m=m+Math.imul(U,oe)|0,m=m+Math.imul(j,rt)|0,M=M+Math.imul(j,oe)|0,w=w+Math.imul(E,it)|0,m=m+Math.imul(E,ge)|0,m=m+Math.imul(C,it)|0,M=M+Math.imul(C,ge)|0;var Sr=(d+w|0)+((m&8191)<<13)|0;d=(M+(m>>>13)|0)+(Sr>>>26)|0,Sr&=67108863,w=Math.imul(ee,Ue),m=Math.imul(ee,le),m=m+Math.imul(te,Ue)|0,M=Math.imul(te,le),w=w+Math.imul(X,rt)|0,m=m+Math.imul(X,oe)|0,m=m+Math.imul(W,rt)|0,M=M+Math.imul(W,oe)|0,w=w+Math.imul(U,it)|0,m=m+Math.imul(U,ge)|0,m=m+Math.imul(j,it)|0,M=M+Math.imul(j,ge)|0,w=w+Math.imul(E,Re)|0,m=m+Math.imul(E,de)|0,m=m+Math.imul(C,Re)|0,M=M+Math.imul(C,de)|0;var Ir=(d+w|0)+((m&8191)<<13)|0;d=(M+(m>>>13)|0)+(Ir>>>26)|0,Ir&=67108863,w=Math.imul(He,Ue),m=Math.imul(He,le),m=m+Math.imul(ue,Ue)|0,M=Math.imul(ue,le),w=w+Math.imul(ee,rt)|0,m=m+Math.imul(ee,oe)|0,m=m+Math.imul(te,rt)|0,M=M+Math.imul(te,oe)|0,w=w+Math.imul(X,it)|0,m=m+Math.imul(X,ge)|0,m=m+Math.imul(W,it)|0,M=M+Math.imul(W,ge)|0,w=w+Math.imul(U,Re)|0,m=m+Math.imul(U,de)|0,m=m+Math.imul(j,Re)|0,M=M+Math.imul(j,de)|0,w=w+Math.imul(E,Ge)|0,m=m+Math.imul(E,fe)|0,m=m+Math.imul(C,Ge)|0,M=M+Math.imul(C,fe)|0;var $t=(d+w|0)+((m&8191)<<13)|0;d=(M+(m>>>13)|0)+($t>>>26)|0,$t&=67108863,w=Math.imul(Ce,Ue),m=Math.imul(Ce,le),m=m+Math.imul(ce,Ue)|0,M=Math.imul(ce,le),w=w+Math.imul(He,rt)|0,m=m+Math.imul(He,oe)|0,m=m+Math.imul(ue,rt)|0,M=M+Math.imul(ue,oe)|0,w=w+Math.imul(ee,it)|0,m=m+Math.imul(ee,ge)|0,m=m+Math.imul(te,it)|0,M=M+Math.imul(te,ge)|0,w=w+Math.imul(X,Re)|0,m=m+Math.imul(X,de)|0,m=m+Math.imul(W,Re)|0,M=M+Math.imul(W,de)|0,w=w+Math.imul(U,Ge)|0,m=m+Math.imul(U,fe)|0,m=m+Math.imul(j,Ge)|0,M=M+Math.imul(j,fe)|0,w=w+Math.imul(E,st)|0,m=m+Math.imul(E,be)|0,m=m+Math.imul(C,st)|0,M=M+Math.imul(C,be)|0;var Ki=(d+w|0)+((m&8191)<<13)|0;d=(M+(m>>>13)|0)+(Ki>>>26)|0,Ki&=67108863,w=Math.imul(Fe,Ue),m=Math.imul(Fe,le),m=m+Math.imul(he,Ue)|0,M=Math.imul(he,le),w=w+Math.imul(Ce,rt)|0,m=m+Math.imul(Ce,oe)|0,m=m+Math.imul(ce,rt)|0,M=M+Math.imul(ce,oe)|0,w=w+Math.imul(He,it)|0,m=m+Math.imul(He,ge)|0,m=m+Math.imul(ue,it)|0,M=M+Math.imul(ue,ge)|0,w=w+Math.imul(ee,Re)|0,m=m+Math.imul(ee,de)|0,m=m+Math.imul(te,Re)|0,M=M+Math.imul(te,de)|0,w=w+Math.imul(X,Ge)|0,m=m+Math.imul(X,fe)|0,m=m+Math.imul(W,Ge)|0,M=M+Math.imul(W,fe)|0,w=w+Math.imul(U,st)|0,m=m+Math.imul(U,be)|0,m=m+Math.imul(j,st)|0,M=M+Math.imul(j,be)|0,w=w+Math.imul(E,at)|0,m=m+Math.imul(E,pe)|0,m=m+Math.imul(C,at)|0,M=M+Math.imul(C,pe)|0;var Vi=(d+w|0)+((m&8191)<<13)|0;d=(M+(m>>>13)|0)+(Vi>>>26)|0,Vi&=67108863,w=Math.imul(qe,Ue),m=Math.imul(qe,le),m=m+Math.imul(ae,Ue)|0,M=Math.imul(ae,le),w=w+Math.imul(Fe,rt)|0,m=m+Math.imul(Fe,oe)|0,m=m+Math.imul(he,rt)|0,M=M+Math.imul(he,oe)|0,w=w+Math.imul(Ce,it)|0,m=m+Math.imul(Ce,ge)|0,m=m+Math.imul(ce,it)|0,M=M+Math.imul(ce,ge)|0,w=w+Math.imul(He,Re)|0,m=m+Math.imul(He,de)|0,m=m+Math.imul(ue,Re)|0,M=M+Math.imul(ue,de)|0,w=w+Math.imul(ee,Ge)|0,m=m+Math.imul(ee,fe)|0,m=m+Math.imul(te,Ge)|0,M=M+Math.imul(te,fe)|0,w=w+Math.imul(X,st)|0,m=m+Math.imul(X,be)|0,m=m+Math.imul(W,st)|0,M=M+Math.imul(W,be)|0,w=w+Math.imul(U,at)|0,m=m+Math.imul(U,pe)|0,m=m+Math.imul(j,at)|0,M=M+Math.imul(j,pe)|0,w=w+Math.imul(E,Pe)|0,m=m+Math.imul(E,me)|0,m=m+Math.imul(C,Pe)|0,M=M+Math.imul(C,me)|0;var Gi=(d+w|0)+((m&8191)<<13)|0;d=(M+(m>>>13)|0)+(Gi>>>26)|0,Gi&=67108863,w=Math.imul(Le,Ue),m=Math.imul(Le,le),m=m+Math.imul(ne,Ue)|0,M=Math.imul(ne,le),w=w+Math.imul(qe,rt)|0,m=m+Math.imul(qe,oe)|0,m=m+Math.imul(ae,rt)|0,M=M+Math.imul(ae,oe)|0,w=w+Math.imul(Fe,it)|0,m=m+Math.imul(Fe,ge)|0,m=m+Math.imul(he,it)|0,M=M+Math.imul(he,ge)|0,w=w+Math.imul(Ce,Re)|0,m=m+Math.imul(Ce,de)|0,m=m+Math.imul(ce,Re)|0,M=M+Math.imul(ce,de)|0,w=w+Math.imul(He,Ge)|0,m=m+Math.imul(He,fe)|0,m=m+Math.imul(ue,Ge)|0,M=M+Math.imul(ue,fe)|0,w=w+Math.imul(ee,st)|0,m=m+Math.imul(ee,be)|0,m=m+Math.imul(te,st)|0,M=M+Math.imul(te,be)|0,w=w+Math.imul(X,at)|0,m=m+Math.imul(X,pe)|0,m=m+Math.imul(W,at)|0,M=M+Math.imul(W,pe)|0,w=w+Math.imul(U,Pe)|0,m=m+Math.imul(U,me)|0,m=m+Math.imul(j,Pe)|0,M=M+Math.imul(j,me)|0,w=w+Math.imul(E,ft)|0,m=m+Math.imul(E,ye)|0,m=m+Math.imul(C,ft)|0,M=M+Math.imul(C,ye)|0;var Wi=(d+w|0)+((m&8191)<<13)|0;d=(M+(m>>>13)|0)+(Wi>>>26)|0,Wi&=67108863,w=Math.imul(Ze,Ue),m=Math.imul(Ze,le),m=m+Math.imul(ve,Ue)|0,M=Math.imul(ve,le),w=w+Math.imul(Le,rt)|0,m=m+Math.imul(Le,oe)|0,m=m+Math.imul(ne,rt)|0,M=M+Math.imul(ne,oe)|0,w=w+Math.imul(qe,it)|0,m=m+Math.imul(qe,ge)|0,m=m+Math.imul(ae,it)|0,M=M+Math.imul(ae,ge)|0,w=w+Math.imul(Fe,Re)|0,m=m+Math.imul(Fe,de)|0,m=m+Math.imul(he,Re)|0,M=M+Math.imul(he,de)|0,w=w+Math.imul(Ce,Ge)|0,m=m+Math.imul(Ce,fe)|0,m=m+Math.imul(ce,Ge)|0,M=M+Math.imul(ce,fe)|0,w=w+Math.imul(He,st)|0,m=m+Math.imul(He,be)|0,m=m+Math.imul(ue,st)|0,M=M+Math.imul(ue,be)|0,w=w+Math.imul(ee,at)|0,m=m+Math.imul(ee,pe)|0,m=m+Math.imul(te,at)|0,M=M+Math.imul(te,pe)|0,w=w+Math.imul(X,Pe)|0,m=m+Math.imul(X,me)|0,m=m+Math.imul(W,Pe)|0,M=M+Math.imul(W,me)|0,w=w+Math.imul(U,ft)|0,m=m+Math.imul(U,ye)|0,m=m+Math.imul(j,ft)|0,M=M+Math.imul(j,ye)|0,w=w+Math.imul(E,Ee)|0,m=m+Math.imul(E,tt)|0,m=m+Math.imul(C,Ee)|0,M=M+Math.imul(C,tt)|0;var Ji=(d+w|0)+((m&8191)<<13)|0;d=(M+(m>>>13)|0)+(Ji>>>26)|0,Ji&=67108863,w=Math.imul(Ze,rt),m=Math.imul(Ze,oe),m=m+Math.imul(ve,rt)|0,M=Math.imul(ve,oe),w=w+Math.imul(Le,it)|0,m=m+Math.imul(Le,ge)|0,m=m+Math.imul(ne,it)|0,M=M+Math.imul(ne,ge)|0,w=w+Math.imul(qe,Re)|0,m=m+Math.imul(qe,de)|0,m=m+Math.imul(ae,Re)|0,M=M+Math.imul(ae,de)|0,w=w+Math.imul(Fe,Ge)|0,m=m+Math.imul(Fe,fe)|0,m=m+Math.imul(he,Ge)|0,M=M+Math.imul(he,fe)|0,w=w+Math.imul(Ce,st)|0,m=m+Math.imul(Ce,be)|0,m=m+Math.imul(ce,st)|0,M=M+Math.imul(ce,be)|0,w=w+Math.imul(He,at)|0,m=m+Math.imul(He,pe)|0,m=m+Math.imul(ue,at)|0,M=M+Math.imul(ue,pe)|0,w=w+Math.imul(ee,Pe)|0,m=m+Math.imul(ee,me)|0,m=m+Math.imul(te,Pe)|0,M=M+Math.imul(te,me)|0,w=w+Math.imul(X,ft)|0,m=m+Math.imul(X,ye)|0,m=m+Math.imul(W,ft)|0,M=M+Math.imul(W,ye)|0,w=w+Math.imul(U,Ee)|0,m=m+Math.imul(U,tt)|0,m=m+Math.imul(j,Ee)|0,M=M+Math.imul(j,tt)|0;var Jr=(d+w|0)+((m&8191)<<13)|0;d=(M+(m>>>13)|0)+(Jr>>>26)|0,Jr&=67108863,w=Math.imul(Ze,it),m=Math.imul(Ze,ge),m=m+Math.imul(ve,it)|0,M=Math.imul(ve,ge),w=w+Math.imul(Le,Re)|0,m=m+Math.imul(Le,de)|0,m=m+Math.imul(ne,Re)|0,M=M+Math.imul(ne,de)|0,w=w+Math.imul(qe,Ge)|0,m=m+Math.imul(qe,fe)|0,m=m+Math.imul(ae,Ge)|0,M=M+Math.imul(ae,fe)|0,w=w+Math.imul(Fe,st)|0,m=m+Math.imul(Fe,be)|0,m=m+Math.imul(he,st)|0,M=M+Math.imul(he,be)|0,w=w+Math.imul(Ce,at)|0,m=m+Math.imul(Ce,pe)|0,m=m+Math.imul(ce,at)|0,M=M+Math.imul(ce,pe)|0,w=w+Math.imul(He,Pe)|0,m=m+Math.imul(He,me)|0,m=m+Math.imul(ue,Pe)|0,M=M+Math.imul(ue,me)|0,w=w+Math.imul(ee,ft)|0,m=m+Math.imul(ee,ye)|0,m=m+Math.imul(te,ft)|0,M=M+Math.imul(te,ye)|0,w=w+Math.imul(X,Ee)|0,m=m+Math.imul(X,tt)|0,m=m+Math.imul(W,Ee)|0,M=M+Math.imul(W,tt)|0;var Yi=(d+w|0)+((m&8191)<<13)|0;d=(M+(m>>>13)|0)+(Yi>>>26)|0,Yi&=67108863,w=Math.imul(Ze,Re),m=Math.imul(Ze,de),m=m+Math.imul(ve,Re)|0,M=Math.imul(ve,de),w=w+Math.imul(Le,Ge)|0,m=m+Math.imul(Le,fe)|0,m=m+Math.imul(ne,Ge)|0,M=M+Math.imul(ne,fe)|0,w=w+Math.imul(qe,st)|0,m=m+Math.imul(qe,be)|0,m=m+Math.imul(ae,st)|0,M=M+Math.imul(ae,be)|0,w=w+Math.imul(Fe,at)|0,m=m+Math.imul(Fe,pe)|0,m=m+Math.imul(he,at)|0,M=M+Math.imul(he,pe)|0,w=w+Math.imul(Ce,Pe)|0,m=m+Math.imul(Ce,me)|0,m=m+Math.imul(ce,Pe)|0,M=M+Math.imul(ce,me)|0,w=w+Math.imul(He,ft)|0,m=m+Math.imul(He,ye)|0,m=m+Math.imul(ue,ft)|0,M=M+Math.imul(ue,ye)|0,w=w+Math.imul(ee,Ee)|0,m=m+Math.imul(ee,tt)|0,m=m+Math.imul(te,Ee)|0,M=M+Math.imul(te,tt)|0;var Zi=(d+w|0)+((m&8191)<<13)|0;d=(M+(m>>>13)|0)+(Zi>>>26)|0,Zi&=67108863,w=Math.imul(Ze,Ge),m=Math.imul(Ze,fe),m=m+Math.imul(ve,Ge)|0,M=Math.imul(ve,fe),w=w+Math.imul(Le,st)|0,m=m+Math.imul(Le,be)|0,m=m+Math.imul(ne,st)|0,M=M+Math.imul(ne,be)|0,w=w+Math.imul(qe,at)|0,m=m+Math.imul(qe,pe)|0,m=m+Math.imul(ae,at)|0,M=M+Math.imul(ae,pe)|0,w=w+Math.imul(Fe,Pe)|0,m=m+Math.imul(Fe,me)|0,m=m+Math.imul(he,Pe)|0,M=M+Math.imul(he,me)|0,w=w+Math.imul(Ce,ft)|0,m=m+Math.imul(Ce,ye)|0,m=m+Math.imul(ce,ft)|0,M=M+Math.imul(ce,ye)|0,w=w+Math.imul(He,Ee)|0,m=m+Math.imul(He,tt)|0,m=m+Math.imul(ue,Ee)|0,M=M+Math.imul(ue,tt)|0;var sr=(d+w|0)+((m&8191)<<13)|0;d=(M+(m>>>13)|0)+(sr>>>26)|0,sr&=67108863,w=Math.imul(Ze,st),m=Math.imul(Ze,be),m=m+Math.imul(ve,st)|0,M=Math.imul(ve,be),w=w+Math.imul(Le,at)|0,m=m+Math.imul(Le,pe)|0,m=m+Math.imul(ne,at)|0,M=M+Math.imul(ne,pe)|0,w=w+Math.imul(qe,Pe)|0,m=m+Math.imul(qe,me)|0,m=m+Math.imul(ae,Pe)|0,M=M+Math.imul(ae,me)|0,w=w+Math.imul(Fe,ft)|0,m=m+Math.imul(Fe,ye)|0,m=m+Math.imul(he,ft)|0,M=M+Math.imul(he,ye)|0,w=w+Math.imul(Ce,Ee)|0,m=m+Math.imul(Ce,tt)|0,m=m+Math.imul(ce,Ee)|0,M=M+Math.imul(ce,tt)|0;var Xi=(d+w|0)+((m&8191)<<13)|0;d=(M+(m>>>13)|0)+(Xi>>>26)|0,Xi&=67108863,w=Math.imul(Ze,at),m=Math.imul(Ze,pe),m=m+Math.imul(ve,at)|0,M=Math.imul(ve,pe),w=w+Math.imul(Le,Pe)|0,m=m+Math.imul(Le,me)|0,m=m+Math.imul(ne,Pe)|0,M=M+Math.imul(ne,me)|0,w=w+Math.imul(qe,ft)|0,m=m+Math.imul(qe,ye)|0,m=m+Math.imul(ae,ft)|0,M=M+Math.imul(ae,ye)|0,w=w+Math.imul(Fe,Ee)|0,m=m+Math.imul(Fe,tt)|0,m=m+Math.imul(he,Ee)|0,M=M+Math.imul(he,tt)|0;var Qi=(d+w|0)+((m&8191)<<13)|0;d=(M+(m>>>13)|0)+(Qi>>>26)|0,Qi&=67108863,w=Math.imul(Ze,Pe),m=Math.imul(Ze,me),m=m+Math.imul(ve,Pe)|0,M=Math.imul(ve,me),w=w+Math.imul(Le,ft)|0,m=m+Math.imul(Le,ye)|0,m=m+Math.imul(ne,ft)|0,M=M+Math.imul(ne,ye)|0,w=w+Math.imul(qe,Ee)|0,m=m+Math.imul(qe,tt)|0,m=m+Math.imul(ae,Ee)|0,M=M+Math.imul(ae,tt)|0;var en=(d+w|0)+((m&8191)<<13)|0;d=(M+(m>>>13)|0)+(en>>>26)|0,en&=67108863,w=Math.imul(Ze,ft),m=Math.imul(Ze,ye),m=m+Math.imul(ve,ft)|0,M=Math.imul(ve,ye),w=w+Math.imul(Le,Ee)|0,m=m+Math.imul(Le,tt)|0,m=m+Math.imul(ne,Ee)|0,M=M+Math.imul(ne,tt)|0;var jo=(d+w|0)+((m&8191)<<13)|0;d=(M+(m>>>13)|0)+(jo>>>26)|0,jo&=67108863,w=Math.imul(Ze,Ee),m=Math.imul(Ze,tt),m=m+Math.imul(ve,Ee)|0,M=Math.imul(ve,tt);var zo=(d+w|0)+((m&8191)<<13)|0;return d=(M+(m>>>13)|0)+(zo>>>26)|0,zo&=67108863,y[0]=xr,y[1]=Er,y[2]=Sr,y[3]=Ir,y[4]=$t,y[5]=Ki,y[6]=Vi,y[7]=Gi,y[8]=Wi,y[9]=Ji,y[10]=Jr,y[11]=Yi,y[12]=Zi,y[13]=sr,y[14]=Xi,y[15]=Qi,y[16]=en,y[17]=jo,y[18]=zo,d!==0&&(y[19]=d,l.length++),l};Math.imul||(N=O);function F(v,c,f){f.negative=c.negative^v.negative,f.length=v.length+c.length;for(var l=0,_=0,x=0;x<f.length-1;x++){var y=_;_=0;for(var d=l&67108863,w=Math.min(x,c.length-1),m=Math.max(0,x-v.length+1);m<=w;m++){var M=x-m,B=v.words[M]|0,E=c.words[m]|0,C=B*E,q=C&67108863;y=y+(C/67108864|0)|0,q=q+d|0,d=q&67108863,y=y+(q>>>26)|0,_+=y>>>26,y&=67108863}f.words[x]=d,l=y,y=_}return l!==0?f.words[x]=l:f.length--,f._strip()}function L(v,c,f){return F(v,c,f)}s.prototype.mulTo=function(c,f){var l,_=this.length+c.length;return this.length===10&&c.length===10?l=N(this,c,f):_<63?l=O(this,c,f):_<1024?l=F(this,c,f):l=L(this,c,f),l},s.prototype.mul=function(c){var f=new s(null);return f.words=new Array(this.length+c.length),this.mulTo(c,f)},s.prototype.mulf=function(c){var f=new s(null);return f.words=new Array(this.length+c.length),L(this,c,f)},s.prototype.imul=function(c){return this.clone().mulTo(c,this)},s.prototype.imuln=function(c){var f=c<0;f&&(c=-c),i(typeof c=="number"),i(c<67108864);for(var l=0,_=0;_<this.length;_++){var x=(this.words[_]|0)*c,y=(x&67108863)+(l&67108863);l>>=26,l+=x/67108864|0,l+=y>>>26,this.words[_]=y&67108863}return l!==0&&(this.words[_]=l,this.length++),f?this.ineg():this},s.prototype.muln=function(c){return this.clone().imuln(c)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(c){var f=R(c);if(f.length===0)return new s(1);for(var l=this,_=0;_<f.length&&f[_]===0;_++,l=l.sqr());if(++_<f.length)for(var x=l.sqr();_<f.length;_++,x=x.sqr())f[_]!==0&&(l=l.mul(x));return l},s.prototype.iushln=function(c){i(typeof c=="number"&&c>=0);var f=c%26,l=(c-f)/26,_=67108863>>>26-f<<26-f,x;if(f!==0){var y=0;for(x=0;x<this.length;x++){var d=this.words[x]&_,w=(this.words[x]|0)-d<<f;this.words[x]=w|y,y=d>>>26-f}y&&(this.words[x]=y,this.length++)}if(l!==0){for(x=this.length-1;x>=0;x--)this.words[x+l]=this.words[x];for(x=0;x<l;x++)this.words[x]=0;this.length+=l}return this._strip()},s.prototype.ishln=function(c){return i(this.negative===0),this.iushln(c)},s.prototype.iushrn=function(c,f,l){i(typeof c=="number"&&c>=0);var _;f?_=(f-f%26)/26:_=0;var x=c%26,y=Math.min((c-x)/26,this.length),d=67108863^67108863>>>x<<x,w=l;if(_-=y,_=Math.max(0,_),w){for(var m=0;m<y;m++)w.words[m]=this.words[m];w.length=y}if(y!==0)if(this.length>y)for(this.length-=y,m=0;m<this.length;m++)this.words[m]=this.words[m+y];else this.words[0]=0,this.length=1;var M=0;for(m=this.length-1;m>=0&&(M!==0||m>=_);m--){var B=this.words[m]|0;this.words[m]=M<<26-x|B>>>x,M=B&d}return w&&M!==0&&(w.words[w.length++]=M),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},s.prototype.ishrn=function(c,f,l){return i(this.negative===0),this.iushrn(c,f,l)},s.prototype.shln=function(c){return this.clone().ishln(c)},s.prototype.ushln=function(c){return this.clone().iushln(c)},s.prototype.shrn=function(c){return this.clone().ishrn(c)},s.prototype.ushrn=function(c){return this.clone().iushrn(c)},s.prototype.testn=function(c){i(typeof c=="number"&&c>=0);var f=c%26,l=(c-f)/26,_=1<<f;if(this.length<=l)return!1;var x=this.words[l];return!!(x&_)},s.prototype.imaskn=function(c){i(typeof c=="number"&&c>=0);var f=c%26,l=(c-f)/26;if(i(this.negative===0,"imaskn works only with positive numbers"),this.length<=l)return this;if(f!==0&&l++,this.length=Math.min(l,this.length),f!==0){var _=67108863^67108863>>>f<<f;this.words[this.length-1]&=_}return this._strip()},s.prototype.maskn=function(c){return this.clone().imaskn(c)},s.prototype.iaddn=function(c){return i(typeof c=="number"),i(c<67108864),c<0?this.isubn(-c):this.negative!==0?this.length===1&&(this.words[0]|0)<=c?(this.words[0]=c-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(c),this.negative=1,this):this._iaddn(c)},s.prototype._iaddn=function(c){this.words[0]+=c;for(var f=0;f<this.length&&this.words[f]>=67108864;f++)this.words[f]-=67108864,f===this.length-1?this.words[f+1]=1:this.words[f+1]++;return this.length=Math.max(this.length,f+1),this},s.prototype.isubn=function(c){if(i(typeof c=="number"),i(c<67108864),c<0)return this.iaddn(-c);if(this.negative!==0)return this.negative=0,this.iaddn(c),this.negative=1,this;if(this.words[0]-=c,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var f=0;f<this.length&&this.words[f]<0;f++)this.words[f]+=67108864,this.words[f+1]-=1;return this._strip()},s.prototype.addn=function(c){return this.clone().iaddn(c)},s.prototype.subn=function(c){return this.clone().isubn(c)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(c,f,l){var _=c.length+l,x;this._expand(_);var y,d=0;for(x=0;x<c.length;x++){y=(this.words[x+l]|0)+d;var w=(c.words[x]|0)*f;y-=w&67108863,d=(y>>26)-(w/67108864|0),this.words[x+l]=y&67108863}for(;x<this.length-l;x++)y=(this.words[x+l]|0)+d,d=y>>26,this.words[x+l]=y&67108863;if(d===0)return this._strip();for(i(d===-1),d=0,x=0;x<this.length;x++)y=-(this.words[x]|0)+d,d=y>>26,this.words[x]=y&67108863;return this.negative=1,this._strip()},s.prototype._wordDiv=function(c,f){var l=this.length-c.length,_=this.clone(),x=c,y=x.words[x.length-1]|0,d=this._countBits(y);l=26-d,l!==0&&(x=x.ushln(l),_.iushln(l),y=x.words[x.length-1]|0);var w=_.length-x.length,m;if(f!=="mod"){m=new s(null),m.length=w+1,m.words=new Array(m.length);for(var M=0;M<m.length;M++)m.words[M]=0}var B=_.clone()._ishlnsubmul(x,1,w);B.negative===0&&(_=B,m&&(m.words[w]=1));for(var E=w-1;E>=0;E--){var C=(_.words[x.length+E]|0)*67108864+(_.words[x.length+E-1]|0);for(C=Math.min(C/y|0,67108863),_._ishlnsubmul(x,C,E);_.negative!==0;)C--,_.negative=0,_._ishlnsubmul(x,1,E),_.isZero()||(_.negative^=1);m&&(m.words[E]=C)}return m&&m._strip(),_._strip(),f!=="div"&&l!==0&&_.iushrn(l),{div:m||null,mod:_}},s.prototype.divmod=function(c,f,l){if(i(!c.isZero()),this.isZero())return{div:new s(0),mod:new s(0)};var _,x,y;return this.negative!==0&&c.negative===0?(y=this.neg().divmod(c,f),f!=="mod"&&(_=y.div.neg()),f!=="div"&&(x=y.mod.neg(),l&&x.negative!==0&&x.iadd(c)),{div:_,mod:x}):this.negative===0&&c.negative!==0?(y=this.divmod(c.neg(),f),f!=="mod"&&(_=y.div.neg()),{div:_,mod:y.mod}):(this.negative&c.negative)!==0?(y=this.neg().divmod(c.neg(),f),f!=="div"&&(x=y.mod.neg(),l&&x.negative!==0&&x.isub(c)),{div:y.div,mod:x}):c.length>this.length||this.cmp(c)<0?{div:new s(0),mod:this}:c.length===1?f==="div"?{div:this.divn(c.words[0]),mod:null}:f==="mod"?{div:null,mod:new s(this.modrn(c.words[0]))}:{div:this.divn(c.words[0]),mod:new s(this.modrn(c.words[0]))}:this._wordDiv(c,f)},s.prototype.div=function(c){return this.divmod(c,"div",!1).div},s.prototype.mod=function(c){return this.divmod(c,"mod",!1).mod},s.prototype.umod=function(c){return this.divmod(c,"mod",!0).mod},s.prototype.divRound=function(c){var f=this.divmod(c);if(f.mod.isZero())return f.div;var l=f.div.negative!==0?f.mod.isub(c):f.mod,_=c.ushrn(1),x=c.andln(1),y=l.cmp(_);return y<0||x===1&&y===0?f.div:f.div.negative!==0?f.div.isubn(1):f.div.iaddn(1)},s.prototype.modrn=function(c){var f=c<0;f&&(c=-c),i(c<=67108863);for(var l=(1<<26)%c,_=0,x=this.length-1;x>=0;x--)_=(l*_+(this.words[x]|0))%c;return f?-_:_},s.prototype.modn=function(c){return this.modrn(c)},s.prototype.idivn=function(c){var f=c<0;f&&(c=-c),i(c<=67108863);for(var l=0,_=this.length-1;_>=0;_--){var x=(this.words[_]|0)+l*67108864;this.words[_]=x/c|0,l=x%c}return this._strip(),f?this.ineg():this},s.prototype.divn=function(c){return this.clone().idivn(c)},s.prototype.egcd=function(c){i(c.negative===0),i(!c.isZero());var f=this,l=c.clone();f.negative!==0?f=f.umod(c):f=f.clone();for(var _=new s(1),x=new s(0),y=new s(0),d=new s(1),w=0;f.isEven()&&l.isEven();)f.iushrn(1),l.iushrn(1),++w;for(var m=l.clone(),M=f.clone();!f.isZero();){for(var B=0,E=1;(f.words[0]&E)===0&&B<26;++B,E<<=1);if(B>0)for(f.iushrn(B);B-- >0;)(_.isOdd()||x.isOdd())&&(_.iadd(m),x.isub(M)),_.iushrn(1),x.iushrn(1);for(var C=0,q=1;(l.words[0]&q)===0&&C<26;++C,q<<=1);if(C>0)for(l.iushrn(C);C-- >0;)(y.isOdd()||d.isOdd())&&(y.iadd(m),d.isub(M)),y.iushrn(1),d.iushrn(1);f.cmp(l)>=0?(f.isub(l),_.isub(y),x.isub(d)):(l.isub(f),y.isub(_),d.isub(x))}return{a:y,b:d,gcd:l.iushln(w)}},s.prototype._invmp=function(c){i(c.negative===0),i(!c.isZero());var f=this,l=c.clone();f.negative!==0?f=f.umod(c):f=f.clone();for(var _=new s(1),x=new s(0),y=l.clone();f.cmpn(1)>0&&l.cmpn(1)>0;){for(var d=0,w=1;(f.words[0]&w)===0&&d<26;++d,w<<=1);if(d>0)for(f.iushrn(d);d-- >0;)_.isOdd()&&_.iadd(y),_.iushrn(1);for(var m=0,M=1;(l.words[0]&M)===0&&m<26;++m,M<<=1);if(m>0)for(l.iushrn(m);m-- >0;)x.isOdd()&&x.iadd(y),x.iushrn(1);f.cmp(l)>=0?(f.isub(l),_.isub(x)):(l.isub(f),x.isub(_))}var B;return f.cmpn(1)===0?B=_:B=x,B.cmpn(0)<0&&B.iadd(c),B},s.prototype.gcd=function(c){if(this.isZero())return c.abs();if(c.isZero())return this.abs();var f=this.clone(),l=c.clone();f.negative=0,l.negative=0;for(var _=0;f.isEven()&&l.isEven();_++)f.iushrn(1),l.iushrn(1);do{for(;f.isEven();)f.iushrn(1);for(;l.isEven();)l.iushrn(1);var x=f.cmp(l);if(x<0){var y=f;f=l,l=y}else if(x===0||l.cmpn(1)===0)break;f.isub(l)}while(!0);return l.iushln(_)},s.prototype.invm=function(c){return this.egcd(c).a.umod(c)},s.prototype.isEven=function(){return(this.words[0]&1)===0},s.prototype.isOdd=function(){return(this.words[0]&1)===1},s.prototype.andln=function(c){return this.words[0]&c},s.prototype.bincn=function(c){i(typeof c=="number");var f=c%26,l=(c-f)/26,_=1<<f;if(this.length<=l)return this._expand(l+1),this.words[l]|=_,this;for(var x=_,y=l;x!==0&&y<this.length;y++){var d=this.words[y]|0;d+=x,x=d>>>26,d&=67108863,this.words[y]=d}return x!==0&&(this.words[y]=x,this.length++),this},s.prototype.isZero=function(){return this.length===1&&this.words[0]===0},s.prototype.cmpn=function(c){var f=c<0;if(this.negative!==0&&!f)return-1;if(this.negative===0&&f)return 1;this._strip();var l;if(this.length>1)l=1;else{f&&(c=-c),i(c<=67108863,"Number is too big");var _=this.words[0]|0;l=_===c?0:_<c?-1:1}return this.negative!==0?-l|0:l},s.prototype.cmp=function(c){if(this.negative!==0&&c.negative===0)return-1;if(this.negative===0&&c.negative!==0)return 1;var f=this.ucmp(c);return this.negative!==0?-f|0:f},s.prototype.ucmp=function(c){if(this.length>c.length)return 1;if(this.length<c.length)return-1;for(var f=0,l=this.length-1;l>=0;l--){var _=this.words[l]|0,x=c.words[l]|0;if(_!==x){_<x?f=-1:_>x&&(f=1);break}}return f},s.prototype.gtn=function(c){return this.cmpn(c)===1},s.prototype.gt=function(c){return this.cmp(c)===1},s.prototype.gten=function(c){return this.cmpn(c)>=0},s.prototype.gte=function(c){return this.cmp(c)>=0},s.prototype.ltn=function(c){return this.cmpn(c)===-1},s.prototype.lt=function(c){return this.cmp(c)===-1},s.prototype.lten=function(c){return this.cmpn(c)<=0},s.prototype.lte=function(c){return this.cmp(c)<=0},s.prototype.eqn=function(c){return this.cmpn(c)===0},s.prototype.eq=function(c){return this.cmp(c)===0},s.red=function(c){return new D(c)},s.prototype.toRed=function(c){return i(!this.red,"Already a number in reduction context"),i(this.negative===0,"red works only with positives"),c.convertTo(this)._forceRed(c)},s.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(c){return this.red=c,this},s.prototype.forceRed=function(c){return i(!this.red,"Already a number in reduction context"),this._forceRed(c)},s.prototype.redAdd=function(c){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,c)},s.prototype.redIAdd=function(c){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,c)},s.prototype.redSub=function(c){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,c)},s.prototype.redISub=function(c){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,c)},s.prototype.redShl=function(c){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,c)},s.prototype.redMul=function(c){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,c),this.red.mul(this,c)},s.prototype.redIMul=function(c){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,c),this.red.imul(this,c)},s.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(c){return i(this.red&&!c.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,c)};var z={k256:null,p224:null,p192:null,p25519:null};function k(v,c){this.name=v,this.p=new s(c,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}k.prototype._tmp=function(){var c=new s(null);return c.words=new Array(Math.ceil(this.n/13)),c},k.prototype.ireduce=function(c){var f=c,l;do this.split(f,this.tmp),f=this.imulK(f),f=f.iadd(this.tmp),l=f.bitLength();while(l>this.n);var _=l<this.n?-1:f.ucmp(this.p);return _===0?(f.words[0]=0,f.length=1):_>0?f.isub(this.p):f.strip!==void 0?f.strip():f._strip(),f},k.prototype.split=function(c,f){c.iushrn(this.n,0,f)},k.prototype.imulK=function(c){return c.imul(this.k)};function G(){k.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}n(G,k),G.prototype.split=function(c,f){for(var l=4194303,_=Math.min(c.length,9),x=0;x<_;x++)f.words[x]=c.words[x];if(f.length=_,c.length<=9){c.words[0]=0,c.length=1;return}var y=c.words[9];for(f.words[f.length++]=y&l,x=10;x<c.length;x++){var d=c.words[x]|0;c.words[x-10]=(d&l)<<4|y>>>22,y=d}y>>>=22,c.words[x-10]=y,y===0&&c.length>10?c.length-=10:c.length-=9},G.prototype.imulK=function(c){c.words[c.length]=0,c.words[c.length+1]=0,c.length+=2;for(var f=0,l=0;l<c.length;l++){var _=c.words[l]|0;f+=_*977,c.words[l]=f&67108863,f=_*64+(f/67108864|0)}return c.words[c.length-1]===0&&(c.length--,c.words[c.length-1]===0&&c.length--),c};function K(){k.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}n(K,k);function H(){k.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}n(H,k);function ie(){k.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}n(ie,k),ie.prototype.imulK=function(c){for(var f=0,l=0;l<c.length;l++){var _=(c.words[l]|0)*19+f,x=_&67108863;_>>>=26,c.words[l]=x,f=_}return f!==0&&(c.words[c.length++]=f),c},s._prime=function(c){if(z[c])return z[c];var f;if(c==="k256")f=new G;else if(c==="p224")f=new K;else if(c==="p192")f=new H;else if(c==="p25519")f=new ie;else throw new Error("Unknown prime "+c);return z[c]=f,f};function D(v){if(typeof v=="string"){var c=s._prime(v);this.m=c.p,this.prime=c}else i(v.gtn(1),"modulus must be greater than 1"),this.m=v,this.prime=null}D.prototype._verify1=function(c){i(c.negative===0,"red works only with positives"),i(c.red,"red works only with red numbers")},D.prototype._verify2=function(c,f){i((c.negative|f.negative)===0,"red works only with positives"),i(c.red&&c.red===f.red,"red works only with red numbers")},D.prototype.imod=function(c){return this.prime?this.prime.ireduce(c)._forceRed(this):(p(c,c.umod(this.m)._forceRed(this)),c)},D.prototype.neg=function(c){return c.isZero()?c.clone():this.m.sub(c)._forceRed(this)},D.prototype.add=function(c,f){this._verify2(c,f);var l=c.add(f);return l.cmp(this.m)>=0&&l.isub(this.m),l._forceRed(this)},D.prototype.iadd=function(c,f){this._verify2(c,f);var l=c.iadd(f);return l.cmp(this.m)>=0&&l.isub(this.m),l},D.prototype.sub=function(c,f){this._verify2(c,f);var l=c.sub(f);return l.cmpn(0)<0&&l.iadd(this.m),l._forceRed(this)},D.prototype.isub=function(c,f){this._verify2(c,f);var l=c.isub(f);return l.cmpn(0)<0&&l.iadd(this.m),l},D.prototype.shl=function(c,f){return this._verify1(c),this.imod(c.ushln(f))},D.prototype.imul=function(c,f){return this._verify2(c,f),this.imod(c.imul(f))},D.prototype.mul=function(c,f){return this._verify2(c,f),this.imod(c.mul(f))},D.prototype.isqr=function(c){return this.imul(c,c.clone())},D.prototype.sqr=function(c){return this.mul(c,c)},D.prototype.sqrt=function(c){if(c.isZero())return c.clone();var f=this.m.andln(3);if(i(f%2===1),f===3){var l=this.m.add(new s(1)).iushrn(2);return this.pow(c,l)}for(var _=this.m.subn(1),x=0;!_.isZero()&&_.andln(1)===0;)x++,_.iushrn(1);i(!_.isZero());var y=new s(1).toRed(this),d=y.redNeg(),w=this.m.subn(1).iushrn(1),m=this.m.bitLength();for(m=new s(2*m*m).toRed(this);this.pow(m,w).cmp(d)!==0;)m.redIAdd(d);for(var M=this.pow(m,_),B=this.pow(c,_.addn(1).iushrn(1)),E=this.pow(c,_),C=x;E.cmp(y)!==0;){for(var q=E,U=0;q.cmp(y)!==0;U++)q=q.redSqr();i(U<C);var j=this.pow(M,new s(1).iushln(C-U-1));B=B.redMul(j),M=j.redSqr(),E=E.redMul(M),C=U}return B},D.prototype.invm=function(c){var f=c._invmp(this.m);return f.negative!==0?(f.negative=0,this.imod(f).redNeg()):this.imod(f)},D.prototype.pow=function(c,f){if(f.isZero())return new s(1).toRed(this);if(f.cmpn(1)===0)return c.clone();var l=4,_=new Array(1<<l);_[0]=new s(1).toRed(this),_[1]=c;for(var x=2;x<_.length;x++)_[x]=this.mul(_[x-1],c);var y=_[0],d=0,w=0,m=f.bitLength()%26;for(m===0&&(m=26),x=f.length-1;x>=0;x--){for(var M=f.words[x],B=m-1;B>=0;B--){var E=M>>B&1;if(y!==_[0]&&(y=this.sqr(y)),E===0&&d===0){w=0;continue}d<<=1,d|=E,w++,!(w!==l&&(x!==0||B!==0))&&(y=this.mul(y,_[d]),w=0,d=0)}m=26}return y},D.prototype.convertTo=function(c){var f=c.umod(this.m);return f===c?f.clone():f},D.prototype.convertFrom=function(c){var f=c.clone();return f.red=null,f},s.mont=function(c){return new g(c)};function g(v){D.call(this,v),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}n(g,D),g.prototype.convertTo=function(c){return this.imod(c.ushln(this.shift))},g.prototype.convertFrom=function(c){var f=this.imod(c.mul(this.rinv));return f.red=null,f},g.prototype.imul=function(c,f){if(c.isZero()||f.isZero())return c.words[0]=0,c.length=1,c;var l=c.imul(f),_=l.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),x=l.isub(_).iushrn(this.shift),y=x;return x.cmp(this.m)>=0?y=x.isub(this.m):x.cmpn(0)<0&&(y=x.iadd(this.m)),y._forceRed(this)},g.prototype.mul=function(c,f){if(c.isZero()||f.isZero())return new s(0)._forceRed(this);var l=c.mul(f),_=l.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),x=l.isub(_).iushrn(this.shift),y=x;return x.cmp(this.m)>=0?y=x.isub(this.m):x.cmpn(0)<0&&(y=x.iadd(this.m)),y._forceRed(this)},g.prototype.invm=function(c){var f=this.imod(c._invmp(this.m).mul(this.r2));return f._forceRed(this)}})(t,yt)})(Ud);var we=Ud.exports;const jd="bignumber/5.7.0";var la=we.BN;const Ni=new Se(jd),of={},zd=9007199254740991;function pw(t){return t!=null&&(Et.isBigNumber(t)||typeof t=="number"&&t%1===0||typeof t=="string"&&!!t.match(/^-?[0-9]+$/)||Ar(t)||typeof t=="bigint"||ss(t))}let kd=!1;class Et{constructor(e,r){e!==of&&Ni.throwError("cannot call constructor directly; use BigNumber.from",Se.errors.UNSUPPORTED_OPERATION,{operation:"new (BigNumber)"}),this._hex=r,this._isBigNumber=!0,Object.freeze(this)}fromTwos(e){return gr(Ae(this).fromTwos(e))}toTwos(e){return gr(Ae(this).toTwos(e))}abs(){return this._hex[0]==="-"?Et.from(this._hex.substring(1)):this}add(e){return gr(Ae(this).add(Ae(e)))}sub(e){return gr(Ae(this).sub(Ae(e)))}div(e){return Et.from(e).isZero()&&Fr("division-by-zero","div"),gr(Ae(this).div(Ae(e)))}mul(e){return gr(Ae(this).mul(Ae(e)))}mod(e){const r=Ae(e);return r.isNeg()&&Fr("division-by-zero","mod"),gr(Ae(this).umod(r))}pow(e){const r=Ae(e);return r.isNeg()&&Fr("negative-power","pow"),gr(Ae(this).pow(r))}and(e){const r=Ae(e);return(this.isNegative()||r.isNeg())&&Fr("unbound-bitwise-result","and"),gr(Ae(this).and(r))}or(e){const r=Ae(e);return(this.isNegative()||r.isNeg())&&Fr("unbound-bitwise-result","or"),gr(Ae(this).or(r))}xor(e){const r=Ae(e);return(this.isNegative()||r.isNeg())&&Fr("unbound-bitwise-result","xor"),gr(Ae(this).xor(r))}mask(e){return(this.isNegative()||e<0)&&Fr("negative-width","mask"),gr(Ae(this).maskn(e))}shl(e){return(this.isNegative()||e<0)&&Fr("negative-width","shl"),gr(Ae(this).shln(e))}shr(e){return(this.isNegative()||e<0)&&Fr("negative-width","shr"),gr(Ae(this).shrn(e))}eq(e){return Ae(this).eq(Ae(e))}lt(e){return Ae(this).lt(Ae(e))}lte(e){return Ae(this).lte(Ae(e))}gt(e){return Ae(this).gt(Ae(e))}gte(e){return Ae(this).gte(Ae(e))}isNegative(){return this._hex[0]==="-"}isZero(){return Ae(this).isZero()}toNumber(){try{return Ae(this).toNumber()}catch{Fr("overflow","toNumber",this.toString())}return null}toBigInt(){try{return BigInt(this.toString())}catch{}return Ni.throwError("this platform does not support BigInt",Se.errors.UNSUPPORTED_OPERATION,{value:this.toString()})}toString(){return arguments.length>0&&(arguments[0]===10?kd||(kd=!0,Ni.warn("BigNumber.toString does not accept any parameters; base-10 is assumed")):arguments[0]===16?Ni.throwError("BigNumber.toString does not accept any parameters; use bigNumber.toHexString()",Se.errors.UNEXPECTED_ARGUMENT,{}):Ni.throwError("BigNumber.toString does not accept parameters",Se.errors.UNEXPECTED_ARGUMENT,{})),Ae(this).toString(10)}toHexString(){return this._hex}toJSON(e){return{type:"BigNumber",hex:this.toHexString()}}static from(e){if(e instanceof Et)return e;if(typeof e=="string")return e.match(/^-?0x[0-9a-f]+$/i)?new Et(of,so(e)):e.match(/^-?[0-9]+$/)?new Et(of,so(new la(e))):Ni.throwArgumentError("invalid BigNumber string","value",e);if(typeof e=="number")return e%1&&Fr("underflow","BigNumber.from",e),(e>=zd||e<=-zd)&&Fr("overflow","BigNumber.from",e),Et.from(String(e));const r=e;if(typeof r=="bigint")return Et.from(r.toString());if(ss(r))return Et.from(cr(r));if(r)if(r.toHexString){const i=r.toHexString();if(typeof i=="string")return Et.from(i)}else{let i=r._hex;if(i==null&&r.type==="BigNumber"&&(i=r.hex),typeof i=="string"&&(Ar(i)||i[0]==="-"&&Ar(i.substring(1))))return Et.from(i)}return Ni.throwArgumentError("invalid BigNumber value","value",e)}static isBigNumber(e){return!!(e&&e._isBigNumber)}}function so(t){if(typeof t!="string")return so(t.toString(16));if(t[0]==="-")return t=t.substring(1),t[0]==="-"&&Ni.throwArgumentError("invalid hex","value",t),t=so(t),t==="0x00"?t:"-"+t;if(t.substring(0,2)!=="0x"&&(t="0x"+t),t==="0x")return"0x00";for(t.length%2&&(t="0x0"+t.substring(2));t.length>4&&t.substring(0,4)==="0x00";)t="0x"+t.substring(4);return t}function gr(t){return Et.from(so(t))}function Ae(t){const e=Et.from(t).toHexString();return e[0]==="-"?new la("-"+e.substring(3),16):new la(e.substring(2),16)}function Fr(t,e,r){const i={fault:t,operation:e};return r!=null&&(i.value=r),Ni.throwError(t,Se.errors.NUMERIC_FAULT,i)}function vw(t){return new la(t,36).toString(16)}const fr=new Se(jd),oo={},Hd=Et.from(0),Kd=Et.from(-1);function Vd(t,e,r,i){const n={fault:e,operation:r};return i!==void 0&&(n.value=i),fr.throwError(t,Se.errors.NUMERIC_FAULT,n)}let ao="0";for(;ao.length<256;)ao+=ao;function af(t){if(typeof t!="number")try{t=Et.from(t).toNumber()}catch{}return typeof t=="number"&&t>=0&&t<=256&&!(t%1)?"1"+ao.substring(0,t):fr.throwArgumentError("invalid decimal size","decimals",t)}function cf(t,e){e==null&&(e=0);const r=af(e);t=Et.from(t);const i=t.lt(Hd);i&&(t=t.mul(Kd));let n=t.mod(r).toString();for(;n.length<r.length-1;)n="0"+n;n=n.match(/^([0-9]*[1-9]|0)(0*)/)[1];const s=t.div(r).toString();return r.length===1?t=s:t=s+"."+n,i&&(t="-"+t),t}function Ci(t,e){e==null&&(e=0);const r=af(e);(typeof t!="string"||!t.match(/^-?[0-9.]+$/))&&fr.throwArgumentError("invalid decimal value","value",t);const i=t.substring(0,1)==="-";i&&(t=t.substring(1)),t==="."&&fr.throwArgumentError("missing value","value",t);const n=t.split(".");n.length>2&&fr.throwArgumentError("too many decimal points","value",t);let s=n[0],o=n[1];for(s||(s="0"),o||(o="0");o[o.length-1]==="0";)o=o.substring(0,o.length-1);for(o.length>r.length-1&&Vd("fractional component exceeds decimals","underflow","parseFixed"),o===""&&(o="0");o.length<r.length-1;)o+="0";const a=Et.from(s),h=Et.from(o);let u=a.mul(r).add(h);return i&&(u=u.mul(Kd)),u}class os{constructor(e,r,i,n){e!==oo&&fr.throwError("cannot use FixedFormat constructor; use FixedFormat.from",Se.errors.UNSUPPORTED_OPERATION,{operation:"new FixedFormat"}),this.signed=r,this.width=i,this.decimals=n,this.name=(r?"":"u")+"fixed"+String(i)+"x"+String(n),this._multiplier=af(n),Object.freeze(this)}static from(e){if(e instanceof os)return e;typeof e=="number"&&(e=`fixed128x${e}`);let r=!0,i=128,n=18;if(typeof e=="string"){if(e!=="fixed")if(e==="ufixed")r=!1;else{const s=e.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);s||fr.throwArgumentError("invalid fixed format","format",e),r=s[1]!=="u",i=parseInt(s[2]),n=parseInt(s[3])}}else if(e){const s=(o,a,h)=>e[o]==null?h:(typeof e[o]!==a&&fr.throwArgumentError("invalid fixed format ("+o+" not "+a+")","format."+o,e[o]),e[o]);r=s("signed","boolean",r),i=s("width","number",i),n=s("decimals","number",n)}return i%8&&fr.throwArgumentError("invalid fixed format width (not byte aligned)","format.width",i),n>80&&fr.throwArgumentError("invalid fixed format (decimals too large)","format.decimals",n),new os(oo,r,i,n)}}class Kt{constructor(e,r,i,n){e!==oo&&fr.throwError("cannot use FixedNumber constructor; use FixedNumber.from",Se.errors.UNSUPPORTED_OPERATION,{operation:"new FixedFormat"}),this.format=n,this._hex=r,this._value=i,this._isFixedNumber=!0,Object.freeze(this)}_checkFormat(e){this.format.name!==e.format.name&&fr.throwArgumentError("incompatible format; use fixedNumber.toFormat","other",e)}addUnsafe(e){this._checkFormat(e);const r=Ci(this._value,this.format.decimals),i=Ci(e._value,e.format.decimals);return Kt.fromValue(r.add(i),this.format.decimals,this.format)}subUnsafe(e){this._checkFormat(e);const r=Ci(this._value,this.format.decimals),i=Ci(e._value,e.format.decimals);return Kt.fromValue(r.sub(i),this.format.decimals,this.format)}mulUnsafe(e){this._checkFormat(e);const r=Ci(this._value,this.format.decimals),i=Ci(e._value,e.format.decimals);return Kt.fromValue(r.mul(i).div(this.format._multiplier),this.format.decimals,this.format)}divUnsafe(e){this._checkFormat(e);const r=Ci(this._value,this.format.decimals),i=Ci(e._value,e.format.decimals);return Kt.fromValue(r.mul(this.format._multiplier).div(i),this.format.decimals,this.format)}floor(){const e=this.toString().split(".");e.length===1&&e.push("0");let r=Kt.from(e[0],this.format);const i=!e[1].match(/^(0*)$/);return this.isNegative()&&i&&(r=r.subUnsafe(Gd.toFormat(r.format))),r}ceiling(){const e=this.toString().split(".");e.length===1&&e.push("0");let r=Kt.from(e[0],this.format);const i=!e[1].match(/^(0*)$/);return!this.isNegative()&&i&&(r=r.addUnsafe(Gd.toFormat(r.format))),r}round(e){e==null&&(e=0);const r=this.toString().split(".");if(r.length===1&&r.push("0"),(e<0||e>80||e%1)&&fr.throwArgumentError("invalid decimal count","decimals",e),r[1].length<=e)return this;const i=Kt.from("1"+ao.substring(0,e),this.format),n=gw.toFormat(this.format);return this.mulUnsafe(i).addUnsafe(n).floor().divUnsafe(i)}isZero(){return this._value==="0.0"||this._value==="0"}isNegative(){return this._value[0]==="-"}toString(){return this._value}toHexString(e){if(e==null)return this._hex;e%8&&fr.throwArgumentError("invalid byte width","width",e);const r=Et.from(this._hex).fromTwos(this.format.width).toTwos(e).toHexString();return sn(r,e/8)}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(e){return Kt.fromString(this._value,e)}static fromValue(e,r,i){return i==null&&r!=null&&!pw(r)&&(i=r,r=null),r==null&&(r=0),i==null&&(i="fixed"),Kt.fromString(cf(e,r),os.from(i))}static fromString(e,r){r==null&&(r="fixed");const i=os.from(r),n=Ci(e,i.decimals);!i.signed&&n.lt(Hd)&&Vd("unsigned value cannot be negative","overflow","value",e);let s=null;i.signed?s=n.toTwos(i.width).toHexString():(s=n.toHexString(),s=sn(s,i.width/8));const o=cf(n,i.decimals);return new Kt(oo,s,o,i)}static fromBytes(e,r){r==null&&(r="fixed");const i=os.from(r);if(Rt(e).length>i.width/8)throw new Error("overflow");let n=Et.from(e);i.signed&&(n=n.fromTwos(i.width));const s=n.toTwos((i.signed?0:1)+i.width).toHexString(),o=cf(n,i.decimals);return new Kt(oo,s,o,i)}static from(e,r){if(typeof e=="string")return Kt.fromString(e,r);if(ss(e))return Kt.fromBytes(e,r);try{return Kt.fromValue(e,0,r)}catch(i){if(i.code!==Se.errors.INVALID_ARGUMENT)throw i}return fr.throwArgumentError("invalid FixedNumber value","value",e)}static isFixedNumber(e){return!!(e&&e._isFixedNumber)}}const Gd=Kt.from(1),gw=Kt.from("0.5");var Wd={exports:{}};/**
 * [js-sha3]{@link https://github.com/emn178/js-sha3}
 *
 * @version 0.8.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2015-2018
 * @license MIT
 */(function(t){(function(){var e="input is invalid type",r="finalize already called",i=typeof window=="object",n=i?window:{};n.JS_SHA3_NO_WINDOW&&(i=!1);var s=!i&&typeof self=="object",o=!n.JS_SHA3_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;o?n=yt:s&&(n=self);var a=!n.JS_SHA3_NO_COMMON_JS&&!0&&t.exports,h=!n.JS_SHA3_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",u="0123456789abcdef".split(""),p=[31,7936,2031616,520093696],b=[4,1024,262144,67108864],S=[1,256,65536,16777216],A=[6,1536,393216,100663296],I=[0,8,16,24],P=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],R=[224,256,384,512],O=[128,256],N=["hex","buffer","arrayBuffer","array","digest"],F={128:168,256:136};(n.JS_SHA3_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(E){return Object.prototype.toString.call(E)==="[object Array]"}),h&&(n.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(E){return typeof E=="object"&&E.buffer&&E.buffer.constructor===ArrayBuffer});for(var L=function(E,C,q){return function(U){return new m(E,C,E).update(U)[q]()}},z=function(E,C,q){return function(U,j){return new m(E,C,j).update(U)[q]()}},k=function(E,C,q){return function(U,j,Y,X){return c["cshake"+E].update(U,j,Y,X)[q]()}},G=function(E,C,q){return function(U,j,Y,X){return c["kmac"+E].update(U,j,Y,X)[q]()}},K=function(E,C,q,U){for(var j=0;j<N.length;++j){var Y=N[j];E[Y]=C(q,U,Y)}return E},H=function(E,C){var q=L(E,C,"hex");return q.create=function(){return new m(E,C,E)},q.update=function(U){return q.create().update(U)},K(q,L,E,C)},ie=function(E,C){var q=z(E,C,"hex");return q.create=function(U){return new m(E,C,U)},q.update=function(U,j){return q.create(j).update(U)},K(q,z,E,C)},D=function(E,C){var q=F[E],U=k(E,C,"hex");return U.create=function(j,Y,X){return!Y&&!X?c["shake"+E].create(j):new m(E,C,j).bytepad([Y,X],q)},U.update=function(j,Y,X,W){return U.create(Y,X,W).update(j)},K(U,k,E,C)},g=function(E,C){var q=F[E],U=G(E,C,"hex");return U.create=function(j,Y,X){return new M(E,C,Y).bytepad(["KMAC",X],q).bytepad([j],q)},U.update=function(j,Y,X,W){return U.create(j,X,W).update(Y)},K(U,G,E,C)},v=[{name:"keccak",padding:S,bits:R,createMethod:H},{name:"sha3",padding:A,bits:R,createMethod:H},{name:"shake",padding:p,bits:O,createMethod:ie},{name:"cshake",padding:b,bits:O,createMethod:D},{name:"kmac",padding:b,bits:O,createMethod:g}],c={},f=[],l=0;l<v.length;++l)for(var _=v[l],x=_.bits,y=0;y<x.length;++y){var d=_.name+"_"+x[y];if(f.push(d),c[d]=_.createMethod(x[y],_.padding),_.name!=="sha3"){var w=_.name+x[y];f.push(w),c[w]=c[d]}}function m(E,C,q){this.blocks=[],this.s=[],this.padding=C,this.outputBits=q,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(E<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=q>>5,this.extraBytes=(q&31)>>3;for(var U=0;U<50;++U)this.s[U]=0}m.prototype.update=function(E){if(this.finalized)throw new Error(r);var C,q=typeof E;if(q!=="string"){if(q==="object"){if(E===null)throw new Error(e);if(h&&E.constructor===ArrayBuffer)E=new Uint8Array(E);else if(!Array.isArray(E)&&(!h||!ArrayBuffer.isView(E)))throw new Error(e)}else throw new Error(e);C=!0}for(var U=this.blocks,j=this.byteCount,Y=E.length,X=this.blockCount,W=0,se=this.s,ee,te;W<Y;){if(this.reset)for(this.reset=!1,U[0]=this.block,ee=1;ee<X+1;++ee)U[ee]=0;if(C)for(ee=this.start;W<Y&&ee<j;++W)U[ee>>2]|=E[W]<<I[ee++&3];else for(ee=this.start;W<Y&&ee<j;++W)te=E.charCodeAt(W),te<128?U[ee>>2]|=te<<I[ee++&3]:te<2048?(U[ee>>2]|=(192|te>>6)<<I[ee++&3],U[ee>>2]|=(128|te&63)<<I[ee++&3]):te<55296||te>=57344?(U[ee>>2]|=(224|te>>12)<<I[ee++&3],U[ee>>2]|=(128|te>>6&63)<<I[ee++&3],U[ee>>2]|=(128|te&63)<<I[ee++&3]):(te=65536+((te&1023)<<10|E.charCodeAt(++W)&1023),U[ee>>2]|=(240|te>>18)<<I[ee++&3],U[ee>>2]|=(128|te>>12&63)<<I[ee++&3],U[ee>>2]|=(128|te>>6&63)<<I[ee++&3],U[ee>>2]|=(128|te&63)<<I[ee++&3]);if(this.lastByteIndex=ee,ee>=j){for(this.start=ee-j,this.block=U[X],ee=0;ee<X;++ee)se[ee]^=U[ee];B(se),this.reset=!0}else this.start=ee}return this},m.prototype.encode=function(E,C){var q=E&255,U=1,j=[q];for(E=E>>8,q=E&255;q>0;)j.unshift(q),E=E>>8,q=E&255,++U;return C?j.push(U):j.unshift(U),this.update(j),j.length},m.prototype.encodeString=function(E){var C,q=typeof E;if(q!=="string"){if(q==="object"){if(E===null)throw new Error(e);if(h&&E.constructor===ArrayBuffer)E=new Uint8Array(E);else if(!Array.isArray(E)&&(!h||!ArrayBuffer.isView(E)))throw new Error(e)}else throw new Error(e);C=!0}var U=0,j=E.length;if(C)U=j;else for(var Y=0;Y<E.length;++Y){var X=E.charCodeAt(Y);X<128?U+=1:X<2048?U+=2:X<55296||X>=57344?U+=3:(X=65536+((X&1023)<<10|E.charCodeAt(++Y)&1023),U+=4)}return U+=this.encode(U*8),this.update(E),U},m.prototype.bytepad=function(E,C){for(var q=this.encode(C),U=0;U<E.length;++U)q+=this.encodeString(E[U]);var j=C-q%C,Y=[];return Y.length=j,this.update(Y),this},m.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var E=this.blocks,C=this.lastByteIndex,q=this.blockCount,U=this.s;if(E[C>>2]|=this.padding[C&3],this.lastByteIndex===this.byteCount)for(E[0]=E[q],C=1;C<q+1;++C)E[C]=0;for(E[q-1]|=2147483648,C=0;C<q;++C)U[C]^=E[C];B(U)}},m.prototype.toString=m.prototype.hex=function(){this.finalize();for(var E=this.blockCount,C=this.s,q=this.outputBlocks,U=this.extraBytes,j=0,Y=0,X="",W;Y<q;){for(j=0;j<E&&Y<q;++j,++Y)W=C[j],X+=u[W>>4&15]+u[W&15]+u[W>>12&15]+u[W>>8&15]+u[W>>20&15]+u[W>>16&15]+u[W>>28&15]+u[W>>24&15];Y%E===0&&(B(C),j=0)}return U&&(W=C[j],X+=u[W>>4&15]+u[W&15],U>1&&(X+=u[W>>12&15]+u[W>>8&15]),U>2&&(X+=u[W>>20&15]+u[W>>16&15])),X},m.prototype.arrayBuffer=function(){this.finalize();var E=this.blockCount,C=this.s,q=this.outputBlocks,U=this.extraBytes,j=0,Y=0,X=this.outputBits>>3,W;U?W=new ArrayBuffer(q+1<<2):W=new ArrayBuffer(X);for(var se=new Uint32Array(W);Y<q;){for(j=0;j<E&&Y<q;++j,++Y)se[Y]=C[j];Y%E===0&&B(C)}return U&&(se[j]=C[j],W=W.slice(0,X)),W},m.prototype.buffer=m.prototype.arrayBuffer,m.prototype.digest=m.prototype.array=function(){this.finalize();for(var E=this.blockCount,C=this.s,q=this.outputBlocks,U=this.extraBytes,j=0,Y=0,X=[],W,se;Y<q;){for(j=0;j<E&&Y<q;++j,++Y)W=Y<<2,se=C[j],X[W]=se&255,X[W+1]=se>>8&255,X[W+2]=se>>16&255,X[W+3]=se>>24&255;Y%E===0&&B(C)}return U&&(W=Y<<2,se=C[j],X[W]=se&255,U>1&&(X[W+1]=se>>8&255),U>2&&(X[W+2]=se>>16&255)),X};function M(E,C,q){m.call(this,E,C,q)}M.prototype=new m,M.prototype.finalize=function(){return this.encode(this.outputBits,!0),m.prototype.finalize.call(this)};var B=function(E){var C,q,U,j,Y,X,W,se,ee,te,ke,He,ue,Ne,Ce,ce,Te,Fe,he,Be,qe,ae,Oe,Le,ne,Ye,Ze,ve,Xe,Ue,le,Qe,rt,oe,et,it,ge,Ke,Re,de,Ve,Ge,fe,nt,st,be,ot,at,pe,We,Pe,me,ct,ft,ye,ht,Ee,tt,xr,Er,Sr,Ir,$t;for(U=0;U<48;U+=2)j=E[0]^E[10]^E[20]^E[30]^E[40],Y=E[1]^E[11]^E[21]^E[31]^E[41],X=E[2]^E[12]^E[22]^E[32]^E[42],W=E[3]^E[13]^E[23]^E[33]^E[43],se=E[4]^E[14]^E[24]^E[34]^E[44],ee=E[5]^E[15]^E[25]^E[35]^E[45],te=E[6]^E[16]^E[26]^E[36]^E[46],ke=E[7]^E[17]^E[27]^E[37]^E[47],He=E[8]^E[18]^E[28]^E[38]^E[48],ue=E[9]^E[19]^E[29]^E[39]^E[49],C=He^(X<<1|W>>>31),q=ue^(W<<1|X>>>31),E[0]^=C,E[1]^=q,E[10]^=C,E[11]^=q,E[20]^=C,E[21]^=q,E[30]^=C,E[31]^=q,E[40]^=C,E[41]^=q,C=j^(se<<1|ee>>>31),q=Y^(ee<<1|se>>>31),E[2]^=C,E[3]^=q,E[12]^=C,E[13]^=q,E[22]^=C,E[23]^=q,E[32]^=C,E[33]^=q,E[42]^=C,E[43]^=q,C=X^(te<<1|ke>>>31),q=W^(ke<<1|te>>>31),E[4]^=C,E[5]^=q,E[14]^=C,E[15]^=q,E[24]^=C,E[25]^=q,E[34]^=C,E[35]^=q,E[44]^=C,E[45]^=q,C=se^(He<<1|ue>>>31),q=ee^(ue<<1|He>>>31),E[6]^=C,E[7]^=q,E[16]^=C,E[17]^=q,E[26]^=C,E[27]^=q,E[36]^=C,E[37]^=q,E[46]^=C,E[47]^=q,C=te^(j<<1|Y>>>31),q=ke^(Y<<1|j>>>31),E[8]^=C,E[9]^=q,E[18]^=C,E[19]^=q,E[28]^=C,E[29]^=q,E[38]^=C,E[39]^=q,E[48]^=C,E[49]^=q,Ne=E[0],Ce=E[1],be=E[11]<<4|E[10]>>>28,ot=E[10]<<4|E[11]>>>28,ve=E[20]<<3|E[21]>>>29,Xe=E[21]<<3|E[20]>>>29,Er=E[31]<<9|E[30]>>>23,Sr=E[30]<<9|E[31]>>>23,Ge=E[40]<<18|E[41]>>>14,fe=E[41]<<18|E[40]>>>14,oe=E[2]<<1|E[3]>>>31,et=E[3]<<1|E[2]>>>31,ce=E[13]<<12|E[12]>>>20,Te=E[12]<<12|E[13]>>>20,at=E[22]<<10|E[23]>>>22,pe=E[23]<<10|E[22]>>>22,Ue=E[33]<<13|E[32]>>>19,le=E[32]<<13|E[33]>>>19,Ir=E[42]<<2|E[43]>>>30,$t=E[43]<<2|E[42]>>>30,ft=E[5]<<30|E[4]>>>2,ye=E[4]<<30|E[5]>>>2,it=E[14]<<6|E[15]>>>26,ge=E[15]<<6|E[14]>>>26,Fe=E[25]<<11|E[24]>>>21,he=E[24]<<11|E[25]>>>21,We=E[34]<<15|E[35]>>>17,Pe=E[35]<<15|E[34]>>>17,Qe=E[45]<<29|E[44]>>>3,rt=E[44]<<29|E[45]>>>3,Le=E[6]<<28|E[7]>>>4,ne=E[7]<<28|E[6]>>>4,ht=E[17]<<23|E[16]>>>9,Ee=E[16]<<23|E[17]>>>9,Ke=E[26]<<25|E[27]>>>7,Re=E[27]<<25|E[26]>>>7,Be=E[36]<<21|E[37]>>>11,qe=E[37]<<21|E[36]>>>11,me=E[47]<<24|E[46]>>>8,ct=E[46]<<24|E[47]>>>8,nt=E[8]<<27|E[9]>>>5,st=E[9]<<27|E[8]>>>5,Ye=E[18]<<20|E[19]>>>12,Ze=E[19]<<20|E[18]>>>12,tt=E[29]<<7|E[28]>>>25,xr=E[28]<<7|E[29]>>>25,de=E[38]<<8|E[39]>>>24,Ve=E[39]<<8|E[38]>>>24,ae=E[48]<<14|E[49]>>>18,Oe=E[49]<<14|E[48]>>>18,E[0]=Ne^~ce&Fe,E[1]=Ce^~Te&he,E[10]=Le^~Ye&ve,E[11]=ne^~Ze&Xe,E[20]=oe^~it&Ke,E[21]=et^~ge&Re,E[30]=nt^~be&at,E[31]=st^~ot&pe,E[40]=ft^~ht&tt,E[41]=ye^~Ee&xr,E[2]=ce^~Fe&Be,E[3]=Te^~he&qe,E[12]=Ye^~ve&Ue,E[13]=Ze^~Xe&le,E[22]=it^~Ke&de,E[23]=ge^~Re&Ve,E[32]=be^~at&We,E[33]=ot^~pe&Pe,E[42]=ht^~tt&Er,E[43]=Ee^~xr&Sr,E[4]=Fe^~Be&ae,E[5]=he^~qe&Oe,E[14]=ve^~Ue&Qe,E[15]=Xe^~le&rt,E[24]=Ke^~de&Ge,E[25]=Re^~Ve&fe,E[34]=at^~We&me,E[35]=pe^~Pe&ct,E[44]=tt^~Er&Ir,E[45]=xr^~Sr&$t,E[6]=Be^~ae&Ne,E[7]=qe^~Oe&Ce,E[16]=Ue^~Qe&Le,E[17]=le^~rt&ne,E[26]=de^~Ge&oe,E[27]=Ve^~fe&et,E[36]=We^~me&nt,E[37]=Pe^~ct&st,E[46]=Er^~Ir&ft,E[47]=Sr^~$t&ye,E[8]=ae^~Ne&ce,E[9]=Oe^~Ce&Te,E[18]=Qe^~Le&Ye,E[19]=rt^~ne&Ze,E[28]=Ge^~oe&it,E[29]=fe^~et&ge,E[38]=me^~nt&be,E[39]=ct^~st&ot,E[48]=Ir^~ft&ht,E[49]=$t^~ye&Ee,E[0]^=P[U],E[1]^=P[U+1]};if(a)t.exports=c;else for(l=0;l<f.length;++l)n[f[l]]=c[f[l]]})()})(Wd);var bw=Wd.exports;function Jd(t){return"0x"+bw.keccak_256(Rt(t))}const mw="rlp/5.7.0";new Se(mw);const yw="address/5.7.0",co=new Se(yw);function Yd(t){Ar(t,20)||co.throwArgumentError("invalid address","address",t),t=t.toLowerCase();const e=t.substring(2).split(""),r=new Uint8Array(40);for(let n=0;n<40;n++)r[n]=e[n].charCodeAt(0);const i=Rt(Jd(r));for(let n=0;n<40;n+=2)i[n>>1]>>4>=8&&(e[n]=e[n].toUpperCase()),(i[n>>1]&15)>=8&&(e[n+1]=e[n+1].toUpperCase());return"0x"+e.join("")}const ww=9007199254740991;function _w(t){return Math.log10?Math.log10(t):Math.log(t)/Math.LN10}const ff={};for(let t=0;t<10;t++)ff[String(t)]=String(t);for(let t=0;t<26;t++)ff[String.fromCharCode(65+t)]=String(10+t);const Zd=Math.floor(_w(ww));function xw(t){t=t.toUpperCase(),t=t.substring(4)+t.substring(0,2)+"00";let e=t.split("").map(i=>ff[i]).join("");for(;e.length>=Zd;){let i=e.substring(0,Zd);e=parseInt(i,10)%97+e.substring(i.length)}let r=String(98-parseInt(e,10)%97);for(;r.length<2;)r="0"+r;return r}function Ew(t){let e=null;if(typeof t!="string"&&co.throwArgumentError("invalid address","address",t),t.match(/^(0x)?[0-9a-fA-F]{40}$/))t.substring(0,2)!=="0x"&&(t="0x"+t),e=Yd(t),t.match(/([A-F].*[a-f])|([a-f].*[A-F])/)&&e!==t&&co.throwArgumentError("bad address checksum","address",t);else if(t.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){for(t.substring(2,4)!==xw(t)&&co.throwArgumentError("bad icap checksum","address",t),e=vw(t.substring(4));e.length<40;)e="0"+e;e=Yd("0x"+e)}else co.throwArgumentError("invalid address","address",t);return e}const Sw="properties/5.7.0";new Se(Sw);function fo(t,e,r){Object.defineProperty(t,e,{enumerable:!0,value:r,writable:!1})}var Mr={},Me={},$n=Xd;function Xd(t,e){if(!t)throw new Error(e||"Assertion failed")}Xd.equal=function(e,r,i){if(e!=r)throw new Error(i||"Assertion failed: "+e+" != "+r)};var as={exports:{}};typeof Object.create=="function"?as.exports=function(e,r){r&&(e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:as.exports=function(e,r){if(r){e.super_=r;var i=function(){};i.prototype=r.prototype,e.prototype=new i,e.prototype.constructor=e}};var Iw=$n,Aw=as.exports;Me.inherits=Aw;function Mw(t,e){return(t.charCodeAt(e)&64512)!==55296||e<0||e+1>=t.length?!1:(t.charCodeAt(e+1)&64512)===56320}function Pw(t,e){if(Array.isArray(t))return t.slice();if(!t)return[];var r=[];if(typeof t=="string")if(e){if(e==="hex")for(t=t.replace(/[^a-z0-9]+/ig,""),t.length%2!==0&&(t="0"+t),n=0;n<t.length;n+=2)r.push(parseInt(t[n]+t[n+1],16))}else for(var i=0,n=0;n<t.length;n++){var s=t.charCodeAt(n);s<128?r[i++]=s:s<2048?(r[i++]=s>>6|192,r[i++]=s&63|128):Mw(t,n)?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),r[i++]=s>>18|240,r[i++]=s>>12&63|128,r[i++]=s>>6&63|128,r[i++]=s&63|128):(r[i++]=s>>12|224,r[i++]=s>>6&63|128,r[i++]=s&63|128)}else for(n=0;n<t.length;n++)r[n]=t[n]|0;return r}Me.toArray=Pw;function Dw(t){for(var e="",r=0;r<t.length;r++)e+=el(t[r].toString(16));return e}Me.toHex=Dw;function Qd(t){var e=t>>>24|t>>>8&65280|t<<8&16711680|(t&255)<<24;return e>>>0}Me.htonl=Qd;function $w(t,e){for(var r="",i=0;i<t.length;i++){var n=t[i];e==="little"&&(n=Qd(n)),r+=tl(n.toString(16))}return r}Me.toHex32=$w;function el(t){return t.length===1?"0"+t:t}Me.zero2=el;function tl(t){return t.length===7?"0"+t:t.length===6?"00"+t:t.length===5?"000"+t:t.length===4?"0000"+t:t.length===3?"00000"+t:t.length===2?"000000"+t:t.length===1?"0000000"+t:t}Me.zero8=tl;function Ow(t,e,r,i){var n=r-e;Iw(n%4===0);for(var s=new Array(n/4),o=0,a=e;o<s.length;o++,a+=4){var h;i==="big"?h=t[a]<<24|t[a+1]<<16|t[a+2]<<8|t[a+3]:h=t[a+3]<<24|t[a+2]<<16|t[a+1]<<8|t[a],s[o]=h>>>0}return s}Me.join32=Ow;function Rw(t,e){for(var r=new Array(t.length*4),i=0,n=0;i<t.length;i++,n+=4){var s=t[i];e==="big"?(r[n]=s>>>24,r[n+1]=s>>>16&255,r[n+2]=s>>>8&255,r[n+3]=s&255):(r[n+3]=s>>>24,r[n+2]=s>>>16&255,r[n+1]=s>>>8&255,r[n]=s&255)}return r}Me.split32=Rw;function Nw(t,e){return t>>>e|t<<32-e}Me.rotr32=Nw;function Cw(t,e){return t<<e|t>>>32-e}Me.rotl32=Cw;function Tw(t,e){return t+e>>>0}Me.sum32=Tw;function Fw(t,e,r){return t+e+r>>>0}Me.sum32_3=Fw;function Bw(t,e,r,i){return t+e+r+i>>>0}Me.sum32_4=Bw;function qw(t,e,r,i,n){return t+e+r+i+n>>>0}Me.sum32_5=qw;function Lw(t,e,r,i){var n=t[e],s=t[e+1],o=i+s>>>0,a=(o<i?1:0)+r+n;t[e]=a>>>0,t[e+1]=o}Me.sum64=Lw;function Uw(t,e,r,i){var n=e+i>>>0,s=(n<e?1:0)+t+r;return s>>>0}Me.sum64_hi=Uw;function jw(t,e,r,i){var n=e+i;return n>>>0}Me.sum64_lo=jw;function zw(t,e,r,i,n,s,o,a){var h=0,u=e;u=u+i>>>0,h+=u<e?1:0,u=u+s>>>0,h+=u<s?1:0,u=u+a>>>0,h+=u<a?1:0;var p=t+r+n+o+h;return p>>>0}Me.sum64_4_hi=zw;function kw(t,e,r,i,n,s,o,a){var h=e+i+s+a;return h>>>0}Me.sum64_4_lo=kw;function Hw(t,e,r,i,n,s,o,a,h,u){var p=0,b=e;b=b+i>>>0,p+=b<e?1:0,b=b+s>>>0,p+=b<s?1:0,b=b+a>>>0,p+=b<a?1:0,b=b+u>>>0,p+=b<u?1:0;var S=t+r+n+o+h+p;return S>>>0}Me.sum64_5_hi=Hw;function Kw(t,e,r,i,n,s,o,a,h,u){var p=e+i+s+a+u;return p>>>0}Me.sum64_5_lo=Kw;function Vw(t,e,r){var i=e<<32-r|t>>>r;return i>>>0}Me.rotr64_hi=Vw;function Gw(t,e,r){var i=t<<32-r|e>>>r;return i>>>0}Me.rotr64_lo=Gw;function Ww(t,e,r){return t>>>r}Me.shr64_hi=Ww;function Jw(t,e,r){var i=t<<32-r|e>>>r;return i>>>0}Me.shr64_lo=Jw;var cs={},rl=Me,Yw=$n;function pa(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}cs.BlockHash=pa,pa.prototype.update=function(e,r){if(e=rl.toArray(e,r),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){e=this.pending;var i=e.length%this._delta8;this.pending=e.slice(e.length-i,e.length),this.pending.length===0&&(this.pending=null),e=rl.join32(e,0,e.length-i,this.endian);for(var n=0;n<e.length;n+=this._delta32)this._update(e,n,n+this._delta32)}return this},pa.prototype.digest=function(e){return this.update(this._pad()),Yw(this.pending===null),this._digest(e)},pa.prototype._pad=function(){var e=this.pendingTotal,r=this._delta8,i=r-(e+this.padLength)%r,n=new Array(i+this.padLength);n[0]=128;for(var s=1;s<i;s++)n[s]=0;if(e<<=3,this.endian==="big"){for(var o=8;o<this.padLength;o++)n[s++]=0;n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=e>>>24&255,n[s++]=e>>>16&255,n[s++]=e>>>8&255,n[s++]=e&255}else for(n[s++]=e&255,n[s++]=e>>>8&255,n[s++]=e>>>16&255,n[s++]=e>>>24&255,n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=0,o=8;o<this.padLength;o++)n[s++]=0;return n};var fs={},li={},Zw=Me,pi=Zw.rotr32;function Xw(t,e,r,i){if(t===0)return il(e,r,i);if(t===1||t===3)return sl(e,r,i);if(t===2)return nl(e,r,i)}li.ft_1=Xw;function il(t,e,r){return t&e^~t&r}li.ch32=il;function nl(t,e,r){return t&e^t&r^e&r}li.maj32=nl;function sl(t,e,r){return t^e^r}li.p32=sl;function Qw(t){return pi(t,2)^pi(t,13)^pi(t,22)}li.s0_256=Qw;function e3(t){return pi(t,6)^pi(t,11)^pi(t,25)}li.s1_256=e3;function t3(t){return pi(t,7)^pi(t,18)^t>>>3}li.g0_256=t3;function r3(t){return pi(t,17)^pi(t,19)^t>>>10}li.g1_256=r3;var hs=Me,i3=cs,n3=li,hf=hs.rotl32,ho=hs.sum32,s3=hs.sum32_5,o3=n3.ft_1,ol=i3.BlockHash,a3=[1518500249,1859775393,2400959708,3395469782];function vi(){if(!(this instanceof vi))return new vi;ol.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}hs.inherits(vi,ol);var c3=vi;vi.blockSize=512,vi.outSize=160,vi.hmacStrength=80,vi.padLength=64,vi.prototype._update=function(e,r){for(var i=this.W,n=0;n<16;n++)i[n]=e[r+n];for(;n<i.length;n++)i[n]=hf(i[n-3]^i[n-8]^i[n-14]^i[n-16],1);var s=this.h[0],o=this.h[1],a=this.h[2],h=this.h[3],u=this.h[4];for(n=0;n<i.length;n++){var p=~~(n/20),b=s3(hf(s,5),o3(p,o,a,h),u,i[n],a3[p]);u=h,h=a,a=hf(o,30),o=s,s=b}this.h[0]=ho(this.h[0],s),this.h[1]=ho(this.h[1],o),this.h[2]=ho(this.h[2],a),this.h[3]=ho(this.h[3],h),this.h[4]=ho(this.h[4],u)},vi.prototype._digest=function(e){return e==="hex"?hs.toHex32(this.h,"big"):hs.split32(this.h,"big")};var us=Me,f3=cs,ds=li,h3=$n,ei=us.sum32,u3=us.sum32_4,d3=us.sum32_5,l3=ds.ch32,p3=ds.maj32,v3=ds.s0_256,g3=ds.s1_256,b3=ds.g0_256,m3=ds.g1_256,al=f3.BlockHash,y3=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function gi(){if(!(this instanceof gi))return new gi;al.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=y3,this.W=new Array(64)}us.inherits(gi,al);var cl=gi;gi.blockSize=512,gi.outSize=256,gi.hmacStrength=192,gi.padLength=64,gi.prototype._update=function(e,r){for(var i=this.W,n=0;n<16;n++)i[n]=e[r+n];for(;n<i.length;n++)i[n]=u3(m3(i[n-2]),i[n-7],b3(i[n-15]),i[n-16]);var s=this.h[0],o=this.h[1],a=this.h[2],h=this.h[3],u=this.h[4],p=this.h[5],b=this.h[6],S=this.h[7];for(h3(this.k.length===i.length),n=0;n<i.length;n++){var A=d3(S,g3(u),l3(u,p,b),this.k[n],i[n]),I=ei(v3(s),p3(s,o,a));S=b,b=p,p=u,u=ei(h,A),h=a,a=o,o=s,s=ei(A,I)}this.h[0]=ei(this.h[0],s),this.h[1]=ei(this.h[1],o),this.h[2]=ei(this.h[2],a),this.h[3]=ei(this.h[3],h),this.h[4]=ei(this.h[4],u),this.h[5]=ei(this.h[5],p),this.h[6]=ei(this.h[6],b),this.h[7]=ei(this.h[7],S)},gi.prototype._digest=function(e){return e==="hex"?us.toHex32(this.h,"big"):us.split32(this.h,"big")};var uf=Me,fl=cl;function Ti(){if(!(this instanceof Ti))return new Ti;fl.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}uf.inherits(Ti,fl);var w3=Ti;Ti.blockSize=512,Ti.outSize=224,Ti.hmacStrength=192,Ti.padLength=64,Ti.prototype._digest=function(e){return e==="hex"?uf.toHex32(this.h.slice(0,7),"big"):uf.split32(this.h.slice(0,7),"big")};var br=Me,_3=cs,x3=$n,bi=br.rotr64_hi,mi=br.rotr64_lo,hl=br.shr64_hi,ul=br.shr64_lo,on=br.sum64,df=br.sum64_hi,lf=br.sum64_lo,E3=br.sum64_4_hi,S3=br.sum64_4_lo,I3=br.sum64_5_hi,A3=br.sum64_5_lo,dl=_3.BlockHash,M3=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function ti(){if(!(this instanceof ti))return new ti;dl.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=M3,this.W=new Array(160)}br.inherits(ti,dl);var ll=ti;ti.blockSize=1024,ti.outSize=512,ti.hmacStrength=192,ti.padLength=128,ti.prototype._prepareBlock=function(e,r){for(var i=this.W,n=0;n<32;n++)i[n]=e[r+n];for(;n<i.length;n+=2){var s=q3(i[n-4],i[n-3]),o=L3(i[n-4],i[n-3]),a=i[n-14],h=i[n-13],u=F3(i[n-30],i[n-29]),p=B3(i[n-30],i[n-29]),b=i[n-32],S=i[n-31];i[n]=E3(s,o,a,h,u,p,b,S),i[n+1]=S3(s,o,a,h,u,p,b,S)}},ti.prototype._update=function(e,r){this._prepareBlock(e,r);var i=this.W,n=this.h[0],s=this.h[1],o=this.h[2],a=this.h[3],h=this.h[4],u=this.h[5],p=this.h[6],b=this.h[7],S=this.h[8],A=this.h[9],I=this.h[10],P=this.h[11],R=this.h[12],O=this.h[13],N=this.h[14],F=this.h[15];x3(this.k.length===i.length);for(var L=0;L<i.length;L+=2){var z=N,k=F,G=C3(S,A),K=T3(S,A),H=P3(S,A,I,P,R),ie=D3(S,A,I,P,R,O),D=this.k[L],g=this.k[L+1],v=i[L],c=i[L+1],f=I3(z,k,G,K,H,ie,D,g,v,c),l=A3(z,k,G,K,H,ie,D,g,v,c);z=R3(n,s),k=N3(n,s),G=$3(n,s,o,a,h),K=O3(n,s,o,a,h,u);var _=df(z,k,G,K),x=lf(z,k,G,K);N=R,F=O,R=I,O=P,I=S,P=A,S=df(p,b,f,l),A=lf(b,b,f,l),p=h,b=u,h=o,u=a,o=n,a=s,n=df(f,l,_,x),s=lf(f,l,_,x)}on(this.h,0,n,s),on(this.h,2,o,a),on(this.h,4,h,u),on(this.h,6,p,b),on(this.h,8,S,A),on(this.h,10,I,P),on(this.h,12,R,O),on(this.h,14,N,F)},ti.prototype._digest=function(e){return e==="hex"?br.toHex32(this.h,"big"):br.split32(this.h,"big")};function P3(t,e,r,i,n){var s=t&r^~t&n;return s<0&&(s+=4294967296),s}function D3(t,e,r,i,n,s){var o=e&i^~e&s;return o<0&&(o+=4294967296),o}function $3(t,e,r,i,n){var s=t&r^t&n^r&n;return s<0&&(s+=4294967296),s}function O3(t,e,r,i,n,s){var o=e&i^e&s^i&s;return o<0&&(o+=4294967296),o}function R3(t,e){var r=bi(t,e,28),i=bi(e,t,2),n=bi(e,t,7),s=r^i^n;return s<0&&(s+=4294967296),s}function N3(t,e){var r=mi(t,e,28),i=mi(e,t,2),n=mi(e,t,7),s=r^i^n;return s<0&&(s+=4294967296),s}function C3(t,e){var r=bi(t,e,14),i=bi(t,e,18),n=bi(e,t,9),s=r^i^n;return s<0&&(s+=4294967296),s}function T3(t,e){var r=mi(t,e,14),i=mi(t,e,18),n=mi(e,t,9),s=r^i^n;return s<0&&(s+=4294967296),s}function F3(t,e){var r=bi(t,e,1),i=bi(t,e,8),n=hl(t,e,7),s=r^i^n;return s<0&&(s+=4294967296),s}function B3(t,e){var r=mi(t,e,1),i=mi(t,e,8),n=ul(t,e,7),s=r^i^n;return s<0&&(s+=4294967296),s}function q3(t,e){var r=bi(t,e,19),i=bi(e,t,29),n=hl(t,e,6),s=r^i^n;return s<0&&(s+=4294967296),s}function L3(t,e){var r=mi(t,e,19),i=mi(e,t,29),n=ul(t,e,6),s=r^i^n;return s<0&&(s+=4294967296),s}var pf=Me,pl=ll;function Fi(){if(!(this instanceof Fi))return new Fi;pl.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}pf.inherits(Fi,pl);var U3=Fi;Fi.blockSize=1024,Fi.outSize=384,Fi.hmacStrength=192,Fi.padLength=128,Fi.prototype._digest=function(e){return e==="hex"?pf.toHex32(this.h.slice(0,12),"big"):pf.split32(this.h.slice(0,12),"big")},fs.sha1=c3,fs.sha224=w3,fs.sha256=cl,fs.sha384=U3,fs.sha512=ll;var vl={},On=Me,j3=cs,va=On.rotl32,gl=On.sum32,uo=On.sum32_3,bl=On.sum32_4,ml=j3.BlockHash;function yi(){if(!(this instanceof yi))return new yi;ml.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}On.inherits(yi,ml),vl.ripemd160=yi,yi.blockSize=512,yi.outSize=160,yi.hmacStrength=192,yi.padLength=64,yi.prototype._update=function(e,r){for(var i=this.h[0],n=this.h[1],s=this.h[2],o=this.h[3],a=this.h[4],h=i,u=n,p=s,b=o,S=a,A=0;A<80;A++){var I=gl(va(bl(i,yl(A,n,s,o),e[H3[A]+r],z3(A)),V3[A]),a);i=a,a=o,o=va(s,10),s=n,n=I,I=gl(va(bl(h,yl(79-A,u,p,b),e[K3[A]+r],k3(A)),G3[A]),S),h=S,S=b,b=va(p,10),p=u,u=I}I=uo(this.h[1],s,b),this.h[1]=uo(this.h[2],o,S),this.h[2]=uo(this.h[3],a,h),this.h[3]=uo(this.h[4],i,u),this.h[4]=uo(this.h[0],n,p),this.h[0]=I},yi.prototype._digest=function(e){return e==="hex"?On.toHex32(this.h,"little"):On.split32(this.h,"little")};function yl(t,e,r,i){return t<=15?e^r^i:t<=31?e&r|~e&i:t<=47?(e|~r)^i:t<=63?e&i|r&~i:e^(r|~i)}function z3(t){return t<=15?0:t<=31?1518500249:t<=47?1859775393:t<=63?2400959708:2840853838}function k3(t){return t<=15?1352829926:t<=31?1548603684:t<=47?1836072691:t<=63?2053994217:0}var H3=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],K3=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],V3=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],G3=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],W3=Me,J3=$n;function ls(t,e,r){if(!(this instanceof ls))return new ls(t,e,r);this.Hash=t,this.blockSize=t.blockSize/8,this.outSize=t.outSize/8,this.inner=null,this.outer=null,this._init(W3.toArray(e,r))}var Y3=ls;ls.prototype._init=function(e){e.length>this.blockSize&&(e=new this.Hash().update(e).digest()),J3(e.length<=this.blockSize);for(var r=e.length;r<this.blockSize;r++)e.push(0);for(r=0;r<e.length;r++)e[r]^=54;for(this.inner=new this.Hash().update(e),r=0;r<e.length;r++)e[r]^=106;this.outer=new this.Hash().update(e)},ls.prototype.update=function(e,r){return this.inner.update(e,r),this},ls.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)},function(t){var e=t;e.utils=Me,e.common=cs,e.sha=fs,e.ripemd=vl,e.hmac=Y3,e.sha1=e.sha.sha1,e.sha256=e.sha.sha256,e.sha224=e.sha.sha224,e.sha384=e.sha.sha384,e.sha512=e.sha.sha512,e.ripemd160=e.ripemd.ripemd160}(Mr);function ps(t,e,r){return r={path:e,exports:{},require:function(i,n){return Z3(i,n??r.path)}},t(r,r.exports),r.exports}function Z3(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var vf=wl;function wl(t,e){if(!t)throw new Error(e||"Assertion failed")}wl.equal=function(e,r,i){if(e!=r)throw new Error(i||"Assertion failed: "+e+" != "+r)};var ri=ps(function(t,e){var r=e;function i(o,a){if(Array.isArray(o))return o.slice();if(!o)return[];var h=[];if(typeof o!="string"){for(var u=0;u<o.length;u++)h[u]=o[u]|0;return h}if(a==="hex"){o=o.replace(/[^a-z0-9]+/ig,""),o.length%2!==0&&(o="0"+o);for(var u=0;u<o.length;u+=2)h.push(parseInt(o[u]+o[u+1],16))}else for(var u=0;u<o.length;u++){var p=o.charCodeAt(u),b=p>>8,S=p&255;b?h.push(b,S):h.push(S)}return h}r.toArray=i;function n(o){return o.length===1?"0"+o:o}r.zero2=n;function s(o){for(var a="",h=0;h<o.length;h++)a+=n(o[h].toString(16));return a}r.toHex=s,r.encode=function(a,h){return h==="hex"?s(a):a}}),Pr=ps(function(t,e){var r=e;r.assert=vf,r.toArray=ri.toArray,r.zero2=ri.zero2,r.toHex=ri.toHex,r.encode=ri.encode;function i(h,u,p){var b=new Array(Math.max(h.bitLength(),p)+1);b.fill(0);for(var S=1<<u+1,A=h.clone(),I=0;I<b.length;I++){var P,R=A.andln(S-1);A.isOdd()?(R>(S>>1)-1?P=(S>>1)-R:P=R,A.isubn(P)):P=0,b[I]=P,A.iushrn(1)}return b}r.getNAF=i;function n(h,u){var p=[[],[]];h=h.clone(),u=u.clone();for(var b=0,S=0,A;h.cmpn(-b)>0||u.cmpn(-S)>0;){var I=h.andln(3)+b&3,P=u.andln(3)+S&3;I===3&&(I=-1),P===3&&(P=-1);var R;(I&1)===0?R=0:(A=h.andln(7)+b&7,(A===3||A===5)&&P===2?R=-I:R=I),p[0].push(R);var O;(P&1)===0?O=0:(A=u.andln(7)+S&7,(A===3||A===5)&&I===2?O=-P:O=P),p[1].push(O),2*b===R+1&&(b=1-b),2*S===O+1&&(S=1-S),h.iushrn(1),u.iushrn(1)}return p}r.getJSF=n;function s(h,u,p){var b="_"+u;h.prototype[u]=function(){return this[b]!==void 0?this[b]:this[b]=p.call(this)}}r.cachedProperty=s;function o(h){return typeof h=="string"?r.toArray(h,"hex"):h}r.parseBytes=o;function a(h){return new we(h,"hex","le")}r.intFromLE=a}),ga=Pr.getNAF,X3=Pr.getJSF,ba=Pr.assert;function an(t,e){this.type=t,this.p=new we(e.p,16),this.red=e.prime?we.red(e.prime):we.mont(this.p),this.zero=new we(0).toRed(this.red),this.one=new we(1).toRed(this.red),this.two=new we(2).toRed(this.red),this.n=e.n&&new we(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var Rn=an;an.prototype.point=function(){throw new Error("Not implemented")},an.prototype.validate=function(){throw new Error("Not implemented")},an.prototype._fixedNafMul=function(e,r){ba(e.precomputed);var i=e._getDoubles(),n=ga(r,1,this._bitLength),s=(1<<i.step+1)-(i.step%2===0?2:1);s/=3;var o=[],a,h;for(a=0;a<n.length;a+=i.step){h=0;for(var u=a+i.step-1;u>=a;u--)h=(h<<1)+n[u];o.push(h)}for(var p=this.jpoint(null,null,null),b=this.jpoint(null,null,null),S=s;S>0;S--){for(a=0;a<o.length;a++)h=o[a],h===S?b=b.mixedAdd(i.points[a]):h===-S&&(b=b.mixedAdd(i.points[a].neg()));p=p.add(b)}return p.toP()},an.prototype._wnafMul=function(e,r){var i=4,n=e._getNAFPoints(i);i=n.wnd;for(var s=n.points,o=ga(r,i,this._bitLength),a=this.jpoint(null,null,null),h=o.length-1;h>=0;h--){for(var u=0;h>=0&&o[h]===0;h--)u++;if(h>=0&&u++,a=a.dblp(u),h<0)break;var p=o[h];ba(p!==0),e.type==="affine"?p>0?a=a.mixedAdd(s[p-1>>1]):a=a.mixedAdd(s[-p-1>>1].neg()):p>0?a=a.add(s[p-1>>1]):a=a.add(s[-p-1>>1].neg())}return e.type==="affine"?a.toP():a},an.prototype._wnafMulAdd=function(e,r,i,n,s){var o=this._wnafT1,a=this._wnafT2,h=this._wnafT3,u=0,p,b,S;for(p=0;p<n;p++){S=r[p];var A=S._getNAFPoints(e);o[p]=A.wnd,a[p]=A.points}for(p=n-1;p>=1;p-=2){var I=p-1,P=p;if(o[I]!==1||o[P]!==1){h[I]=ga(i[I],o[I],this._bitLength),h[P]=ga(i[P],o[P],this._bitLength),u=Math.max(h[I].length,u),u=Math.max(h[P].length,u);continue}var R=[r[I],null,null,r[P]];r[I].y.cmp(r[P].y)===0?(R[1]=r[I].add(r[P]),R[2]=r[I].toJ().mixedAdd(r[P].neg())):r[I].y.cmp(r[P].y.redNeg())===0?(R[1]=r[I].toJ().mixedAdd(r[P]),R[2]=r[I].add(r[P].neg())):(R[1]=r[I].toJ().mixedAdd(r[P]),R[2]=r[I].toJ().mixedAdd(r[P].neg()));var O=[-3,-1,-5,-7,0,7,5,1,3],N=X3(i[I],i[P]);for(u=Math.max(N[0].length,u),h[I]=new Array(u),h[P]=new Array(u),b=0;b<u;b++){var F=N[0][b]|0,L=N[1][b]|0;h[I][b]=O[(F+1)*3+(L+1)],h[P][b]=0,a[I]=R}}var z=this.jpoint(null,null,null),k=this._wnafT4;for(p=u;p>=0;p--){for(var G=0;p>=0;){var K=!0;for(b=0;b<n;b++)k[b]=h[b][p]|0,k[b]!==0&&(K=!1);if(!K)break;G++,p--}if(p>=0&&G++,z=z.dblp(G),p<0)break;for(b=0;b<n;b++){var H=k[b];H!==0&&(H>0?S=a[b][H-1>>1]:H<0&&(S=a[b][-H-1>>1].neg()),S.type==="affine"?z=z.mixedAdd(S):z=z.add(S))}}for(p=0;p<n;p++)a[p]=null;return s?z:z.toP()};function Br(t,e){this.curve=t,this.type=e,this.precomputed=null}an.BasePoint=Br,Br.prototype.eq=function(){throw new Error("Not implemented")},Br.prototype.validate=function(){return this.curve.validate(this)},an.prototype.decodePoint=function(e,r){e=Pr.toArray(e,r);var i=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1===2*i){e[0]===6?ba(e[e.length-1]%2===0):e[0]===7&&ba(e[e.length-1]%2===1);var n=this.point(e.slice(1,1+i),e.slice(1+i,1+2*i));return n}else if((e[0]===2||e[0]===3)&&e.length-1===i)return this.pointFromX(e.slice(1,1+i),e[0]===3);throw new Error("Unknown point format")},Br.prototype.encodeCompressed=function(e){return this.encode(e,!0)},Br.prototype._encode=function(e){var r=this.curve.p.byteLength(),i=this.getX().toArray("be",r);return e?[this.getY().isEven()?2:3].concat(i):[4].concat(i,this.getY().toArray("be",r))},Br.prototype.encode=function(e,r){return Pr.encode(this._encode(r),e)},Br.prototype.precompute=function(e){if(this.precomputed)return this;var r={doubles:null,naf:null,beta:null};return r.naf=this._getNAFPoints(8),r.doubles=this._getDoubles(4,e),r.beta=this._getBeta(),this.precomputed=r,this},Br.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var r=this.precomputed.doubles;return r?r.points.length>=Math.ceil((e.bitLength()+1)/r.step):!1},Br.prototype._getDoubles=function(e,r){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var i=[this],n=this,s=0;s<r;s+=e){for(var o=0;o<e;o++)n=n.dbl();i.push(n)}return{step:e,points:i}},Br.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var r=[this],i=(1<<e)-1,n=i===1?null:this.dbl(),s=1;s<i;s++)r[s]=r[s-1].add(n);return{wnd:e,points:r}},Br.prototype._getBeta=function(){return null},Br.prototype.dblp=function(e){for(var r=this,i=0;i<e;i++)r=r.dbl();return r};var gf=ps(function(t){typeof Object.create=="function"?t.exports=function(r,i){i&&(r.super_=i,r.prototype=Object.create(i.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(r,i){if(i){r.super_=i;var n=function(){};n.prototype=i.prototype,r.prototype=new n,r.prototype.constructor=r}}}),Q3=Pr.assert;function qr(t){Rn.call(this,"short",t),this.a=new we(t.a,16).toRed(this.red),this.b=new we(t.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(t),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}gf(qr,Rn);var e6=qr;qr.prototype._getEndomorphism=function(e){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var r,i;if(e.beta)r=new we(e.beta,16).toRed(this.red);else{var n=this._getEndoRoots(this.p);r=n[0].cmp(n[1])<0?n[0]:n[1],r=r.toRed(this.red)}if(e.lambda)i=new we(e.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(r))===0?i=s[0]:(i=s[1],Q3(this.g.mul(i).x.cmp(this.g.x.redMul(r))===0))}var o;return e.basis?o=e.basis.map(function(a){return{a:new we(a.a,16),b:new we(a.b,16)}}):o=this._getEndoBasis(i),{beta:r,lambda:i,basis:o}}},qr.prototype._getEndoRoots=function(e){var r=e===this.p?this.red:we.mont(e),i=new we(2).toRed(r).redInvm(),n=i.redNeg(),s=new we(3).toRed(r).redNeg().redSqrt().redMul(i),o=n.redAdd(s).fromRed(),a=n.redSub(s).fromRed();return[o,a]},qr.prototype._getEndoBasis=function(e){for(var r=this.n.ushrn(Math.floor(this.n.bitLength()/2)),i=e,n=this.n.clone(),s=new we(1),o=new we(0),a=new we(0),h=new we(1),u,p,b,S,A,I,P,R=0,O,N;i.cmpn(0)!==0;){var F=n.div(i);O=n.sub(F.mul(i)),N=a.sub(F.mul(s));var L=h.sub(F.mul(o));if(!b&&O.cmp(r)<0)u=P.neg(),p=s,b=O.neg(),S=N;else if(b&&++R===2)break;P=O,n=i,i=O,a=s,s=N,h=o,o=L}A=O.neg(),I=N;var z=b.sqr().add(S.sqr()),k=A.sqr().add(I.sqr());return k.cmp(z)>=0&&(A=u,I=p),b.negative&&(b=b.neg(),S=S.neg()),A.negative&&(A=A.neg(),I=I.neg()),[{a:b,b:S},{a:A,b:I}]},qr.prototype._endoSplit=function(e){var r=this.endo.basis,i=r[0],n=r[1],s=n.b.mul(e).divRound(this.n),o=i.b.neg().mul(e).divRound(this.n),a=s.mul(i.a),h=o.mul(n.a),u=s.mul(i.b),p=o.mul(n.b),b=e.sub(a).sub(h),S=u.add(p).neg();return{k1:b,k2:S}},qr.prototype.pointFromX=function(e,r){e=new we(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),n=i.redSqrt();if(n.redSqr().redSub(i).cmp(this.zero)!==0)throw new Error("invalid point");var s=n.fromRed().isOdd();return(r&&!s||!r&&s)&&(n=n.redNeg()),this.point(e,n)},qr.prototype.validate=function(e){if(e.inf)return!0;var r=e.x,i=e.y,n=this.a.redMul(r),s=r.redSqr().redMul(r).redIAdd(n).redIAdd(this.b);return i.redSqr().redISub(s).cmpn(0)===0},qr.prototype._endoWnafMulAdd=function(e,r,i){for(var n=this._endoWnafT1,s=this._endoWnafT2,o=0;o<e.length;o++){var a=this._endoSplit(r[o]),h=e[o],u=h._getBeta();a.k1.negative&&(a.k1.ineg(),h=h.neg(!0)),a.k2.negative&&(a.k2.ineg(),u=u.neg(!0)),n[o*2]=h,n[o*2+1]=u,s[o*2]=a.k1,s[o*2+1]=a.k2}for(var p=this._wnafMulAdd(1,n,s,o*2,i),b=0;b<o*2;b++)n[b]=null,s[b]=null;return p};function Ft(t,e,r,i){Rn.BasePoint.call(this,t,"affine"),e===null&&r===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new we(e,16),this.y=new we(r,16),i&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}gf(Ft,Rn.BasePoint),qr.prototype.point=function(e,r,i){return new Ft(this,e,r,i)},qr.prototype.pointFromJSON=function(e,r){return Ft.fromJSON(this,e,r)},Ft.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var r=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var i=this.curve,n=function(s){return i.point(s.x.redMul(i.endo.beta),s.y)};e.beta=r,r.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(n)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(n)}}}return r}},Ft.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},Ft.fromJSON=function(e,r,i){typeof r=="string"&&(r=JSON.parse(r));var n=e.point(r[0],r[1],i);if(!r[2])return n;function s(a){return e.point(a[0],a[1],i)}var o=r[2];return n.precomputed={beta:null,doubles:o.doubles&&{step:o.doubles.step,points:[n].concat(o.doubles.points.map(s))},naf:o.naf&&{wnd:o.naf.wnd,points:[n].concat(o.naf.points.map(s))}},n},Ft.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},Ft.prototype.isInfinity=function(){return this.inf},Ft.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var r=this.y.redSub(e.y);r.cmpn(0)!==0&&(r=r.redMul(this.x.redSub(e.x).redInvm()));var i=r.redSqr().redISub(this.x).redISub(e.x),n=r.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,n)},Ft.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var r=this.curve.a,i=this.x.redSqr(),n=e.redInvm(),s=i.redAdd(i).redIAdd(i).redIAdd(r).redMul(n),o=s.redSqr().redISub(this.x.redAdd(this.x)),a=s.redMul(this.x.redSub(o)).redISub(this.y);return this.curve.point(o,a)},Ft.prototype.getX=function(){return this.x.fromRed()},Ft.prototype.getY=function(){return this.y.fromRed()},Ft.prototype.mul=function(e){return e=new we(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)},Ft.prototype.mulAdd=function(e,r,i){var n=[this,r],s=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,s):this.curve._wnafMulAdd(1,n,s,2)},Ft.prototype.jmulAdd=function(e,r,i){var n=[this,r],s=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,s,!0):this.curve._wnafMulAdd(1,n,s,2,!0)},Ft.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)},Ft.prototype.neg=function(e){if(this.inf)return this;var r=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var i=this.precomputed,n=function(s){return s.neg()};r.precomputed={naf:i.naf&&{wnd:i.naf.wnd,points:i.naf.points.map(n)},doubles:i.doubles&&{step:i.doubles.step,points:i.doubles.points.map(n)}}}return r},Ft.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e};function Vt(t,e,r,i){Rn.BasePoint.call(this,t,"jacobian"),e===null&&r===null&&i===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new we(0)):(this.x=new we(e,16),this.y=new we(r,16),this.z=new we(i,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}gf(Vt,Rn.BasePoint),qr.prototype.jpoint=function(e,r,i){return new Vt(this,e,r,i)},Vt.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),r=e.redSqr(),i=this.x.redMul(r),n=this.y.redMul(r).redMul(e);return this.curve.point(i,n)},Vt.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},Vt.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var r=e.z.redSqr(),i=this.z.redSqr(),n=this.x.redMul(r),s=e.x.redMul(i),o=this.y.redMul(r.redMul(e.z)),a=e.y.redMul(i.redMul(this.z)),h=n.redSub(s),u=o.redSub(a);if(h.cmpn(0)===0)return u.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var p=h.redSqr(),b=p.redMul(h),S=n.redMul(p),A=u.redSqr().redIAdd(b).redISub(S).redISub(S),I=u.redMul(S.redISub(A)).redISub(o.redMul(b)),P=this.z.redMul(e.z).redMul(h);return this.curve.jpoint(A,I,P)},Vt.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var r=this.z.redSqr(),i=this.x,n=e.x.redMul(r),s=this.y,o=e.y.redMul(r).redMul(this.z),a=i.redSub(n),h=s.redSub(o);if(a.cmpn(0)===0)return h.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var u=a.redSqr(),p=u.redMul(a),b=i.redMul(u),S=h.redSqr().redIAdd(p).redISub(b).redISub(b),A=h.redMul(b.redISub(S)).redISub(s.redMul(p)),I=this.z.redMul(a);return this.curve.jpoint(S,A,I)},Vt.prototype.dblp=function(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var r;if(this.curve.zeroA||this.curve.threeA){var i=this;for(r=0;r<e;r++)i=i.dbl();return i}var n=this.curve.a,s=this.curve.tinv,o=this.x,a=this.y,h=this.z,u=h.redSqr().redSqr(),p=a.redAdd(a);for(r=0;r<e;r++){var b=o.redSqr(),S=p.redSqr(),A=S.redSqr(),I=b.redAdd(b).redIAdd(b).redIAdd(n.redMul(u)),P=o.redMul(S),R=I.redSqr().redISub(P.redAdd(P)),O=P.redISub(R),N=I.redMul(O);N=N.redIAdd(N).redISub(A);var F=p.redMul(h);r+1<e&&(u=u.redMul(A)),o=R,h=F,p=N}return this.curve.jpoint(o,p.redMul(s),h)},Vt.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},Vt.prototype._zeroDbl=function(){var e,r,i;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(n).redISub(o);a=a.redIAdd(a);var h=n.redAdd(n).redIAdd(n),u=h.redSqr().redISub(a).redISub(a),p=o.redIAdd(o);p=p.redIAdd(p),p=p.redIAdd(p),e=u,r=h.redMul(a.redISub(u)).redISub(p),i=this.y.redAdd(this.y)}else{var b=this.x.redSqr(),S=this.y.redSqr(),A=S.redSqr(),I=this.x.redAdd(S).redSqr().redISub(b).redISub(A);I=I.redIAdd(I);var P=b.redAdd(b).redIAdd(b),R=P.redSqr(),O=A.redIAdd(A);O=O.redIAdd(O),O=O.redIAdd(O),e=R.redISub(I).redISub(I),r=P.redMul(I.redISub(e)).redISub(O),i=this.y.redMul(this.z),i=i.redIAdd(i)}return this.curve.jpoint(e,r,i)},Vt.prototype._threeDbl=function(){var e,r,i;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(n).redISub(o);a=a.redIAdd(a);var h=n.redAdd(n).redIAdd(n).redIAdd(this.curve.a),u=h.redSqr().redISub(a).redISub(a);e=u;var p=o.redIAdd(o);p=p.redIAdd(p),p=p.redIAdd(p),r=h.redMul(a.redISub(u)).redISub(p),i=this.y.redAdd(this.y)}else{var b=this.z.redSqr(),S=this.y.redSqr(),A=this.x.redMul(S),I=this.x.redSub(b).redMul(this.x.redAdd(b));I=I.redAdd(I).redIAdd(I);var P=A.redIAdd(A);P=P.redIAdd(P);var R=P.redAdd(P);e=I.redSqr().redISub(R),i=this.y.redAdd(this.z).redSqr().redISub(S).redISub(b);var O=S.redSqr();O=O.redIAdd(O),O=O.redIAdd(O),O=O.redIAdd(O),r=I.redMul(P.redISub(e)).redISub(O)}return this.curve.jpoint(e,r,i)},Vt.prototype._dbl=function(){var e=this.curve.a,r=this.x,i=this.y,n=this.z,s=n.redSqr().redSqr(),o=r.redSqr(),a=i.redSqr(),h=o.redAdd(o).redIAdd(o).redIAdd(e.redMul(s)),u=r.redAdd(r);u=u.redIAdd(u);var p=u.redMul(a),b=h.redSqr().redISub(p.redAdd(p)),S=p.redISub(b),A=a.redSqr();A=A.redIAdd(A),A=A.redIAdd(A),A=A.redIAdd(A);var I=h.redMul(S).redISub(A),P=i.redAdd(i).redMul(n);return this.curve.jpoint(b,I,P)},Vt.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),r=this.y.redSqr(),i=this.z.redSqr(),n=r.redSqr(),s=e.redAdd(e).redIAdd(e),o=s.redSqr(),a=this.x.redAdd(r).redSqr().redISub(e).redISub(n);a=a.redIAdd(a),a=a.redAdd(a).redIAdd(a),a=a.redISub(o);var h=a.redSqr(),u=n.redIAdd(n);u=u.redIAdd(u),u=u.redIAdd(u),u=u.redIAdd(u);var p=s.redIAdd(a).redSqr().redISub(o).redISub(h).redISub(u),b=r.redMul(p);b=b.redIAdd(b),b=b.redIAdd(b);var S=this.x.redMul(h).redISub(b);S=S.redIAdd(S),S=S.redIAdd(S);var A=this.y.redMul(p.redMul(u.redISub(p)).redISub(a.redMul(h)));A=A.redIAdd(A),A=A.redIAdd(A),A=A.redIAdd(A);var I=this.z.redAdd(a).redSqr().redISub(i).redISub(h);return this.curve.jpoint(S,A,I)},Vt.prototype.mul=function(e,r){return e=new we(e,r),this.curve._wnafMul(this,e)},Vt.prototype.eq=function(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return!0;var r=this.z.redSqr(),i=e.z.redSqr();if(this.x.redMul(i).redISub(e.x.redMul(r)).cmpn(0)!==0)return!1;var n=r.redMul(this.z),s=i.redMul(e.z);return this.y.redMul(s).redISub(e.y.redMul(n)).cmpn(0)===0},Vt.prototype.eqXToP=function(e){var r=this.z.redSqr(),i=e.toRed(this.curve.red).redMul(r);if(this.x.cmp(i)===0)return!0;for(var n=e.clone(),s=this.curve.redN.redMul(r);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(i.redIAdd(s),this.x.cmp(i)===0)return!0}},Vt.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},Vt.prototype.isInfinity=function(){return this.z.cmpn(0)===0};var ma=ps(function(t,e){var r=e;r.base=Rn,r.short=e6,r.mont=null,r.edwards=null}),ya=ps(function(t,e){var r=e,i=Pr.assert;function n(a){a.type==="short"?this.curve=new ma.short(a):a.type==="edwards"?this.curve=new ma.edwards(a):this.curve=new ma.mont(a),this.g=this.curve.g,this.n=this.curve.n,this.hash=a.hash,i(this.g.validate(),"Invalid curve"),i(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}r.PresetCurve=n;function s(a,h){Object.defineProperty(r,a,{configurable:!0,enumerable:!0,get:function(){var u=new n(h);return Object.defineProperty(r,a,{configurable:!0,enumerable:!0,value:u}),u}})}s("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:Mr.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),s("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:Mr.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),s("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:Mr.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),s("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:Mr.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),s("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:Mr.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),s("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:Mr.sha256,gRed:!1,g:["9"]}),s("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:Mr.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var o;try{o=null.crash()}catch{o=void 0}s("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:Mr.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",o]})});function cn(t){if(!(this instanceof cn))return new cn(t);this.hash=t.hash,this.predResist=!!t.predResist,this.outLen=this.hash.outSize,this.minEntropy=t.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=ri.toArray(t.entropy,t.entropyEnc||"hex"),r=ri.toArray(t.nonce,t.nonceEnc||"hex"),i=ri.toArray(t.pers,t.persEnc||"hex");vf(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,r,i)}var _l=cn;cn.prototype._init=function(e,r,i){var n=e.concat(r).concat(i);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var s=0;s<this.V.length;s++)this.K[s]=0,this.V[s]=1;this._update(n),this._reseed=1,this.reseedInterval=281474976710656},cn.prototype._hmac=function(){return new Mr.hmac(this.hash,this.K)},cn.prototype._update=function(e){var r=this._hmac().update(this.V).update([0]);e&&(r=r.update(e)),this.K=r.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())},cn.prototype.reseed=function(e,r,i,n){typeof r!="string"&&(n=i,i=r,r=null),e=ri.toArray(e,r),i=ri.toArray(i,n),vf(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(i||[])),this._reseed=1},cn.prototype.generate=function(e,r,i,n){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof r!="string"&&(n=i,i=r,r=null),i&&(i=ri.toArray(i,n||"hex"),this._update(i));for(var s=[];s.length<e;)this.V=this._hmac().update(this.V).digest(),s=s.concat(this.V);var o=s.slice(0,e);return this._update(i),this._reseed++,ri.encode(o,r)};var bf=Pr.assert;function tr(t,e){this.ec=t,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}var mf=tr;tr.fromPublic=function(e,r,i){return r instanceof tr?r:new tr(e,{pub:r,pubEnc:i})},tr.fromPrivate=function(e,r,i){return r instanceof tr?r:new tr(e,{priv:r,privEnc:i})},tr.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},tr.prototype.getPublic=function(e,r){return typeof e=="string"&&(r=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),r?this.pub.encode(r,e):this.pub},tr.prototype.getPrivate=function(e){return e==="hex"?this.priv.toString(16,2):this.priv},tr.prototype._importPrivate=function(e,r){this.priv=new we(e,r||16),this.priv=this.priv.umod(this.ec.curve.n)},tr.prototype._importPublic=function(e,r){if(e.x||e.y){this.ec.curve.type==="mont"?bf(e.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&bf(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,r)},tr.prototype.derive=function(e){return e.validate()||bf(e.validate(),"public point not validated"),e.mul(this.priv).getX()},tr.prototype.sign=function(e,r,i){return this.ec.sign(e,this,r,i)},tr.prototype.verify=function(e,r){return this.ec.verify(e,r,this)},tr.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var t6=Pr.assert;function wa(t,e){if(t instanceof wa)return t;this._importDER(t,e)||(t6(t.r&&t.s,"Signature without r or s"),this.r=new we(t.r,16),this.s=new we(t.s,16),t.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=t.recoveryParam)}var _a=wa;function r6(){this.place=0}function yf(t,e){var r=t[e.place++];if(!(r&128))return r;var i=r&15;if(i===0||i>4)return!1;for(var n=0,s=0,o=e.place;s<i;s++,o++)n<<=8,n|=t[o],n>>>=0;return n<=127?!1:(e.place=o,n)}function xl(t){for(var e=0,r=t.length-1;!t[e]&&!(t[e+1]&128)&&e<r;)e++;return e===0?t:t.slice(e)}wa.prototype._importDER=function(e,r){e=Pr.toArray(e,r);var i=new r6;if(e[i.place++]!==48)return!1;var n=yf(e,i);if(n===!1||n+i.place!==e.length||e[i.place++]!==2)return!1;var s=yf(e,i);if(s===!1)return!1;var o=e.slice(i.place,s+i.place);if(i.place+=s,e[i.place++]!==2)return!1;var a=yf(e,i);if(a===!1||e.length!==a+i.place)return!1;var h=e.slice(i.place,a+i.place);if(o[0]===0)if(o[1]&128)o=o.slice(1);else return!1;if(h[0]===0)if(h[1]&128)h=h.slice(1);else return!1;return this.r=new we(o),this.s=new we(h),this.recoveryParam=null,!0};function wf(t,e){if(e<128){t.push(e);return}var r=1+(Math.log(e)/Math.LN2>>>3);for(t.push(r|128);--r;)t.push(e>>>(r<<3)&255);t.push(e)}wa.prototype.toDER=function(e){var r=this.r.toArray(),i=this.s.toArray();for(r[0]&128&&(r=[0].concat(r)),i[0]&128&&(i=[0].concat(i)),r=xl(r),i=xl(i);!i[0]&&!(i[1]&128);)i=i.slice(1);var n=[2];wf(n,r.length),n=n.concat(r),n.push(2),wf(n,i.length);var s=n.concat(i),o=[48];return wf(o,s.length),o=o.concat(s),Pr.encode(o,e)};var i6=function(){throw new Error("unsupported")},El=Pr.assert;function Lr(t){if(!(this instanceof Lr))return new Lr(t);typeof t=="string"&&(El(Object.prototype.hasOwnProperty.call(ya,t),"Unknown curve "+t),t=ya[t]),t instanceof ya.PresetCurve&&(t={curve:t}),this.curve=t.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=t.curve.g,this.g.precompute(t.curve.n.bitLength()+1),this.hash=t.hash||t.curve.hash}var n6=Lr;Lr.prototype.keyPair=function(e){return new mf(this,e)},Lr.prototype.keyFromPrivate=function(e,r){return mf.fromPrivate(this,e,r)},Lr.prototype.keyFromPublic=function(e,r){return mf.fromPublic(this,e,r)},Lr.prototype.genKeyPair=function(e){e||(e={});for(var r=new _l({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||i6(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),i=this.n.byteLength(),n=this.n.sub(new we(2));;){var s=new we(r.generate(i));if(!(s.cmp(n)>0))return s.iaddn(1),this.keyFromPrivate(s)}},Lr.prototype._truncateToN=function(e,r){var i=e.byteLength()*8-this.n.bitLength();return i>0&&(e=e.ushrn(i)),!r&&e.cmp(this.n)>=0?e.sub(this.n):e},Lr.prototype.sign=function(e,r,i,n){typeof i=="object"&&(n=i,i=null),n||(n={}),r=this.keyFromPrivate(r,i),e=this._truncateToN(new we(e,16));for(var s=this.n.byteLength(),o=r.getPrivate().toArray("be",s),a=e.toArray("be",s),h=new _l({hash:this.hash,entropy:o,nonce:a,pers:n.pers,persEnc:n.persEnc||"utf8"}),u=this.n.sub(new we(1)),p=0;;p++){var b=n.k?n.k(p):new we(h.generate(this.n.byteLength()));if(b=this._truncateToN(b,!0),!(b.cmpn(1)<=0||b.cmp(u)>=0)){var S=this.g.mul(b);if(!S.isInfinity()){var A=S.getX(),I=A.umod(this.n);if(I.cmpn(0)!==0){var P=b.invm(this.n).mul(I.mul(r.getPrivate()).iadd(e));if(P=P.umod(this.n),P.cmpn(0)!==0){var R=(S.getY().isOdd()?1:0)|(A.cmp(I)!==0?2:0);return n.canonical&&P.cmp(this.nh)>0&&(P=this.n.sub(P),R^=1),new _a({r:I,s:P,recoveryParam:R})}}}}}},Lr.prototype.verify=function(e,r,i,n){e=this._truncateToN(new we(e,16)),i=this.keyFromPublic(i,n),r=new _a(r,"hex");var s=r.r,o=r.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0||o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;var a=o.invm(this.n),h=a.mul(e).umod(this.n),u=a.mul(s).umod(this.n),p;return this.curve._maxwellTrick?(p=this.g.jmulAdd(h,i.getPublic(),u),p.isInfinity()?!1:p.eqXToP(s)):(p=this.g.mulAdd(h,i.getPublic(),u),p.isInfinity()?!1:p.getX().umod(this.n).cmp(s)===0)},Lr.prototype.recoverPubKey=function(t,e,r,i){El((3&r)===r,"The recovery param is more than two bits"),e=new _a(e,i);var n=this.n,s=new we(t),o=e.r,a=e.s,h=r&1,u=r>>1;if(o.cmp(this.curve.p.umod(this.curve.n))>=0&&u)throw new Error("Unable to find sencond key candinate");u?o=this.curve.pointFromX(o.add(this.curve.n),h):o=this.curve.pointFromX(o,h);var p=e.r.invm(n),b=n.sub(s).mul(p).umod(n),S=a.mul(p).umod(n);return this.g.mulAdd(b,o,S)},Lr.prototype.getKeyRecoveryParam=function(t,e,r,i){if(e=new _a(e,i),e.recoveryParam!==null)return e.recoveryParam;for(var n=0;n<4;n++){var s;try{s=this.recoverPubKey(t,e,n)}catch{continue}if(s.eq(r))return n}throw new Error("Unable to find valid recovery factor")};var s6=ps(function(t,e){var r=e;r.version="6.5.4",r.utils=Pr,r.rand=function(){throw new Error("unsupported")},r.curve=ma,r.curves=ya,r.ec=n6,r.eddsa=null}),o6=s6.ec;const a6="signing-key/5.7.0",_f=new Se(a6);let xf=null;function wi(){return xf||(xf=new o6("secp256k1")),xf}class c6{constructor(e){fo(this,"curve","secp256k1"),fo(this,"privateKey",cr(e)),uw(this.privateKey)!==32&&_f.throwArgumentError("invalid private key","privateKey","[[ REDACTED ]]");const r=wi().keyFromPrivate(Rt(this.privateKey));fo(this,"publicKey","0x"+r.getPublic(!1,"hex")),fo(this,"compressedPublicKey","0x"+r.getPublic(!0,"hex")),fo(this,"_isSigningKey",!0)}_addPoint(e){const r=wi().keyFromPublic(Rt(this.publicKey)),i=wi().keyFromPublic(Rt(e));return"0x"+r.pub.add(i.pub).encodeCompressed("hex")}signDigest(e){const r=wi().keyFromPrivate(Rt(this.privateKey)),i=Rt(e);i.length!==32&&_f.throwArgumentError("bad digest length","digest",e);const n=r.sign(i,{canonical:!0});return Ld({recoveryParam:n.recoveryParam,r:sn("0x"+n.r.toString(16),32),s:sn("0x"+n.s.toString(16),32)})}computeSharedSecret(e){const r=wi().keyFromPrivate(Rt(this.privateKey)),i=wi().keyFromPublic(Rt(Sl(e)));return sn("0x"+r.derive(i.getPublic()).toString(16),32)}static isSigningKey(e){return!!(e&&e._isSigningKey)}}function f6(t,e){const r=Ld(e),i={r:Rt(r.r),s:Rt(r.s)};return"0x"+wi().recoverPubKey(Rt(t),i,r.recoveryParam).encode("hex",!1)}function Sl(t,e){const r=Rt(t);if(r.length===32){const i=new c6(r);return e?"0x"+wi().keyFromPrivate(r).getPublic(!0,"hex"):i.publicKey}else{if(r.length===33)return e?cr(r):"0x"+wi().keyFromPublic(r).getPublic(!1,"hex");if(r.length===65)return e?"0x"+wi().keyFromPublic(r).getPublic(!0,"hex"):cr(r)}return _f.throwArgumentError("invalid public or private key","key","[REDACTED]")}const h6="transactions/5.7.0";new Se(h6);var Il;(function(t){t[t.legacy=0]="legacy",t[t.eip2930=1]="eip2930",t[t.eip1559=2]="eip1559"})(Il||(Il={}));function u6(t){const e=Sl(t);return Ew(qd(Jd(qd(e,1)),12))}function d6(t,e){return u6(f6(Rt(t),e))}function Al(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function Ef(t,e){e||(e=t.reduce((n,s)=>n+s.length,0));const r=Al(e);let i=0;for(const n of t)r.set(n,i),i+=n.length;return r}function l6(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=n}var a=t.length,h=t.charAt(0),u=Math.log(a)/Math.log(256),p=Math.log(256)/Math.log(a);function b(I){if(I instanceof Uint8Array||(ArrayBuffer.isView(I)?I=new Uint8Array(I.buffer,I.byteOffset,I.byteLength):Array.isArray(I)&&(I=Uint8Array.from(I))),!(I instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(I.length===0)return"";for(var P=0,R=0,O=0,N=I.length;O!==N&&I[O]===0;)O++,P++;for(var F=(N-O)*p+1>>>0,L=new Uint8Array(F);O!==N;){for(var z=I[O],k=0,G=F-1;(z!==0||k<R)&&G!==-1;G--,k++)z+=256*L[G]>>>0,L[G]=z%a>>>0,z=z/a>>>0;if(z!==0)throw new Error("Non-zero carry");R=k,O++}for(var K=F-R;K!==F&&L[K]===0;)K++;for(var H=h.repeat(P);K<F;++K)H+=t.charAt(L[K]);return H}function S(I){if(typeof I!="string")throw new TypeError("Expected String");if(I.length===0)return new Uint8Array;var P=0;if(I[P]!==" "){for(var R=0,O=0;I[P]===h;)R++,P++;for(var N=(I.length-P)*u+1>>>0,F=new Uint8Array(N);I[P];){var L=r[I.charCodeAt(P)];if(L===255)return;for(var z=0,k=N-1;(L!==0||z<O)&&k!==-1;k--,z++)L+=a*F[k]>>>0,F[k]=L%256>>>0,L=L/256>>>0;if(L!==0)throw new Error("Non-zero carry");O=z,P++}if(I[P]!==" "){for(var G=N-O;G!==N&&F[G]===0;)G++;for(var K=new Uint8Array(R+(N-G)),H=R;G!==N;)K[H++]=F[G++];return K}}}function A(I){var P=S(I);if(P)return P;throw new Error(`Non-${e} character`)}return{encode:b,decodeUnsafe:S,decode:A}}var p6=l6,v6=p6;const Ml=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},g6=t=>new TextEncoder().encode(t),b6=t=>new TextDecoder().decode(t);class m6{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class y6{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Pl(this,e)}}class w6{constructor(e){this.decoders=e}or(e){return Pl(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Pl=(t,e)=>new w6({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class _6{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new m6(e,r,i),this.decoder=new y6(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const xa=({name:t,prefix:e,encode:r,decode:i})=>new _6(t,e,r,i),lo=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=v6(r,e);return xa({prefix:t,name:e,encode:i,decode:s=>Ml(n(s))})},x6=(t,e,r,i)=>{const n={};for(let p=0;p<e.length;++p)n[e[p]]=p;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let a=0,h=0,u=0;for(let p=0;p<s;++p){const b=n[t[p]];if(b===void 0)throw new SyntaxError(`Non-${i} character`);h=h<<r|b,a+=r,a>=8&&(a-=8,o[u++]=255&h>>a)}if(a>=r||255&h<<8-a)throw new SyntaxError("Unexpected end of data");return o},E6=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",o=0,a=0;for(let h=0;h<t.length;++h)for(a=a<<8|t[h],o+=8;o>r;)o-=r,s+=e[n&a>>o];if(o&&(s+=e[n&a<<r-o]),i)for(;s.length*r&7;)s+="=";return s},Gt=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>xa({prefix:e,name:t,encode(n){return E6(n,i,r)},decode(n){return x6(n,i,r,t)}}),S6=xa({prefix:"\0",name:"identity",encode:t=>b6(t),decode:t=>g6(t)});var I6=Object.freeze({__proto__:null,identity:S6});const A6=Gt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var M6=Object.freeze({__proto__:null,base2:A6});const P6=Gt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var D6=Object.freeze({__proto__:null,base8:P6});const $6=lo({prefix:"9",name:"base10",alphabet:"0123456789"});var O6=Object.freeze({__proto__:null,base10:$6});const R6=Gt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),N6=Gt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var C6=Object.freeze({__proto__:null,base16:R6,base16upper:N6});const T6=Gt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),F6=Gt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),B6=Gt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),q6=Gt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),L6=Gt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),U6=Gt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),j6=Gt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),z6=Gt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),k6=Gt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var H6=Object.freeze({__proto__:null,base32:T6,base32upper:F6,base32pad:B6,base32padupper:q6,base32hex:L6,base32hexupper:U6,base32hexpad:j6,base32hexpadupper:z6,base32z:k6});const K6=lo({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),V6=lo({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var G6=Object.freeze({__proto__:null,base36:K6,base36upper:V6});const W6=lo({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),J6=lo({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Y6=Object.freeze({__proto__:null,base58btc:W6,base58flickr:J6});const Z6=Gt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),X6=Gt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Q6=Gt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),e4=Gt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var t4=Object.freeze({__proto__:null,base64:Z6,base64pad:X6,base64url:Q6,base64urlpad:e4});const Dl=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),r4=Dl.reduce((t,e,r)=>(t[r]=e,t),[]),i4=Dl.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function n4(t){return t.reduce((e,r)=>(e+=r4[r],e),"")}function s4(t){const e=[];for(const r of t){const i=i4[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const o4=xa({prefix:"\u{1F680}",name:"base256emoji",encode:n4,decode:s4});var a4=Object.freeze({__proto__:null,base256emoji:o4}),c4=Ol,$l=128,f4=127,h4=~f4,u4=Math.pow(2,31);function Ol(t,e,r){e=e||[],r=r||0;for(var i=r;t>=u4;)e[r++]=t&255|$l,t/=128;for(;t&h4;)e[r++]=t&255|$l,t>>>=7;return e[r]=t|0,Ol.bytes=r-i+1,e}var d4=Sf,l4=128,Rl=127;function Sf(t,i){var r=0,i=i||0,n=0,s=i,o,a=t.length;do{if(s>=a)throw Sf.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=n<28?(o&Rl)<<n:(o&Rl)*Math.pow(2,n),n+=7}while(o>=l4);return Sf.bytes=s-i,r}var p4=Math.pow(2,7),v4=Math.pow(2,14),g4=Math.pow(2,21),b4=Math.pow(2,28),m4=Math.pow(2,35),y4=Math.pow(2,42),w4=Math.pow(2,49),_4=Math.pow(2,56),x4=Math.pow(2,63),E4=function(t){return t<p4?1:t<v4?2:t<g4?3:t<b4?4:t<m4?5:t<y4?6:t<w4?7:t<_4?8:t<x4?9:10},S4={encode:c4,decode:d4,encodingLength:E4},Nl=S4;const Cl=(t,e,r=0)=>(Nl.encode(t,e,r),e),Tl=t=>Nl.encodingLength(t),If=(t,e)=>{const r=e.byteLength,i=Tl(t),n=i+Tl(r),s=new Uint8Array(n+r);return Cl(t,s,0),Cl(r,s,i),s.set(e,n),new I4(t,r,e,s)};class I4{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}const Fl=({name:t,code:e,encode:r})=>new A4(t,e,r);class A4{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?If(this.code,r):r.then(i=>If(this.code,i))}else throw Error("Unknown type, must be binary type")}}const Bl=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),M4=Fl({name:"sha2-256",code:18,encode:Bl("SHA-256")}),P4=Fl({name:"sha2-512",code:19,encode:Bl("SHA-512")});var D4=Object.freeze({__proto__:null,sha256:M4,sha512:P4});const ql=0,$4="identity",Ll=Ml;var O4=Object.freeze({__proto__:null,identity:{code:ql,name:$4,encode:Ll,digest:t=>If(ql,Ll(t))}});new TextEncoder,new TextDecoder;const Ul={...I6,...M6,...D6,...O6,...C6,...H6,...G6,...Y6,...t4,...a4};({...D4,...O4});function jl(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const zl=jl("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Af=jl("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=Al(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),kl={utf8:zl,"utf-8":zl,hex:Ul.base16,latin1:Af,ascii:Af,binary:Af,...Ul};function Ur(t,e="utf8"){const r=kl[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}function hr(t,e="utf8"){const r=kl[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}var Hl={},R4="elliptic",N4="6.6.1",C4="EC cryptography",T4="lib/elliptic.js",F4=["lib"],B4={lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},q4={type:"git",url:"git@github.com:indutny/elliptic"},L4=["EC","Elliptic","curve","Cryptography"],U4="Fedor Indutny <fedor@indutny.com>",j4="MIT",z4={url:"https://github.com/indutny/elliptic/issues"},k4="https://github.com/indutny/elliptic",H4={brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},K4={"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"},V4={name:R4,version:N4,description:C4,main:T4,files:F4,scripts:B4,repository:q4,keywords:L4,author:U4,license:j4,bugs:z4,homepage:k4,devDependencies:H4,dependencies:K4},Dr={},_i={exports:{}};(function(t){(function(e,r){function i(D,g){if(!D)throw new Error(g||"Assertion failed")}function n(D,g){D.super_=g;var v=function(){};v.prototype=g.prototype,D.prototype=new v,D.prototype.constructor=D}function s(D,g,v){if(s.isBN(D))return D;this.negative=0,this.words=null,this.length=0,this.red=null,D!==null&&((g==="le"||g==="be")&&(v=g,g=10),this._init(D||0,g||10,v||"be"))}typeof e=="object"?e.exports=s:r.BN=s,s.BN=s,s.wordSize=26;var o;try{typeof window<"u"&&typeof window.Buffer<"u"?o=window.Buffer:o=sf.Buffer}catch{}s.isBN=function(g){return g instanceof s?!0:g!==null&&typeof g=="object"&&g.constructor.wordSize===s.wordSize&&Array.isArray(g.words)},s.max=function(g,v){return g.cmp(v)>0?g:v},s.min=function(g,v){return g.cmp(v)<0?g:v},s.prototype._init=function(g,v,c){if(typeof g=="number")return this._initNumber(g,v,c);if(typeof g=="object")return this._initArray(g,v,c);v==="hex"&&(v=16),i(v===(v|0)&&v>=2&&v<=36),g=g.toString().replace(/\s+/g,"");var f=0;g[0]==="-"&&(f++,this.negative=1),f<g.length&&(v===16?this._parseHex(g,f,c):(this._parseBase(g,v,f),c==="le"&&this._initArray(this.toArray(),v,c)))},s.prototype._initNumber=function(g,v,c){g<0&&(this.negative=1,g=-g),g<67108864?(this.words=[g&67108863],this.length=1):g<4503599627370496?(this.words=[g&67108863,g/67108864&67108863],this.length=2):(i(g<9007199254740992),this.words=[g&67108863,g/67108864&67108863,1],this.length=3),c==="le"&&this._initArray(this.toArray(),v,c)},s.prototype._initArray=function(g,v,c){if(i(typeof g.length=="number"),g.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(g.length/3),this.words=new Array(this.length);for(var f=0;f<this.length;f++)this.words[f]=0;var l,_,x=0;if(c==="be")for(f=g.length-1,l=0;f>=0;f-=3)_=g[f]|g[f-1]<<8|g[f-2]<<16,this.words[l]|=_<<x&67108863,this.words[l+1]=_>>>26-x&67108863,x+=24,x>=26&&(x-=26,l++);else if(c==="le")for(f=0,l=0;f<g.length;f+=3)_=g[f]|g[f+1]<<8|g[f+2]<<16,this.words[l]|=_<<x&67108863,this.words[l+1]=_>>>26-x&67108863,x+=24,x>=26&&(x-=26,l++);return this.strip()};function a(D,g){var v=D.charCodeAt(g);return v>=65&&v<=70?v-55:v>=97&&v<=102?v-87:v-48&15}function h(D,g,v){var c=a(D,v);return v-1>=g&&(c|=a(D,v-1)<<4),c}s.prototype._parseHex=function(g,v,c){this.length=Math.ceil((g.length-v)/6),this.words=new Array(this.length);for(var f=0;f<this.length;f++)this.words[f]=0;var l=0,_=0,x;if(c==="be")for(f=g.length-1;f>=v;f-=2)x=h(g,v,f)<<l,this.words[_]|=x&67108863,l>=18?(l-=18,_+=1,this.words[_]|=x>>>26):l+=8;else{var y=g.length-v;for(f=y%2===0?v+1:v;f<g.length;f+=2)x=h(g,v,f)<<l,this.words[_]|=x&67108863,l>=18?(l-=18,_+=1,this.words[_]|=x>>>26):l+=8}this.strip()};function u(D,g,v,c){for(var f=0,l=Math.min(D.length,v),_=g;_<l;_++){var x=D.charCodeAt(_)-48;f*=c,x>=49?f+=x-49+10:x>=17?f+=x-17+10:f+=x}return f}s.prototype._parseBase=function(g,v,c){this.words=[0],this.length=1;for(var f=0,l=1;l<=67108863;l*=v)f++;f--,l=l/v|0;for(var _=g.length-c,x=_%f,y=Math.min(_,_-x)+c,d=0,w=c;w<y;w+=f)d=u(g,w,w+f,v),this.imuln(l),this.words[0]+d<67108864?this.words[0]+=d:this._iaddn(d);if(x!==0){var m=1;for(d=u(g,w,g.length,v),w=0;w<x;w++)m*=v;this.imuln(m),this.words[0]+d<67108864?this.words[0]+=d:this._iaddn(d)}this.strip()},s.prototype.copy=function(g){g.words=new Array(this.length);for(var v=0;v<this.length;v++)g.words[v]=this.words[v];g.length=this.length,g.negative=this.negative,g.red=this.red},s.prototype.clone=function(){var g=new s(null);return this.copy(g),g},s.prototype._expand=function(g){for(;this.length<g;)this.words[this.length++]=0;return this},s.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},s.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},s.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var p=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],b=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],S=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];s.prototype.toString=function(g,v){g=g||10,v=v|0||1;var c;if(g===16||g==="hex"){c="";for(var f=0,l=0,_=0;_<this.length;_++){var x=this.words[_],y=((x<<f|l)&16777215).toString(16);l=x>>>24-f&16777215,f+=2,f>=26&&(f-=26,_--),l!==0||_!==this.length-1?c=p[6-y.length]+y+c:c=y+c}for(l!==0&&(c=l.toString(16)+c);c.length%v!==0;)c="0"+c;return this.negative!==0&&(c="-"+c),c}if(g===(g|0)&&g>=2&&g<=36){var d=b[g],w=S[g];c="";var m=this.clone();for(m.negative=0;!m.isZero();){var M=m.modn(w).toString(g);m=m.idivn(w),m.isZero()?c=M+c:c=p[d-M.length]+M+c}for(this.isZero()&&(c="0"+c);c.length%v!==0;)c="0"+c;return this.negative!==0&&(c="-"+c),c}i(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var g=this.words[0];return this.length===2?g+=this.words[1]*67108864:this.length===3&&this.words[2]===1?g+=4503599627370496+this.words[1]*67108864:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-g:g},s.prototype.toJSON=function(){return this.toString(16)},s.prototype.toBuffer=function(g,v){return i(typeof o<"u"),this.toArrayLike(o,g,v)},s.prototype.toArray=function(g,v){return this.toArrayLike(Array,g,v)},s.prototype.toArrayLike=function(g,v,c){var f=this.byteLength(),l=c||Math.max(1,f);i(f<=l,"byte array longer than desired length"),i(l>0,"Requested array length <= 0"),this.strip();var _=v==="le",x=new g(l),y,d,w=this.clone();if(_){for(d=0;!w.isZero();d++)y=w.andln(255),w.iushrn(8),x[d]=y;for(;d<l;d++)x[d]=0}else{for(d=0;d<l-f;d++)x[d]=0;for(d=0;!w.isZero();d++)y=w.andln(255),w.iushrn(8),x[l-d-1]=y}return x},Math.clz32?s.prototype._countBits=function(g){return 32-Math.clz32(g)}:s.prototype._countBits=function(g){var v=g,c=0;return v>=4096&&(c+=13,v>>>=13),v>=64&&(c+=7,v>>>=7),v>=8&&(c+=4,v>>>=4),v>=2&&(c+=2,v>>>=2),c+v},s.prototype._zeroBits=function(g){if(g===0)return 26;var v=g,c=0;return(v&8191)===0&&(c+=13,v>>>=13),(v&127)===0&&(c+=7,v>>>=7),(v&15)===0&&(c+=4,v>>>=4),(v&3)===0&&(c+=2,v>>>=2),(v&1)===0&&c++,c},s.prototype.bitLength=function(){var g=this.words[this.length-1],v=this._countBits(g);return(this.length-1)*26+v};function A(D){for(var g=new Array(D.bitLength()),v=0;v<g.length;v++){var c=v/26|0,f=v%26;g[v]=(D.words[c]&1<<f)>>>f}return g}s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var g=0,v=0;v<this.length;v++){var c=this._zeroBits(this.words[v]);if(g+=c,c!==26)break}return g},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(g){return this.negative!==0?this.abs().inotn(g).iaddn(1):this.clone()},s.prototype.fromTwos=function(g){return this.testn(g-1)?this.notn(g).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return this.negative!==0},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(g){for(;this.length<g.length;)this.words[this.length++]=0;for(var v=0;v<g.length;v++)this.words[v]=this.words[v]|g.words[v];return this.strip()},s.prototype.ior=function(g){return i((this.negative|g.negative)===0),this.iuor(g)},s.prototype.or=function(g){return this.length>g.length?this.clone().ior(g):g.clone().ior(this)},s.prototype.uor=function(g){return this.length>g.length?this.clone().iuor(g):g.clone().iuor(this)},s.prototype.iuand=function(g){var v;this.length>g.length?v=g:v=this;for(var c=0;c<v.length;c++)this.words[c]=this.words[c]&g.words[c];return this.length=v.length,this.strip()},s.prototype.iand=function(g){return i((this.negative|g.negative)===0),this.iuand(g)},s.prototype.and=function(g){return this.length>g.length?this.clone().iand(g):g.clone().iand(this)},s.prototype.uand=function(g){return this.length>g.length?this.clone().iuand(g):g.clone().iuand(this)},s.prototype.iuxor=function(g){var v,c;this.length>g.length?(v=this,c=g):(v=g,c=this);for(var f=0;f<c.length;f++)this.words[f]=v.words[f]^c.words[f];if(this!==v)for(;f<v.length;f++)this.words[f]=v.words[f];return this.length=v.length,this.strip()},s.prototype.ixor=function(g){return i((this.negative|g.negative)===0),this.iuxor(g)},s.prototype.xor=function(g){return this.length>g.length?this.clone().ixor(g):g.clone().ixor(this)},s.prototype.uxor=function(g){return this.length>g.length?this.clone().iuxor(g):g.clone().iuxor(this)},s.prototype.inotn=function(g){i(typeof g=="number"&&g>=0);var v=Math.ceil(g/26)|0,c=g%26;this._expand(v),c>0&&v--;for(var f=0;f<v;f++)this.words[f]=~this.words[f]&67108863;return c>0&&(this.words[f]=~this.words[f]&67108863>>26-c),this.strip()},s.prototype.notn=function(g){return this.clone().inotn(g)},s.prototype.setn=function(g,v){i(typeof g=="number"&&g>=0);var c=g/26|0,f=g%26;return this._expand(c+1),v?this.words[c]=this.words[c]|1<<f:this.words[c]=this.words[c]&~(1<<f),this.strip()},s.prototype.iadd=function(g){var v;if(this.negative!==0&&g.negative===0)return this.negative=0,v=this.isub(g),this.negative^=1,this._normSign();if(this.negative===0&&g.negative!==0)return g.negative=0,v=this.isub(g),g.negative=1,v._normSign();var c,f;this.length>g.length?(c=this,f=g):(c=g,f=this);for(var l=0,_=0;_<f.length;_++)v=(c.words[_]|0)+(f.words[_]|0)+l,this.words[_]=v&67108863,l=v>>>26;for(;l!==0&&_<c.length;_++)v=(c.words[_]|0)+l,this.words[_]=v&67108863,l=v>>>26;if(this.length=c.length,l!==0)this.words[this.length]=l,this.length++;else if(c!==this)for(;_<c.length;_++)this.words[_]=c.words[_];return this},s.prototype.add=function(g){var v;return g.negative!==0&&this.negative===0?(g.negative=0,v=this.sub(g),g.negative^=1,v):g.negative===0&&this.negative!==0?(this.negative=0,v=g.sub(this),this.negative=1,v):this.length>g.length?this.clone().iadd(g):g.clone().iadd(this)},s.prototype.isub=function(g){if(g.negative!==0){g.negative=0;var v=this.iadd(g);return g.negative=1,v._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(g),this.negative=1,this._normSign();var c=this.cmp(g);if(c===0)return this.negative=0,this.length=1,this.words[0]=0,this;var f,l;c>0?(f=this,l=g):(f=g,l=this);for(var _=0,x=0;x<l.length;x++)v=(f.words[x]|0)-(l.words[x]|0)+_,_=v>>26,this.words[x]=v&67108863;for(;_!==0&&x<f.length;x++)v=(f.words[x]|0)+_,_=v>>26,this.words[x]=v&67108863;if(_===0&&x<f.length&&f!==this)for(;x<f.length;x++)this.words[x]=f.words[x];return this.length=Math.max(this.length,x),f!==this&&(this.negative=1),this.strip()},s.prototype.sub=function(g){return this.clone().isub(g)};function I(D,g,v){v.negative=g.negative^D.negative;var c=D.length+g.length|0;v.length=c,c=c-1|0;var f=D.words[0]|0,l=g.words[0]|0,_=f*l,x=_&67108863,y=_/67108864|0;v.words[0]=x;for(var d=1;d<c;d++){for(var w=y>>>26,m=y&67108863,M=Math.min(d,g.length-1),B=Math.max(0,d-D.length+1);B<=M;B++){var E=d-B|0;f=D.words[E]|0,l=g.words[B]|0,_=f*l+m,w+=_/67108864|0,m=_&67108863}v.words[d]=m|0,y=w|0}return y!==0?v.words[d]=y|0:v.length--,v.strip()}var P=function(g,v,c){var f=g.words,l=v.words,_=c.words,x=0,y,d,w,m=f[0]|0,M=m&8191,B=m>>>13,E=f[1]|0,C=E&8191,q=E>>>13,U=f[2]|0,j=U&8191,Y=U>>>13,X=f[3]|0,W=X&8191,se=X>>>13,ee=f[4]|0,te=ee&8191,ke=ee>>>13,He=f[5]|0,ue=He&8191,Ne=He>>>13,Ce=f[6]|0,ce=Ce&8191,Te=Ce>>>13,Fe=f[7]|0,he=Fe&8191,Be=Fe>>>13,qe=f[8]|0,ae=qe&8191,Oe=qe>>>13,Le=f[9]|0,ne=Le&8191,Ye=Le>>>13,Ze=l[0]|0,ve=Ze&8191,Xe=Ze>>>13,Ue=l[1]|0,le=Ue&8191,Qe=Ue>>>13,rt=l[2]|0,oe=rt&8191,et=rt>>>13,it=l[3]|0,ge=it&8191,Ke=it>>>13,Re=l[4]|0,de=Re&8191,Ve=Re>>>13,Ge=l[5]|0,fe=Ge&8191,nt=Ge>>>13,st=l[6]|0,be=st&8191,ot=st>>>13,at=l[7]|0,pe=at&8191,We=at>>>13,Pe=l[8]|0,me=Pe&8191,ct=Pe>>>13,ft=l[9]|0,ye=ft&8191,ht=ft>>>13;c.negative=g.negative^v.negative,c.length=19,y=Math.imul(M,ve),d=Math.imul(M,Xe),d=d+Math.imul(B,ve)|0,w=Math.imul(B,Xe);var Ee=(x+y|0)+((d&8191)<<13)|0;x=(w+(d>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,y=Math.imul(C,ve),d=Math.imul(C,Xe),d=d+Math.imul(q,ve)|0,w=Math.imul(q,Xe),y=y+Math.imul(M,le)|0,d=d+Math.imul(M,Qe)|0,d=d+Math.imul(B,le)|0,w=w+Math.imul(B,Qe)|0;var tt=(x+y|0)+((d&8191)<<13)|0;x=(w+(d>>>13)|0)+(tt>>>26)|0,tt&=67108863,y=Math.imul(j,ve),d=Math.imul(j,Xe),d=d+Math.imul(Y,ve)|0,w=Math.imul(Y,Xe),y=y+Math.imul(C,le)|0,d=d+Math.imul(C,Qe)|0,d=d+Math.imul(q,le)|0,w=w+Math.imul(q,Qe)|0,y=y+Math.imul(M,oe)|0,d=d+Math.imul(M,et)|0,d=d+Math.imul(B,oe)|0,w=w+Math.imul(B,et)|0;var xr=(x+y|0)+((d&8191)<<13)|0;x=(w+(d>>>13)|0)+(xr>>>26)|0,xr&=67108863,y=Math.imul(W,ve),d=Math.imul(W,Xe),d=d+Math.imul(se,ve)|0,w=Math.imul(se,Xe),y=y+Math.imul(j,le)|0,d=d+Math.imul(j,Qe)|0,d=d+Math.imul(Y,le)|0,w=w+Math.imul(Y,Qe)|0,y=y+Math.imul(C,oe)|0,d=d+Math.imul(C,et)|0,d=d+Math.imul(q,oe)|0,w=w+Math.imul(q,et)|0,y=y+Math.imul(M,ge)|0,d=d+Math.imul(M,Ke)|0,d=d+Math.imul(B,ge)|0,w=w+Math.imul(B,Ke)|0;var Er=(x+y|0)+((d&8191)<<13)|0;x=(w+(d>>>13)|0)+(Er>>>26)|0,Er&=67108863,y=Math.imul(te,ve),d=Math.imul(te,Xe),d=d+Math.imul(ke,ve)|0,w=Math.imul(ke,Xe),y=y+Math.imul(W,le)|0,d=d+Math.imul(W,Qe)|0,d=d+Math.imul(se,le)|0,w=w+Math.imul(se,Qe)|0,y=y+Math.imul(j,oe)|0,d=d+Math.imul(j,et)|0,d=d+Math.imul(Y,oe)|0,w=w+Math.imul(Y,et)|0,y=y+Math.imul(C,ge)|0,d=d+Math.imul(C,Ke)|0,d=d+Math.imul(q,ge)|0,w=w+Math.imul(q,Ke)|0,y=y+Math.imul(M,de)|0,d=d+Math.imul(M,Ve)|0,d=d+Math.imul(B,de)|0,w=w+Math.imul(B,Ve)|0;var Sr=(x+y|0)+((d&8191)<<13)|0;x=(w+(d>>>13)|0)+(Sr>>>26)|0,Sr&=67108863,y=Math.imul(ue,ve),d=Math.imul(ue,Xe),d=d+Math.imul(Ne,ve)|0,w=Math.imul(Ne,Xe),y=y+Math.imul(te,le)|0,d=d+Math.imul(te,Qe)|0,d=d+Math.imul(ke,le)|0,w=w+Math.imul(ke,Qe)|0,y=y+Math.imul(W,oe)|0,d=d+Math.imul(W,et)|0,d=d+Math.imul(se,oe)|0,w=w+Math.imul(se,et)|0,y=y+Math.imul(j,ge)|0,d=d+Math.imul(j,Ke)|0,d=d+Math.imul(Y,ge)|0,w=w+Math.imul(Y,Ke)|0,y=y+Math.imul(C,de)|0,d=d+Math.imul(C,Ve)|0,d=d+Math.imul(q,de)|0,w=w+Math.imul(q,Ve)|0,y=y+Math.imul(M,fe)|0,d=d+Math.imul(M,nt)|0,d=d+Math.imul(B,fe)|0,w=w+Math.imul(B,nt)|0;var Ir=(x+y|0)+((d&8191)<<13)|0;x=(w+(d>>>13)|0)+(Ir>>>26)|0,Ir&=67108863,y=Math.imul(ce,ve),d=Math.imul(ce,Xe),d=d+Math.imul(Te,ve)|0,w=Math.imul(Te,Xe),y=y+Math.imul(ue,le)|0,d=d+Math.imul(ue,Qe)|0,d=d+Math.imul(Ne,le)|0,w=w+Math.imul(Ne,Qe)|0,y=y+Math.imul(te,oe)|0,d=d+Math.imul(te,et)|0,d=d+Math.imul(ke,oe)|0,w=w+Math.imul(ke,et)|0,y=y+Math.imul(W,ge)|0,d=d+Math.imul(W,Ke)|0,d=d+Math.imul(se,ge)|0,w=w+Math.imul(se,Ke)|0,y=y+Math.imul(j,de)|0,d=d+Math.imul(j,Ve)|0,d=d+Math.imul(Y,de)|0,w=w+Math.imul(Y,Ve)|0,y=y+Math.imul(C,fe)|0,d=d+Math.imul(C,nt)|0,d=d+Math.imul(q,fe)|0,w=w+Math.imul(q,nt)|0,y=y+Math.imul(M,be)|0,d=d+Math.imul(M,ot)|0,d=d+Math.imul(B,be)|0,w=w+Math.imul(B,ot)|0;var $t=(x+y|0)+((d&8191)<<13)|0;x=(w+(d>>>13)|0)+($t>>>26)|0,$t&=67108863,y=Math.imul(he,ve),d=Math.imul(he,Xe),d=d+Math.imul(Be,ve)|0,w=Math.imul(Be,Xe),y=y+Math.imul(ce,le)|0,d=d+Math.imul(ce,Qe)|0,d=d+Math.imul(Te,le)|0,w=w+Math.imul(Te,Qe)|0,y=y+Math.imul(ue,oe)|0,d=d+Math.imul(ue,et)|0,d=d+Math.imul(Ne,oe)|0,w=w+Math.imul(Ne,et)|0,y=y+Math.imul(te,ge)|0,d=d+Math.imul(te,Ke)|0,d=d+Math.imul(ke,ge)|0,w=w+Math.imul(ke,Ke)|0,y=y+Math.imul(W,de)|0,d=d+Math.imul(W,Ve)|0,d=d+Math.imul(se,de)|0,w=w+Math.imul(se,Ve)|0,y=y+Math.imul(j,fe)|0,d=d+Math.imul(j,nt)|0,d=d+Math.imul(Y,fe)|0,w=w+Math.imul(Y,nt)|0,y=y+Math.imul(C,be)|0,d=d+Math.imul(C,ot)|0,d=d+Math.imul(q,be)|0,w=w+Math.imul(q,ot)|0,y=y+Math.imul(M,pe)|0,d=d+Math.imul(M,We)|0,d=d+Math.imul(B,pe)|0,w=w+Math.imul(B,We)|0;var Ki=(x+y|0)+((d&8191)<<13)|0;x=(w+(d>>>13)|0)+(Ki>>>26)|0,Ki&=67108863,y=Math.imul(ae,ve),d=Math.imul(ae,Xe),d=d+Math.imul(Oe,ve)|0,w=Math.imul(Oe,Xe),y=y+Math.imul(he,le)|0,d=d+Math.imul(he,Qe)|0,d=d+Math.imul(Be,le)|0,w=w+Math.imul(Be,Qe)|0,y=y+Math.imul(ce,oe)|0,d=d+Math.imul(ce,et)|0,d=d+Math.imul(Te,oe)|0,w=w+Math.imul(Te,et)|0,y=y+Math.imul(ue,ge)|0,d=d+Math.imul(ue,Ke)|0,d=d+Math.imul(Ne,ge)|0,w=w+Math.imul(Ne,Ke)|0,y=y+Math.imul(te,de)|0,d=d+Math.imul(te,Ve)|0,d=d+Math.imul(ke,de)|0,w=w+Math.imul(ke,Ve)|0,y=y+Math.imul(W,fe)|0,d=d+Math.imul(W,nt)|0,d=d+Math.imul(se,fe)|0,w=w+Math.imul(se,nt)|0,y=y+Math.imul(j,be)|0,d=d+Math.imul(j,ot)|0,d=d+Math.imul(Y,be)|0,w=w+Math.imul(Y,ot)|0,y=y+Math.imul(C,pe)|0,d=d+Math.imul(C,We)|0,d=d+Math.imul(q,pe)|0,w=w+Math.imul(q,We)|0,y=y+Math.imul(M,me)|0,d=d+Math.imul(M,ct)|0,d=d+Math.imul(B,me)|0,w=w+Math.imul(B,ct)|0;var Vi=(x+y|0)+((d&8191)<<13)|0;x=(w+(d>>>13)|0)+(Vi>>>26)|0,Vi&=67108863,y=Math.imul(ne,ve),d=Math.imul(ne,Xe),d=d+Math.imul(Ye,ve)|0,w=Math.imul(Ye,Xe),y=y+Math.imul(ae,le)|0,d=d+Math.imul(ae,Qe)|0,d=d+Math.imul(Oe,le)|0,w=w+Math.imul(Oe,Qe)|0,y=y+Math.imul(he,oe)|0,d=d+Math.imul(he,et)|0,d=d+Math.imul(Be,oe)|0,w=w+Math.imul(Be,et)|0,y=y+Math.imul(ce,ge)|0,d=d+Math.imul(ce,Ke)|0,d=d+Math.imul(Te,ge)|0,w=w+Math.imul(Te,Ke)|0,y=y+Math.imul(ue,de)|0,d=d+Math.imul(ue,Ve)|0,d=d+Math.imul(Ne,de)|0,w=w+Math.imul(Ne,Ve)|0,y=y+Math.imul(te,fe)|0,d=d+Math.imul(te,nt)|0,d=d+Math.imul(ke,fe)|0,w=w+Math.imul(ke,nt)|0,y=y+Math.imul(W,be)|0,d=d+Math.imul(W,ot)|0,d=d+Math.imul(se,be)|0,w=w+Math.imul(se,ot)|0,y=y+Math.imul(j,pe)|0,d=d+Math.imul(j,We)|0,d=d+Math.imul(Y,pe)|0,w=w+Math.imul(Y,We)|0,y=y+Math.imul(C,me)|0,d=d+Math.imul(C,ct)|0,d=d+Math.imul(q,me)|0,w=w+Math.imul(q,ct)|0,y=y+Math.imul(M,ye)|0,d=d+Math.imul(M,ht)|0,d=d+Math.imul(B,ye)|0,w=w+Math.imul(B,ht)|0;var Gi=(x+y|0)+((d&8191)<<13)|0;x=(w+(d>>>13)|0)+(Gi>>>26)|0,Gi&=67108863,y=Math.imul(ne,le),d=Math.imul(ne,Qe),d=d+Math.imul(Ye,le)|0,w=Math.imul(Ye,Qe),y=y+Math.imul(ae,oe)|0,d=d+Math.imul(ae,et)|0,d=d+Math.imul(Oe,oe)|0,w=w+Math.imul(Oe,et)|0,y=y+Math.imul(he,ge)|0,d=d+Math.imul(he,Ke)|0,d=d+Math.imul(Be,ge)|0,w=w+Math.imul(Be,Ke)|0,y=y+Math.imul(ce,de)|0,d=d+Math.imul(ce,Ve)|0,d=d+Math.imul(Te,de)|0,w=w+Math.imul(Te,Ve)|0,y=y+Math.imul(ue,fe)|0,d=d+Math.imul(ue,nt)|0,d=d+Math.imul(Ne,fe)|0,w=w+Math.imul(Ne,nt)|0,y=y+Math.imul(te,be)|0,d=d+Math.imul(te,ot)|0,d=d+Math.imul(ke,be)|0,w=w+Math.imul(ke,ot)|0,y=y+Math.imul(W,pe)|0,d=d+Math.imul(W,We)|0,d=d+Math.imul(se,pe)|0,w=w+Math.imul(se,We)|0,y=y+Math.imul(j,me)|0,d=d+Math.imul(j,ct)|0,d=d+Math.imul(Y,me)|0,w=w+Math.imul(Y,ct)|0,y=y+Math.imul(C,ye)|0,d=d+Math.imul(C,ht)|0,d=d+Math.imul(q,ye)|0,w=w+Math.imul(q,ht)|0;var Wi=(x+y|0)+((d&8191)<<13)|0;x=(w+(d>>>13)|0)+(Wi>>>26)|0,Wi&=67108863,y=Math.imul(ne,oe),d=Math.imul(ne,et),d=d+Math.imul(Ye,oe)|0,w=Math.imul(Ye,et),y=y+Math.imul(ae,ge)|0,d=d+Math.imul(ae,Ke)|0,d=d+Math.imul(Oe,ge)|0,w=w+Math.imul(Oe,Ke)|0,y=y+Math.imul(he,de)|0,d=d+Math.imul(he,Ve)|0,d=d+Math.imul(Be,de)|0,w=w+Math.imul(Be,Ve)|0,y=y+Math.imul(ce,fe)|0,d=d+Math.imul(ce,nt)|0,d=d+Math.imul(Te,fe)|0,w=w+Math.imul(Te,nt)|0,y=y+Math.imul(ue,be)|0,d=d+Math.imul(ue,ot)|0,d=d+Math.imul(Ne,be)|0,w=w+Math.imul(Ne,ot)|0,y=y+Math.imul(te,pe)|0,d=d+Math.imul(te,We)|0,d=d+Math.imul(ke,pe)|0,w=w+Math.imul(ke,We)|0,y=y+Math.imul(W,me)|0,d=d+Math.imul(W,ct)|0,d=d+Math.imul(se,me)|0,w=w+Math.imul(se,ct)|0,y=y+Math.imul(j,ye)|0,d=d+Math.imul(j,ht)|0,d=d+Math.imul(Y,ye)|0,w=w+Math.imul(Y,ht)|0;var Ji=(x+y|0)+((d&8191)<<13)|0;x=(w+(d>>>13)|0)+(Ji>>>26)|0,Ji&=67108863,y=Math.imul(ne,ge),d=Math.imul(ne,Ke),d=d+Math.imul(Ye,ge)|0,w=Math.imul(Ye,Ke),y=y+Math.imul(ae,de)|0,d=d+Math.imul(ae,Ve)|0,d=d+Math.imul(Oe,de)|0,w=w+Math.imul(Oe,Ve)|0,y=y+Math.imul(he,fe)|0,d=d+Math.imul(he,nt)|0,d=d+Math.imul(Be,fe)|0,w=w+Math.imul(Be,nt)|0,y=y+Math.imul(ce,be)|0,d=d+Math.imul(ce,ot)|0,d=d+Math.imul(Te,be)|0,w=w+Math.imul(Te,ot)|0,y=y+Math.imul(ue,pe)|0,d=d+Math.imul(ue,We)|0,d=d+Math.imul(Ne,pe)|0,w=w+Math.imul(Ne,We)|0,y=y+Math.imul(te,me)|0,d=d+Math.imul(te,ct)|0,d=d+Math.imul(ke,me)|0,w=w+Math.imul(ke,ct)|0,y=y+Math.imul(W,ye)|0,d=d+Math.imul(W,ht)|0,d=d+Math.imul(se,ye)|0,w=w+Math.imul(se,ht)|0;var Jr=(x+y|0)+((d&8191)<<13)|0;x=(w+(d>>>13)|0)+(Jr>>>26)|0,Jr&=67108863,y=Math.imul(ne,de),d=Math.imul(ne,Ve),d=d+Math.imul(Ye,de)|0,w=Math.imul(Ye,Ve),y=y+Math.imul(ae,fe)|0,d=d+Math.imul(ae,nt)|0,d=d+Math.imul(Oe,fe)|0,w=w+Math.imul(Oe,nt)|0,y=y+Math.imul(he,be)|0,d=d+Math.imul(he,ot)|0,d=d+Math.imul(Be,be)|0,w=w+Math.imul(Be,ot)|0,y=y+Math.imul(ce,pe)|0,d=d+Math.imul(ce,We)|0,d=d+Math.imul(Te,pe)|0,w=w+Math.imul(Te,We)|0,y=y+Math.imul(ue,me)|0,d=d+Math.imul(ue,ct)|0,d=d+Math.imul(Ne,me)|0,w=w+Math.imul(Ne,ct)|0,y=y+Math.imul(te,ye)|0,d=d+Math.imul(te,ht)|0,d=d+Math.imul(ke,ye)|0,w=w+Math.imul(ke,ht)|0;var Yi=(x+y|0)+((d&8191)<<13)|0;x=(w+(d>>>13)|0)+(Yi>>>26)|0,Yi&=67108863,y=Math.imul(ne,fe),d=Math.imul(ne,nt),d=d+Math.imul(Ye,fe)|0,w=Math.imul(Ye,nt),y=y+Math.imul(ae,be)|0,d=d+Math.imul(ae,ot)|0,d=d+Math.imul(Oe,be)|0,w=w+Math.imul(Oe,ot)|0,y=y+Math.imul(he,pe)|0,d=d+Math.imul(he,We)|0,d=d+Math.imul(Be,pe)|0,w=w+Math.imul(Be,We)|0,y=y+Math.imul(ce,me)|0,d=d+Math.imul(ce,ct)|0,d=d+Math.imul(Te,me)|0,w=w+Math.imul(Te,ct)|0,y=y+Math.imul(ue,ye)|0,d=d+Math.imul(ue,ht)|0,d=d+Math.imul(Ne,ye)|0,w=w+Math.imul(Ne,ht)|0;var Zi=(x+y|0)+((d&8191)<<13)|0;x=(w+(d>>>13)|0)+(Zi>>>26)|0,Zi&=67108863,y=Math.imul(ne,be),d=Math.imul(ne,ot),d=d+Math.imul(Ye,be)|0,w=Math.imul(Ye,ot),y=y+Math.imul(ae,pe)|0,d=d+Math.imul(ae,We)|0,d=d+Math.imul(Oe,pe)|0,w=w+Math.imul(Oe,We)|0,y=y+Math.imul(he,me)|0,d=d+Math.imul(he,ct)|0,d=d+Math.imul(Be,me)|0,w=w+Math.imul(Be,ct)|0,y=y+Math.imul(ce,ye)|0,d=d+Math.imul(ce,ht)|0,d=d+Math.imul(Te,ye)|0,w=w+Math.imul(Te,ht)|0;var sr=(x+y|0)+((d&8191)<<13)|0;x=(w+(d>>>13)|0)+(sr>>>26)|0,sr&=67108863,y=Math.imul(ne,pe),d=Math.imul(ne,We),d=d+Math.imul(Ye,pe)|0,w=Math.imul(Ye,We),y=y+Math.imul(ae,me)|0,d=d+Math.imul(ae,ct)|0,d=d+Math.imul(Oe,me)|0,w=w+Math.imul(Oe,ct)|0,y=y+Math.imul(he,ye)|0,d=d+Math.imul(he,ht)|0,d=d+Math.imul(Be,ye)|0,w=w+Math.imul(Be,ht)|0;var Xi=(x+y|0)+((d&8191)<<13)|0;x=(w+(d>>>13)|0)+(Xi>>>26)|0,Xi&=67108863,y=Math.imul(ne,me),d=Math.imul(ne,ct),d=d+Math.imul(Ye,me)|0,w=Math.imul(Ye,ct),y=y+Math.imul(ae,ye)|0,d=d+Math.imul(ae,ht)|0,d=d+Math.imul(Oe,ye)|0,w=w+Math.imul(Oe,ht)|0;var Qi=(x+y|0)+((d&8191)<<13)|0;x=(w+(d>>>13)|0)+(Qi>>>26)|0,Qi&=67108863,y=Math.imul(ne,ye),d=Math.imul(ne,ht),d=d+Math.imul(Ye,ye)|0,w=Math.imul(Ye,ht);var en=(x+y|0)+((d&8191)<<13)|0;return x=(w+(d>>>13)|0)+(en>>>26)|0,en&=67108863,_[0]=Ee,_[1]=tt,_[2]=xr,_[3]=Er,_[4]=Sr,_[5]=Ir,_[6]=$t,_[7]=Ki,_[8]=Vi,_[9]=Gi,_[10]=Wi,_[11]=Ji,_[12]=Jr,_[13]=Yi,_[14]=Zi,_[15]=sr,_[16]=Xi,_[17]=Qi,_[18]=en,x!==0&&(_[19]=x,c.length++),c};Math.imul||(P=I);function R(D,g,v){v.negative=g.negative^D.negative,v.length=D.length+g.length;for(var c=0,f=0,l=0;l<v.length-1;l++){var _=f;f=0;for(var x=c&67108863,y=Math.min(l,g.length-1),d=Math.max(0,l-D.length+1);d<=y;d++){var w=l-d,m=D.words[w]|0,M=g.words[d]|0,B=m*M,E=B&67108863;_=_+(B/67108864|0)|0,E=E+x|0,x=E&67108863,_=_+(E>>>26)|0,f+=_>>>26,_&=67108863}v.words[l]=x,c=_,_=f}return c!==0?v.words[l]=c:v.length--,v.strip()}function O(D,g,v){var c=new N;return c.mulp(D,g,v)}s.prototype.mulTo=function(g,v){var c,f=this.length+g.length;return this.length===10&&g.length===10?c=P(this,g,v):f<63?c=I(this,g,v):f<1024?c=R(this,g,v):c=O(this,g,v),c};function N(D,g){this.x=D,this.y=g}N.prototype.makeRBT=function(g){for(var v=new Array(g),c=s.prototype._countBits(g)-1,f=0;f<g;f++)v[f]=this.revBin(f,c,g);return v},N.prototype.revBin=function(g,v,c){if(g===0||g===c-1)return g;for(var f=0,l=0;l<v;l++)f|=(g&1)<<v-l-1,g>>=1;return f},N.prototype.permute=function(g,v,c,f,l,_){for(var x=0;x<_;x++)f[x]=v[g[x]],l[x]=c[g[x]]},N.prototype.transform=function(g,v,c,f,l,_){this.permute(_,g,v,c,f,l);for(var x=1;x<l;x<<=1)for(var y=x<<1,d=Math.cos(2*Math.PI/y),w=Math.sin(2*Math.PI/y),m=0;m<l;m+=y)for(var M=d,B=w,E=0;E<x;E++){var C=c[m+E],q=f[m+E],U=c[m+E+x],j=f[m+E+x],Y=M*U-B*j;j=M*j+B*U,U=Y,c[m+E]=C+U,f[m+E]=q+j,c[m+E+x]=C-U,f[m+E+x]=q-j,E!==y&&(Y=d*M-w*B,B=d*B+w*M,M=Y)}},N.prototype.guessLen13b=function(g,v){var c=Math.max(v,g)|1,f=c&1,l=0;for(c=c/2|0;c;c=c>>>1)l++;return 1<<l+1+f},N.prototype.conjugate=function(g,v,c){if(!(c<=1))for(var f=0;f<c/2;f++){var l=g[f];g[f]=g[c-f-1],g[c-f-1]=l,l=v[f],v[f]=-v[c-f-1],v[c-f-1]=-l}},N.prototype.normalize13b=function(g,v){for(var c=0,f=0;f<v/2;f++){var l=Math.round(g[2*f+1]/v)*8192+Math.round(g[2*f]/v)+c;g[f]=l&67108863,l<67108864?c=0:c=l/67108864|0}return g},N.prototype.convert13b=function(g,v,c,f){for(var l=0,_=0;_<v;_++)l=l+(g[_]|0),c[2*_]=l&8191,l=l>>>13,c[2*_+1]=l&8191,l=l>>>13;for(_=2*v;_<f;++_)c[_]=0;i(l===0),i((l&-8192)===0)},N.prototype.stub=function(g){for(var v=new Array(g),c=0;c<g;c++)v[c]=0;return v},N.prototype.mulp=function(g,v,c){var f=2*this.guessLen13b(g.length,v.length),l=this.makeRBT(f),_=this.stub(f),x=new Array(f),y=new Array(f),d=new Array(f),w=new Array(f),m=new Array(f),M=new Array(f),B=c.words;B.length=f,this.convert13b(g.words,g.length,x,f),this.convert13b(v.words,v.length,w,f),this.transform(x,_,y,d,f,l),this.transform(w,_,m,M,f,l);for(var E=0;E<f;E++){var C=y[E]*m[E]-d[E]*M[E];d[E]=y[E]*M[E]+d[E]*m[E],y[E]=C}return this.conjugate(y,d,f),this.transform(y,d,B,_,f,l),this.conjugate(B,_,f),this.normalize13b(B,f),c.negative=g.negative^v.negative,c.length=g.length+v.length,c.strip()},s.prototype.mul=function(g){var v=new s(null);return v.words=new Array(this.length+g.length),this.mulTo(g,v)},s.prototype.mulf=function(g){var v=new s(null);return v.words=new Array(this.length+g.length),O(this,g,v)},s.prototype.imul=function(g){return this.clone().mulTo(g,this)},s.prototype.imuln=function(g){i(typeof g=="number"),i(g<67108864);for(var v=0,c=0;c<this.length;c++){var f=(this.words[c]|0)*g,l=(f&67108863)+(v&67108863);v>>=26,v+=f/67108864|0,v+=l>>>26,this.words[c]=l&67108863}return v!==0&&(this.words[c]=v,this.length++),this},s.prototype.muln=function(g){return this.clone().imuln(g)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(g){var v=A(g);if(v.length===0)return new s(1);for(var c=this,f=0;f<v.length&&v[f]===0;f++,c=c.sqr());if(++f<v.length)for(var l=c.sqr();f<v.length;f++,l=l.sqr())v[f]!==0&&(c=c.mul(l));return c},s.prototype.iushln=function(g){i(typeof g=="number"&&g>=0);var v=g%26,c=(g-v)/26,f=67108863>>>26-v<<26-v,l;if(v!==0){var _=0;for(l=0;l<this.length;l++){var x=this.words[l]&f,y=(this.words[l]|0)-x<<v;this.words[l]=y|_,_=x>>>26-v}_&&(this.words[l]=_,this.length++)}if(c!==0){for(l=this.length-1;l>=0;l--)this.words[l+c]=this.words[l];for(l=0;l<c;l++)this.words[l]=0;this.length+=c}return this.strip()},s.prototype.ishln=function(g){return i(this.negative===0),this.iushln(g)},s.prototype.iushrn=function(g,v,c){i(typeof g=="number"&&g>=0);var f;v?f=(v-v%26)/26:f=0;var l=g%26,_=Math.min((g-l)/26,this.length),x=67108863^67108863>>>l<<l,y=c;if(f-=_,f=Math.max(0,f),y){for(var d=0;d<_;d++)y.words[d]=this.words[d];y.length=_}if(_!==0)if(this.length>_)for(this.length-=_,d=0;d<this.length;d++)this.words[d]=this.words[d+_];else this.words[0]=0,this.length=1;var w=0;for(d=this.length-1;d>=0&&(w!==0||d>=f);d--){var m=this.words[d]|0;this.words[d]=w<<26-l|m>>>l,w=m&x}return y&&w!==0&&(y.words[y.length++]=w),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},s.prototype.ishrn=function(g,v,c){return i(this.negative===0),this.iushrn(g,v,c)},s.prototype.shln=function(g){return this.clone().ishln(g)},s.prototype.ushln=function(g){return this.clone().iushln(g)},s.prototype.shrn=function(g){return this.clone().ishrn(g)},s.prototype.ushrn=function(g){return this.clone().iushrn(g)},s.prototype.testn=function(g){i(typeof g=="number"&&g>=0);var v=g%26,c=(g-v)/26,f=1<<v;if(this.length<=c)return!1;var l=this.words[c];return!!(l&f)},s.prototype.imaskn=function(g){i(typeof g=="number"&&g>=0);var v=g%26,c=(g-v)/26;if(i(this.negative===0,"imaskn works only with positive numbers"),this.length<=c)return this;if(v!==0&&c++,this.length=Math.min(c,this.length),v!==0){var f=67108863^67108863>>>v<<v;this.words[this.length-1]&=f}return this.strip()},s.prototype.maskn=function(g){return this.clone().imaskn(g)},s.prototype.iaddn=function(g){return i(typeof g=="number"),i(g<67108864),g<0?this.isubn(-g):this.negative!==0?this.length===1&&(this.words[0]|0)<g?(this.words[0]=g-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(g),this.negative=1,this):this._iaddn(g)},s.prototype._iaddn=function(g){this.words[0]+=g;for(var v=0;v<this.length&&this.words[v]>=67108864;v++)this.words[v]-=67108864,v===this.length-1?this.words[v+1]=1:this.words[v+1]++;return this.length=Math.max(this.length,v+1),this},s.prototype.isubn=function(g){if(i(typeof g=="number"),i(g<67108864),g<0)return this.iaddn(-g);if(this.negative!==0)return this.negative=0,this.iaddn(g),this.negative=1,this;if(this.words[0]-=g,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var v=0;v<this.length&&this.words[v]<0;v++)this.words[v]+=67108864,this.words[v+1]-=1;return this.strip()},s.prototype.addn=function(g){return this.clone().iaddn(g)},s.prototype.subn=function(g){return this.clone().isubn(g)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(g,v,c){var f=g.length+c,l;this._expand(f);var _,x=0;for(l=0;l<g.length;l++){_=(this.words[l+c]|0)+x;var y=(g.words[l]|0)*v;_-=y&67108863,x=(_>>26)-(y/67108864|0),this.words[l+c]=_&67108863}for(;l<this.length-c;l++)_=(this.words[l+c]|0)+x,x=_>>26,this.words[l+c]=_&67108863;if(x===0)return this.strip();for(i(x===-1),x=0,l=0;l<this.length;l++)_=-(this.words[l]|0)+x,x=_>>26,this.words[l]=_&67108863;return this.negative=1,this.strip()},s.prototype._wordDiv=function(g,v){var c=this.length-g.length,f=this.clone(),l=g,_=l.words[l.length-1]|0,x=this._countBits(_);c=26-x,c!==0&&(l=l.ushln(c),f.iushln(c),_=l.words[l.length-1]|0);var y=f.length-l.length,d;if(v!=="mod"){d=new s(null),d.length=y+1,d.words=new Array(d.length);for(var w=0;w<d.length;w++)d.words[w]=0}var m=f.clone()._ishlnsubmul(l,1,y);m.negative===0&&(f=m,d&&(d.words[y]=1));for(var M=y-1;M>=0;M--){var B=(f.words[l.length+M]|0)*67108864+(f.words[l.length+M-1]|0);for(B=Math.min(B/_|0,67108863),f._ishlnsubmul(l,B,M);f.negative!==0;)B--,f.negative=0,f._ishlnsubmul(l,1,M),f.isZero()||(f.negative^=1);d&&(d.words[M]=B)}return d&&d.strip(),f.strip(),v!=="div"&&c!==0&&f.iushrn(c),{div:d||null,mod:f}},s.prototype.divmod=function(g,v,c){if(i(!g.isZero()),this.isZero())return{div:new s(0),mod:new s(0)};var f,l,_;return this.negative!==0&&g.negative===0?(_=this.neg().divmod(g,v),v!=="mod"&&(f=_.div.neg()),v!=="div"&&(l=_.mod.neg(),c&&l.negative!==0&&l.iadd(g)),{div:f,mod:l}):this.negative===0&&g.negative!==0?(_=this.divmod(g.neg(),v),v!=="mod"&&(f=_.div.neg()),{div:f,mod:_.mod}):(this.negative&g.negative)!==0?(_=this.neg().divmod(g.neg(),v),v!=="div"&&(l=_.mod.neg(),c&&l.negative!==0&&l.isub(g)),{div:_.div,mod:l}):g.length>this.length||this.cmp(g)<0?{div:new s(0),mod:this}:g.length===1?v==="div"?{div:this.divn(g.words[0]),mod:null}:v==="mod"?{div:null,mod:new s(this.modn(g.words[0]))}:{div:this.divn(g.words[0]),mod:new s(this.modn(g.words[0]))}:this._wordDiv(g,v)},s.prototype.div=function(g){return this.divmod(g,"div",!1).div},s.prototype.mod=function(g){return this.divmod(g,"mod",!1).mod},s.prototype.umod=function(g){return this.divmod(g,"mod",!0).mod},s.prototype.divRound=function(g){var v=this.divmod(g);if(v.mod.isZero())return v.div;var c=v.div.negative!==0?v.mod.isub(g):v.mod,f=g.ushrn(1),l=g.andln(1),_=c.cmp(f);return _<0||l===1&&_===0?v.div:v.div.negative!==0?v.div.isubn(1):v.div.iaddn(1)},s.prototype.modn=function(g){i(g<=67108863);for(var v=(1<<26)%g,c=0,f=this.length-1;f>=0;f--)c=(v*c+(this.words[f]|0))%g;return c},s.prototype.idivn=function(g){i(g<=67108863);for(var v=0,c=this.length-1;c>=0;c--){var f=(this.words[c]|0)+v*67108864;this.words[c]=f/g|0,v=f%g}return this.strip()},s.prototype.divn=function(g){return this.clone().idivn(g)},s.prototype.egcd=function(g){i(g.negative===0),i(!g.isZero());var v=this,c=g.clone();v.negative!==0?v=v.umod(g):v=v.clone();for(var f=new s(1),l=new s(0),_=new s(0),x=new s(1),y=0;v.isEven()&&c.isEven();)v.iushrn(1),c.iushrn(1),++y;for(var d=c.clone(),w=v.clone();!v.isZero();){for(var m=0,M=1;(v.words[0]&M)===0&&m<26;++m,M<<=1);if(m>0)for(v.iushrn(m);m-- >0;)(f.isOdd()||l.isOdd())&&(f.iadd(d),l.isub(w)),f.iushrn(1),l.iushrn(1);for(var B=0,E=1;(c.words[0]&E)===0&&B<26;++B,E<<=1);if(B>0)for(c.iushrn(B);B-- >0;)(_.isOdd()||x.isOdd())&&(_.iadd(d),x.isub(w)),_.iushrn(1),x.iushrn(1);v.cmp(c)>=0?(v.isub(c),f.isub(_),l.isub(x)):(c.isub(v),_.isub(f),x.isub(l))}return{a:_,b:x,gcd:c.iushln(y)}},s.prototype._invmp=function(g){i(g.negative===0),i(!g.isZero());var v=this,c=g.clone();v.negative!==0?v=v.umod(g):v=v.clone();for(var f=new s(1),l=new s(0),_=c.clone();v.cmpn(1)>0&&c.cmpn(1)>0;){for(var x=0,y=1;(v.words[0]&y)===0&&x<26;++x,y<<=1);if(x>0)for(v.iushrn(x);x-- >0;)f.isOdd()&&f.iadd(_),f.iushrn(1);for(var d=0,w=1;(c.words[0]&w)===0&&d<26;++d,w<<=1);if(d>0)for(c.iushrn(d);d-- >0;)l.isOdd()&&l.iadd(_),l.iushrn(1);v.cmp(c)>=0?(v.isub(c),f.isub(l)):(c.isub(v),l.isub(f))}var m;return v.cmpn(1)===0?m=f:m=l,m.cmpn(0)<0&&m.iadd(g),m},s.prototype.gcd=function(g){if(this.isZero())return g.abs();if(g.isZero())return this.abs();var v=this.clone(),c=g.clone();v.negative=0,c.negative=0;for(var f=0;v.isEven()&&c.isEven();f++)v.iushrn(1),c.iushrn(1);do{for(;v.isEven();)v.iushrn(1);for(;c.isEven();)c.iushrn(1);var l=v.cmp(c);if(l<0){var _=v;v=c,c=_}else if(l===0||c.cmpn(1)===0)break;v.isub(c)}while(!0);return c.iushln(f)},s.prototype.invm=function(g){return this.egcd(g).a.umod(g)},s.prototype.isEven=function(){return(this.words[0]&1)===0},s.prototype.isOdd=function(){return(this.words[0]&1)===1},s.prototype.andln=function(g){return this.words[0]&g},s.prototype.bincn=function(g){i(typeof g=="number");var v=g%26,c=(g-v)/26,f=1<<v;if(this.length<=c)return this._expand(c+1),this.words[c]|=f,this;for(var l=f,_=c;l!==0&&_<this.length;_++){var x=this.words[_]|0;x+=l,l=x>>>26,x&=67108863,this.words[_]=x}return l!==0&&(this.words[_]=l,this.length++),this},s.prototype.isZero=function(){return this.length===1&&this.words[0]===0},s.prototype.cmpn=function(g){var v=g<0;if(this.negative!==0&&!v)return-1;if(this.negative===0&&v)return 1;this.strip();var c;if(this.length>1)c=1;else{v&&(g=-g),i(g<=67108863,"Number is too big");var f=this.words[0]|0;c=f===g?0:f<g?-1:1}return this.negative!==0?-c|0:c},s.prototype.cmp=function(g){if(this.negative!==0&&g.negative===0)return-1;if(this.negative===0&&g.negative!==0)return 1;var v=this.ucmp(g);return this.negative!==0?-v|0:v},s.prototype.ucmp=function(g){if(this.length>g.length)return 1;if(this.length<g.length)return-1;for(var v=0,c=this.length-1;c>=0;c--){var f=this.words[c]|0,l=g.words[c]|0;if(f!==l){f<l?v=-1:f>l&&(v=1);break}}return v},s.prototype.gtn=function(g){return this.cmpn(g)===1},s.prototype.gt=function(g){return this.cmp(g)===1},s.prototype.gten=function(g){return this.cmpn(g)>=0},s.prototype.gte=function(g){return this.cmp(g)>=0},s.prototype.ltn=function(g){return this.cmpn(g)===-1},s.prototype.lt=function(g){return this.cmp(g)===-1},s.prototype.lten=function(g){return this.cmpn(g)<=0},s.prototype.lte=function(g){return this.cmp(g)<=0},s.prototype.eqn=function(g){return this.cmpn(g)===0},s.prototype.eq=function(g){return this.cmp(g)===0},s.red=function(g){return new H(g)},s.prototype.toRed=function(g){return i(!this.red,"Already a number in reduction context"),i(this.negative===0,"red works only with positives"),g.convertTo(this)._forceRed(g)},s.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(g){return this.red=g,this},s.prototype.forceRed=function(g){return i(!this.red,"Already a number in reduction context"),this._forceRed(g)},s.prototype.redAdd=function(g){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,g)},s.prototype.redIAdd=function(g){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,g)},s.prototype.redSub=function(g){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,g)},s.prototype.redISub=function(g){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,g)},s.prototype.redShl=function(g){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,g)},s.prototype.redMul=function(g){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,g),this.red.mul(this,g)},s.prototype.redIMul=function(g){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,g),this.red.imul(this,g)},s.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(g){return i(this.red&&!g.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,g)};var F={k256:null,p224:null,p192:null,p25519:null};function L(D,g){this.name=D,this.p=new s(g,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}L.prototype._tmp=function(){var g=new s(null);return g.words=new Array(Math.ceil(this.n/13)),g},L.prototype.ireduce=function(g){var v=g,c;do this.split(v,this.tmp),v=this.imulK(v),v=v.iadd(this.tmp),c=v.bitLength();while(c>this.n);var f=c<this.n?-1:v.ucmp(this.p);return f===0?(v.words[0]=0,v.length=1):f>0?v.isub(this.p):v.strip!==void 0?v.strip():v._strip(),v},L.prototype.split=function(g,v){g.iushrn(this.n,0,v)},L.prototype.imulK=function(g){return g.imul(this.k)};function z(){L.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}n(z,L),z.prototype.split=function(g,v){for(var c=4194303,f=Math.min(g.length,9),l=0;l<f;l++)v.words[l]=g.words[l];if(v.length=f,g.length<=9){g.words[0]=0,g.length=1;return}var _=g.words[9];for(v.words[v.length++]=_&c,l=10;l<g.length;l++){var x=g.words[l]|0;g.words[l-10]=(x&c)<<4|_>>>22,_=x}_>>>=22,g.words[l-10]=_,_===0&&g.length>10?g.length-=10:g.length-=9},z.prototype.imulK=function(g){g.words[g.length]=0,g.words[g.length+1]=0,g.length+=2;for(var v=0,c=0;c<g.length;c++){var f=g.words[c]|0;v+=f*977,g.words[c]=v&67108863,v=f*64+(v/67108864|0)}return g.words[g.length-1]===0&&(g.length--,g.words[g.length-1]===0&&g.length--),g};function k(){L.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}n(k,L);function G(){L.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}n(G,L);function K(){L.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}n(K,L),K.prototype.imulK=function(g){for(var v=0,c=0;c<g.length;c++){var f=(g.words[c]|0)*19+v,l=f&67108863;f>>>=26,g.words[c]=l,v=f}return v!==0&&(g.words[g.length++]=v),g},s._prime=function(g){if(F[g])return F[g];var v;if(g==="k256")v=new z;else if(g==="p224")v=new k;else if(g==="p192")v=new G;else if(g==="p25519")v=new K;else throw new Error("Unknown prime "+g);return F[g]=v,v};function H(D){if(typeof D=="string"){var g=s._prime(D);this.m=g.p,this.prime=g}else i(D.gtn(1),"modulus must be greater than 1"),this.m=D,this.prime=null}H.prototype._verify1=function(g){i(g.negative===0,"red works only with positives"),i(g.red,"red works only with red numbers")},H.prototype._verify2=function(g,v){i((g.negative|v.negative)===0,"red works only with positives"),i(g.red&&g.red===v.red,"red works only with red numbers")},H.prototype.imod=function(g){return this.prime?this.prime.ireduce(g)._forceRed(this):g.umod(this.m)._forceRed(this)},H.prototype.neg=function(g){return g.isZero()?g.clone():this.m.sub(g)._forceRed(this)},H.prototype.add=function(g,v){this._verify2(g,v);var c=g.add(v);return c.cmp(this.m)>=0&&c.isub(this.m),c._forceRed(this)},H.prototype.iadd=function(g,v){this._verify2(g,v);var c=g.iadd(v);return c.cmp(this.m)>=0&&c.isub(this.m),c},H.prototype.sub=function(g,v){this._verify2(g,v);var c=g.sub(v);return c.cmpn(0)<0&&c.iadd(this.m),c._forceRed(this)},H.prototype.isub=function(g,v){this._verify2(g,v);var c=g.isub(v);return c.cmpn(0)<0&&c.iadd(this.m),c},H.prototype.shl=function(g,v){return this._verify1(g),this.imod(g.ushln(v))},H.prototype.imul=function(g,v){return this._verify2(g,v),this.imod(g.imul(v))},H.prototype.mul=function(g,v){return this._verify2(g,v),this.imod(g.mul(v))},H.prototype.isqr=function(g){return this.imul(g,g.clone())},H.prototype.sqr=function(g){return this.mul(g,g)},H.prototype.sqrt=function(g){if(g.isZero())return g.clone();var v=this.m.andln(3);if(i(v%2===1),v===3){var c=this.m.add(new s(1)).iushrn(2);return this.pow(g,c)}for(var f=this.m.subn(1),l=0;!f.isZero()&&f.andln(1)===0;)l++,f.iushrn(1);i(!f.isZero());var _=new s(1).toRed(this),x=_.redNeg(),y=this.m.subn(1).iushrn(1),d=this.m.bitLength();for(d=new s(2*d*d).toRed(this);this.pow(d,y).cmp(x)!==0;)d.redIAdd(x);for(var w=this.pow(d,f),m=this.pow(g,f.addn(1).iushrn(1)),M=this.pow(g,f),B=l;M.cmp(_)!==0;){for(var E=M,C=0;E.cmp(_)!==0;C++)E=E.redSqr();i(C<B);var q=this.pow(w,new s(1).iushln(B-C-1));m=m.redMul(q),w=q.redSqr(),M=M.redMul(w),B=C}return m},H.prototype.invm=function(g){var v=g._invmp(this.m);return v.negative!==0?(v.negative=0,this.imod(v).redNeg()):this.imod(v)},H.prototype.pow=function(g,v){if(v.isZero())return new s(1).toRed(this);if(v.cmpn(1)===0)return g.clone();var c=4,f=new Array(1<<c);f[0]=new s(1).toRed(this),f[1]=g;for(var l=2;l<f.length;l++)f[l]=this.mul(f[l-1],g);var _=f[0],x=0,y=0,d=v.bitLength()%26;for(d===0&&(d=26),l=v.length-1;l>=0;l--){for(var w=v.words[l],m=d-1;m>=0;m--){var M=w>>m&1;if(_!==f[0]&&(_=this.sqr(_)),M===0&&x===0){y=0;continue}x<<=1,x|=M,y++,!(y!==c&&(l!==0||m!==0))&&(_=this.mul(_,f[x]),y=0,x=0)}d=26}return _},H.prototype.convertTo=function(g){var v=g.umod(this.m);return v===g?v.clone():v},H.prototype.convertFrom=function(g){var v=g.clone();return v.red=null,v},s.mont=function(g){return new ie(g)};function ie(D){H.call(this,D),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}n(ie,H),ie.prototype.convertTo=function(g){return this.imod(g.ushln(this.shift))},ie.prototype.convertFrom=function(g){var v=this.imod(g.mul(this.rinv));return v.red=null,v},ie.prototype.imul=function(g,v){if(g.isZero()||v.isZero())return g.words[0]=0,g.length=1,g;var c=g.imul(v),f=c.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),l=c.isub(f).iushrn(this.shift),_=l;return l.cmp(this.m)>=0?_=l.isub(this.m):l.cmpn(0)<0&&(_=l.iadd(this.m)),_._forceRed(this)},ie.prototype.mul=function(g,v){if(g.isZero()||v.isZero())return new s(0)._forceRed(this);var c=g.mul(v),f=c.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),l=c.isub(f).iushrn(this.shift),_=l;return l.cmp(this.m)>=0?_=l.isub(this.m):l.cmpn(0)<0&&(_=l.iadd(this.m)),_._forceRed(this)},ie.prototype.invm=function(g){var v=this.imod(g._invmp(this.m).mul(this.r2));return v._forceRed(this)}})(t,yt)})(_i);var Mf={};(function(t){var e=t;function r(s,o){if(Array.isArray(s))return s.slice();if(!s)return[];var a=[];if(typeof s!="string"){for(var h=0;h<s.length;h++)a[h]=s[h]|0;return a}if(o==="hex"){s=s.replace(/[^a-z0-9]+/ig,""),s.length%2!==0&&(s="0"+s);for(var h=0;h<s.length;h+=2)a.push(parseInt(s[h]+s[h+1],16))}else for(var h=0;h<s.length;h++){var u=s.charCodeAt(h),p=u>>8,b=u&255;p?a.push(p,b):a.push(b)}return a}e.toArray=r;function i(s){return s.length===1?"0"+s:s}e.zero2=i;function n(s){for(var o="",a=0;a<s.length;a++)o+=i(s[a].toString(16));return o}e.toHex=n,e.encode=function(o,a){return a==="hex"?n(o):o}})(Mf),function(t){var e=t,r=_i.exports,i=$n,n=Mf;e.assert=i,e.toArray=n.toArray,e.zero2=n.zero2,e.toHex=n.toHex,e.encode=n.encode;function s(p,b,S){var A=new Array(Math.max(p.bitLength(),S)+1),I;for(I=0;I<A.length;I+=1)A[I]=0;var P=1<<b+1,R=p.clone();for(I=0;I<A.length;I++){var O,N=R.andln(P-1);R.isOdd()?(N>(P>>1)-1?O=(P>>1)-N:O=N,R.isubn(O)):O=0,A[I]=O,R.iushrn(1)}return A}e.getNAF=s;function o(p,b){var S=[[],[]];p=p.clone(),b=b.clone();for(var A=0,I=0,P;p.cmpn(-A)>0||b.cmpn(-I)>0;){var R=p.andln(3)+A&3,O=b.andln(3)+I&3;R===3&&(R=-1),O===3&&(O=-1);var N;(R&1)===0?N=0:(P=p.andln(7)+A&7,(P===3||P===5)&&O===2?N=-R:N=R),S[0].push(N);var F;(O&1)===0?F=0:(P=b.andln(7)+I&7,(P===3||P===5)&&R===2?F=-O:F=O),S[1].push(F),2*A===N+1&&(A=1-A),2*I===F+1&&(I=1-I),p.iushrn(1),b.iushrn(1)}return S}e.getJSF=o;function a(p,b,S){var A="_"+b;p.prototype[b]=function(){return this[A]!==void 0?this[A]:this[A]=S.call(this)}}e.cachedProperty=a;function h(p){return typeof p=="string"?e.toArray(p,"hex"):p}e.parseBytes=h;function u(p){return new r(p,"hex","le")}e.intFromLE=u}(Dr);var Ea={exports:{}},Pf;Ea.exports=function(e){return Pf||(Pf=new fn(null)),Pf.generate(e)};function fn(t){this.rand=t}if(Ea.exports.Rand=fn,fn.prototype.generate=function(e){return this._rand(e)},fn.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var r=new Uint8Array(e),i=0;i<r.length;i++)r[i]=this.rand.getByte();return r},typeof self=="object")self.crypto&&self.crypto.getRandomValues?fn.prototype._rand=function(e){var r=new Uint8Array(e);return self.crypto.getRandomValues(r),r}:self.msCrypto&&self.msCrypto.getRandomValues?fn.prototype._rand=function(e){var r=new Uint8Array(e);return self.msCrypto.getRandomValues(r),r}:typeof window=="object"&&(fn.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var Kl=sf;if(typeof Kl.randomBytes!="function")throw new Error("Not supported");fn.prototype._rand=function(e){return Kl.randomBytes(e)}}catch{}var Df={},Nn=_i.exports,po=Dr,Sa=po.getNAF,G4=po.getJSF,Ia=po.assert;function hn(t,e){this.type=t,this.p=new Nn(e.p,16),this.red=e.prime?Nn.red(e.prime):Nn.mont(this.p),this.zero=new Nn(0).toRed(this.red),this.one=new Nn(1).toRed(this.red),this.two=new Nn(2).toRed(this.red),this.n=e.n&&new Nn(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var Aa=hn;hn.prototype.point=function(){throw new Error("Not implemented")},hn.prototype.validate=function(){throw new Error("Not implemented")},hn.prototype._fixedNafMul=function(e,r){Ia(e.precomputed);var i=e._getDoubles(),n=Sa(r,1,this._bitLength),s=(1<<i.step+1)-(i.step%2===0?2:1);s/=3;var o=[],a,h;for(a=0;a<n.length;a+=i.step){h=0;for(var u=a+i.step-1;u>=a;u--)h=(h<<1)+n[u];o.push(h)}for(var p=this.jpoint(null,null,null),b=this.jpoint(null,null,null),S=s;S>0;S--){for(a=0;a<o.length;a++)h=o[a],h===S?b=b.mixedAdd(i.points[a]):h===-S&&(b=b.mixedAdd(i.points[a].neg()));p=p.add(b)}return p.toP()},hn.prototype._wnafMul=function(e,r){var i=4,n=e._getNAFPoints(i);i=n.wnd;for(var s=n.points,o=Sa(r,i,this._bitLength),a=this.jpoint(null,null,null),h=o.length-1;h>=0;h--){for(var u=0;h>=0&&o[h]===0;h--)u++;if(h>=0&&u++,a=a.dblp(u),h<0)break;var p=o[h];Ia(p!==0),e.type==="affine"?p>0?a=a.mixedAdd(s[p-1>>1]):a=a.mixedAdd(s[-p-1>>1].neg()):p>0?a=a.add(s[p-1>>1]):a=a.add(s[-p-1>>1].neg())}return e.type==="affine"?a.toP():a},hn.prototype._wnafMulAdd=function(e,r,i,n,s){var o=this._wnafT1,a=this._wnafT2,h=this._wnafT3,u=0,p,b,S;for(p=0;p<n;p++){S=r[p];var A=S._getNAFPoints(e);o[p]=A.wnd,a[p]=A.points}for(p=n-1;p>=1;p-=2){var I=p-1,P=p;if(o[I]!==1||o[P]!==1){h[I]=Sa(i[I],o[I],this._bitLength),h[P]=Sa(i[P],o[P],this._bitLength),u=Math.max(h[I].length,u),u=Math.max(h[P].length,u);continue}var R=[r[I],null,null,r[P]];r[I].y.cmp(r[P].y)===0?(R[1]=r[I].add(r[P]),R[2]=r[I].toJ().mixedAdd(r[P].neg())):r[I].y.cmp(r[P].y.redNeg())===0?(R[1]=r[I].toJ().mixedAdd(r[P]),R[2]=r[I].add(r[P].neg())):(R[1]=r[I].toJ().mixedAdd(r[P]),R[2]=r[I].toJ().mixedAdd(r[P].neg()));var O=[-3,-1,-5,-7,0,7,5,1,3],N=G4(i[I],i[P]);for(u=Math.max(N[0].length,u),h[I]=new Array(u),h[P]=new Array(u),b=0;b<u;b++){var F=N[0][b]|0,L=N[1][b]|0;h[I][b]=O[(F+1)*3+(L+1)],h[P][b]=0,a[I]=R}}var z=this.jpoint(null,null,null),k=this._wnafT4;for(p=u;p>=0;p--){for(var G=0;p>=0;){var K=!0;for(b=0;b<n;b++)k[b]=h[b][p]|0,k[b]!==0&&(K=!1);if(!K)break;G++,p--}if(p>=0&&G++,z=z.dblp(G),p<0)break;for(b=0;b<n;b++){var H=k[b];H!==0&&(H>0?S=a[b][H-1>>1]:H<0&&(S=a[b][-H-1>>1].neg()),S.type==="affine"?z=z.mixedAdd(S):z=z.add(S))}}for(p=0;p<n;p++)a[p]=null;return s?z:z.toP()};function jr(t,e){this.curve=t,this.type=e,this.precomputed=null}hn.BasePoint=jr,jr.prototype.eq=function(){throw new Error("Not implemented")},jr.prototype.validate=function(){return this.curve.validate(this)},hn.prototype.decodePoint=function(e,r){e=po.toArray(e,r);var i=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1===2*i){e[0]===6?Ia(e[e.length-1]%2===0):e[0]===7&&Ia(e[e.length-1]%2===1);var n=this.point(e.slice(1,1+i),e.slice(1+i,1+2*i));return n}else if((e[0]===2||e[0]===3)&&e.length-1===i)return this.pointFromX(e.slice(1,1+i),e[0]===3);throw new Error("Unknown point format")},jr.prototype.encodeCompressed=function(e){return this.encode(e,!0)},jr.prototype._encode=function(e){var r=this.curve.p.byteLength(),i=this.getX().toArray("be",r);return e?[this.getY().isEven()?2:3].concat(i):[4].concat(i,this.getY().toArray("be",r))},jr.prototype.encode=function(e,r){return po.encode(this._encode(r),e)},jr.prototype.precompute=function(e){if(this.precomputed)return this;var r={doubles:null,naf:null,beta:null};return r.naf=this._getNAFPoints(8),r.doubles=this._getDoubles(4,e),r.beta=this._getBeta(),this.precomputed=r,this},jr.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var r=this.precomputed.doubles;return r?r.points.length>=Math.ceil((e.bitLength()+1)/r.step):!1},jr.prototype._getDoubles=function(e,r){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var i=[this],n=this,s=0;s<r;s+=e){for(var o=0;o<e;o++)n=n.dbl();i.push(n)}return{step:e,points:i}},jr.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var r=[this],i=(1<<e)-1,n=i===1?null:this.dbl(),s=1;s<i;s++)r[s]=r[s-1].add(n);return{wnd:e,points:r}},jr.prototype._getBeta=function(){return null},jr.prototype.dblp=function(e){for(var r=this,i=0;i<e;i++)r=r.dbl();return r};var W4=Dr,St=_i.exports,$f=as.exports,vs=Aa,J4=W4.assert;function zr(t){vs.call(this,"short",t),this.a=new St(t.a,16).toRed(this.red),this.b=new St(t.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(t),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}$f(zr,vs);var Y4=zr;zr.prototype._getEndomorphism=function(e){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var r,i;if(e.beta)r=new St(e.beta,16).toRed(this.red);else{var n=this._getEndoRoots(this.p);r=n[0].cmp(n[1])<0?n[0]:n[1],r=r.toRed(this.red)}if(e.lambda)i=new St(e.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(r))===0?i=s[0]:(i=s[1],J4(this.g.mul(i).x.cmp(this.g.x.redMul(r))===0))}var o;return e.basis?o=e.basis.map(function(a){return{a:new St(a.a,16),b:new St(a.b,16)}}):o=this._getEndoBasis(i),{beta:r,lambda:i,basis:o}}},zr.prototype._getEndoRoots=function(e){var r=e===this.p?this.red:St.mont(e),i=new St(2).toRed(r).redInvm(),n=i.redNeg(),s=new St(3).toRed(r).redNeg().redSqrt().redMul(i),o=n.redAdd(s).fromRed(),a=n.redSub(s).fromRed();return[o,a]},zr.prototype._getEndoBasis=function(e){for(var r=this.n.ushrn(Math.floor(this.n.bitLength()/2)),i=e,n=this.n.clone(),s=new St(1),o=new St(0),a=new St(0),h=new St(1),u,p,b,S,A,I,P,R=0,O,N;i.cmpn(0)!==0;){var F=n.div(i);O=n.sub(F.mul(i)),N=a.sub(F.mul(s));var L=h.sub(F.mul(o));if(!b&&O.cmp(r)<0)u=P.neg(),p=s,b=O.neg(),S=N;else if(b&&++R===2)break;P=O,n=i,i=O,a=s,s=N,h=o,o=L}A=O.neg(),I=N;var z=b.sqr().add(S.sqr()),k=A.sqr().add(I.sqr());return k.cmp(z)>=0&&(A=u,I=p),b.negative&&(b=b.neg(),S=S.neg()),A.negative&&(A=A.neg(),I=I.neg()),[{a:b,b:S},{a:A,b:I}]},zr.prototype._endoSplit=function(e){var r=this.endo.basis,i=r[0],n=r[1],s=n.b.mul(e).divRound(this.n),o=i.b.neg().mul(e).divRound(this.n),a=s.mul(i.a),h=o.mul(n.a),u=s.mul(i.b),p=o.mul(n.b),b=e.sub(a).sub(h),S=u.add(p).neg();return{k1:b,k2:S}},zr.prototype.pointFromX=function(e,r){e=new St(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),n=i.redSqrt();if(n.redSqr().redSub(i).cmp(this.zero)!==0)throw new Error("invalid point");var s=n.fromRed().isOdd();return(r&&!s||!r&&s)&&(n=n.redNeg()),this.point(e,n)},zr.prototype.validate=function(e){if(e.inf)return!0;var r=e.x,i=e.y,n=this.a.redMul(r),s=r.redSqr().redMul(r).redIAdd(n).redIAdd(this.b);return i.redSqr().redISub(s).cmpn(0)===0},zr.prototype._endoWnafMulAdd=function(e,r,i){for(var n=this._endoWnafT1,s=this._endoWnafT2,o=0;o<e.length;o++){var a=this._endoSplit(r[o]),h=e[o],u=h._getBeta();a.k1.negative&&(a.k1.ineg(),h=h.neg(!0)),a.k2.negative&&(a.k2.ineg(),u=u.neg(!0)),n[o*2]=h,n[o*2+1]=u,s[o*2]=a.k1,s[o*2+1]=a.k2}for(var p=this._wnafMulAdd(1,n,s,o*2,i),b=0;b<o*2;b++)n[b]=null,s[b]=null;return p};function Bt(t,e,r,i){vs.BasePoint.call(this,t,"affine"),e===null&&r===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new St(e,16),this.y=new St(r,16),i&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}$f(Bt,vs.BasePoint),zr.prototype.point=function(e,r,i){return new Bt(this,e,r,i)},zr.prototype.pointFromJSON=function(e,r){return Bt.fromJSON(this,e,r)},Bt.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var r=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var i=this.curve,n=function(s){return i.point(s.x.redMul(i.endo.beta),s.y)};e.beta=r,r.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(n)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(n)}}}return r}},Bt.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},Bt.fromJSON=function(e,r,i){typeof r=="string"&&(r=JSON.parse(r));var n=e.point(r[0],r[1],i);if(!r[2])return n;function s(a){return e.point(a[0],a[1],i)}var o=r[2];return n.precomputed={beta:null,doubles:o.doubles&&{step:o.doubles.step,points:[n].concat(o.doubles.points.map(s))},naf:o.naf&&{wnd:o.naf.wnd,points:[n].concat(o.naf.points.map(s))}},n},Bt.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},Bt.prototype.isInfinity=function(){return this.inf},Bt.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var r=this.y.redSub(e.y);r.cmpn(0)!==0&&(r=r.redMul(this.x.redSub(e.x).redInvm()));var i=r.redSqr().redISub(this.x).redISub(e.x),n=r.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,n)},Bt.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var r=this.curve.a,i=this.x.redSqr(),n=e.redInvm(),s=i.redAdd(i).redIAdd(i).redIAdd(r).redMul(n),o=s.redSqr().redISub(this.x.redAdd(this.x)),a=s.redMul(this.x.redSub(o)).redISub(this.y);return this.curve.point(o,a)},Bt.prototype.getX=function(){return this.x.fromRed()},Bt.prototype.getY=function(){return this.y.fromRed()},Bt.prototype.mul=function(e){return e=new St(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)},Bt.prototype.mulAdd=function(e,r,i){var n=[this,r],s=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,s):this.curve._wnafMulAdd(1,n,s,2)},Bt.prototype.jmulAdd=function(e,r,i){var n=[this,r],s=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,s,!0):this.curve._wnafMulAdd(1,n,s,2,!0)},Bt.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)},Bt.prototype.neg=function(e){if(this.inf)return this;var r=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var i=this.precomputed,n=function(s){return s.neg()};r.precomputed={naf:i.naf&&{wnd:i.naf.wnd,points:i.naf.points.map(n)},doubles:i.doubles&&{step:i.doubles.step,points:i.doubles.points.map(n)}}}return r},Bt.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e};function Wt(t,e,r,i){vs.BasePoint.call(this,t,"jacobian"),e===null&&r===null&&i===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new St(0)):(this.x=new St(e,16),this.y=new St(r,16),this.z=new St(i,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}$f(Wt,vs.BasePoint),zr.prototype.jpoint=function(e,r,i){return new Wt(this,e,r,i)},Wt.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),r=e.redSqr(),i=this.x.redMul(r),n=this.y.redMul(r).redMul(e);return this.curve.point(i,n)},Wt.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},Wt.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var r=e.z.redSqr(),i=this.z.redSqr(),n=this.x.redMul(r),s=e.x.redMul(i),o=this.y.redMul(r.redMul(e.z)),a=e.y.redMul(i.redMul(this.z)),h=n.redSub(s),u=o.redSub(a);if(h.cmpn(0)===0)return u.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var p=h.redSqr(),b=p.redMul(h),S=n.redMul(p),A=u.redSqr().redIAdd(b).redISub(S).redISub(S),I=u.redMul(S.redISub(A)).redISub(o.redMul(b)),P=this.z.redMul(e.z).redMul(h);return this.curve.jpoint(A,I,P)},Wt.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var r=this.z.redSqr(),i=this.x,n=e.x.redMul(r),s=this.y,o=e.y.redMul(r).redMul(this.z),a=i.redSub(n),h=s.redSub(o);if(a.cmpn(0)===0)return h.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var u=a.redSqr(),p=u.redMul(a),b=i.redMul(u),S=h.redSqr().redIAdd(p).redISub(b).redISub(b),A=h.redMul(b.redISub(S)).redISub(s.redMul(p)),I=this.z.redMul(a);return this.curve.jpoint(S,A,I)},Wt.prototype.dblp=function(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var r;if(this.curve.zeroA||this.curve.threeA){var i=this;for(r=0;r<e;r++)i=i.dbl();return i}var n=this.curve.a,s=this.curve.tinv,o=this.x,a=this.y,h=this.z,u=h.redSqr().redSqr(),p=a.redAdd(a);for(r=0;r<e;r++){var b=o.redSqr(),S=p.redSqr(),A=S.redSqr(),I=b.redAdd(b).redIAdd(b).redIAdd(n.redMul(u)),P=o.redMul(S),R=I.redSqr().redISub(P.redAdd(P)),O=P.redISub(R),N=I.redMul(O);N=N.redIAdd(N).redISub(A);var F=p.redMul(h);r+1<e&&(u=u.redMul(A)),o=R,h=F,p=N}return this.curve.jpoint(o,p.redMul(s),h)},Wt.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},Wt.prototype._zeroDbl=function(){var e,r,i;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(n).redISub(o);a=a.redIAdd(a);var h=n.redAdd(n).redIAdd(n),u=h.redSqr().redISub(a).redISub(a),p=o.redIAdd(o);p=p.redIAdd(p),p=p.redIAdd(p),e=u,r=h.redMul(a.redISub(u)).redISub(p),i=this.y.redAdd(this.y)}else{var b=this.x.redSqr(),S=this.y.redSqr(),A=S.redSqr(),I=this.x.redAdd(S).redSqr().redISub(b).redISub(A);I=I.redIAdd(I);var P=b.redAdd(b).redIAdd(b),R=P.redSqr(),O=A.redIAdd(A);O=O.redIAdd(O),O=O.redIAdd(O),e=R.redISub(I).redISub(I),r=P.redMul(I.redISub(e)).redISub(O),i=this.y.redMul(this.z),i=i.redIAdd(i)}return this.curve.jpoint(e,r,i)},Wt.prototype._threeDbl=function(){var e,r,i;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(n).redISub(o);a=a.redIAdd(a);var h=n.redAdd(n).redIAdd(n).redIAdd(this.curve.a),u=h.redSqr().redISub(a).redISub(a);e=u;var p=o.redIAdd(o);p=p.redIAdd(p),p=p.redIAdd(p),r=h.redMul(a.redISub(u)).redISub(p),i=this.y.redAdd(this.y)}else{var b=this.z.redSqr(),S=this.y.redSqr(),A=this.x.redMul(S),I=this.x.redSub(b).redMul(this.x.redAdd(b));I=I.redAdd(I).redIAdd(I);var P=A.redIAdd(A);P=P.redIAdd(P);var R=P.redAdd(P);e=I.redSqr().redISub(R),i=this.y.redAdd(this.z).redSqr().redISub(S).redISub(b);var O=S.redSqr();O=O.redIAdd(O),O=O.redIAdd(O),O=O.redIAdd(O),r=I.redMul(P.redISub(e)).redISub(O)}return this.curve.jpoint(e,r,i)},Wt.prototype._dbl=function(){var e=this.curve.a,r=this.x,i=this.y,n=this.z,s=n.redSqr().redSqr(),o=r.redSqr(),a=i.redSqr(),h=o.redAdd(o).redIAdd(o).redIAdd(e.redMul(s)),u=r.redAdd(r);u=u.redIAdd(u);var p=u.redMul(a),b=h.redSqr().redISub(p.redAdd(p)),S=p.redISub(b),A=a.redSqr();A=A.redIAdd(A),A=A.redIAdd(A),A=A.redIAdd(A);var I=h.redMul(S).redISub(A),P=i.redAdd(i).redMul(n);return this.curve.jpoint(b,I,P)},Wt.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),r=this.y.redSqr(),i=this.z.redSqr(),n=r.redSqr(),s=e.redAdd(e).redIAdd(e),o=s.redSqr(),a=this.x.redAdd(r).redSqr().redISub(e).redISub(n);a=a.redIAdd(a),a=a.redAdd(a).redIAdd(a),a=a.redISub(o);var h=a.redSqr(),u=n.redIAdd(n);u=u.redIAdd(u),u=u.redIAdd(u),u=u.redIAdd(u);var p=s.redIAdd(a).redSqr().redISub(o).redISub(h).redISub(u),b=r.redMul(p);b=b.redIAdd(b),b=b.redIAdd(b);var S=this.x.redMul(h).redISub(b);S=S.redIAdd(S),S=S.redIAdd(S);var A=this.y.redMul(p.redMul(u.redISub(p)).redISub(a.redMul(h)));A=A.redIAdd(A),A=A.redIAdd(A),A=A.redIAdd(A);var I=this.z.redAdd(a).redSqr().redISub(i).redISub(h);return this.curve.jpoint(S,A,I)},Wt.prototype.mul=function(e,r){return e=new St(e,r),this.curve._wnafMul(this,e)},Wt.prototype.eq=function(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return!0;var r=this.z.redSqr(),i=e.z.redSqr();if(this.x.redMul(i).redISub(e.x.redMul(r)).cmpn(0)!==0)return!1;var n=r.redMul(this.z),s=i.redMul(e.z);return this.y.redMul(s).redISub(e.y.redMul(n)).cmpn(0)===0},Wt.prototype.eqXToP=function(e){var r=this.z.redSqr(),i=e.toRed(this.curve.red).redMul(r);if(this.x.cmp(i)===0)return!0;for(var n=e.clone(),s=this.curve.redN.redMul(r);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(i.redIAdd(s),this.x.cmp(i)===0)return!0}},Wt.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},Wt.prototype.isInfinity=function(){return this.z.cmpn(0)===0};var gs=_i.exports,Vl=as.exports,Ma=Aa,Z4=Dr;function bs(t){Ma.call(this,"mont",t),this.a=new gs(t.a,16).toRed(this.red),this.b=new gs(t.b,16).toRed(this.red),this.i4=new gs(4).toRed(this.red).redInvm(),this.two=new gs(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}Vl(bs,Ma);var X4=bs;bs.prototype.validate=function(e){var r=e.normalize().x,i=r.redSqr(),n=i.redMul(r).redAdd(i.redMul(this.a)).redAdd(r),s=n.redSqrt();return s.redSqr().cmp(n)===0};function qt(t,e,r){Ma.BasePoint.call(this,t,"projective"),e===null&&r===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new gs(e,16),this.z=new gs(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}Vl(qt,Ma.BasePoint),bs.prototype.decodePoint=function(e,r){return this.point(Z4.toArray(e,r),1)},bs.prototype.point=function(e,r){return new qt(this,e,r)},bs.prototype.pointFromJSON=function(e){return qt.fromJSON(this,e)},qt.prototype.precompute=function(){},qt.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},qt.fromJSON=function(e,r){return new qt(e,r[0],r[1]||e.one)},qt.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},qt.prototype.isInfinity=function(){return this.z.cmpn(0)===0},qt.prototype.dbl=function(){var e=this.x.redAdd(this.z),r=e.redSqr(),i=this.x.redSub(this.z),n=i.redSqr(),s=r.redSub(n),o=r.redMul(n),a=s.redMul(n.redAdd(this.curve.a24.redMul(s)));return this.curve.point(o,a)},qt.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},qt.prototype.diffAdd=function(e,r){var i=this.x.redAdd(this.z),n=this.x.redSub(this.z),s=e.x.redAdd(e.z),o=e.x.redSub(e.z),a=o.redMul(i),h=s.redMul(n),u=r.z.redMul(a.redAdd(h).redSqr()),p=r.x.redMul(a.redISub(h).redSqr());return this.curve.point(u,p)},qt.prototype.mul=function(e){for(var r=e.clone(),i=this,n=this.curve.point(null,null),s=this,o=[];r.cmpn(0)!==0;r.iushrn(1))o.push(r.andln(1));for(var a=o.length-1;a>=0;a--)o[a]===0?(i=i.diffAdd(n,s),n=n.dbl()):(n=i.diffAdd(n,s),i=i.dbl());return n},qt.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},qt.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},qt.prototype.eq=function(e){return this.getX().cmp(e.getX())===0},qt.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},qt.prototype.getX=function(){return this.normalize(),this.x.fromRed()};var Q4=Dr,Bi=_i.exports,Gl=as.exports,Pa=Aa,e8=Q4.assert;function xi(t){this.twisted=(t.a|0)!==1,this.mOneA=this.twisted&&(t.a|0)===-1,this.extended=this.mOneA,Pa.call(this,"edwards",t),this.a=new Bi(t.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new Bi(t.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new Bi(t.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),e8(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(t.c|0)===1}Gl(xi,Pa);var t8=xi;xi.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)},xi.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)},xi.prototype.jpoint=function(e,r,i,n){return this.point(e,r,i,n)},xi.prototype.pointFromX=function(e,r){e=new Bi(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr(),n=this.c2.redSub(this.a.redMul(i)),s=this.one.redSub(this.c2.redMul(this.d).redMul(i)),o=n.redMul(s.redInvm()),a=o.redSqrt();if(a.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");var h=a.fromRed().isOdd();return(r&&!h||!r&&h)&&(a=a.redNeg()),this.point(e,a)},xi.prototype.pointFromY=function(e,r){e=new Bi(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr(),n=i.redSub(this.c2),s=i.redMul(this.d).redMul(this.c2).redSub(this.a),o=n.redMul(s.redInvm());if(o.cmp(this.zero)===0){if(r)throw new Error("invalid point");return this.point(this.zero,e)}var a=o.redSqrt();if(a.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");return a.fromRed().isOdd()!==r&&(a=a.redNeg()),this.point(a,e)},xi.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var r=e.x.redSqr(),i=e.y.redSqr(),n=r.redMul(this.a).redAdd(i),s=this.c2.redMul(this.one.redAdd(this.d.redMul(r).redMul(i)));return n.cmp(s)===0};function vt(t,e,r,i,n){Pa.BasePoint.call(this,t,"projective"),e===null&&r===null&&i===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new Bi(e,16),this.y=new Bi(r,16),this.z=i?new Bi(i,16):this.curve.one,this.t=n&&new Bi(n,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}Gl(vt,Pa.BasePoint),xi.prototype.pointFromJSON=function(e){return vt.fromJSON(this,e)},xi.prototype.point=function(e,r,i,n){return new vt(this,e,r,i,n)},vt.fromJSON=function(e,r){return new vt(e,r[0],r[1],r[2])},vt.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},vt.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)},vt.prototype._extDbl=function(){var e=this.x.redSqr(),r=this.y.redSqr(),i=this.z.redSqr();i=i.redIAdd(i);var n=this.curve._mulA(e),s=this.x.redAdd(this.y).redSqr().redISub(e).redISub(r),o=n.redAdd(r),a=o.redSub(i),h=n.redSub(r),u=s.redMul(a),p=o.redMul(h),b=s.redMul(h),S=a.redMul(o);return this.curve.point(u,p,S,b)},vt.prototype._projDbl=function(){var e=this.x.redAdd(this.y).redSqr(),r=this.x.redSqr(),i=this.y.redSqr(),n,s,o,a,h,u;if(this.curve.twisted){a=this.curve._mulA(r);var p=a.redAdd(i);this.zOne?(n=e.redSub(r).redSub(i).redMul(p.redSub(this.curve.two)),s=p.redMul(a.redSub(i)),o=p.redSqr().redSub(p).redSub(p)):(h=this.z.redSqr(),u=p.redSub(h).redISub(h),n=e.redSub(r).redISub(i).redMul(u),s=p.redMul(a.redSub(i)),o=p.redMul(u))}else a=r.redAdd(i),h=this.curve._mulC(this.z).redSqr(),u=a.redSub(h).redSub(h),n=this.curve._mulC(e.redISub(a)).redMul(u),s=this.curve._mulC(a).redMul(r.redISub(i)),o=a.redMul(u);return this.curve.point(n,s,o)},vt.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},vt.prototype._extAdd=function(e){var r=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),i=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),n=this.t.redMul(this.curve.dd).redMul(e.t),s=this.z.redMul(e.z.redAdd(e.z)),o=i.redSub(r),a=s.redSub(n),h=s.redAdd(n),u=i.redAdd(r),p=o.redMul(a),b=h.redMul(u),S=o.redMul(u),A=a.redMul(h);return this.curve.point(p,b,A,S)},vt.prototype._projAdd=function(e){var r=this.z.redMul(e.z),i=r.redSqr(),n=this.x.redMul(e.x),s=this.y.redMul(e.y),o=this.curve.d.redMul(n).redMul(s),a=i.redSub(o),h=i.redAdd(o),u=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(n).redISub(s),p=r.redMul(a).redMul(u),b,S;return this.curve.twisted?(b=r.redMul(h).redMul(s.redSub(this.curve._mulA(n))),S=a.redMul(h)):(b=r.redMul(h).redMul(s.redSub(n)),S=this.curve._mulC(a).redMul(h)),this.curve.point(p,b,S)},vt.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)},vt.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)},vt.prototype.mulAdd=function(e,r,i){return this.curve._wnafMulAdd(1,[this,r],[e,i],2,!1)},vt.prototype.jmulAdd=function(e,r,i){return this.curve._wnafMulAdd(1,[this,r],[e,i],2,!0)},vt.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this},vt.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},vt.prototype.getX=function(){return this.normalize(),this.x.fromRed()},vt.prototype.getY=function(){return this.normalize(),this.y.fromRed()},vt.prototype.eq=function(e){return this===e||this.getX().cmp(e.getX())===0&&this.getY().cmp(e.getY())===0},vt.prototype.eqXToP=function(e){var r=e.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(r)===0)return!0;for(var i=e.clone(),n=this.curve.redN.redMul(this.z);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(n),this.x.cmp(r)===0)return!0}},vt.prototype.toP=vt.prototype.normalize,vt.prototype.mixedAdd=vt.prototype.add,function(t){var e=t;e.base=Aa,e.short=Y4,e.mont=X4,e.edwards=t8}(Df);var Da={},Of,Wl;function r8(){return Wl||(Wl=1,Of={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}),Of}(function(t){var e=t,r=Mr,i=Df,n=Dr,s=n.assert;function o(u){u.type==="short"?this.curve=new i.short(u):u.type==="edwards"?this.curve=new i.edwards(u):this.curve=new i.mont(u),this.g=this.curve.g,this.n=this.curve.n,this.hash=u.hash,s(this.g.validate(),"Invalid curve"),s(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}e.PresetCurve=o;function a(u,p){Object.defineProperty(e,u,{configurable:!0,enumerable:!0,get:function(){var b=new o(p);return Object.defineProperty(e,u,{configurable:!0,enumerable:!0,value:b}),b}})}a("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:r.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),a("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:r.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),a("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:r.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),a("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:r.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),a("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:r.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),a("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:r.sha256,gRed:!1,g:["9"]}),a("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:r.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var h;try{h=r8()}catch{h=void 0}a("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:r.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",h]})})(Da);var i8=Mr,Cn=Mf,Jl=$n;function un(t){if(!(this instanceof un))return new un(t);this.hash=t.hash,this.predResist=!!t.predResist,this.outLen=this.hash.outSize,this.minEntropy=t.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=Cn.toArray(t.entropy,t.entropyEnc||"hex"),r=Cn.toArray(t.nonce,t.nonceEnc||"hex"),i=Cn.toArray(t.pers,t.persEnc||"hex");Jl(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,r,i)}var n8=un;un.prototype._init=function(e,r,i){var n=e.concat(r).concat(i);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var s=0;s<this.V.length;s++)this.K[s]=0,this.V[s]=1;this._update(n),this._reseed=1,this.reseedInterval=281474976710656},un.prototype._hmac=function(){return new i8.hmac(this.hash,this.K)},un.prototype._update=function(e){var r=this._hmac().update(this.V).update([0]);e&&(r=r.update(e)),this.K=r.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())},un.prototype.reseed=function(e,r,i,n){typeof r!="string"&&(n=i,i=r,r=null),e=Cn.toArray(e,r),i=Cn.toArray(i,n),Jl(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(i||[])),this._reseed=1},un.prototype.generate=function(e,r,i,n){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof r!="string"&&(n=i,i=r,r=null),i&&(i=Cn.toArray(i,n||"hex"),this._update(i));for(var s=[];s.length<e;)this.V=this._hmac().update(this.V).digest(),s=s.concat(this.V);var o=s.slice(0,e);return this._update(i),this._reseed++,Cn.encode(o,r)};var s8=_i.exports,o8=Dr,Rf=o8.assert;function rr(t,e){this.ec=t,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}var a8=rr;rr.fromPublic=function(e,r,i){return r instanceof rr?r:new rr(e,{pub:r,pubEnc:i})},rr.fromPrivate=function(e,r,i){return r instanceof rr?r:new rr(e,{priv:r,privEnc:i})},rr.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},rr.prototype.getPublic=function(e,r){return typeof e=="string"&&(r=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),r?this.pub.encode(r,e):this.pub},rr.prototype.getPrivate=function(e){return e==="hex"?this.priv.toString(16,2):this.priv},rr.prototype._importPrivate=function(e,r){this.priv=new s8(e,r||16),this.priv=this.priv.umod(this.ec.curve.n)},rr.prototype._importPublic=function(e,r){if(e.x||e.y){this.ec.curve.type==="mont"?Rf(e.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&Rf(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,r)},rr.prototype.derive=function(e){return e.validate()||Rf(e.validate(),"public point not validated"),e.mul(this.priv).getX()},rr.prototype.sign=function(e,r,i){return this.ec.sign(e,this,r,i)},rr.prototype.verify=function(e,r,i){return this.ec.verify(e,r,this,void 0,i)},rr.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var $a=_i.exports,Nf=Dr,c8=Nf.assert;function Oa(t,e){if(t instanceof Oa)return t;this._importDER(t,e)||(c8(t.r&&t.s,"Signature without r or s"),this.r=new $a(t.r,16),this.s=new $a(t.s,16),t.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=t.recoveryParam)}var f8=Oa;function h8(){this.place=0}function Cf(t,e){var r=t[e.place++];if(!(r&128))return r;var i=r&15;if(i===0||i>4||t[e.place]===0)return!1;for(var n=0,s=0,o=e.place;s<i;s++,o++)n<<=8,n|=t[o],n>>>=0;return n<=127?!1:(e.place=o,n)}function Yl(t){for(var e=0,r=t.length-1;!t[e]&&!(t[e+1]&128)&&e<r;)e++;return e===0?t:t.slice(e)}Oa.prototype._importDER=function(e,r){e=Nf.toArray(e,r);var i=new h8;if(e[i.place++]!==48)return!1;var n=Cf(e,i);if(n===!1||n+i.place!==e.length||e[i.place++]!==2)return!1;var s=Cf(e,i);if(s===!1||(e[i.place]&128)!==0)return!1;var o=e.slice(i.place,s+i.place);if(i.place+=s,e[i.place++]!==2)return!1;var a=Cf(e,i);if(a===!1||e.length!==a+i.place||(e[i.place]&128)!==0)return!1;var h=e.slice(i.place,a+i.place);if(o[0]===0)if(o[1]&128)o=o.slice(1);else return!1;if(h[0]===0)if(h[1]&128)h=h.slice(1);else return!1;return this.r=new $a(o),this.s=new $a(h),this.recoveryParam=null,!0};function Tf(t,e){if(e<128){t.push(e);return}var r=1+(Math.log(e)/Math.LN2>>>3);for(t.push(r|128);--r;)t.push(e>>>(r<<3)&255);t.push(e)}Oa.prototype.toDER=function(e){var r=this.r.toArray(),i=this.s.toArray();for(r[0]&128&&(r=[0].concat(r)),i[0]&128&&(i=[0].concat(i)),r=Yl(r),i=Yl(i);!i[0]&&!(i[1]&128);)i=i.slice(1);var n=[2];Tf(n,r.length),n=n.concat(r),n.push(2),Tf(n,i.length);var s=n.concat(i),o=[48];return Tf(o,s.length),o=o.concat(s),Nf.encode(o,e)};var ii=_i.exports,Zl=n8,u8=Dr,Ff=Da,d8=Ea.exports,Tn=u8.assert,Bf=a8,Ra=f8;function kr(t){if(!(this instanceof kr))return new kr(t);typeof t=="string"&&(Tn(Object.prototype.hasOwnProperty.call(Ff,t),"Unknown curve "+t),t=Ff[t]),t instanceof Ff.PresetCurve&&(t={curve:t}),this.curve=t.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=t.curve.g,this.g.precompute(t.curve.n.bitLength()+1),this.hash=t.hash||t.curve.hash}var l8=kr;kr.prototype.keyPair=function(e){return new Bf(this,e)},kr.prototype.keyFromPrivate=function(e,r){return Bf.fromPrivate(this,e,r)},kr.prototype.keyFromPublic=function(e,r){return Bf.fromPublic(this,e,r)},kr.prototype.genKeyPair=function(e){e||(e={});for(var r=new Zl({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||d8(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),i=this.n.byteLength(),n=this.n.sub(new ii(2));;){var s=new ii(r.generate(i));if(!(s.cmp(n)>0))return s.iaddn(1),this.keyFromPrivate(s)}},kr.prototype._truncateToN=function(e,r,i){var n;if(ii.isBN(e)||typeof e=="number")e=new ii(e,16),n=e.byteLength();else if(typeof e=="object")n=e.length,e=new ii(e,16);else{var s=e.toString();n=s.length+1>>>1,e=new ii(s,16)}typeof i!="number"&&(i=n*8);var o=i-this.n.bitLength();return o>0&&(e=e.ushrn(o)),!r&&e.cmp(this.n)>=0?e.sub(this.n):e},kr.prototype.sign=function(e,r,i,n){if(typeof i=="object"&&(n=i,i=null),n||(n={}),typeof e!="string"&&typeof e!="number"&&!ii.isBN(e)){Tn(typeof e=="object"&&e&&typeof e.length=="number","Expected message to be an array-like, a hex string, or a BN instance"),Tn(e.length>>>0===e.length);for(var s=0;s<e.length;s++)Tn((e[s]&255)===e[s])}r=this.keyFromPrivate(r,i),e=this._truncateToN(e,!1,n.msgBitLength),Tn(!e.isNeg(),"Can not sign a negative message");var o=this.n.byteLength(),a=r.getPrivate().toArray("be",o),h=e.toArray("be",o);Tn(new ii(h).eq(e),"Can not sign message");for(var u=new Zl({hash:this.hash,entropy:a,nonce:h,pers:n.pers,persEnc:n.persEnc||"utf8"}),p=this.n.sub(new ii(1)),b=0;;b++){var S=n.k?n.k(b):new ii(u.generate(this.n.byteLength()));if(S=this._truncateToN(S,!0),!(S.cmpn(1)<=0||S.cmp(p)>=0)){var A=this.g.mul(S);if(!A.isInfinity()){var I=A.getX(),P=I.umod(this.n);if(P.cmpn(0)!==0){var R=S.invm(this.n).mul(P.mul(r.getPrivate()).iadd(e));if(R=R.umod(this.n),R.cmpn(0)!==0){var O=(A.getY().isOdd()?1:0)|(I.cmp(P)!==0?2:0);return n.canonical&&R.cmp(this.nh)>0&&(R=this.n.sub(R),O^=1),new Ra({r:P,s:R,recoveryParam:O})}}}}}},kr.prototype.verify=function(e,r,i,n,s){s||(s={}),e=this._truncateToN(e,!1,s.msgBitLength),i=this.keyFromPublic(i,n),r=new Ra(r,"hex");var o=r.r,a=r.s;if(o.cmpn(1)<0||o.cmp(this.n)>=0||a.cmpn(1)<0||a.cmp(this.n)>=0)return!1;var h=a.invm(this.n),u=h.mul(e).umod(this.n),p=h.mul(o).umod(this.n),b;return this.curve._maxwellTrick?(b=this.g.jmulAdd(u,i.getPublic(),p),b.isInfinity()?!1:b.eqXToP(o)):(b=this.g.mulAdd(u,i.getPublic(),p),b.isInfinity()?!1:b.getX().umod(this.n).cmp(o)===0)},kr.prototype.recoverPubKey=function(t,e,r,i){Tn((3&r)===r,"The recovery param is more than two bits"),e=new Ra(e,i);var n=this.n,s=new ii(t),o=e.r,a=e.s,h=r&1,u=r>>1;if(o.cmp(this.curve.p.umod(this.curve.n))>=0&&u)throw new Error("Unable to find sencond key candinate");u?o=this.curve.pointFromX(o.add(this.curve.n),h):o=this.curve.pointFromX(o,h);var p=e.r.invm(n),b=n.sub(s).mul(p).umod(n),S=a.mul(p).umod(n);return this.g.mulAdd(b,o,S)},kr.prototype.getKeyRecoveryParam=function(t,e,r,i){if(e=new Ra(e,i),e.recoveryParam!==null)return e.recoveryParam;for(var n=0;n<4;n++){var s;try{s=this.recoverPubKey(t,e,n)}catch{continue}if(s.eq(r))return n}throw new Error("Unable to find valid recovery factor")};var vo=Dr,Xl=vo.assert,Ql=vo.parseBytes,ms=vo.cachedProperty;function Lt(t,e){this.eddsa=t,this._secret=Ql(e.secret),t.isPoint(e.pub)?this._pub=e.pub:this._pubBytes=Ql(e.pub)}Lt.fromPublic=function(e,r){return r instanceof Lt?r:new Lt(e,{pub:r})},Lt.fromSecret=function(e,r){return r instanceof Lt?r:new Lt(e,{secret:r})},Lt.prototype.secret=function(){return this._secret},ms(Lt,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),ms(Lt,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),ms(Lt,"privBytes",function(){var e=this.eddsa,r=this.hash(),i=e.encodingLength-1,n=r.slice(0,e.encodingLength);return n[0]&=248,n[i]&=127,n[i]|=64,n}),ms(Lt,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),ms(Lt,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),ms(Lt,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),Lt.prototype.sign=function(e){return Xl(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)},Lt.prototype.verify=function(e,r){return this.eddsa.verify(e,r,this)},Lt.prototype.getSecret=function(e){return Xl(this._secret,"KeyPair is public only"),vo.encode(this.secret(),e)},Lt.prototype.getPublic=function(e){return vo.encode(this.pubBytes(),e)};var p8=Lt,v8=_i.exports,Na=Dr,e0=Na.assert,Ca=Na.cachedProperty,g8=Na.parseBytes;function Fn(t,e){this.eddsa=t,typeof e!="object"&&(e=g8(e)),Array.isArray(e)&&(e0(e.length===t.encodingLength*2,"Signature has invalid size"),e={R:e.slice(0,t.encodingLength),S:e.slice(t.encodingLength)}),e0(e.R&&e.S,"Signature without R or S"),t.isPoint(e.R)&&(this._R=e.R),e.S instanceof v8&&(this._S=e.S),this._Rencoded=Array.isArray(e.R)?e.R:e.Rencoded,this._Sencoded=Array.isArray(e.S)?e.S:e.Sencoded}Ca(Fn,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),Ca(Fn,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),Ca(Fn,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),Ca(Fn,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),Fn.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},Fn.prototype.toHex=function(){return Na.encode(this.toBytes(),"hex").toUpperCase()};var b8=Fn,m8=Mr,y8=Da,ys=Dr,w8=ys.assert,t0=ys.parseBytes,r0=p8,i0=b8;function mr(t){if(w8(t==="ed25519","only tested with ed25519 so far"),!(this instanceof mr))return new mr(t);t=y8[t].curve,this.curve=t,this.g=t.g,this.g.precompute(t.n.bitLength()+1),this.pointClass=t.point().constructor,this.encodingLength=Math.ceil(t.n.bitLength()/8),this.hash=m8.sha512}var _8=mr;mr.prototype.sign=function(e,r){e=t0(e);var i=this.keyFromSecret(r),n=this.hashInt(i.messagePrefix(),e),s=this.g.mul(n),o=this.encodePoint(s),a=this.hashInt(o,i.pubBytes(),e).mul(i.priv()),h=n.add(a).umod(this.curve.n);return this.makeSignature({R:s,S:h,Rencoded:o})},mr.prototype.verify=function(e,r,i){if(e=t0(e),r=this.makeSignature(r),r.S().gte(r.eddsa.curve.n)||r.S().isNeg())return!1;var n=this.keyFromPublic(i),s=this.hashInt(r.Rencoded(),n.pubBytes(),e),o=this.g.mul(r.S()),a=r.R().add(n.pub().mul(s));return a.eq(o)},mr.prototype.hashInt=function(){for(var e=this.hash(),r=0;r<arguments.length;r++)e.update(arguments[r]);return ys.intFromLE(e.digest()).umod(this.curve.n)},mr.prototype.keyFromPublic=function(e){return r0.fromPublic(this,e)},mr.prototype.keyFromSecret=function(e){return r0.fromSecret(this,e)},mr.prototype.makeSignature=function(e){return e instanceof i0?e:new i0(this,e)},mr.prototype.encodePoint=function(e){var r=e.getY().toArray("le",this.encodingLength);return r[this.encodingLength-1]|=e.getX().isOdd()?128:0,r},mr.prototype.decodePoint=function(e){e=ys.parseBytes(e);var r=e.length-1,i=e.slice(0,r).concat(e[r]&-129),n=(e[r]&128)!==0,s=ys.intFromLE(i);return this.curve.pointFromY(s,n)},mr.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)},mr.prototype.decodeInt=function(e){return ys.intFromLE(e)},mr.prototype.isPoint=function(e){return e instanceof this.pointClass},function(t){var e=t;e.version=V4.version,e.utils=Dr,e.rand=Ea.exports,e.curve=Df,e.curves=Da,e.ec=l8,e.eddsa=_8}(Hl);const x8={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var E8=Object.defineProperty,n0=Object.getOwnPropertySymbols,S8=Object.prototype.hasOwnProperty,I8=Object.prototype.propertyIsEnumerable,s0=(t,e,r)=>e in t?E8(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,A8=(t,e)=>{for(var r in e||(e={}))S8.call(e,r)&&s0(t,r,e[r]);if(n0)for(var r of n0(e))I8.call(e,r)&&s0(t,r,e[r]);return t};const M8=":";function ws(t){const[e,r]=t.split(M8);return{namespace:e,reference:r}}function o0(t,e){return t.includes(":")?[t]:e.chains||[]}const P8="ReactNative",$r={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},D8="js";function Ta(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function dn(){return!io()&&!!Qc()&&navigator.product===P8}function $8(){return dn()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function O8(){return dn()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function go(){return!Ta()&&!!Qc()&&!!io()}function bo(){return dn()?$r.reactNative:Ta()?$r.node:go()?$r.browser:$r.unknown}function a0(){var t;try{return dn()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(t=global.Application)==null?void 0:t.applicationId:void 0}catch{return}}function R8(t,e){const r=new URLSearchParams(t);for(const i of Object.keys(e).sort())if(e.hasOwnProperty(i)){const n=e[i];n!==void 0&&r.set(i,n)}return r.toString()}function c0(){return Dd()||{name:"",description:"",url:"",icons:[""]}}function N8(){if(bo()===$r.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:i}=global.Platform;return[r,i].join("-")}const t=H2();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function C8(){var t;const e=bo();return e===$r.browser?[e,((t=Pd())==null?void 0:t.host)||"unknown"].join(":"):e}function f0(t,e,r){const i=N8(),n=C8();return[[t,e].join("-"),[D8,r].join("-"),i,n].join("/")}function T8({protocol:t,version:e,relayUrl:r,sdkVersion:i,auth:n,projectId:s,useOnCloseEvent:o,bundleId:a,packageName:h}){const u=r.split("?"),p=f0(t,e,i),b={auth:n,ua:p,projectId:s,useOnCloseEvent:o||void 0,packageName:h||void 0,bundleId:a||void 0},S=R8(u[1]||"",b);return u[0]+"?"+S}function Bn(t,e){return t.filter(r=>e.includes(r)).length===t.length}function h0(t){return Object.fromEntries(t.entries())}function u0(t){return new Map(Object.entries(t))}function qn(t=Z.FIVE_MINUTES,e){const r=Z.toMiliseconds(t||Z.FIVE_MINUTES);let i,n,s,o;return{resolve:a=>{s&&i&&(clearTimeout(s),i(a),o=Promise.resolve(a))},reject:a=>{s&&n&&(clearTimeout(s),n(a))},done:()=>new Promise((a,h)=>{if(o)return a(o);s=setTimeout(()=>{const u=new Error(e);o=Promise.reject(u),h(u)},r),i=a,n=h})}}function ln(t,e,r){return new Promise(async(i,n)=>{const s=setTimeout(()=>n(new Error(r)),e);try{const o=await t;i(o)}catch(o){n(o)}clearTimeout(s)})}function d0(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function F8(t){return d0("topic",t)}function B8(t){return d0("id",t)}function l0(t){const[e,r]=t.split(":"),i={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")i.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))i.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return i}function Nt(t,e){return Z.fromMiliseconds((e||Date.now())+Z.toMiliseconds(t))}function pn(t){return Date.now()>=Z.toMiliseconds(t)}function Ie(t,e){return`${t}${e?`:${e}`:""}`}function Fa(t=[],e=[]){return[...new Set([...t,...e])]}async function q8({id:t,topic:e,wcDeepLink:r}){var i;try{if(!r)return;const n=typeof r=="string"?JSON.parse(r):r,s=n?.href;if(typeof s!="string")return;const o=L8(s,t,e),a=bo();if(a===$r.browser){if(!((i=io())!=null&&i.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}U8(o)}else a===$r.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(o)}catch(n){console.error(n)}}function L8(t,e,r){const i=`requestId=${e}&sessionTopic=${r}`;t.endsWith("/")&&(t=t.slice(0,-1));let n=`${t}`;if(t.startsWith("https://t.me")){const s=t.includes("?")?"&startapp=":"?startapp=";n=`${n}${s}${H8(i,!0)}`}else n=`${n}/wc?${i}`;return n}function U8(t){let e="_self";k8()?e="_top":(z8()||t.startsWith("https://")||t.startsWith("http://"))&&(e="_blank"),window.open(t,e,"noreferrer noopener")}async function j8(t,e){let r="";try{if(go()&&(r=localStorage.getItem(e),r))return r;r=await t.getItem(e)}catch(i){console.error(i)}return r}function p0(t,e){if(!t.includes(e))return null;const r=t.split(/([&,?,=])/),i=r.indexOf(e);return r[i+2]}function v0(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}function qf(){return typeof process<"u"&&process.env.IS_VITEST==="true"}function z8(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function k8(){try{return window.self!==window.top}catch{return!1}}function H8(t,e=!1){const r=Buffer.from(t).toString("base64");return e?r.replace(/[=]/g,""):r}function g0(t){return Buffer.from(t,"base64").toString("utf-8")}function K8(t){return new Promise(e=>setTimeout(e,t))}function mo(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function V8(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Ba(t,...e){if(!V8(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function Lf(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");mo(t.outputLen),mo(t.blockLen)}function _s(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function b0(t,e){Ba(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const qa=BigInt(2**32-1),m0=BigInt(32);function G8(t,e=!1){return e?{h:Number(t&qa),l:Number(t>>m0&qa)}:{h:Number(t>>m0&qa)|0,l:Number(t&qa)|0}}function W8(t,e=!1){let r=new Uint32Array(t.length),i=new Uint32Array(t.length);for(let n=0;n<t.length;n++){const{h:s,l:o}=G8(t[n],e);[r[n],i[n]]=[s,o]}return[r,i]}const J8=(t,e,r)=>t<<r|e>>>32-r,Y8=(t,e,r)=>e<<r|t>>>32-r,Z8=(t,e,r)=>e<<r-32|t>>>64-r,X8=(t,e,r)=>t<<r-32|e>>>64-r,xs=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function Q8(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function Uf(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Ei(t,e){return t<<32-e|t>>>e}const y0=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function e5(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}function w0(t){for(let e=0;e<t.length;e++)t[e]=e5(t[e])}function t5(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function Es(t){return typeof t=="string"&&(t=t5(t)),Ba(t),t}class jf{clone(){return this._cloneInto()}}function _0(t){const e=i=>t().update(Es(i)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function yo(t=32){if(xs&&typeof xs.getRandomValues=="function")return xs.getRandomValues(new Uint8Array(t));if(xs&&typeof xs.randomBytes=="function")return xs.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}const x0=[],E0=[],S0=[],r5=BigInt(0),wo=BigInt(1),i5=BigInt(2),n5=BigInt(7),s5=BigInt(256),o5=BigInt(113);for(let t=0,e=wo,r=1,i=0;t<24;t++){[r,i]=[i,(2*r+3*i)%5],x0.push(2*(5*i+r)),E0.push((t+1)*(t+2)/2%64);let n=r5;for(let s=0;s<7;s++)e=(e<<wo^(e>>n5)*o5)%s5,e&i5&&(n^=wo<<(wo<<BigInt(s))-wo);S0.push(n)}const[a5,c5]=W8(S0,!0),I0=(t,e,r)=>r>32?Z8(t,e,r):J8(t,e,r),A0=(t,e,r)=>r>32?X8(t,e,r):Y8(t,e,r);function f5(t,e=24){const r=new Uint32Array(10);for(let i=24-e;i<24;i++){for(let o=0;o<10;o++)r[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,h=(o+2)%10,u=r[h],p=r[h+1],b=I0(u,p,1)^r[a],S=A0(u,p,1)^r[a+1];for(let A=0;A<50;A+=10)t[o+A]^=b,t[o+A+1]^=S}let n=t[2],s=t[3];for(let o=0;o<24;o++){const a=E0[o],h=I0(n,s,a),u=A0(n,s,a),p=x0[o];n=t[p],s=t[p+1],t[p]=h,t[p+1]=u}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)r[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~r[(a+2)%10]&r[(a+4)%10]}t[0]^=a5[i],t[1]^=c5[i]}r.fill(0)}class zf extends jf{constructor(e,r,i,n=!1,s=24){if(super(),this.blockLen=e,this.suffix=r,this.outputLen=i,this.enableXOF=n,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,mo(i),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=Q8(this.state)}keccak(){y0||w0(this.state32),f5(this.state32,this.rounds),y0||w0(this.state32),this.posOut=0,this.pos=0}update(e){_s(this);const{blockLen:r,state:i}=this;e=Es(e);const n=e.length;for(let s=0;s<n;){const o=Math.min(r-this.pos,n-s);for(let a=0;a<o;a++)i[this.pos++]^=e[s++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:r,pos:i,blockLen:n}=this;e[i]^=r,(r&128)!==0&&i===n-1&&this.keccak(),e[n-1]^=128,this.keccak()}writeInto(e){_s(this,!1),Ba(e),this.finish();const r=this.state,{blockLen:i}=this;for(let n=0,s=e.length;n<s;){this.posOut>=i&&this.keccak();const o=Math.min(i-this.posOut,s-n);e.set(r.subarray(this.posOut,this.posOut+o),n),this.posOut+=o,n+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return mo(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(b0(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:r,suffix:i,outputLen:n,rounds:s,enableXOF:o}=this;return e||(e=new zf(r,i,n,o,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=i,e.outputLen=n,e.enableXOF=o,e.destroyed=this.destroyed,e}}const h5=(t,e,r)=>_0(()=>new zf(e,t,r)),u5=h5(1,136,256/8),d5="https://rpc.walletconnect.org/v1";function M0(t){const e=`Ethereum Signed Message:
${t.length}`,r=new TextEncoder().encode(e+t);return"0x"+Buffer.from(u5(r)).toString("hex")}async function l5(t,e,r,i,n,s){switch(r.t){case"eip191":return p5(t,e,r.s);case"eip1271":return await v5(t,e,r.s,i,n,s);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${r.t}`)}}function p5(t,e,r){return d6(M0(e),r).toLowerCase()===t.toLowerCase()}async function v5(t,e,r,i,n,s){const o=ws(i);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${i}`);try{const a="0x1626ba7e",h="0000000000000000000000000000000000000000000000000000000000000040",u="0000000000000000000000000000000000000000000000000000000000000041",p=r.substring(2),b=M0(e).substring(2),S=a+b+h+u+p,A=await fetch(`${s||d5}/?chainId=${i}&projectId=${n}`,{method:"POST",body:JSON.stringify({id:g5(),jsonrpc:"2.0",method:"eth_call",params:[{to:t,data:S},"latest"]})}),{result:I}=await A.json();return I?I.slice(0,a.length).toLowerCase()===a.toLowerCase():!1}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function g5(){return Date.now()+Math.floor(Math.random()*1e3)}var b5=Object.defineProperty,m5=Object.defineProperties,y5=Object.getOwnPropertyDescriptors,P0=Object.getOwnPropertySymbols,w5=Object.prototype.hasOwnProperty,_5=Object.prototype.propertyIsEnumerable,D0=(t,e,r)=>e in t?b5(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,x5=(t,e)=>{for(var r in e||(e={}))w5.call(e,r)&&D0(t,r,e[r]);if(P0)for(var r of P0(e))_5.call(e,r)&&D0(t,r,e[r]);return t},E5=(t,e)=>m5(t,y5(e));const S5="did:pkh:",kf=t=>t?.split(":"),I5=t=>{const e=t&&kf(t);if(e)return t.includes(S5)?e[3]:e[1]},Hf=t=>{const e=t&&kf(t);if(e)return e[2]+":"+e[3]},La=t=>{const e=t&&kf(t);if(e)return e.pop()};async function $0(t){const{cacao:e,projectId:r}=t,{s:i,p:n}=e,s=O0(n,n.iss),o=La(n.iss);return await l5(o,s,i,Hf(n.iss),r)}const O0=(t,e)=>{const r=`${t.domain} wants you to sign in with your Ethereum account:`,i=La(e);if(!t.aud&&!t.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let n=t.statement||void 0;const s=`URI: ${t.aud||t.uri}`,o=`Version: ${t.version}`,a=`Chain ID: ${I5(e)}`,h=`Nonce: ${t.nonce}`,u=`Issued At: ${t.iat}`,p=t.exp?`Expiration Time: ${t.exp}`:void 0,b=t.nbf?`Not Before: ${t.nbf}`:void 0,S=t.requestId?`Request ID: ${t.requestId}`:void 0,A=t.resources?`Resources:${t.resources.map(P=>`
- ${P}`).join("")}`:void 0,I=Ua(t.resources);if(I){const P=_o(I);n=C5(n,P)}return[r,i,"",n,"",s,o,a,h,u,p,b,S,A].filter(P=>P!=null).join(`
`)};function A5(t){return Buffer.from(JSON.stringify(t)).toString("base64")}function M5(t){return JSON.parse(Buffer.from(t,"base64").toString("utf-8"))}function Ln(t){if(!t)throw new Error("No recap provided, value is undefined");if(!t.att)throw new Error("No `att` property found");const e=Object.keys(t.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(r=>{const i=t.att[r];if(Array.isArray(i))throw new Error(`Resource must be an object: ${r}`);if(typeof i!="object")throw new Error(`Resource must be an object: ${r}`);if(!Object.keys(i).length)throw new Error(`Resource object is empty: ${r}`);Object.keys(i).forEach(n=>{const s=i[n];if(!Array.isArray(s))throw new Error(`Ability limits ${n} must be an array of objects, found: ${s}`);if(!s.length)throw new Error(`Value of ${n} is empty array, must be an array with objects`);s.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${n}) must be an array of objects, found: ${o}`)})})})}function P5(t,e,r,i={}){return r?.sort((n,s)=>n.localeCompare(s)),{att:{[t]:D5(e,r,i)}}}function D5(t,e,r={}){e=e?.sort((n,s)=>n.localeCompare(s));const i=e.map(n=>({[`${t}/${n}`]:[r]}));return Object.assign({},...i)}function R0(t){return Ln(t),`urn:recap:${A5(t).replace(/=/g,"")}`}function _o(t){const e=M5(t.replace("urn:recap:",""));return Ln(e),e}function $5(t,e,r){const i=P5(t,e,r);return R0(i)}function O5(t){return t&&t.includes("urn:recap:")}function R5(t,e){const r=_o(t),i=_o(e),n=N5(r,i);return R0(n)}function N5(t,e){Ln(t),Ln(e);const r=Object.keys(t.att).concat(Object.keys(e.att)).sort((n,s)=>n.localeCompare(s)),i={att:{}};return r.forEach(n=>{var s,o;Object.keys(((s=t.att)==null?void 0:s[n])||{}).concat(Object.keys(((o=e.att)==null?void 0:o[n])||{})).sort((a,h)=>a.localeCompare(h)).forEach(a=>{var h,u;i.att[n]=E5(x5({},i.att[n]),{[a]:((h=t.att[n])==null?void 0:h[a])||((u=e.att[n])==null?void 0:u[a])})})}),i}function C5(t="",e){Ln(e);const r="I further authorize the stated URI to perform the following actions on my behalf: ";if(t.includes(r))return t;const i=[];let n=0;Object.keys(e.att).forEach(a=>{const h=Object.keys(e.att[a]).map(b=>({ability:b.split("/")[0],action:b.split("/")[1]}));h.sort((b,S)=>b.action.localeCompare(S.action));const u={};h.forEach(b=>{u[b.ability]||(u[b.ability]=[]),u[b.ability].push(b.action)});const p=Object.keys(u).map(b=>(n++,`(${n}) '${b}': '${u[b].join("', '")}' for '${a}'.`));i.push(p.join(", ").replace(".,","."))});const s=i.join(" "),o=`${r}${s}`;return`${t?t+" ":""}${o}`}function N0(t){var e;const r=_o(t);Ln(r);const i=(e=r.att)==null?void 0:e.eip155;return i?Object.keys(i).map(n=>n.split("/")[1]):[]}function C0(t){const e=_o(t);Ln(e);const r=[];return Object.values(e.att).forEach(i=>{Object.values(i).forEach(n=>{var s;(s=n?.[0])!=null&&s.chains&&r.push(n[0].chains)})}),[...new Set(r.flat())]}function Ua(t){if(!t)return;const e=t?.[t.length-1];return O5(e)?e:void 0}function Kf(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function T0(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Or(t,...e){if(!T0(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function F0(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function T5(t,e){Or(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function B0(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}const vn=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),F5=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);if(!(new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68))throw new Error("Non little-endian hardware is not supported");function B5(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function Vf(t){if(typeof t=="string")t=B5(t);else if(T0(t))t=Gf(t);else throw new Error("Uint8Array expected, got "+typeof t);return t}function q5(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function L5(t,e){if(t.length!==e.length)return!1;let r=0;for(let i=0;i<t.length;i++)r|=t[i]^e[i];return r===0}const U5=(t,e)=>{function r(i,...n){if(Or(i),t.nonceLength!==void 0){const u=n[0];if(!u)throw new Error("nonce / iv required");t.varSizeNonce?Or(u):Or(u,t.nonceLength)}const s=t.tagLength;s&&n[1]!==void 0&&Or(n[1]);const o=e(i,...n),a=(u,p)=>{if(p!==void 0){if(u!==2)throw new Error("cipher output not supported");Or(p)}};let h=!1;return{encrypt(u,p){if(h)throw new Error("cannot encrypt() twice with same key + nonce");return h=!0,Or(u),a(o.encrypt.length,p),o.encrypt(u,p)},decrypt(u,p){if(Or(u),s&&u.length<s)throw new Error("invalid ciphertext length: smaller than tagLength="+s);return a(o.decrypt.length,p),o.decrypt(u,p)}}}return Object.assign(r,t),r};function q0(t,e,r=!0){if(e===void 0)return new Uint8Array(t);if(e.length!==t)throw new Error("invalid output length, expected "+t+", got: "+e.length);if(r&&!j5(e))throw new Error("invalid output, must be aligned");return e}function L0(t,e,r,i){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,i);const n=BigInt(32),s=BigInt(4294967295),o=Number(r>>n&s),a=Number(r&s),h=i?4:0,u=i?0:4;t.setUint32(e+h,o,i),t.setUint32(e+u,a,i)}function j5(t){return t.byteOffset%4===0}function Gf(t){return Uint8Array.from(t)}function Ss(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}const U0=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),z5=U0("expand 16-byte k"),k5=U0("expand 32-byte k"),H5=vn(z5),K5=vn(k5);function je(t,e){return t<<e|t>>>32-e}function Wf(t){return t.byteOffset%4===0}const ja=64,V5=16,j0=2**32-1,z0=new Uint32Array;function G5(t,e,r,i,n,s,o,a){const h=n.length,u=new Uint8Array(ja),p=vn(u),b=Wf(n)&&Wf(s),S=b?vn(n):z0,A=b?vn(s):z0;for(let I=0;I<h;o++){if(t(e,r,i,p,o,a),o>=j0)throw new Error("arx: counter overflow");const P=Math.min(ja,h-I);if(b&&P===ja){const R=I/4;if(I%4!==0)throw new Error("arx: invalid block position");for(let O=0,N;O<V5;O++)N=R+O,A[N]=S[N]^p[O];I+=ja;continue}for(let R=0,O;R<P;R++)O=I+R,s[O]=n[O]^u[R];I+=P}}function W5(t,e){const{allowShortKeys:r,extendNonceFn:i,counterLength:n,counterRight:s,rounds:o}=q5({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return Kf(n),Kf(o),B0(s),B0(r),(a,h,u,p,b=0)=>{Or(a),Or(h),Or(u);const S=u.length;if(p===void 0&&(p=new Uint8Array(S)),Or(p),Kf(b),b<0||b>=j0)throw new Error("arx: counter overflow");if(p.length<S)throw new Error(`arx: output (${p.length}) is shorter than data (${S})`);const A=[];let I=a.length,P,R;if(I===32)A.push(P=Gf(a)),R=K5;else if(I===16&&r)P=new Uint8Array(32),P.set(a),P.set(a,16),R=H5,A.push(P);else throw new Error(`arx: invalid 32-byte key, got length=${I}`);Wf(h)||A.push(h=Gf(h));const O=vn(P);if(i){if(h.length!==24)throw new Error("arx: extended nonce must be 24 bytes");i(R,O,vn(h.subarray(0,16)),O),h=h.subarray(16)}const N=16-n;if(N!==h.length)throw new Error(`arx: nonce must be ${N} or 16 bytes`);if(N!==12){const L=new Uint8Array(12);L.set(h,s?0:12-h.length),h=L,A.push(h)}const F=vn(h);return G5(t,R,O,F,u,p,b,o),Ss(...A),p}}const Jt=(t,e)=>t[e++]&255|(t[e++]&255)<<8;class J5{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=Vf(e),Or(e,32);const r=Jt(e,0),i=Jt(e,2),n=Jt(e,4),s=Jt(e,6),o=Jt(e,8),a=Jt(e,10),h=Jt(e,12),u=Jt(e,14);this.r[0]=r&8191,this.r[1]=(r>>>13|i<<3)&8191,this.r[2]=(i>>>10|n<<6)&7939,this.r[3]=(n>>>7|s<<9)&8191,this.r[4]=(s>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|h<<5)&8065,this.r[8]=(h>>>8|u<<8)&8191,this.r[9]=u>>>5&127;for(let p=0;p<8;p++)this.pad[p]=Jt(e,16+2*p)}process(e,r,i=!1){const n=i?0:2048,{h:s,r:o}=this,a=o[0],h=o[1],u=o[2],p=o[3],b=o[4],S=o[5],A=o[6],I=o[7],P=o[8],R=o[9],O=Jt(e,r+0),N=Jt(e,r+2),F=Jt(e,r+4),L=Jt(e,r+6),z=Jt(e,r+8),k=Jt(e,r+10),G=Jt(e,r+12),K=Jt(e,r+14);let H=s[0]+(O&8191),ie=s[1]+((O>>>13|N<<3)&8191),D=s[2]+((N>>>10|F<<6)&8191),g=s[3]+((F>>>7|L<<9)&8191),v=s[4]+((L>>>4|z<<12)&8191),c=s[5]+(z>>>1&8191),f=s[6]+((z>>>14|k<<2)&8191),l=s[7]+((k>>>11|G<<5)&8191),_=s[8]+((G>>>8|K<<8)&8191),x=s[9]+(K>>>5|n),y=0,d=y+H*a+ie*(5*R)+D*(5*P)+g*(5*I)+v*(5*A);y=d>>>13,d&=8191,d+=c*(5*S)+f*(5*b)+l*(5*p)+_*(5*u)+x*(5*h),y+=d>>>13,d&=8191;let w=y+H*h+ie*a+D*(5*R)+g*(5*P)+v*(5*I);y=w>>>13,w&=8191,w+=c*(5*A)+f*(5*S)+l*(5*b)+_*(5*p)+x*(5*u),y+=w>>>13,w&=8191;let m=y+H*u+ie*h+D*a+g*(5*R)+v*(5*P);y=m>>>13,m&=8191,m+=c*(5*I)+f*(5*A)+l*(5*S)+_*(5*b)+x*(5*p),y+=m>>>13,m&=8191;let M=y+H*p+ie*u+D*h+g*a+v*(5*R);y=M>>>13,M&=8191,M+=c*(5*P)+f*(5*I)+l*(5*A)+_*(5*S)+x*(5*b),y+=M>>>13,M&=8191;let B=y+H*b+ie*p+D*u+g*h+v*a;y=B>>>13,B&=8191,B+=c*(5*R)+f*(5*P)+l*(5*I)+_*(5*A)+x*(5*S),y+=B>>>13,B&=8191;let E=y+H*S+ie*b+D*p+g*u+v*h;y=E>>>13,E&=8191,E+=c*a+f*(5*R)+l*(5*P)+_*(5*I)+x*(5*A),y+=E>>>13,E&=8191;let C=y+H*A+ie*S+D*b+g*p+v*u;y=C>>>13,C&=8191,C+=c*h+f*a+l*(5*R)+_*(5*P)+x*(5*I),y+=C>>>13,C&=8191;let q=y+H*I+ie*A+D*S+g*b+v*p;y=q>>>13,q&=8191,q+=c*u+f*h+l*a+_*(5*R)+x*(5*P),y+=q>>>13,q&=8191;let U=y+H*P+ie*I+D*A+g*S+v*b;y=U>>>13,U&=8191,U+=c*p+f*u+l*h+_*a+x*(5*R),y+=U>>>13,U&=8191;let j=y+H*R+ie*P+D*I+g*A+v*S;y=j>>>13,j&=8191,j+=c*b+f*p+l*u+_*h+x*a,y+=j>>>13,j&=8191,y=(y<<2)+y|0,y=y+d|0,d=y&8191,y=y>>>13,w+=y,s[0]=d,s[1]=w,s[2]=m,s[3]=M,s[4]=B,s[5]=E,s[6]=C,s[7]=q,s[8]=U,s[9]=j}finalize(){const{h:e,pad:r}=this,i=new Uint16Array(10);let n=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=n,n=e[a]>>>13,e[a]&=8191;e[0]+=n*5,n=e[0]>>>13,e[0]&=8191,e[1]+=n,n=e[1]>>>13,e[1]&=8191,e[2]+=n,i[0]=e[0]+5,n=i[0]>>>13,i[0]&=8191;for(let a=1;a<10;a++)i[a]=e[a]+n,n=i[a]>>>13,i[a]&=8191;i[9]-=8192;let s=(n^1)-1;for(let a=0;a<10;a++)i[a]&=s;s=~s;for(let a=0;a<10;a++)e[a]=e[a]&s|i[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+r[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+r[a]|0)+(o>>>16)|0,e[a]=o&65535;Ss(i)}update(e){F0(this);const{buffer:r,blockLen:i}=this;e=Vf(e);const n=e.length;for(let s=0;s<n;){const o=Math.min(i-this.pos,n-s);if(o===i){for(;i<=n-s;s+=i)this.process(e,s);continue}r.set(e.subarray(s,s+o),this.pos),this.pos+=o,s+=o,this.pos===i&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){Ss(this.h,this.r,this.buffer,this.pad)}digestInto(e){F0(this),T5(e,this),this.finished=!0;const{buffer:r,h:i}=this;let{pos:n}=this;if(n){for(r[n++]=1;n<16;n++)r[n]=0;this.process(r,0,!0)}this.finalize();let s=0;for(let o=0;o<8;o++)e[s++]=i[o]>>>0,e[s++]=i[o]>>>8;return e}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const i=e.slice(0,r);return this.destroy(),i}}function Y5(t){const e=(i,n)=>t(n).update(Vf(i)).digest(),r=t(new Uint8Array(32));return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=i=>t(i),e}const Z5=Y5(t=>new J5(t));function X5(t,e,r,i,n,s=20){let o=t[0],a=t[1],h=t[2],u=t[3],p=e[0],b=e[1],S=e[2],A=e[3],I=e[4],P=e[5],R=e[6],O=e[7],N=n,F=r[0],L=r[1],z=r[2],k=o,G=a,K=h,H=u,ie=p,D=b,g=S,v=A,c=I,f=P,l=R,_=O,x=N,y=F,d=L,w=z;for(let M=0;M<s;M+=2)k=k+ie|0,x=je(x^k,16),c=c+x|0,ie=je(ie^c,12),k=k+ie|0,x=je(x^k,8),c=c+x|0,ie=je(ie^c,7),G=G+D|0,y=je(y^G,16),f=f+y|0,D=je(D^f,12),G=G+D|0,y=je(y^G,8),f=f+y|0,D=je(D^f,7),K=K+g|0,d=je(d^K,16),l=l+d|0,g=je(g^l,12),K=K+g|0,d=je(d^K,8),l=l+d|0,g=je(g^l,7),H=H+v|0,w=je(w^H,16),_=_+w|0,v=je(v^_,12),H=H+v|0,w=je(w^H,8),_=_+w|0,v=je(v^_,7),k=k+D|0,w=je(w^k,16),l=l+w|0,D=je(D^l,12),k=k+D|0,w=je(w^k,8),l=l+w|0,D=je(D^l,7),G=G+g|0,x=je(x^G,16),_=_+x|0,g=je(g^_,12),G=G+g|0,x=je(x^G,8),_=_+x|0,g=je(g^_,7),K=K+v|0,y=je(y^K,16),c=c+y|0,v=je(v^c,12),K=K+v|0,y=je(y^K,8),c=c+y|0,v=je(v^c,7),H=H+ie|0,d=je(d^H,16),f=f+d|0,ie=je(ie^f,12),H=H+ie|0,d=je(d^H,8),f=f+d|0,ie=je(ie^f,7);let m=0;i[m++]=o+k|0,i[m++]=a+G|0,i[m++]=h+K|0,i[m++]=u+H|0,i[m++]=p+ie|0,i[m++]=b+D|0,i[m++]=S+g|0,i[m++]=A+v|0,i[m++]=I+c|0,i[m++]=P+f|0,i[m++]=R+l|0,i[m++]=O+_|0,i[m++]=N+x|0,i[m++]=F+y|0,i[m++]=L+d|0,i[m++]=z+w|0}const Q5=W5(X5,{counterRight:!1,counterLength:4,allowShortKeys:!1}),e_=new Uint8Array(16),k0=(t,e)=>{t.update(e);const r=e.length%16;r&&t.update(e_.subarray(r))},t_=new Uint8Array(32);function H0(t,e,r,i,n){const s=t(e,r,t_),o=Z5.create(s);n&&k0(o,n),k0(o,i);const a=new Uint8Array(16),h=F5(a);L0(h,0,BigInt(n?n.length:0),!0),L0(h,8,BigInt(i.length),!0),o.update(a);const u=o.digest();return Ss(s,a),u}const r_=t=>(e,r,i)=>({encrypt(n,s){const o=n.length;s=q0(o+16,s,!1),s.set(n);const a=s.subarray(0,-16);t(e,r,a,a,1);const h=H0(t,e,r,a,i);return s.set(h,o),Ss(h),s},decrypt(n,s){s=q0(n.length-16,s,!1);const o=n.subarray(0,-16),a=n.subarray(-16),h=H0(t,e,r,o,i);if(!L5(a,h))throw new Error("invalid tag");return s.set(n.subarray(0,-16)),t(e,r,s,s,1),Ss(h),s}}),K0=U5({blockSize:64,nonceLength:12,tagLength:16},r_(Q5));class V0 extends jf{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,Lf(e);const i=Es(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,s=new Uint8Array(n);s.set(i.length>n?e.create().update(i).digest():i);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=e.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),s.fill(0)}update(e){return _s(this),this.iHash.update(e),this}digestInto(e){_s(this),Ba(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:i,finished:n,destroyed:s,blockLen:o,outputLen:a}=this;return e=e,e.finished=n,e.destroyed=s,e.blockLen=o,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=i._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Jf=(t,e,r)=>new V0(t,e).update(r).digest();Jf.create=(t,e)=>new V0(t,e);function i_(t,e,r){return Lf(t),r===void 0&&(r=new Uint8Array(t.outputLen)),Jf(t,Es(r),Es(e))}const Yf=new Uint8Array([0]),G0=new Uint8Array;function n_(t,e,r,i=32){if(Lf(t),mo(i),i>255*t.outputLen)throw new Error("Length should be <= 255*HashLen");const n=Math.ceil(i/t.outputLen);r===void 0&&(r=G0);const s=new Uint8Array(n*t.outputLen),o=Jf.create(t,e),a=o._cloneInto(),h=new Uint8Array(o.outputLen);for(let u=0;u<n;u++)Yf[0]=u+1,a.update(u===0?G0:h).update(r).update(Yf).digestInto(h),s.set(h,t.outputLen*u),o._cloneInto(a);return o.destroy(),a.destroy(),h.fill(0),Yf.fill(0),s.slice(0,i)}const s_=(t,e,r,i,n)=>n_(t,i_(t,e,r),i,n);function o_(t,e,r,i){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,i);const n=BigInt(32),s=BigInt(4294967295),o=Number(r>>n&s),a=Number(r&s),h=i?4:0,u=i?0:4;t.setUint32(e+h,o,i),t.setUint32(e+u,a,i)}function a_(t,e,r){return t&e^~t&r}function c_(t,e,r){return t&e^t&r^e&r}class f_ extends jf{constructor(e,r,i,n){super(),this.blockLen=e,this.outputLen=r,this.padOffset=i,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Uf(this.buffer)}update(e){_s(this);const{view:r,buffer:i,blockLen:n}=this;e=Es(e);const s=e.length;for(let o=0;o<s;){const a=Math.min(n-this.pos,s-o);if(a===n){const h=Uf(e);for(;n<=s-o;o+=n)this.process(h,o);continue}i.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===n&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){_s(this),b0(e,this),this.finished=!0;const{buffer:r,view:i,blockLen:n,isLE:s}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>n-o&&(this.process(i,0),o=0);for(let b=o;b<n;b++)r[b]=0;o_(i,n-8,BigInt(this.length*8),s),this.process(i,0);const a=Uf(e),h=this.outputLen;if(h%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=h/4,p=this.get();if(u>p.length)throw new Error("_sha2: outputLen bigger than state");for(let b=0;b<u;b++)a.setUint32(4*b,p[b],s)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const i=e.slice(0,r);return this.destroy(),i}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:i,length:n,finished:s,destroyed:o,pos:a}=this;return e.length=n,e.pos=a,e.finished=s,e.destroyed=o,n%r&&e.buffer.set(i),e}}const h_=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),gn=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),bn=new Uint32Array(64);class u_ extends f_{constructor(){super(64,32,8,!1),this.A=gn[0]|0,this.B=gn[1]|0,this.C=gn[2]|0,this.D=gn[3]|0,this.E=gn[4]|0,this.F=gn[5]|0,this.G=gn[6]|0,this.H=gn[7]|0}get(){const{A:e,B:r,C:i,D:n,E:s,F:o,G:a,H:h}=this;return[e,r,i,n,s,o,a,h]}set(e,r,i,n,s,o,a,h){this.A=e|0,this.B=r|0,this.C=i|0,this.D=n|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=h|0}process(e,r){for(let b=0;b<16;b++,r+=4)bn[b]=e.getUint32(r,!1);for(let b=16;b<64;b++){const S=bn[b-15],A=bn[b-2],I=Ei(S,7)^Ei(S,18)^S>>>3,P=Ei(A,17)^Ei(A,19)^A>>>10;bn[b]=P+bn[b-7]+I+bn[b-16]|0}let{A:i,B:n,C:s,D:o,E:a,F:h,G:u,H:p}=this;for(let b=0;b<64;b++){const S=Ei(a,6)^Ei(a,11)^Ei(a,25),A=p+S+a_(a,h,u)+h_[b]+bn[b]|0,I=(Ei(i,2)^Ei(i,13)^Ei(i,22))+c_(i,n,s)|0;p=u,u=h,h=a,a=o+A|0,o=s,s=n,n=i,i=A+I|0}i=i+this.A|0,n=n+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,h=h+this.F|0,u=u+this.G|0,p=p+this.H|0,this.set(i,n,s,o,a,h,u,p)}roundClean(){bn.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const za=_0(()=>new u_);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const W0=BigInt(0);function Zf(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function J0(t){if(!Zf(t))throw new Error("Uint8Array expected")}const d_=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function l_(t){J0(t);let e="";for(let r=0;r<t.length;r++)e+=d_[t[r]];return e}function p_(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?W0:BigInt("0x"+t)}const qi={_0:48,_9:57,A:65,F:70,a:97,f:102};function Y0(t){if(t>=qi._0&&t<=qi._9)return t-qi._0;if(t>=qi.A&&t<=qi.F)return t-(qi.A-10);if(t>=qi.a&&t<=qi.f)return t-(qi.a-10)}function Z0(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const i=new Uint8Array(r);for(let n=0,s=0;n<r;n++,s+=2){const o=Y0(t.charCodeAt(s)),a=Y0(t.charCodeAt(s+1));if(o===void 0||a===void 0){const h=t[s]+t[s+1];throw new Error('hex string expected, got non-hex character "'+h+'" at index '+s)}i[n]=o*16+a}return i}function X0(t){return J0(t),p_(l_(Uint8Array.from(t).reverse()))}function v_(t,e){return Z0(t.toString(16).padStart(e*2,"0"))}function g_(t,e){return v_(t,e).reverse()}function Q0(t,e,r){let i;if(typeof e=="string")try{i=Z0(e)}catch(s){throw new Error(t+" must be hex string or Uint8Array, cause: "+s)}else if(Zf(e))i=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const n=i.length;if(typeof r=="number"&&n!==r)throw new Error(t+" of length "+r+" expected, got "+n);return i}const Xf=t=>typeof t=="bigint"&&W0<=t;function b_(t,e,r){return Xf(t)&&Xf(e)&&Xf(r)&&e<=t&&t<r}function ep(t,e,r,i){if(!b_(e,r,i))throw new Error("expected valid "+t+": "+r+" <= n < "+i+", got "+e)}const m_={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||Zf(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function y_(t,e,r={}){const i=(n,s,o)=>{const a=m_[s];if(typeof a!="function")throw new Error("invalid validator function");const h=t[n];if(!(o&&h===void 0)&&!a(h,t))throw new Error("param "+String(n)+" is invalid. Expected "+s+", got "+h)};for(const[n,s]of Object.entries(e))i(n,s,!1);for(const[n,s]of Object.entries(r))i(n,s,!0);return t}const Is=BigInt(0),ka=BigInt(1);function tp(t,e){const r=t%e;return r>=Is?r:e+r}function w_(t,e,r){if(e<Is)throw new Error("invalid exponent, negatives unsupported");if(r<=Is)throw new Error("invalid modulus");if(r===ka)return Is;let i=ka;for(;e>Is;)e&ka&&(i=i*t%r),t=t*t%r,e>>=ka;return i}function ni(t,e,r){let i=t;for(;e-- >Is;)i*=i,i%=r;return i}BigInt(0),BigInt(1),BigInt(0),BigInt(1),BigInt(2),BigInt(8);const As=BigInt(0),Qf=BigInt(1);function __(t){return y_(t,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze(A8({},t))}function x_(t){const e=__(t),{P:r}=e,i=N=>tp(N,r),n=e.montgomeryBits,s=Math.ceil(n/8),o=e.nByteLength,a=e.adjustScalarBytes||(N=>N),h=e.powPminus2||(N=>w_(N,r-BigInt(2),r));function u(N,F,L){const z=i(N*(F-L));return F=i(F-z),L=i(L+z),[F,L]}const p=(e.a-BigInt(2))/BigInt(4);function b(N,F){ep("u",N,As,r),ep("scalar",F,As,r);const L=F,z=N;let k=Qf,G=As,K=N,H=Qf,ie=As,D;for(let v=BigInt(n-1);v>=As;v--){const c=L>>v&Qf;ie^=c,D=u(ie,k,K),k=D[0],K=D[1],D=u(ie,G,H),G=D[0],H=D[1],ie=c;const f=k+G,l=i(f*f),_=k-G,x=i(_*_),y=l-x,d=K+H,w=K-H,m=i(w*f),M=i(d*_),B=m+M,E=m-M;K=i(B*B),H=i(z*i(E*E)),k=i(l*x),G=i(y*(l+i(p*y)))}D=u(ie,k,K),k=D[0],K=D[1],D=u(ie,G,H),G=D[0],H=D[1];const g=h(G);return i(k*g)}function S(N){return g_(i(N),s)}function A(N){const F=Q0("u coordinate",N,s);return o===32&&(F[31]&=127),X0(F)}function I(N){const F=Q0("scalar",N),L=F.length;if(L!==s&&L!==o){let z=""+s+" or "+o;throw new Error("invalid scalar, expected "+z+" bytes, got "+L)}return X0(a(F))}function P(N,F){const L=A(F),z=I(N),k=b(L,z);if(k===As)throw new Error("invalid private or public key received");return S(k)}const R=S(e.Gu);function O(N){return P(N,R)}return{scalarMult:P,scalarMultBase:O,getSharedSecret:(N,F)=>P(N,F),getPublicKey:N=>O(N),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:R}}const eh=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");BigInt(0);const E_=BigInt(1),rp=BigInt(2),S_=BigInt(3),I_=BigInt(5);BigInt(8);function A_(t){const e=BigInt(10),r=BigInt(20),i=BigInt(40),n=BigInt(80),s=eh,o=t*t%s*t%s,a=ni(o,rp,s)*o%s,h=ni(a,E_,s)*t%s,u=ni(h,I_,s)*h%s,p=ni(u,e,s)*u%s,b=ni(p,r,s)*p%s,S=ni(b,i,s)*b%s,A=ni(S,n,s)*S%s,I=ni(A,n,s)*S%s,P=ni(I,e,s)*u%s;return{pow_p_5_8:ni(P,rp,s)*t%s,b2:o}}function M_(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}const th=x_({P:eh,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:t=>{const e=eh,{pow_p_5_8:r,b2:i}=A_(t);return tp(ni(r,S_,e)*i,e)},adjustScalarBytes:M_,randomBytes:yo}),ip="base10",ir="base16",mn="base64pad",xo="base64url",Eo="utf8",np=0,Li=1,So=2,P_=0,sp=1,Io=12,rh=32;function D_(){const t=th.utils.randomPrivateKey(),e=th.getPublicKey(t);return{privateKey:hr(t,ir),publicKey:hr(e,ir)}}function ih(){const t=yo(rh);return hr(t,ir)}function $_(t,e){const r=th.getSharedSecret(Ur(t,ir),Ur(e,ir)),i=s_(za,r,void 0,void 0,rh);return hr(i,ir)}function Ha(t){const e=za(Ur(t,ir));return hr(e,ir)}function Ui(t){const e=za(Ur(t,Eo));return hr(e,ir)}function op(t){return Ur(`${t}`,ip)}function Un(t){return Number(hr(t,ip))}function O_(t){const e=op(typeof t.type<"u"?t.type:np);if(Un(e)===Li&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?Ur(t.senderPublicKey,ir):void 0,i=typeof t.iv<"u"?Ur(t.iv,ir):yo(Io),n=Ur(t.symKey,ir),s=K0(n,i).encrypt(Ur(t.message,Eo));return ap({type:e,sealed:s,iv:i,senderPublicKey:r,encoding:t.encoding})}function R_(t){const e=Ur(t.symKey,ir),{sealed:r,iv:i}=Ao(t),n=K0(e,i).decrypt(r);if(n===null)throw new Error("Failed to decrypt");return hr(n,Eo)}function N_(t,e){const r=op(So),i=yo(Io),n=Ur(t,Eo);return ap({type:r,sealed:n,iv:i,encoding:e})}function C_(t,e){const{sealed:r}=Ao({encoded:t,encoding:e});return hr(r,Eo)}function ap(t){const{encoding:e=mn}=t;if(Un(t.type)===So)return hr(Ef([t.type,t.sealed]),e);if(Un(t.type)===Li){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return hr(Ef([t.type,t.senderPublicKey,t.iv,t.sealed]),e)}return hr(Ef([t.type,t.iv,t.sealed]),e)}function Ao(t){const{encoded:e,encoding:r=mn}=t,i=Ur(e,r),n=i.slice(P_,sp),s=sp;if(Un(n)===Li){const u=s+rh,p=u+Io,b=i.slice(s,u),S=i.slice(u,p),A=i.slice(p);return{type:n,sealed:A,iv:S,senderPublicKey:b}}if(Un(n)===So){const u=i.slice(s),p=yo(Io);return{type:n,sealed:u,iv:p}}const o=s+Io,a=i.slice(s,o),h=i.slice(o);return{type:n,sealed:h,iv:a}}function T_(t,e){const r=Ao({encoded:t,encoding:e?.encoding});return cp({type:Un(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?hr(r.senderPublicKey,ir):void 0,receiverPublicKey:e?.receiverPublicKey})}function cp(t){const e=t?.type||np;if(e===Li){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function fp(t){return t.type===Li&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}function hp(t){return t.type===So}function F_(t){return new Hl.ec("p256").keyFromPublic({x:Buffer.from(t.x,"base64").toString("hex"),y:Buffer.from(t.y,"base64").toString("hex")},"hex")}function B_(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");const r=e.length%4;return r>0&&(e+="=".repeat(4-r)),e}function q_(t){return Buffer.from(B_(t),"base64")}function L_(t,e){const[r,i,n]=t.split("."),s=q_(n);if(s.length!==64)throw new Error("Invalid signature length");const o=s.slice(0,32).toString("hex"),a=s.slice(32,64).toString("hex"),h=`${r}.${i}`,u=za(h),p=F_(e),b=hr(u,ir);if(!p.verify(b,{r:o,s:a}))throw new Error("Invalid signature");return Xc(t).payload}const U_="irn";function Ka(t){return t?.relay||{protocol:U_}}function Mo(t){const e=x8[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}function j_(t,e="-"){const r={},i="relay"+e;return Object.keys(t).forEach(n=>{if(n.startsWith(i)){const s=n.replace(i,""),o=t[n];r[s]=o}}),r}function up(t){if(!t.includes("wc:")){const u=g0(t);u!=null&&u.includes("wc:")&&(t=u)}t=t.includes("wc://")?t.replace("wc://",""):t,t=t.includes("wc:")?t.replace("wc:",""):t;const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,i=t.substring(0,e),n=t.substring(e+1,r).split("@"),s=typeof r<"u"?t.substring(r):"",o=new URLSearchParams(s),a={};o.forEach((u,p)=>{a[p]=u});const h=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:i,topic:z_(n[0]),version:parseInt(n[1],10),symKey:a.symKey,relay:j_(a),methods:h,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function z_(t){return t.startsWith("//")?t.substring(2):t}function k_(t,e="-"){const r="relay",i={};return Object.keys(t).forEach(n=>{const s=r+e+n;t[n]&&(i[s]=t[n])}),i}function dp(t){const e=new URLSearchParams,r=k_(t.relay);Object.keys(r).sort().forEach(n=>{e.set(n,r[n])}),e.set("symKey",t.symKey),t.expiryTimestamp&&e.set("expiryTimestamp",t.expiryTimestamp.toString()),t.methods&&e.set("methods",t.methods.join(","));const i=e.toString();return`${t.protocol}:${t.topic}@${t.version}?${i}`}function Va(t,e,r){return`${t}?wc_ev=${r}&topic=${e}`}function Ms(t){const e=[];return t.forEach(r=>{const[i,n]=r.split(":");e.push(`${i}:${n}`)}),e}function H_(t){const e=[];return Object.values(t).forEach(r=>{e.push(...Ms(r.accounts))}),e}function K_(t,e){const r=[];return Object.values(t).forEach(i=>{Ms(i.accounts).includes(e)&&r.push(...i.methods)}),r}function V_(t,e){const r=[];return Object.values(t).forEach(i=>{Ms(i.accounts).includes(e)&&r.push(...i.events)}),r}function nh(t){return t.includes(":")}function Po(t){return nh(t)?t.split(":")[0]:t}function G_(t){const e={};return t?.forEach(r=>{const[i,n]=r.split(":");e[i]||(e[i]={accounts:[],chains:[],events:[]}),e[i].accounts.push(r),e[i].chains.push(`${i}:${n}`)}),e}function lp(t,e){e=e.map(i=>i.replace("did:pkh:",""));const r=G_(e);for(const[i,n]of Object.entries(r))n.methods?n.methods=Fa(n.methods,t):n.methods=t,n.events=["chainChanged","accountsChanged"];return r}const W_={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},J_={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function Q(t,e){const{message:r,code:i}=J_[t];return{message:e?`${r} ${e}`:r,code:i}}function dt(t,e){const{message:r,code:i}=W_[t];return{message:e?`${r} ${e}`:r,code:i}}function jn(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}function Do(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function ur(t){return typeof t>"u"}function Pt(t,e){return e&&ur(t)?!0:typeof t=="string"&&!!t.trim().length}function sh(t,e){return e&&ur(t)?!0:typeof t=="number"&&!isNaN(t)}function Y_(t,e){const{requiredNamespaces:r}=e,i=Object.keys(t.namespaces),n=Object.keys(r);let s=!0;return Bn(n,i)?(i.forEach(o=>{const{accounts:a,methods:h,events:u}=t.namespaces[o],p=Ms(a),b=r[o];(!Bn(o0(o,b),p)||!Bn(b.methods,h)||!Bn(b.events,u))&&(s=!1)}),s):!1}function Ga(t){return Pt(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function Z_(t){if(Pt(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&Ga(r)}}return!1}function X_(t){function e(r){try{return typeof new URL(r)<"u"}catch{return!1}}try{if(Pt(t,!1)){if(e(t))return!0;const r=g0(t);return e(r)}}catch{}return!1}function Q_(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function e9(t){return t?.topic}function t9(t,e){let r=null;return Pt(t?.publicKey,!1)||(r=Q("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function pp(t){let e=!0;return jn(t)?t.length&&(e=t.every(r=>Pt(r,!1))):e=!1,e}function r9(t,e,r){let i=null;return jn(e)&&e.length?e.forEach(n=>{i||Ga(n)||(i=dt("UNSUPPORTED_CHAINS",`${r}, chain ${n} should be a string and conform to "namespace:chainId" format`))}):Ga(t)||(i=dt("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),i}function i9(t,e,r){let i=null;return Object.entries(t).forEach(([n,s])=>{if(i)return;const o=r9(n,o0(n,s),`${e} ${r}`);o&&(i=o)}),i}function n9(t,e){let r=null;return jn(t)?t.forEach(i=>{r||Z_(i)||(r=dt("UNSUPPORTED_ACCOUNTS",`${e}, account ${i} should be a string and conform to "namespace:chainId:address" format`))}):r=dt("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function s9(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=n9(i?.accounts,`${e} namespace`);n&&(r=n)}),r}function o9(t,e){let r=null;return pp(t?.methods)?pp(t?.events)||(r=dt("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=dt("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function vp(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=o9(i,`${e}, namespace`);n&&(r=n)}),r}function a9(t,e,r){let i=null;if(t&&Do(t)){const n=vp(t,e);n&&(i=n);const s=i9(t,e,r);s&&(i=s)}else i=Q("MISSING_OR_INVALID",`${e}, ${r} should be an object with data`);return i}function oh(t,e){let r=null;if(t&&Do(t)){const i=vp(t,e);i&&(r=i);const n=s9(t,e);n&&(r=n)}else r=Q("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function gp(t){return Pt(t.protocol,!0)}function c9(t,e){let r=!1;return e&&!t?r=!0:t&&jn(t)&&t.length&&t.forEach(i=>{r=gp(i)}),r}function f9(t){return typeof t=="number"}function yr(t){return typeof t<"u"&&typeof t!==null}function h9(t){return!(!t||typeof t!="object"||!t.code||!sh(t.code,!1)||!t.message||!Pt(t.message,!1))}function u9(t){return!(ur(t)||!Pt(t.method,!1))}function d9(t){return!(ur(t)||ur(t.result)&&ur(t.error)||!sh(t.id,!1)||!Pt(t.jsonrpc,!1))}function l9(t){return!(ur(t)||!Pt(t.name,!1))}function bp(t,e){return!(!Ga(e)||!H_(t).includes(e))}function p9(t,e,r){return Pt(r,!1)?K_(t,e).includes(r):!1}function v9(t,e,r){return Pt(r,!1)?V_(t,e).includes(r):!1}function mp(t,e,r){let i=null;const n=g9(t),s=b9(e),o=Object.keys(n),a=Object.keys(s),h=yp(Object.keys(t)),u=yp(Object.keys(e)),p=h.filter(b=>!u.includes(b));return p.length&&(i=Q("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${p.toString()}
      Received: ${Object.keys(e).toString()}`)),Bn(o,a)||(i=Q("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(e).forEach(b=>{if(!b.includes(":")||i)return;const S=Ms(e[b].accounts);S.includes(b)||(i=Q("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${b}
        Required: ${b}
        Approved: ${S.toString()}`))}),o.forEach(b=>{i||(Bn(n[b].methods,s[b].methods)?Bn(n[b].events,s[b].events)||(i=Q("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${b}`)):i=Q("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${b}`))}),i}function g9(t){const e={};return Object.keys(t).forEach(r=>{var i;r.includes(":")?e[r]=t[r]:(i=t[r].chains)==null||i.forEach(n=>{e[n]={methods:t[r].methods,events:t[r].events}})}),e}function yp(t){return[...new Set(t.map(e=>e.includes(":")?e.split(":")[0]:e))]}function b9(t){const e={};return Object.keys(t).forEach(r=>{if(r.includes(":"))e[r]=t[r];else{const i=Ms(t[r].accounts);i?.forEach(n=>{e[n]={accounts:t[r].accounts.filter(s=>s.includes(`${n}:`)),methods:t[r].methods,events:t[r].events}})}}),e}function m9(t,e){return sh(t,!1)&&t<=e.max&&t>=e.min}function wp(){const t=bo();return new Promise(e=>{switch(t){case $r.browser:e(y9());break;case $r.reactNative:e(w9());break;case $r.node:e(_9());break;default:e(!0)}})}function y9(){return go()&&navigator?.onLine}async function w9(){if(dn()&&typeof global<"u"&&global!=null&&global.NetInfo){const t=await(global==null?void 0:global.NetInfo.fetch());return t?.isConnected}return!0}function _9(){return!0}function x9(t){switch(bo()){case $r.browser:E9(t);break;case $r.reactNative:S9(t);break}}function E9(t){!dn()&&go()&&(window.addEventListener("online",()=>t(!0)),window.addEventListener("offline",()=>t(!1)))}function S9(t){dn()&&typeof global<"u"&&global!=null&&global.NetInfo&&global?.NetInfo.addEventListener(e=>t(e?.isConnected))}const ah={};class $o{static get(e){return ah[e]}static set(e,r){ah[e]=r}static delete(e){delete ah[e]}}const I9="PARSE_ERROR",A9="INVALID_REQUEST",M9="METHOD_NOT_FOUND",P9="INVALID_PARAMS",_p="INTERNAL_ERROR",ch="SERVER_ERROR",D9=[-32700,-32600,-32601,-32602,-32603],Oo={[I9]:{code:-32700,message:"Parse error"},[A9]:{code:-32600,message:"Invalid Request"},[M9]:{code:-32601,message:"Method not found"},[P9]:{code:-32602,message:"Invalid params"},[_p]:{code:-32603,message:"Internal error"},[ch]:{code:-32e3,message:"Server error"}},xp=ch;function $9(t){return D9.includes(t)}function Ep(t){return Object.keys(Oo).includes(t)?Oo[t]:Oo[xp]}function O9(t){const e=Object.values(Oo).find(r=>r.code===t);return e||Oo[xp]}function Sp(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var Ip={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var fh=function(t,e){return fh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},fh(t,e)};function R9(t,e){fh(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var hh=function(){return hh=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},hh.apply(this,arguments)};function N9(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function C9(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(n<3?o(s):n>3?o(e,r,s):o(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function T9(t,e){return function(r,i){e(r,i,t)}}function F9(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function B9(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(p){try{u(i.next(p))}catch(b){o(b)}}function h(p){try{u(i.throw(p))}catch(b){o(b)}}function u(p){p.done?s(p.value):n(p.value).then(a,h)}u((i=i.apply(t,e||[])).next())})}function q9(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(p){return h([u,p])}}function h(u){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=u[0]&2?n.return:u[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,u[1])).done)return s;switch(n=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,n=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(p){u=[6,p],n=0}finally{i=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function L9(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function U9(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function uh(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ap(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],o;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(a){o={error:a}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function j9(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Ap(arguments[e]));return t}function z9(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,n++)i[n]=s[o];return i}function Ro(t){return this instanceof Ro?(this.v=t,this):new Ro(t)}function k9(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(S){i[S]&&(n[S]=function(A){return new Promise(function(I,P){s.push([S,A,I,P])>1||a(S,A)})})}function a(S,A){try{h(i[S](A))}catch(I){b(s[0][3],I)}}function h(S){S.value instanceof Ro?Promise.resolve(S.value.v).then(u,p):b(s[0][2],S)}function u(S){a("next",S)}function p(S){a("throw",S)}function b(S,A){S(A),s.shift(),s.length&&a(s[0][0],s[0][1])}}function H9(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(o){return(r=!r)?{value:Ro(t[n](o)),done:n==="return"}:s?s(o):o}:s}}function K9(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof uh=="function"?uh(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(o){return new Promise(function(a,h){o=t[s](o),n(a,h,o.done,o.value)})}}function n(s,o,a,h){Promise.resolve(h).then(function(u){s({value:u,done:a})},o)}}function V9(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function G9(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function W9(t){return t&&t.__esModule?t:{default:t}}function J9(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Y9(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Z9=Object.freeze({__proto__:null,__extends:R9,get __assign(){return hh},__rest:N9,__decorate:C9,__param:T9,__metadata:F9,__awaiter:B9,__generator:q9,__createBinding:L9,__exportStar:U9,__values:uh,__read:Ap,__spread:j9,__spreadArrays:z9,__await:Ro,__asyncGenerator:k9,__asyncDelegator:H9,__asyncValues:K9,__makeTemplateObject:V9,__importStar:G9,__importDefault:W9,__classPrivateFieldGet:J9,__classPrivateFieldSet:Y9}),X9=bc(Z9),ji={},Mp;function Q9(){if(Mp)return ji;Mp=1,Object.defineProperty(ji,"__esModule",{value:!0}),ji.isBrowserCryptoAvailable=ji.getSubtleCrypto=ji.getBrowerCrypto=void 0;function t(){return yt?.crypto||yt?.msCrypto||{}}ji.getBrowerCrypto=t;function e(){const i=t();return i.subtle||i.webkitSubtle}ji.getSubtleCrypto=e;function r(){return!!t()&&!!e()}return ji.isBrowserCryptoAvailable=r,ji}var zi={},Pp;function e7(){if(Pp)return zi;Pp=1,Object.defineProperty(zi,"__esModule",{value:!0}),zi.isBrowser=zi.isNode=zi.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}zi.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}zi.isNode=e;function r(){return!t()&&!e()}return zi.isBrowser=r,zi}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=X9;e.__exportStar(Q9(),t),e.__exportStar(e7(),t)})(Ip);function ki(t=3){const e=Date.now()*Math.pow(10,t),r=Math.floor(Math.random()*Math.pow(10,t));return e+r}function zn(t=6){return BigInt(ki(t))}function yn(t,e,r){return{id:r||ki(),jsonrpc:"2.0",method:t,params:e}}function Wa(t,e){return{id:t,jsonrpc:"2.0",result:e}}function Ja(t,e,r){return{id:t,jsonrpc:"2.0",error:t7(e,r)}}function t7(t,e){return typeof t>"u"?Ep(_p):(typeof t=="string"&&(t=Object.assign(Object.assign({},Ep(ch)),{message:t})),typeof e<"u"&&(t.data=e),$9(t.code)&&(t=O9(t.code)),t)}class r7{}class i7 extends r7{constructor(){super()}}class n7 extends i7{constructor(e){super()}}const s7="^https?:",o7="^wss?:";function a7(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function Dp(t,e){const r=a7(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function $p(t){return Dp(t,s7)}function Op(t){return Dp(t,o7)}function c7(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function Rp(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function dh(t){return Rp(t)&&"method"in t}function Ya(t){return Rp(t)&&(Si(t)||Hr(t))}function Si(t){return"result"in t}function Hr(t){return"error"in t}class Kr extends n7{constructor(e){super(e),this.events=new er.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(yn(e.method,e.params||[],e.id||zn().toString()),r)}async requestStrict(e,r){return new Promise(async(i,n)=>{if(!this.connection.connected)try{await this.open()}catch(s){n(s)}this.events.on(`${e.id}`,s=>{Hr(s)?n(s.error):i(s.result)});try{await this.connection.send(e,r)}catch(s){n(s)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Ya(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const f7=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),h7=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Np=t=>t.split("?")[0],Cp=10,u7=f7();class d7{constructor(e){if(this.url=e,this.events=new er.exports.EventEmitter,this.registering=!1,!Op(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=i=>{this.onClose(i),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send($i(e))}catch(r){this.onError(e.id,r)}}register(e=this.url){if(!Op(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((i,n)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),n(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return n(new Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,i)=>{const n=Ip.isReactNative()?void 0:{rejectUnauthorized:!c7(e)},s=new u7(e,[],n);h7()?s.onerror=o=>{const a=o;i(this.emitError(a.error))}:s.on("error",o=>{i(this.emitError(o))}),s.onopen=()=>{this.onOpen(s),r(s)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=r=>this.onClose(r),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?Mn(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const i=this.parseError(r),n=i.message||i.toString(),s=Ja(e,n);this.events.emit("payload",s)}parseError(e,r=this.url){return Sp(e,Np(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Cp&&this.events.setMaxListeners(Cp)}emitError(e){const r=this.parseError(new Error(e?.message||`WebSocket connection failed for host: ${Np(this.url)}`));return this.events.emit("register_error",r),r}}var lh={exports:{}};(function(t,e){var r=200,i="__lodash_hash_undefined__",n=1,s=2,o=9007199254740991,a="[object Arguments]",h="[object Array]",u="[object AsyncFunction]",p="[object Boolean]",b="[object Date]",S="[object Error]",A="[object Function]",I="[object GeneratorFunction]",P="[object Map]",R="[object Number]",O="[object Null]",N="[object Object]",F="[object Promise]",L="[object Proxy]",z="[object RegExp]",k="[object Set]",G="[object String]",K="[object Symbol]",H="[object Undefined]",ie="[object WeakMap]",D="[object ArrayBuffer]",g="[object DataView]",v="[object Float32Array]",c="[object Float64Array]",f="[object Int8Array]",l="[object Int16Array]",_="[object Int32Array]",x="[object Uint8Array]",y="[object Uint8ClampedArray]",d="[object Uint16Array]",w="[object Uint32Array]",m=/[\\^$.*+?()[\]{}|]/g,M=/^\[object .+?Constructor\]$/,B=/^(?:0|[1-9]\d*)$/,E={};E[v]=E[c]=E[f]=E[l]=E[_]=E[x]=E[y]=E[d]=E[w]=!0,E[a]=E[h]=E[D]=E[p]=E[g]=E[b]=E[S]=E[A]=E[P]=E[R]=E[N]=E[z]=E[k]=E[G]=E[ie]=!1;var C=typeof yt=="object"&&yt&&yt.Object===Object&&yt,q=typeof self=="object"&&self&&self.Object===Object&&self,U=C||q||Function("return this")(),j=e&&!e.nodeType&&e,Y=j&&!0&&t&&!t.nodeType&&t,X=Y&&Y.exports===j,W=X&&C.process,se=function(){try{return W&&W.binding&&W.binding("util")}catch{}}(),ee=se&&se.isTypedArray;function te($,T){for(var V=-1,re=$==null?0:$.length,_t=0,_e=[];++V<re;){var It=$[V];T(It,V,$)&&(_e[_t++]=It)}return _e}function ke($,T){for(var V=-1,re=T.length,_t=$.length;++V<re;)$[_t+V]=T[V];return $}function He($,T){for(var V=-1,re=$==null?0:$.length;++V<re;)if(T($[V],V,$))return!0;return!1}function ue($,T){for(var V=-1,re=Array($);++V<$;)re[V]=T(V);return re}function Ne($){return function(T){return $(T)}}function Ce($,T){return $.has(T)}function ce($,T){return $?.[T]}function Te($){var T=-1,V=Array($.size);return $.forEach(function(re,_t){V[++T]=[_t,re]}),V}function Fe($,T){return function(V){return $(T(V))}}function he($){var T=-1,V=Array($.size);return $.forEach(function(re){V[++T]=re}),V}var Be=Array.prototype,qe=Function.prototype,ae=Object.prototype,Oe=U["__core-js_shared__"],Le=qe.toString,ne=ae.hasOwnProperty,Ye=function(){var $=/[^.]+$/.exec(Oe&&Oe.keys&&Oe.keys.IE_PROTO||"");return $?"Symbol(src)_1."+$:""}(),Ze=ae.toString,ve=RegExp("^"+Le.call(ne).replace(m,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Xe=X?U.Buffer:void 0,Ue=U.Symbol,le=U.Uint8Array,Qe=ae.propertyIsEnumerable,rt=Be.splice,oe=Ue?Ue.toStringTag:void 0,et=Object.getOwnPropertySymbols,it=Xe?Xe.isBuffer:void 0,ge=Fe(Object.keys,Object),Ke=Gs(U,"DataView"),Re=Gs(U,"Map"),de=Gs(U,"Promise"),Ve=Gs(U,"Set"),Ge=Gs(U,"WeakMap"),fe=Gs(Object,"create"),nt=Jn(Ke),st=Jn(Re),be=Jn(de),ot=Jn(Ve),at=Jn(Ge),pe=Ue?Ue.prototype:void 0,We=pe?pe.valueOf:void 0;function Pe($){var T=-1,V=$==null?0:$.length;for(this.clear();++T<V;){var re=$[T];this.set(re[0],re[1])}}function me(){this.__data__=fe?fe(null):{},this.size=0}function ct($){var T=this.has($)&&delete this.__data__[$];return this.size-=T?1:0,T}function ft($){var T=this.__data__;if(fe){var V=T[$];return V===i?void 0:V}return ne.call(T,$)?T[$]:void 0}function ye($){var T=this.__data__;return fe?T[$]!==void 0:ne.call(T,$)}function ht($,T){var V=this.__data__;return this.size+=this.has($)?0:1,V[$]=fe&&T===void 0?i:T,this}Pe.prototype.clear=me,Pe.prototype.delete=ct,Pe.prototype.get=ft,Pe.prototype.has=ye,Pe.prototype.set=ht;function Ee($){var T=-1,V=$==null?0:$.length;for(this.clear();++T<V;){var re=$[T];this.set(re[0],re[1])}}function tt(){this.__data__=[],this.size=0}function xr($){var T=this.__data__,V=dc(T,$);if(V<0)return!1;var re=T.length-1;return V==re?T.pop():rt.call(T,V,1),--this.size,!0}function Er($){var T=this.__data__,V=dc(T,$);return V<0?void 0:T[V][1]}function Sr($){return dc(this.__data__,$)>-1}function Ir($,T){var V=this.__data__,re=dc(V,$);return re<0?(++this.size,V.push([$,T])):V[re][1]=T,this}Ee.prototype.clear=tt,Ee.prototype.delete=xr,Ee.prototype.get=Er,Ee.prototype.has=Sr,Ee.prototype.set=Ir;function $t($){var T=-1,V=$==null?0:$.length;for(this.clear();++T<V;){var re=$[T];this.set(re[0],re[1])}}function Ki(){this.size=0,this.__data__={hash:new Pe,map:new(Re||Ee),string:new Pe}}function Vi($){var T=lc(this,$).delete($);return this.size-=T?1:0,T}function Gi($){return lc(this,$).get($)}function Wi($){return lc(this,$).has($)}function Ji($,T){var V=lc(this,$),re=V.size;return V.set($,T),this.size+=V.size==re?0:1,this}$t.prototype.clear=Ki,$t.prototype.delete=Vi,$t.prototype.get=Gi,$t.prototype.has=Wi,$t.prototype.set=Ji;function Jr($){var T=-1,V=$==null?0:$.length;for(this.__data__=new $t;++T<V;)this.add($[T])}function Yi($){return this.__data__.set($,i),this}function Zi($){return this.__data__.has($)}Jr.prototype.add=Jr.prototype.push=Yi,Jr.prototype.has=Zi;function sr($){var T=this.__data__=new Ee($);this.size=T.size}function Xi(){this.__data__=new Ee,this.size=0}function Qi($){var T=this.__data__,V=T.delete($);return this.size=T.size,V}function en($){return this.__data__.get($)}function jo($){return this.__data__.has($)}function zo($,T){var V=this.__data__;if(V instanceof Ee){var re=V.__data__;if(!Re||re.length<r-1)return re.push([$,T]),this.size=++V.size,this;V=this.__data__=new $t(re)}return V.set($,T),this.size=V.size,this}sr.prototype.clear=Xi,sr.prototype.delete=Qi,sr.prototype.get=en,sr.prototype.has=jo,sr.prototype.set=zo;function FR($,T){var V=pc($),re=!V&&ZR($),_t=!V&&!re&&Gh($),_e=!V&&!re&&!_t&&Tv($),It=V||re||_t||_e,kt=It?ue($.length,String):[],Qt=kt.length;for(var xt in $)(T||ne.call($,xt))&&!(It&&(xt=="length"||_t&&(xt=="offset"||xt=="parent")||_e&&(xt=="buffer"||xt=="byteLength"||xt=="byteOffset")||VR(xt,Qt)))&&kt.push(xt);return kt}function dc($,T){for(var V=$.length;V--;)if(Ov($[V][0],T))return V;return-1}function BR($,T,V){var re=T($);return pc($)?re:ke(re,V($))}function ko($){return $==null?$===void 0?H:O:oe&&oe in Object($)?HR($):YR($)}function Mv($){return Ho($)&&ko($)==a}function Pv($,T,V,re,_t){return $===T?!0:$==null||T==null||!Ho($)&&!Ho(T)?$!==$&&T!==T:qR($,T,V,re,Pv,_t)}function qR($,T,V,re,_t,_e){var It=pc($),kt=pc(T),Qt=It?h:wn($),xt=kt?h:wn(T);Qt=Qt==a?N:Qt,xt=xt==a?N:xt;var Tr=Qt==N,fi=xt==N,or=Qt==xt;if(or&&Gh($)){if(!Gh(T))return!1;It=!0,Tr=!1}if(or&&!Tr)return _e||(_e=new sr),It||Tv($)?Dv($,T,V,re,_t,_e):zR($,T,Qt,V,re,_t,_e);if(!(V&n)){var Yr=Tr&&ne.call($,"__wrapped__"),Zr=fi&&ne.call(T,"__wrapped__");if(Yr||Zr){var _n=Yr?$.value():$,tn=Zr?T.value():T;return _e||(_e=new sr),_t(_n,tn,V,re,_e)}}return or?(_e||(_e=new sr),kR($,T,V,re,_t,_e)):!1}function LR($){if(!Cv($)||WR($))return!1;var T=Rv($)?ve:M;return T.test(Jn($))}function UR($){return Ho($)&&Nv($.length)&&!!E[ko($)]}function jR($){if(!JR($))return ge($);var T=[];for(var V in Object($))ne.call($,V)&&V!="constructor"&&T.push(V);return T}function Dv($,T,V,re,_t,_e){var It=V&n,kt=$.length,Qt=T.length;if(kt!=Qt&&!(It&&Qt>kt))return!1;var xt=_e.get($);if(xt&&_e.get(T))return xt==T;var Tr=-1,fi=!0,or=V&s?new Jr:void 0;for(_e.set($,T),_e.set(T,$);++Tr<kt;){var Yr=$[Tr],Zr=T[Tr];if(re)var _n=It?re(Zr,Yr,Tr,T,$,_e):re(Yr,Zr,Tr,$,T,_e);if(_n!==void 0){if(_n)continue;fi=!1;break}if(or){if(!He(T,function(tn,Yn){if(!Ce(or,Yn)&&(Yr===tn||_t(Yr,tn,V,re,_e)))return or.push(Yn)})){fi=!1;break}}else if(!(Yr===Zr||_t(Yr,Zr,V,re,_e))){fi=!1;break}}return _e.delete($),_e.delete(T),fi}function zR($,T,V,re,_t,_e,It){switch(V){case g:if($.byteLength!=T.byteLength||$.byteOffset!=T.byteOffset)return!1;$=$.buffer,T=T.buffer;case D:return!($.byteLength!=T.byteLength||!_e(new le($),new le(T)));case p:case b:case R:return Ov(+$,+T);case S:return $.name==T.name&&$.message==T.message;case z:case G:return $==T+"";case P:var kt=Te;case k:var Qt=re&n;if(kt||(kt=he),$.size!=T.size&&!Qt)return!1;var xt=It.get($);if(xt)return xt==T;re|=s,It.set($,T);var Tr=Dv(kt($),kt(T),re,_t,_e,It);return It.delete($),Tr;case K:if(We)return We.call($)==We.call(T)}return!1}function kR($,T,V,re,_t,_e){var It=V&n,kt=$v($),Qt=kt.length,xt=$v(T),Tr=xt.length;if(Qt!=Tr&&!It)return!1;for(var fi=Qt;fi--;){var or=kt[fi];if(!(It?or in T:ne.call(T,or)))return!1}var Yr=_e.get($);if(Yr&&_e.get(T))return Yr==T;var Zr=!0;_e.set($,T),_e.set(T,$);for(var _n=It;++fi<Qt;){or=kt[fi];var tn=$[or],Yn=T[or];if(re)var Fv=It?re(Yn,tn,or,T,$,_e):re(tn,Yn,or,$,T,_e);if(!(Fv===void 0?tn===Yn||_t(tn,Yn,V,re,_e):Fv)){Zr=!1;break}_n||(_n=or=="constructor")}if(Zr&&!_n){var vc=$.constructor,gc=T.constructor;vc!=gc&&"constructor"in $&&"constructor"in T&&!(typeof vc=="function"&&vc instanceof vc&&typeof gc=="function"&&gc instanceof gc)&&(Zr=!1)}return _e.delete($),_e.delete(T),Zr}function $v($){return BR($,eN,KR)}function lc($,T){var V=$.__data__;return GR(T)?V[typeof T=="string"?"string":"hash"]:V.map}function Gs($,T){var V=ce($,T);return LR(V)?V:void 0}function HR($){var T=ne.call($,oe),V=$[oe];try{$[oe]=void 0;var re=!0}catch{}var _t=Ze.call($);return re&&(T?$[oe]=V:delete $[oe]),_t}var KR=et?function($){return $==null?[]:($=Object($),te(et($),function(T){return Qe.call($,T)}))}:tN,wn=ko;(Ke&&wn(new Ke(new ArrayBuffer(1)))!=g||Re&&wn(new Re)!=P||de&&wn(de.resolve())!=F||Ve&&wn(new Ve)!=k||Ge&&wn(new Ge)!=ie)&&(wn=function($){var T=ko($),V=T==N?$.constructor:void 0,re=V?Jn(V):"";if(re)switch(re){case nt:return g;case st:return P;case be:return F;case ot:return k;case at:return ie}return T});function VR($,T){return T=T??o,!!T&&(typeof $=="number"||B.test($))&&$>-1&&$%1==0&&$<T}function GR($){var T=typeof $;return T=="string"||T=="number"||T=="symbol"||T=="boolean"?$!=="__proto__":$===null}function WR($){return!!Ye&&Ye in $}function JR($){var T=$&&$.constructor,V=typeof T=="function"&&T.prototype||ae;return $===V}function YR($){return Ze.call($)}function Jn($){if($!=null){try{return Le.call($)}catch{}try{return $+""}catch{}}return""}function Ov($,T){return $===T||$!==$&&T!==T}var ZR=Mv(function(){return arguments}())?Mv:function($){return Ho($)&&ne.call($,"callee")&&!Qe.call($,"callee")},pc=Array.isArray;function XR($){return $!=null&&Nv($.length)&&!Rv($)}var Gh=it||rN;function QR($,T){return Pv($,T)}function Rv($){if(!Cv($))return!1;var T=ko($);return T==A||T==I||T==u||T==L}function Nv($){return typeof $=="number"&&$>-1&&$%1==0&&$<=o}function Cv($){var T=typeof $;return $!=null&&(T=="object"||T=="function")}function Ho($){return $!=null&&typeof $=="object"}var Tv=ee?Ne(ee):UR;function eN($){return XR($)?FR($):jR($)}function tN(){return[]}function rN(){return!1}t.exports=QR})(lh,lh.exports);var l7=lh.exports,p7=Object.defineProperty,Tp=Object.getOwnPropertySymbols,v7=Object.prototype.hasOwnProperty,g7=Object.prototype.propertyIsEnumerable,Fp=(t,e,r)=>e in t?p7(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,dr=(t,e)=>{for(var r in e||(e={}))v7.call(e,r)&&Fp(t,r,e[r]);if(Tp)for(var r of Tp(e))g7.call(e,r)&&Fp(t,r,e[r]);return t};const Bp="wc",qp=2,Za="core",Ii=`${Bp}@2:${Za}:`,b7={name:Za,logger:"error"},m7={database:":memory:"},y7="crypto",Lp="client_ed25519_seed",w7=Z.ONE_DAY,_7="keychain",x7="0.3",E7="messages",S7="0.3",Up=Z.SIX_HOURS,I7="publisher",jp="irn",A7="error",zp="wss://relay.walletconnect.org",M7="relayer",Ut={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},P7="_subscription",Vr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},D7=.1,ph="2.18.1",gt={link_mode:"link_mode",relay:"relay"},$7="0.3",O7="WALLETCONNECT_CLIENT_ID",kp="WALLETCONNECT_LINK_MODE_APPS",Rr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},R7="subscription",N7="0.3",C7=Z.FIVE_SECONDS*1e3,T7="pairing",F7="0.3",No={wc_pairingDelete:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:0},res:{ttl:Z.ONE_DAY,prompt:!1,tag:0}}},kn={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},si={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},B7="history",q7="0.3",L7="expirer",Gr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},U7="0.3",j7="verify-api",z7="https://verify.walletconnect.com",Hp="https://verify.walletconnect.org",Co=Hp,k7=`${Co}/v3`,H7=[z7,Hp],K7="echo",V7="https://echo.walletconnect.com",Ai={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},Hi={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},oi={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},Hn={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},Kn={authenticated_session_approve_started:"authenticated_session_approve_started",authenticated_session_not_expired:"authenticated_session_not_expired",chains_caip2_compliant:"chains_caip2_compliant",chains_evm_compliant:"chains_evm_compliant",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve",authenticated_session_approve_publish_success:"authenticated_session_approve_publish_success"},To={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",missing_session_authenticate_request:"missing_session_authenticate_request",session_authenticate_request_expired:"session_authenticate_request_expired",chains_caip2_compliant_failure:"chains_caip2_compliant_failure",chains_evm_compliant_failure:"chains_evm_compliant_failure",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},G7=.1,W7="event-client",J7=86400,Y7="https://pulse.walletconnect.org/batch";function Z7(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=n}var a=t.length,h=t.charAt(0),u=Math.log(a)/Math.log(256),p=Math.log(256)/Math.log(a);function b(I){if(I instanceof Uint8Array||(ArrayBuffer.isView(I)?I=new Uint8Array(I.buffer,I.byteOffset,I.byteLength):Array.isArray(I)&&(I=Uint8Array.from(I))),!(I instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(I.length===0)return"";for(var P=0,R=0,O=0,N=I.length;O!==N&&I[O]===0;)O++,P++;for(var F=(N-O)*p+1>>>0,L=new Uint8Array(F);O!==N;){for(var z=I[O],k=0,G=F-1;(z!==0||k<R)&&G!==-1;G--,k++)z+=256*L[G]>>>0,L[G]=z%a>>>0,z=z/a>>>0;if(z!==0)throw new Error("Non-zero carry");R=k,O++}for(var K=F-R;K!==F&&L[K]===0;)K++;for(var H=h.repeat(P);K<F;++K)H+=t.charAt(L[K]);return H}function S(I){if(typeof I!="string")throw new TypeError("Expected String");if(I.length===0)return new Uint8Array;var P=0;if(I[P]!==" "){for(var R=0,O=0;I[P]===h;)R++,P++;for(var N=(I.length-P)*u+1>>>0,F=new Uint8Array(N);I[P];){var L=r[I.charCodeAt(P)];if(L===255)return;for(var z=0,k=N-1;(L!==0||z<O)&&k!==-1;k--,z++)L+=a*F[k]>>>0,F[k]=L%256>>>0,L=L/256>>>0;if(L!==0)throw new Error("Non-zero carry");O=z,P++}if(I[P]!==" "){for(var G=N-O;G!==N&&F[G]===0;)G++;for(var K=new Uint8Array(R+(N-G)),H=R;G!==N;)K[H++]=F[G++];return K}}}function A(I){var P=S(I);if(P)return P;throw new Error(`Non-${e} character`)}return{encode:b,decodeUnsafe:S,decode:A}}var X7=Z7,Q7=X7;const Kp=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},ex=t=>new TextEncoder().encode(t),tx=t=>new TextDecoder().decode(t);class rx{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class ix{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Vp(this,e)}}class nx{constructor(e){this.decoders=e}or(e){return Vp(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Vp=(t,e)=>new nx(dr(dr({},t.decoders||{[t.prefix]:t}),e.decoders||{[e.prefix]:e}));class sx{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new rx(e,r,i),this.decoder=new ix(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Xa=({name:t,prefix:e,encode:r,decode:i})=>new sx(t,e,r,i),Fo=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=Q7(r,e);return Xa({prefix:t,name:e,encode:i,decode:s=>Kp(n(s))})},ox=(t,e,r,i)=>{const n={};for(let p=0;p<e.length;++p)n[e[p]]=p;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let a=0,h=0,u=0;for(let p=0;p<s;++p){const b=n[t[p]];if(b===void 0)throw new SyntaxError(`Non-${i} character`);h=h<<r|b,a+=r,a>=8&&(a-=8,o[u++]=255&h>>a)}if(a>=r||255&h<<8-a)throw new SyntaxError("Unexpected end of data");return o},ax=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",o=0,a=0;for(let h=0;h<t.length;++h)for(a=a<<8|t[h],o+=8;o>r;)o-=r,s+=e[n&a>>o];if(o&&(s+=e[n&a<<r-o]),i)for(;s.length*r&7;)s+="=";return s},Yt=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>Xa({prefix:e,name:t,encode(n){return ax(n,i,r)},decode(n){return ox(n,i,r,t)}}),cx=Xa({prefix:"\0",name:"identity",encode:t=>tx(t),decode:t=>ex(t)});var fx=Object.freeze({__proto__:null,identity:cx});const hx=Yt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var ux=Object.freeze({__proto__:null,base2:hx});const dx=Yt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var lx=Object.freeze({__proto__:null,base8:dx});const px=Fo({prefix:"9",name:"base10",alphabet:"0123456789"});var vx=Object.freeze({__proto__:null,base10:px});const gx=Yt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),bx=Yt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var mx=Object.freeze({__proto__:null,base16:gx,base16upper:bx});const yx=Yt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),wx=Yt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),_x=Yt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),xx=Yt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ex=Yt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Sx=Yt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Ix=Yt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Ax=Yt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Mx=Yt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Px=Object.freeze({__proto__:null,base32:yx,base32upper:wx,base32pad:_x,base32padupper:xx,base32hex:Ex,base32hexupper:Sx,base32hexpad:Ix,base32hexpadupper:Ax,base32z:Mx});const Dx=Fo({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),$x=Fo({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Ox=Object.freeze({__proto__:null,base36:Dx,base36upper:$x});const Rx=Fo({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Nx=Fo({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Cx=Object.freeze({__proto__:null,base58btc:Rx,base58flickr:Nx});const Tx=Yt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Fx=Yt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Bx=Yt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),qx=Yt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Lx=Object.freeze({__proto__:null,base64:Tx,base64pad:Fx,base64url:Bx,base64urlpad:qx});const Gp=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Ux=Gp.reduce((t,e,r)=>(t[r]=e,t),[]),jx=Gp.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function zx(t){return t.reduce((e,r)=>(e+=Ux[r],e),"")}function kx(t){const e=[];for(const r of t){const i=jx[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const Hx=Xa({prefix:"\u{1F680}",name:"base256emoji",encode:zx,decode:kx});var Kx=Object.freeze({__proto__:null,base256emoji:Hx}),Vx=Jp,Wp=128,Gx=127,Wx=~Gx,Jx=Math.pow(2,31);function Jp(t,e,r){e=e||[],r=r||0;for(var i=r;t>=Jx;)e[r++]=t&255|Wp,t/=128;for(;t&Wx;)e[r++]=t&255|Wp,t>>>=7;return e[r]=t|0,Jp.bytes=r-i+1,e}var Yx=vh,Zx=128,Yp=127;function vh(t,i){var r=0,i=i||0,n=0,s=i,o,a=t.length;do{if(s>=a)throw vh.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=n<28?(o&Yp)<<n:(o&Yp)*Math.pow(2,n),n+=7}while(o>=Zx);return vh.bytes=s-i,r}var Xx=Math.pow(2,7),Qx=Math.pow(2,14),eE=Math.pow(2,21),tE=Math.pow(2,28),rE=Math.pow(2,35),iE=Math.pow(2,42),nE=Math.pow(2,49),sE=Math.pow(2,56),oE=Math.pow(2,63),aE=function(t){return t<Xx?1:t<Qx?2:t<eE?3:t<tE?4:t<rE?5:t<iE?6:t<nE?7:t<sE?8:t<oE?9:10},cE={encode:Vx,decode:Yx,encodingLength:aE},Zp=cE;const Xp=(t,e,r=0)=>(Zp.encode(t,e,r),e),Qp=t=>Zp.encodingLength(t),gh=(t,e)=>{const r=e.byteLength,i=Qp(t),n=i+Qp(r),s=new Uint8Array(n+r);return Xp(t,s,0),Xp(r,s,i),s.set(e,n),new fE(t,r,e,s)};class fE{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}const e1=({name:t,code:e,encode:r})=>new hE(t,e,r);class hE{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?gh(this.code,r):r.then(i=>gh(this.code,i))}else throw Error("Unknown type, must be binary type")}}const t1=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),uE=e1({name:"sha2-256",code:18,encode:t1("SHA-256")}),dE=e1({name:"sha2-512",code:19,encode:t1("SHA-512")});var lE=Object.freeze({__proto__:null,sha256:uE,sha512:dE});const r1=0,pE="identity",i1=Kp;var vE=Object.freeze({__proto__:null,identity:{code:r1,name:pE,encode:i1,digest:t=>gh(r1,i1(t))}});new TextEncoder,new TextDecoder;const n1=dr(dr(dr(dr(dr(dr(dr(dr(dr(dr({},fx),ux),lx),vx),mx),Px),Ox),Cx),Lx),Kx);dr(dr({},lE),vE);function gE(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function s1(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const o1=s1("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),bh=s1("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=gE(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),bE=dr({utf8:o1,"utf-8":o1,hex:n1.base16,latin1:bh,ascii:bh,binary:bh},n1);function mE(t,e="utf8"){const r=bE[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}var yE=Object.defineProperty,wE=(t,e,r)=>e in t?yE(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Mi=(t,e,r)=>wE(t,typeof e!="symbol"?e+"":e,r);class _E{constructor(e,r){this.core=e,this.logger=r,Mi(this,"keychain",new Map),Mi(this,"name",_7),Mi(this,"version",x7),Mi(this,"initialized",!1),Mi(this,"storagePrefix",Ii),Mi(this,"init",async()=>{if(!this.initialized){const i=await this.getKeyChain();typeof i<"u"&&(this.keychain=i),this.initialized=!0}}),Mi(this,"has",i=>(this.isInitialized(),this.keychain.has(i))),Mi(this,"set",async(i,n)=>{this.isInitialized(),this.keychain.set(i,n),await this.persist()}),Mi(this,"get",i=>{this.isInitialized();const n=this.keychain.get(i);if(typeof n>"u"){const{message:s}=Q("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(s)}return n}),Mi(this,"del",async i=>{this.isInitialized(),this.keychain.delete(i),await this.persist()}),this.core=e,this.logger=ar(r,this.name)}get context(){return pr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,h0(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?u0(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=Q("NOT_INITIALIZED",this.name);throw new Error(e)}}}var xE=Object.defineProperty,EE=(t,e,r)=>e in t?xE(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Zt=(t,e,r)=>EE(t,typeof e!="symbol"?e+"":e,r);class SE{constructor(e,r,i){this.core=e,this.logger=r,Zt(this,"name",y7),Zt(this,"keychain"),Zt(this,"randomSessionIdentifier",ih()),Zt(this,"initialized",!1),Zt(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),Zt(this,"hasKeys",n=>(this.isInitialized(),this.keychain.has(n))),Zt(this,"getClientId",async()=>{this.isInitialized();const n=await this.getClientSeed(),s=Ed(n);return xd(s.publicKey)}),Zt(this,"generateKeyPair",()=>{this.isInitialized();const n=D_();return this.setPrivateKey(n.publicKey,n.privateKey)}),Zt(this,"signJWT",async n=>{this.isInitialized();const s=await this.getClientSeed(),o=Ed(s),a=this.randomSessionIdentifier;return await T2(a,n,w7,o)}),Zt(this,"generateSharedKey",(n,s,o)=>{this.isInitialized();const a=this.getPrivateKey(n),h=$_(a,s);return this.setSymKey(h,o)}),Zt(this,"setSymKey",async(n,s)=>{this.isInitialized();const o=s||Ha(n);return await this.keychain.set(o,n),o}),Zt(this,"deleteKeyPair",async n=>{this.isInitialized(),await this.keychain.del(n)}),Zt(this,"deleteSymKey",async n=>{this.isInitialized(),await this.keychain.del(n)}),Zt(this,"encode",async(n,s,o)=>{this.isInitialized();const a=cp(o),h=$i(s);if(hp(a))return N_(h,o?.encoding);if(fp(a)){const S=a.senderPublicKey,A=a.receiverPublicKey;n=await this.generateSharedKey(S,A)}const u=this.getSymKey(n),{type:p,senderPublicKey:b}=a;return O_({type:p,symKey:u,message:h,senderPublicKey:b,encoding:o?.encoding})}),Zt(this,"decode",async(n,s,o)=>{this.isInitialized();const a=T_(s,o);if(hp(a)){const h=C_(s,o?.encoding);return Mn(h)}if(fp(a)){const h=a.receiverPublicKey,u=a.senderPublicKey;n=await this.generateSharedKey(h,u)}try{const h=this.getSymKey(n),u=R_({symKey:h,encoded:s,encoding:o?.encoding});return Mn(u)}catch(h){this.logger.error(`Failed to decode message from topic: '${n}', clientId: '${await this.getClientId()}'`),this.logger.error(h)}}),Zt(this,"getPayloadType",(n,s=mn)=>{const o=Ao({encoded:n,encoding:s});return Un(o.type)}),Zt(this,"getPayloadSenderPublicKey",(n,s=mn)=>{const o=Ao({encoded:n,encoding:s});return o.senderPublicKey?hr(o.senderPublicKey,ir):void 0}),this.core=e,this.logger=ar(r,this.name),this.keychain=i||new _E(this.core,this.logger)}get context(){return pr(this.logger)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Lp)}catch{e=ih(),await this.keychain.set(Lp,e)}return mE(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=Q("NOT_INITIALIZED",this.name);throw new Error(e)}}}var IE=Object.defineProperty,AE=(t,e,r)=>e in t?IE(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Pi=(t,e,r)=>AE(t,typeof e!="symbol"?e+"":e,r);class ME extends Cb{constructor(e,r){super(e,r),this.logger=e,this.core=r,Pi(this,"messages",new Map),Pi(this,"name",E7),Pi(this,"version",S7),Pi(this,"initialized",!1),Pi(this,"storagePrefix",Ii),Pi(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const i=await this.getRelayerMessages();typeof i<"u"&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}}),Pi(this,"set",async(i,n)=>{this.isInitialized();const s=Ui(n);let o=this.messages.get(i);return typeof o>"u"&&(o={}),typeof o[s]<"u"||(o[s]=n,this.messages.set(i,o),await this.persist()),s}),Pi(this,"get",i=>{this.isInitialized();let n=this.messages.get(i);return typeof n>"u"&&(n={}),n}),Pi(this,"has",(i,n)=>{this.isInitialized();const s=this.get(i),o=Ui(n);return typeof s[o]<"u"}),Pi(this,"del",async i=>{this.isInitialized(),this.messages.delete(i),await this.persist()}),this.logger=ar(e,this.name),this.core=r}get context(){return pr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,h0(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?u0(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=Q("NOT_INITIALIZED",this.name);throw new Error(e)}}}var PE=Object.defineProperty,DE=Object.defineProperties,$E=Object.getOwnPropertyDescriptors,a1=Object.getOwnPropertySymbols,OE=Object.prototype.hasOwnProperty,RE=Object.prototype.propertyIsEnumerable,mh=(t,e,r)=>e in t?PE(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Qa=(t,e)=>{for(var r in e||(e={}))OE.call(e,r)&&mh(t,r,e[r]);if(a1)for(var r of a1(e))RE.call(e,r)&&mh(t,r,e[r]);return t},yh=(t,e)=>DE(t,$E(e)),ai=(t,e,r)=>mh(t,typeof e!="symbol"?e+"":e,r);class NE extends Tb{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,ai(this,"events",new er.exports.EventEmitter),ai(this,"name",I7),ai(this,"queue",new Map),ai(this,"publishTimeout",Z.toMiliseconds(Z.ONE_MINUTE)),ai(this,"initialPublishTimeout",Z.toMiliseconds(Z.ONE_SECOND*15)),ai(this,"needsTransportRestart",!1),ai(this,"publish",async(i,n,s)=>{var o;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:s}});const a=s?.ttl||Up,h=Ka(s),u=s?.prompt||!1,p=s?.tag||0,b=s?.id||zn().toString(),S={topic:i,message:n,opts:{ttl:a,relay:h,prompt:u,tag:p,id:b,attestation:s?.attestation,tvf:s?.tvf}},A=`Failed to publish payload, please try again. id:${b} tag:${p}`;try{const I=new Promise(async P=>{const R=({id:N})=>{S.opts.id===N&&(this.removeRequestFromQueue(N),this.relayer.events.removeListener(Ut.publish,R),P(S))};this.relayer.events.on(Ut.publish,R);const O=ln(new Promise((N,F)=>{this.rpcPublish({topic:i,message:n,ttl:a,prompt:u,tag:p,id:b,attestation:s?.attestation,tvf:s?.tvf}).then(N).catch(L=>{this.logger.warn(L,L?.message),F(L)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${b} tag:${p}`);try{await O,this.events.removeListener(Ut.publish,R)}catch(N){this.queue.set(b,yh(Qa({},S),{attempt:1})),this.logger.warn(N,N?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:b,topic:i,message:n,opts:s}}),await ln(I,this.publishTimeout,A)}catch(I){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(I),(o=s?.internal)!=null&&o.throwOnFailedPublish)throw I}finally{this.queue.delete(b)}}),ai(this,"on",(i,n)=>{this.events.on(i,n)}),ai(this,"once",(i,n)=>{this.events.once(i,n)}),ai(this,"off",(i,n)=>{this.events.off(i,n)}),ai(this,"removeListener",(i,n)=>{this.events.removeListener(i,n)}),this.relayer=e,this.logger=ar(r,this.name),this.registerEventListeners()}get context(){return pr(this.logger)}async rpcPublish(e){var r,i,n,s;const{topic:o,message:a,ttl:h=Up,prompt:u,tag:p,id:b,attestation:S,tvf:A}=e,I={method:Mo(Ka().protocol).publish,params:Qa({topic:o,message:a,ttl:h,prompt:u,tag:p,attestation:S},A),id:b};ur((r=I.params)==null?void 0:r.prompt)&&((i=I.params)==null||delete i.prompt),ur((n=I.params)==null?void 0:n.tag)&&((s=I.params)==null||delete s.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:I});const P=await this.relayer.request(I);return this.relayer.events.emit(Ut.publish,e),this.logger.debug("Successfully Published Payload"),P}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,r)=>{const i=e.attempt+1;this.queue.set(r,yh(Qa({},e),{attempt:i}));const{topic:n,message:s,opts:o,attestation:a}=e;this.logger.warn({},`Publisher: queue->publishing: ${e.opts.id}, tag: ${e.opts.tag}, attempt: ${i}`),await this.rpcPublish(yh(Qa({},e),{topic:n,message:s,ttl:o.ttl,prompt:o.prompt,tag:o.tag,id:o.id,attestation:a,tvf:o.tvf})),this.logger.warn({},`Publisher: queue->published: ${e.opts.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(Qn.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Ut.connection_stalled);return}this.checkQueue()}),this.relayer.on(Ut.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var CE=Object.defineProperty,TE=(t,e,r)=>e in t?CE(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ps=(t,e,r)=>TE(t,typeof e!="symbol"?e+"":e,r);class FE{constructor(){Ps(this,"map",new Map),Ps(this,"set",(e,r)=>{const i=this.get(e);this.exists(e,r)||this.map.set(e,[...i,r])}),Ps(this,"get",e=>this.map.get(e)||[]),Ps(this,"exists",(e,r)=>this.get(e).includes(r)),Ps(this,"delete",(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const i=this.get(e);if(!this.exists(e,r))return;const n=i.filter(s=>s!==r);if(!n.length){this.map.delete(e);return}this.map.set(e,n)}),Ps(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var BE=Object.defineProperty,qE=Object.defineProperties,LE=Object.getOwnPropertyDescriptors,c1=Object.getOwnPropertySymbols,UE=Object.prototype.hasOwnProperty,jE=Object.prototype.propertyIsEnumerable,wh=(t,e,r)=>e in t?BE(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Bo=(t,e)=>{for(var r in e||(e={}))UE.call(e,r)&&wh(t,r,e[r]);if(c1)for(var r of c1(e))jE.call(e,r)&&wh(t,r,e[r]);return t},_h=(t,e)=>qE(t,LE(e)),lt=(t,e,r)=>wh(t,typeof e!="symbol"?e+"":e,r);class zE extends qb{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,lt(this,"subscriptions",new Map),lt(this,"topicMap",new FE),lt(this,"events",new er.exports.EventEmitter),lt(this,"name",R7),lt(this,"version",N7),lt(this,"pending",new Map),lt(this,"cached",[]),lt(this,"initialized",!1),lt(this,"pendingSubscriptionWatchLabel","pending_sub_watch_label"),lt(this,"pollingInterval",20),lt(this,"storagePrefix",Ii),lt(this,"subscribeTimeout",Z.toMiliseconds(Z.ONE_MINUTE)),lt(this,"initialSubscribeTimeout",Z.toMiliseconds(Z.ONE_SECOND*15)),lt(this,"clientId"),lt(this,"batchSubscribeTopicsLimit",500),lt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),lt(this,"subscribe",async(i,n)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}});try{const s=Ka(n),o={topic:i,relay:s,transportType:n?.transportType};this.pending.set(i,o);const a=await this.rpcSubscribe(i,s,n);return typeof a=="string"&&(this.onSubscribe(a,o),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}})),a}catch(s){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(s),s}}),lt(this,"unsubscribe",async(i,n)=>{await this.restartToComplete(),this.isInitialized(),typeof n?.id<"u"?await this.unsubscribeById(i,n.id,n):await this.unsubscribeByTopic(i,n)}),lt(this,"isSubscribed",async i=>{if(this.topics.includes(i))return!0;const n=`${this.pendingSubscriptionWatchLabel}_${i}`;return await new Promise((s,o)=>{const a=new Z.Watch;a.start(n);const h=setInterval(()=>{(!this.pending.has(i)&&this.topics.includes(i)||this.cached.some(u=>u.topic===i))&&(clearInterval(h),a.stop(n),s(!0)),a.elapsed(n)>=C7&&(clearInterval(h),a.stop(n),o(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1)}),lt(this,"on",(i,n)=>{this.events.on(i,n)}),lt(this,"once",(i,n)=>{this.events.once(i,n)}),lt(this,"off",(i,n)=>{this.events.off(i,n)}),lt(this,"removeListener",(i,n)=>{this.events.removeListener(i,n)}),lt(this,"start",async()=>{await this.onConnect()}),lt(this,"stop",async()=>{await this.onDisconnect()}),lt(this,"restart",async()=>{await this.restore(),await this.onRestart()}),lt(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const i=[];this.pending.forEach(n=>{i.push(n)}),await this.batchSubscribe(i)}),lt(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(Qn.pulse,async()=>{await this.checkPending()}),this.events.on(Rr.created,async i=>{const n=Rr.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:i}),await this.persist()}),this.events.on(Rr.deleted,async i=>{const n=Rr.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:i}),await this.persist()})}),this.relayer=e,this.logger=ar(r,this.name),this.clientId=""}get context(){return pr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let i=!1;try{i=this.getSubscription(e).topic===r}catch{}return i}reset(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,r){const i=this.topicMap.get(e);await Promise.all(i.map(async n=>await this.unsubscribeById(e,n,r)))}async unsubscribeById(e,r,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}});try{const n=Ka(i);await this.rpcUnsubscribe(e,r,n);const s=dt("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}})}catch(n){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(n),n}}async rpcSubscribe(e,r,i){var n;i?.transportType===gt.relay&&await this.restartToComplete();const s={method:Mo(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});const o=(n=i?.internal)==null?void 0:n.throwOnFailedPublish;try{const a=await this.getSubscriptionId(e);if(i?.transportType===gt.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(s).catch(p=>this.logger.warn(p))},Z.toMiliseconds(Z.ONE_SECOND)),a;const h=new Promise(async p=>{const b=S=>{S.topic===e&&(this.events.removeListener(Rr.created,b),p(S.id))};this.events.on(Rr.created,b);try{const S=await ln(new Promise((A,I)=>{this.relayer.request(s).catch(P=>{this.logger.warn(P,P?.message),I(P)}).then(A)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(Rr.created,b),p(S)}catch{}}),u=await ln(h,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!u&&o)throw new Error(`Subscribing to ${e} failed, please try again`);return u?a:null}catch(a){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Ut.connection_stalled),o)throw a}return null}async rpcBatchSubscribe(e){if(!e.length)return;const r=e[0].relay,i={method:Mo(r.protocol).batchSubscribe,params:{topics:e.map(n=>n.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{await await ln(new Promise(n=>{this.relayer.request(i).catch(s=>this.logger.warn(s)).then(n)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(Ut.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const r=e[0].relay,i={method:Mo(r.protocol).batchFetchMessages,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});let n;try{n=await await ln(new Promise((s,o)=>{this.relayer.request(i).catch(a=>{this.logger.warn(a),o(a)}).then(s)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(Ut.connection_stalled)}return n}rpcUnsubscribe(e,r,i){const n={method:Mo(i.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.request(n)}onSubscribe(e,r){this.setSubscription(e,_h(Bo({},r),{id:e})),this.pending.delete(r.topic)}onBatchSubscribe(e){e.length&&e.forEach(r=>{this.setSubscription(r.id,Bo({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(e,r,i){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,i),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r)}addSubscription(e,r){this.subscriptions.set(e,Bo({},r)),this.topicMap.set(r.topic,e),this.events.emit(Rr.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:i}=Q("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const i=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(i.topic,e),this.events.emit(Rr.deleted,_h(Bo({},i),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Rr.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],r=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let i=0;i<r;i++){const n=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(Rr.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async r=>_h(Bo({},r),{id:await this.getSubscriptionId(r.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const r=await this.rpcBatchFetchMessages(e);r&&r.messages&&(await K8(Z.toMiliseconds(Z.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(r.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=Q("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){!this.relayer.connected&&!this.relayer.connecting&&await this.relayer.transportOpen()}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return Ui(e+await this.getClientId())}}var kE=Object.defineProperty,f1=Object.getOwnPropertySymbols,HE=Object.prototype.hasOwnProperty,KE=Object.prototype.propertyIsEnumerable,xh=(t,e,r)=>e in t?kE(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,h1=(t,e)=>{for(var r in e||(e={}))HE.call(e,r)&&xh(t,r,e[r]);if(f1)for(var r of f1(e))KE.call(e,r)&&xh(t,r,e[r]);return t},Je=(t,e,r)=>xh(t,typeof e!="symbol"?e+"":e,r);class VE extends Fb{constructor(e){super(e),Je(this,"protocol","wc"),Je(this,"version",2),Je(this,"core"),Je(this,"logger"),Je(this,"events",new er.exports.EventEmitter),Je(this,"provider"),Je(this,"messages"),Je(this,"subscriber"),Je(this,"publisher"),Je(this,"name",M7),Je(this,"transportExplicitlyClosed",!1),Je(this,"initialized",!1),Je(this,"connectionAttemptInProgress",!1),Je(this,"relayUrl"),Je(this,"projectId"),Je(this,"packageName"),Je(this,"bundleId"),Je(this,"hasExperiencedNetworkDisruption",!1),Je(this,"pingTimeout"),Je(this,"heartBeatTimeout",Z.toMiliseconds(Z.THIRTY_SECONDS+Z.FIVE_SECONDS)),Je(this,"reconnectTimeout"),Je(this,"connectPromise"),Je(this,"requestsInFlight",[]),Je(this,"connectTimeout",Z.toMiliseconds(Z.ONE_SECOND*15)),Je(this,"request",async r=>{var i,n;this.logger.debug("Publishing Request Payload");const s=r.id||zn().toString();await this.toEstablishConnection();try{this.logger.trace({id:s,method:r.method,topic:(i=r.params)==null?void 0:i.topic},"relayer.request - publishing...");const o=`${s}:${((n=r.params)==null?void 0:n.tag)||""}`;this.requestsInFlight.push(o);const a=await this.provider.request(r);return this.requestsInFlight=this.requestsInFlight.filter(h=>h!==o),a}catch(o){throw this.logger.debug(`Failed to Publish Request: ${s}`),o}}),Je(this,"resetPingTimeout",()=>{if(Ta())try{clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var r,i,n;this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(n=(i=(r=this.provider)==null?void 0:r.connection)==null?void 0:i.socket)==null||n.terminate()},this.heartBeatTimeout)}catch(r){this.logger.warn(r,r?.message)}}),Je(this,"onPayloadHandler",r=>{this.onProviderPayload(r),this.resetPingTimeout()}),Je(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected \u{1F6DC}"),this.startPingTimeout(),this.events.emit(Ut.connect)}),Je(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected \u{1F6D1}"),this.requestsInFlight=[],this.onProviderDisconnect()}),Je(this,"onProviderErrorHandler",r=>{this.logger.fatal(r,`Fatal socket error: ${r?.message}`),this.events.emit(Ut.error,r),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),Je(this,"registerProviderListeners",()=>{this.provider.on(Vr.payload,this.onPayloadHandler),this.provider.on(Vr.connect,this.onConnectHandler),this.provider.on(Vr.disconnect,this.onDisconnectHandler),this.provider.on(Vr.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?ar(e.logger,this.name):hi(ra({level:e.logger||A7})),this.messages=new ME(this.logger,e.core),this.subscriber=new zE(this,this.logger),this.publisher=new NE(this,this.logger),this.relayUrl=e?.relayUrl||zp,this.projectId=e.projectId,$8()?this.packageName=a0():O8()&&(this.bundleId=a0()),this.provider={}}async init(){if(this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.subscriber.cached.length>0)try{await this.transportOpen()}catch(e){this.logger.warn(e,e?.message)}}get context(){return pr(this.logger)}get connected(){var e,r,i;return((i=(r=(e=this.provider)==null?void 0:e.connection)==null?void 0:r.socket)==null?void 0:i.readyState)===1}get connecting(){var e,r,i;return((i=(r=(e=this.provider)==null?void 0:e.connection)==null?void 0:r.socket)==null?void 0:i.readyState)===0}async publish(e,r,i){this.isInitialized(),await this.publisher.publish(e,r,i),await this.recordMessageEvent({topic:e,message:r,publishedAt:Date.now(),transportType:gt.relay})}async subscribe(e,r){var i,n,s;this.isInitialized(),(!(r!=null&&r.transportType)||r?.transportType==="relay")&&await this.toEstablishConnection();const o=typeof((i=r?.internal)==null?void 0:i.throwOnFailedPublish)>"u"?!0:(n=r?.internal)==null?void 0:n.throwOnFailedPublish;let a=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"",h;const u=p=>{p.topic===e&&(this.subscriber.off(Rr.created,u),h())};return await Promise.all([new Promise(p=>{h=p,this.subscriber.on(Rr.created,u)}),new Promise(async(p,b)=>{a=await this.subscriber.subscribe(e,h1({internal:{throwOnFailedPublish:o}},r)).catch(S=>{o&&b(S)})||a,p()})]),a}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await ln(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(r,i)=>{await this.connect(e).then(r).catch(i).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await wp())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if(e?.length===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const r=e.sort((i,n)=>i.publishedAt-n.publishedAt);this.logger.debug(`Batch of ${r.length} message events sorted`);for(const i of r)try{await this.onMessageEvent(i)}catch(n){this.logger.warn(n,"Error while processing batch message event: "+n?.message)}this.logger.trace(`Batch of ${r.length} message events processed`)}async onLinkMessageEvent(e,r){const{topic:i}=e;if(!r.sessionExists){const n=Nt(Z.FIVE_MINUTES),s={topic:i,expiry:n,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(i,s)}this.events.emit(Ut.message,e),await this.recordMessageEvent(e)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let r=1;for(;r<6;){try{this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${r}...`),await this.createProvider(),await new Promise(async(i,n)=>{const s=()=>{n(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Vr.disconnect,s),await ln(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{n(o)}).finally(()=>{this.provider.off(Vr.disconnect,s),clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0}),await new Promise(async(o,a)=>{const h=()=>{a(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Vr.disconnect,h),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(Vr.disconnect,h)})}),this.hasExperiencedNetworkDisruption=!1,i()})}catch(i){await this.subscriber.stop();const n=i;this.logger.warn({},n.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${r}`);break}await new Promise(i=>setTimeout(i,Z.toMiliseconds(r*1))),r++}}startPingTimeout(){var e,r,i,n,s;if(Ta())try{(r=(e=this.provider)==null?void 0:e.connection)!=null&&r.socket&&((s=(n=(i=this.provider)==null?void 0:i.connection)==null?void 0:n.socket)==null||s.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Kr(new d7(T8({sdkVersion:ph,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:r,message:i}=e;await this.messages.set(r,i)}async shouldIgnoreMessageEvent(e){const{topic:r,message:i}=e;if(!i||i.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${i}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.warn(`Ignoring message for non-subscribed topic ${r}`),!0;const n=this.messages.has(r,i);return n&&this.logger.warn(`Ignoring duplicate message: ${i}`),n}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),dh(e)){if(!e.method.endsWith(P7))return;const r=e.params,{topic:i,message:n,publishedAt:s,attestation:o}=r.data,a={topic:i,message:n,publishedAt:s,transportType:gt.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(h1({type:"event",event:r.id},a)),this.events.emit(r.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else Ya(e)&&this.events.emit(Ut.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(Ut.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=Wa(e.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(Vr.payload,this.onPayloadHandler),this.provider.off(Vr.connect,this.onConnectHandler),this.provider.off(Vr.disconnect,this.onDisconnectHandler),this.provider.off(Vr.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await wp();x9(async r=>{e!==r&&(e=r,r?await this.transportOpen().catch(i=>this.logger.error(i,i?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))})}async onProviderDisconnect(){await this.subscriber.stop(),clearTimeout(this.pingTimeout),this.events.emit(Ut.disconnect),this.connectionAttemptInProgress=!1,!this.transportExplicitlyClosed&&(this.reconnectTimeout||this.connectPromise||(this.reconnectTimeout=setTimeout(async()=>{clearTimeout(this.reconnectTimeout),await this.transportOpen().catch(e=>this.logger.error(e,e?.message))},Z.toMiliseconds(D7))))}isInitialized(){if(!this.initialized){const{message:e}=Q("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){await this.confirmOnlineStateOrThrow(),!this.connected&&await this.transportOpen()}}var GE=Object.defineProperty,u1=Object.getOwnPropertySymbols,WE=Object.prototype.hasOwnProperty,JE=Object.prototype.propertyIsEnumerable,Eh=(t,e,r)=>e in t?GE(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,d1=(t,e)=>{for(var r in e||(e={}))WE.call(e,r)&&Eh(t,r,e[r]);if(u1)for(var r of u1(e))JE.call(e,r)&&Eh(t,r,e[r]);return t},wr=(t,e,r)=>Eh(t,typeof e!="symbol"?e+"":e,r);class Vn extends Bb{constructor(e,r,i,n=Ii,s=void 0){super(e,r,i,n),this.core=e,this.logger=r,this.name=i,wr(this,"map",new Map),wr(this,"version",$7),wr(this,"cached",[]),wr(this,"initialized",!1),wr(this,"getKey"),wr(this,"storagePrefix",Ii),wr(this,"recentlyDeleted",[]),wr(this,"recentlyDeletedLimit",200),wr(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!ur(o)?this.map.set(this.getKey(o),o):Q_(o)?this.map.set(o.id,o):e9(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),wr(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),wr(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),wr(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(h=>l7(a[h],o[h]))):this.values)),wr(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const h=d1(d1({},this.getData(o)),a);this.map.set(o,h),await this.persist()}),wr(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=ar(r,this.name),this.storagePrefix=n,this.getKey=s}get context(){return pr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){if(this.recentlyDeleted.includes(e)){const{message:n}=Q("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}const{message:i}=Q("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=Q("NOT_INITIALIZED",this.name);throw new Error(e)}}}var YE=Object.defineProperty,ZE=(t,e,r)=>e in t?YE(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,De=(t,e,r)=>ZE(t,typeof e!="symbol"?e+"":e,r);class XE{constructor(e,r){this.core=e,this.logger=r,De(this,"name",T7),De(this,"version",F7),De(this,"events",new er.exports),De(this,"pairings"),De(this,"initialized",!1),De(this,"storagePrefix",Ii),De(this,"ignoredPayloadTypes",[Li]),De(this,"registeredMethods",[]),De(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),De(this,"register",({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]}),De(this,"create",async i=>{this.isInitialized();const n=ih(),s=await this.core.crypto.setSymKey(n),o=Nt(Z.FIVE_MINUTES),a={protocol:jp},h={topic:s,expiry:o,relay:a,active:!1,methods:i?.methods},u=dp({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:n,relay:a,expiryTimestamp:o,methods:i?.methods});return this.events.emit(kn.create,h),this.core.expirer.set(s,o),await this.pairings.set(s,h),await this.core.relayer.subscribe(s,{transportType:i?.transportType}),{topic:s,uri:u}}),De(this,"pair",async i=>{this.isInitialized();const n=this.core.eventClient.createEvent({properties:{topic:i?.uri,trace:[Ai.pairing_started]}});this.isValidPair(i,n);const{topic:s,symKey:o,relay:a,expiryTimestamp:h,methods:u}=up(i.uri);n.props.properties.topic=s,n.addTrace(Ai.pairing_uri_validation_success),n.addTrace(Ai.pairing_uri_not_expired);let p;if(this.pairings.keys.includes(s)){if(p=this.pairings.get(s),n.addTrace(Ai.existing_pairing),p.active)throw n.setError(Hi.active_pairing_already_exists),new Error(`Pairing already exists: ${s}. Please try again with a new connection URI.`);n.addTrace(Ai.pairing_not_expired)}const b=h||Nt(Z.FIVE_MINUTES),S={topic:s,relay:a,expiry:b,active:!1,methods:u};this.core.expirer.set(s,b),await this.pairings.set(s,S),n.addTrace(Ai.store_new_pairing),i.activatePairing&&await this.activate({topic:s}),this.events.emit(kn.create,S),n.addTrace(Ai.emit_inactive_pairing),this.core.crypto.keychain.has(s)||await this.core.crypto.setSymKey(o,s),n.addTrace(Ai.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{n.setError(Hi.no_internet_connection)}try{await this.core.relayer.subscribe(s,{relay:a})}catch(A){throw n.setError(Hi.subscribe_pairing_topic_failure),A}return n.addTrace(Ai.subscribe_pairing_topic_success),S}),De(this,"activate",async({topic:i})=>{this.isInitialized();const n=Nt(Z.FIVE_MINUTES);this.core.expirer.set(i,n),await this.pairings.update(i,{active:!0,expiry:n})}),De(this,"ping",async i=>{this.isInitialized(),await this.isValidPing(i),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:n}=i;if(this.pairings.keys.includes(n)){const s=await this.sendRequest(n,"wc_pairingPing",{}),{done:o,resolve:a,reject:h}=qn();this.events.once(Ie("pairing_ping",s),({error:u})=>{u?h(u):a()}),await o()}}),De(this,"updateExpiry",async({topic:i,expiry:n})=>{this.isInitialized(),await this.pairings.update(i,{expiry:n})}),De(this,"updateMetadata",async({topic:i,metadata:n})=>{this.isInitialized(),await this.pairings.update(i,{peerMetadata:n})}),De(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),De(this,"disconnect",async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:n}=i;this.pairings.keys.includes(n)&&(await this.sendRequest(n,"wc_pairingDelete",dt("USER_DISCONNECTED")),await this.deletePairing(n))}),De(this,"formatUriFromPairing",i=>{this.isInitialized();const{topic:n,relay:s,expiry:o,methods:a}=i,h=this.core.crypto.keychain.get(n);return dp({protocol:this.core.protocol,version:this.core.version,topic:n,symKey:h,relay:s,expiryTimestamp:o,methods:a})}),De(this,"sendRequest",async(i,n,s)=>{const o=yn(n,s),a=await this.core.crypto.encode(i,o),h=No[n].req;return this.core.history.set(i,o),this.core.relayer.publish(i,a,h),o.id}),De(this,"sendResult",async(i,n,s)=>{const o=Wa(i,s),a=await this.core.crypto.encode(n,o),h=await this.core.history.get(n,i),u=No[h.request.method].res;await this.core.relayer.publish(n,a,u),await this.core.history.resolve(o)}),De(this,"sendError",async(i,n,s)=>{const o=Ja(i,s),a=await this.core.crypto.encode(n,o),h=await this.core.history.get(n,i),u=No[h.request.method]?No[h.request.method].res:No.unregistered_method.res;await this.core.relayer.publish(n,a,u),await this.core.history.resolve(o)}),De(this,"deletePairing",async(i,n)=>{await this.core.relayer.unsubscribe(i),await Promise.all([this.pairings.delete(i,dt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(i),n?Promise.resolve():this.core.expirer.del(i)])}),De(this,"cleanup",async()=>{const i=this.pairings.getAll().filter(n=>pn(n.expiry));await Promise.all(i.map(n=>this.deletePairing(n.topic)))}),De(this,"onRelayEventRequest",i=>{const{topic:n,payload:s}=i;switch(s.method){case"wc_pairingPing":return this.onPairingPingRequest(n,s);case"wc_pairingDelete":return this.onPairingDeleteRequest(n,s);default:return this.onUnknownRpcMethodRequest(n,s)}}),De(this,"onRelayEventResponse",async i=>{const{topic:n,payload:s}=i,o=(await this.core.history.get(n,s.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(n,s);default:return this.onUnknownRpcMethodResponse(o)}}),De(this,"onPairingPingRequest",async(i,n)=>{const{id:s}=n;try{this.isValidPing({topic:i}),await this.sendResult(s,i,!0),this.events.emit(kn.ping,{id:s,topic:i})}catch(o){await this.sendError(s,i,o),this.logger.error(o)}}),De(this,"onPairingPingResponse",(i,n)=>{const{id:s}=n;setTimeout(()=>{Si(n)?this.events.emit(Ie("pairing_ping",s),{}):Hr(n)&&this.events.emit(Ie("pairing_ping",s),{error:n.error})},500)}),De(this,"onPairingDeleteRequest",async(i,n)=>{const{id:s}=n;try{this.isValidDisconnect({topic:i}),await this.deletePairing(i),this.events.emit(kn.delete,{id:s,topic:i})}catch(o){await this.sendError(s,i,o),this.logger.error(o)}}),De(this,"onUnknownRpcMethodRequest",async(i,n)=>{const{id:s,method:o}=n;try{if(this.registeredMethods.includes(o))return;const a=dt("WC_METHOD_UNSUPPORTED",o);await this.sendError(s,i,a),this.logger.error(a)}catch(a){await this.sendError(s,i,a),this.logger.error(a)}}),De(this,"onUnknownRpcMethodResponse",i=>{this.registeredMethods.includes(i)||this.logger.error(dt("WC_METHOD_UNSUPPORTED",i))}),De(this,"isValidPair",(i,n)=>{var s;if(!yr(i)){const{message:a}=Q("MISSING_OR_INVALID",`pair() params: ${i}`);throw n.setError(Hi.malformed_pairing_uri),new Error(a)}if(!X_(i.uri)){const{message:a}=Q("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw n.setError(Hi.malformed_pairing_uri),new Error(a)}const o=up(i?.uri);if(!((s=o?.relay)!=null&&s.protocol)){const{message:a}=Q("MISSING_OR_INVALID","pair() uri#relay-protocol");throw n.setError(Hi.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=Q("MISSING_OR_INVALID","pair() uri#symKey");throw n.setError(Hi.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&Z.toMiliseconds(o?.expiryTimestamp)<Date.now()){n.setError(Hi.pairing_expired);const{message:a}=Q("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),De(this,"isValidPing",async i=>{if(!yr(i)){const{message:s}=Q("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(s)}const{topic:n}=i;await this.isValidPairingTopic(n)}),De(this,"isValidDisconnect",async i=>{if(!yr(i)){const{message:s}=Q("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(s)}const{topic:n}=i;await this.isValidPairingTopic(n)}),De(this,"isValidPairingTopic",async i=>{if(!Pt(i,!1)){const{message:n}=Q("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(n)}if(!this.pairings.keys.includes(i)){const{message:n}=Q("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(n)}if(pn(this.pairings.get(i).expiry)){await this.deletePairing(i);const{message:n}=Q("EXPIRED",`pairing topic: ${i}`);throw new Error(n)}}),this.core=e,this.logger=ar(r,this.name),this.pairings=new Vn(this.core,this.logger,this.name,this.storagePrefix)}get context(){return pr(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=Q("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Ut.message,async e=>{const{topic:r,message:i,transportType:n}=e;if(!this.pairings.keys.includes(r)||n===gt.link_mode||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))return;const s=await this.core.crypto.decode(r,i);try{dh(s)?(this.core.history.set(r,s),this.onRelayEventRequest({topic:r,payload:s})):Ya(s)&&(await this.core.history.resolve(s),await this.onRelayEventResponse({topic:r,payload:s}),this.core.history.delete(r,s.id))}catch(o){this.logger.error(o)}})}registerExpirerEvents(){this.core.expirer.on(Gr.expired,async e=>{const{topic:r}=l0(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(kn.expire,{topic:r}))})}}var QE=Object.defineProperty,eS=(t,e,r)=>e in t?QE(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Xt=(t,e,r)=>eS(t,typeof e!="symbol"?e+"":e,r);class tS extends Nb{constructor(e,r){super(e,r),this.core=e,this.logger=r,Xt(this,"records",new Map),Xt(this,"events",new er.exports.EventEmitter),Xt(this,"name",B7),Xt(this,"version",q7),Xt(this,"cached",[]),Xt(this,"initialized",!1),Xt(this,"storagePrefix",Ii),Xt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Xt(this,"set",(i,n,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:n,chainId:s}),this.records.has(n.id))return;const o={id:n.id,topic:i,request:{method:n.method,params:n.params||null},chainId:s,expiry:Nt(Z.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(si.created,o)}),Xt(this,"resolve",async i=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;const n=await this.getRecord(i.id);typeof n.response>"u"&&(n.response=Hr(i)?{error:i.error}:{result:i.result},this.records.set(n.id,n),this.persist(),this.events.emit(si.updated,n))}),Xt(this,"get",async(i,n)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:n}),await this.getRecord(n))),Xt(this,"delete",(i,n)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:n}),this.values.forEach(s=>{if(s.topic===i){if(typeof n<"u"&&s.id!==n)return;this.records.delete(s.id),this.events.emit(si.deleted,s)}}),this.persist()}),Xt(this,"exists",async(i,n)=>(this.isInitialized(),this.records.has(n)?(await this.getRecord(n)).topic===i:!1)),Xt(this,"on",(i,n)=>{this.events.on(i,n)}),Xt(this,"once",(i,n)=>{this.events.once(i,n)}),Xt(this,"off",(i,n)=>{this.events.off(i,n)}),Xt(this,"removeListener",(i,n)=>{this.events.removeListener(i,n)}),this.logger=ar(r,this.name)}get context(){return pr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const i={topic:r.topic,request:yn(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(i)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:i}=Q("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(si.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(si.created,e=>{const r=si.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.events.on(si.updated,e=>{const r=si.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.events.on(si.deleted,e=>{const r=si.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.core.heartbeat.on(Qn.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(r=>{Z.toMiliseconds(r.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${r.id}`),this.records.delete(r.id),this.events.emit(si.deleted,r,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=Q("NOT_INITIALIZED",this.name);throw new Error(e)}}}var rS=Object.defineProperty,iS=(t,e,r)=>e in t?rS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,nr=(t,e,r)=>iS(t,typeof e!="symbol"?e+"":e,r);class nS extends Lb{constructor(e,r){super(e,r),this.core=e,this.logger=r,nr(this,"expirations",new Map),nr(this,"events",new er.exports.EventEmitter),nr(this,"name",L7),nr(this,"version",U7),nr(this,"cached",[]),nr(this,"initialized",!1),nr(this,"storagePrefix",Ii),nr(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),nr(this,"has",i=>{try{const n=this.formatTarget(i);return typeof this.getExpiration(n)<"u"}catch{return!1}}),nr(this,"set",(i,n)=>{this.isInitialized();const s=this.formatTarget(i),o={target:s,expiry:n};this.expirations.set(s,o),this.checkExpiry(s,o),this.events.emit(Gr.created,{target:s,expiration:o})}),nr(this,"get",i=>{this.isInitialized();const n=this.formatTarget(i);return this.getExpiration(n)}),nr(this,"del",i=>{if(this.isInitialized(),this.has(i)){const n=this.formatTarget(i),s=this.getExpiration(n);this.expirations.delete(n),this.events.emit(Gr.deleted,{target:n,expiration:s})}}),nr(this,"on",(i,n)=>{this.events.on(i,n)}),nr(this,"once",(i,n)=>{this.events.once(i,n)}),nr(this,"off",(i,n)=>{this.events.off(i,n)}),nr(this,"removeListener",(i,n)=>{this.events.removeListener(i,n)}),this.logger=ar(r,this.name)}get context(){return pr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return F8(e);if(typeof e=="number")return B8(e);const{message:r}=Q("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Gr.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:i}=Q("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(i),new Error(i)}return r}checkExpiry(e,r){const{expiry:i}=r;Z.toMiliseconds(i)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(Gr.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(Qn.pulse,()=>this.checkExpirations()),this.events.on(Gr.created,e=>{const r=Gr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(Gr.expired,e=>{const r=Gr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(Gr.deleted,e=>{const r=Gr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=Q("NOT_INITIALIZED",this.name);throw new Error(e)}}}var sS=Object.defineProperty,oS=(t,e,r)=>e in t?sS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Dt=(t,e,r)=>oS(t,typeof e!="symbol"?e+"":e,r);class aS extends Ub{constructor(e,r,i){super(e,r,i),this.core=e,this.logger=r,this.store=i,Dt(this,"name",j7),Dt(this,"abortController"),Dt(this,"isDevEnv"),Dt(this,"verifyUrlV3",k7),Dt(this,"storagePrefix",Ii),Dt(this,"version",qp),Dt(this,"publicKey"),Dt(this,"fetchPromise"),Dt(this,"init",async()=>{var n;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&Z.toMiliseconds((n=this.publicKey)==null?void 0:n.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),Dt(this,"register",async n=>{if(!go()||this.isDevEnv)return;const s=window.location.origin,{id:o,decryptedId:a}=n,h=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${s}&id=${o}&decryptedId=${a}`;try{const u=io(),p=this.startAbortTimer(Z.ONE_SECOND*5),b=await new Promise((S,A)=>{const I=()=>{window.removeEventListener("message",R),u.body.removeChild(P),A("attestation aborted")};this.abortController.signal.addEventListener("abort",I);const P=u.createElement("iframe");P.src=h,P.style.display="none",P.addEventListener("error",I,{signal:this.abortController.signal});const R=O=>{if(O.data&&typeof O.data=="string")try{const N=JSON.parse(O.data);if(N.type==="verify_attestation"){if(Xc(N.attestation).payload.id!==o)return;clearInterval(p),u.body.removeChild(P),this.abortController.signal.removeEventListener("abort",I),window.removeEventListener("message",R),S(N.attestation===null?"":N.attestation)}}catch(N){this.logger.warn(N)}};u.body.appendChild(P),window.addEventListener("message",R,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",b),b}catch(u){this.logger.warn(u)}return""}),Dt(this,"resolve",async n=>{if(this.isDevEnv)return"";const{attestationId:s,hash:o,encryptedId:a}=n;if(s===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(s){if(Xc(s).payload.id!==a)return;const u=await this.isValidJwtAttestation(s);if(u){if(!u.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return u}}if(!o)return;const h=this.getVerifyUrl(n?.verifyUrl);return this.fetchAttestation(o,h)}),Dt(this,"fetchAttestation",async(n,s)=>{this.logger.debug(`resolving attestation: ${n} from url: ${s}`);const o=this.startAbortTimer(Z.ONE_SECOND*5),a=await fetch(`${s}/attestation/${n}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),Dt(this,"getVerifyUrl",n=>{let s=n||Co;return H7.includes(s)||(this.logger.info(`verify url: ${s}, not included in trusted list, assigning default: ${Co}`),s=Co),s}),Dt(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const n=this.startAbortTimer(Z.FIVE_SECONDS),s=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(n),await s.json()}catch(n){this.logger.warn(n)}}),Dt(this,"persistPublicKey",async n=>{this.logger.debug("persisting public key to local storage",n),await this.store.setItem(this.storeKey,n),this.publicKey=n}),Dt(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),Dt(this,"isValidJwtAttestation",async n=>{const s=await this.getPublicKey();try{if(s)return this.validateAttestation(n,s)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(n,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),Dt(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),Dt(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async s=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),s(o))});const n=await this.fetchPromise;return this.fetchPromise=void 0,n}),Dt(this,"validateAttestation",(n,s)=>{const o=L_(n,s.publicKey),a={hasExpired:Z.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=ar(r,this.name),this.abortController=new AbortController,this.isDevEnv=qf(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return pr(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),Z.toMiliseconds(e))}}var cS=Object.defineProperty,fS=(t,e,r)=>e in t?cS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,l1=(t,e,r)=>fS(t,typeof e!="symbol"?e+"":e,r);class hS extends jb{constructor(e,r){super(e,r),this.projectId=e,this.logger=r,l1(this,"context",K7),l1(this,"registerDeviceToken",async i=>{const{clientId:n,token:s,notificationType:o,enableEncrypted:a=!1}=i,h=`${V7}/${this.projectId}/clients`;await fetch(h,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:n,type:o,token:s,always_raw:a})})}),this.logger=ar(r,this.context)}}var uS=Object.defineProperty,p1=Object.getOwnPropertySymbols,dS=Object.prototype.hasOwnProperty,lS=Object.prototype.propertyIsEnumerable,Sh=(t,e,r)=>e in t?uS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,qo=(t,e)=>{for(var r in e||(e={}))dS.call(e,r)&&Sh(t,r,e[r]);if(p1)for(var r of p1(e))lS.call(e,r)&&Sh(t,r,e[r]);return t},jt=(t,e,r)=>Sh(t,typeof e!="symbol"?e+"":e,r);class pS extends zb{constructor(e,r,i=!0){super(e,r,i),this.core=e,this.logger=r,jt(this,"context",W7),jt(this,"storagePrefix",Ii),jt(this,"storageVersion",G7),jt(this,"events",new Map),jt(this,"shouldPersist",!1),jt(this,"init",async()=>{if(!qf())try{const n={eventId:v0(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:f0(this.core.relayer.protocol,this.core.relayer.version,ph)}}};await this.sendEvent([n])}catch(n){this.logger.warn(n)}}),jt(this,"createEvent",n=>{const{event:s="ERROR",type:o="",properties:{topic:a,trace:h}}=n,u=v0(),p=this.core.projectId||"",b=Date.now(),S=qo({eventId:u,timestamp:b,props:{event:s,type:o,properties:{topic:a,trace:h}},bundleId:p,domain:this.getAppDomain()},this.setMethods(u));return this.telemetryEnabled&&(this.events.set(u,S),this.shouldPersist=!0),S}),jt(this,"getEvent",n=>{const{eventId:s,topic:o}=n;if(s)return this.events.get(s);const a=Array.from(this.events.values()).find(h=>h.props.properties.topic===o);if(a)return qo(qo({},a),this.setMethods(a.eventId))}),jt(this,"deleteEvent",n=>{const{eventId:s}=n;this.events.delete(s),this.shouldPersist=!0}),jt(this,"setEventListeners",()=>{this.core.heartbeat.on(Qn.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(n=>{Z.fromMiliseconds(Date.now())-Z.fromMiliseconds(n.timestamp)>J7&&(this.events.delete(n.eventId),this.shouldPersist=!0)})})}),jt(this,"setMethods",n=>({addTrace:s=>this.addTrace(n,s),setError:s=>this.setError(n,s)})),jt(this,"addTrace",(n,s)=>{const o=this.events.get(n);o&&(o.props.properties.trace.push(s),this.events.set(n,o),this.shouldPersist=!0)}),jt(this,"setError",(n,s)=>{const o=this.events.get(n);o&&(o.props.type=s,o.timestamp=Date.now(),this.events.set(n,o),this.shouldPersist=!0)}),jt(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),jt(this,"restore",async()=>{try{const n=await this.core.storage.getItem(this.storageKey)||[];if(!n.length)return;n.forEach(s=>{this.events.set(s.eventId,qo(qo({},s),this.setMethods(s.eventId)))})}catch(n){this.logger.warn(n)}}),jt(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const n=[];for(const[s,o]of this.events)o.props.type&&n.push(o);if(n.length!==0)try{if((await this.sendEvent(n)).ok)for(const s of n)this.events.delete(s.eventId),this.shouldPersist=!0}catch(s){this.logger.warn(s)}}),jt(this,"sendEvent",async n=>{const s=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${Y7}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${ph}${s}`,{method:"POST",body:JSON.stringify(n)})}),jt(this,"getAppDomain",()=>c0().url),this.logger=ar(r,this.context),this.telemetryEnabled=i,i?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var vS=Object.defineProperty,v1=Object.getOwnPropertySymbols,gS=Object.prototype.hasOwnProperty,bS=Object.prototype.propertyIsEnumerable,Ih=(t,e,r)=>e in t?vS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,g1=(t,e)=>{for(var r in e||(e={}))gS.call(e,r)&&Ih(t,r,e[r]);if(v1)for(var r of v1(e))bS.call(e,r)&&Ih(t,r,e[r]);return t},bt=(t,e,r)=>Ih(t,typeof e!="symbol"?e+"":e,r);class Ah extends Db{constructor(e){var r;super(e),bt(this,"protocol",Bp),bt(this,"version",qp),bt(this,"name",Za),bt(this,"relayUrl"),bt(this,"projectId"),bt(this,"customStoragePrefix"),bt(this,"events",new er.exports.EventEmitter),bt(this,"logger"),bt(this,"heartbeat"),bt(this,"relayer"),bt(this,"crypto"),bt(this,"storage"),bt(this,"history"),bt(this,"expirer"),bt(this,"pairing"),bt(this,"verify"),bt(this,"echoClient"),bt(this,"linkModeSupportedApps"),bt(this,"eventClient"),bt(this,"initialized",!1),bt(this,"logChunkController"),bt(this,"on",(o,a)=>this.events.on(o,a)),bt(this,"once",(o,a)=>this.events.once(o,a)),bt(this,"off",(o,a)=>this.events.off(o,a)),bt(this,"removeListener",(o,a)=>this.events.removeListener(o,a)),bt(this,"dispatchEnvelope",({topic:o,message:a,sessionExists:h})=>{if(!o||!a)return;const u={topic:o,message:a,publishedAt:Date.now(),transportType:gt.link_mode};this.relayer.onLinkMessageEvent(u,{sessionExists:h})}),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||zp,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const i=ra({level:typeof e?.logger=="string"&&e.logger?e.logger:b7.logger,name:Za}),{logger:n,chunkLoggerController:s}=Ab({opts:i,maxSizeInBytes:e?.maxLogBlobSizeInBytes,loggerOverride:e?.logger});this.logChunkController=s,(r=this.logChunkController)!=null&&r.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var o,a;(o=this.logChunkController)!=null&&o.downloadLogsBlobInBrowser&&((a=this.logChunkController)==null||a.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=ar(n,this.name),this.heartbeat=new Ic,this.crypto=new SE(this,this.logger,e?.keychain),this.history=new tS(this,this.logger),this.expirer=new nS(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new Xg(g1(g1({},m7),e?.storageOptions)),this.relayer=new VE({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new XE(this,this.logger),this.verify=new aS(this,this.logger,this.storage),this.echoClient=new hS(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new pS(this,this.logger,e?.telemetryEnabled)}static async init(e){const r=new Ah(e);await r.initialize();const i=await r.crypto.getClientId();return await r.storage.setItem(O7,i),r}get context(){return pr(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(kp,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(kp)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const mS=Ah,b1="wc",m1=2,y1="client",Mh=`${b1}@${m1}:${y1}:`,Ph={name:y1,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.org"},w1="WALLETCONNECT_DEEPLINK_CHOICE",yS="proposal",_1="Proposal expired",wS="session",Ds=Z.SEVEN_DAYS,_S="engine",zt={wc_sessionPropose:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1104},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1106},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1112},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1114},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:Z.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:Z.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1119}}},Dh={min:Z.FIVE_MINUTES,max:Z.SEVEN_DAYS},Di={idle:"IDLE",active:"ACTIVE"},x1={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"}},xS="request",ES=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],SS="wc",IS="auth",AS="authKeys",MS="pairingTopics",PS="requests",ec=`${SS}@${1.5}:${IS}:`,tc=`${ec}:PUB_KEY`;var DS=Object.defineProperty,$S=Object.defineProperties,OS=Object.getOwnPropertyDescriptors,E1=Object.getOwnPropertySymbols,RS=Object.prototype.hasOwnProperty,NS=Object.prototype.propertyIsEnumerable,$h=(t,e,r)=>e in t?DS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,mt=(t,e)=>{for(var r in e||(e={}))RS.call(e,r)&&$h(t,r,e[r]);if(E1)for(var r of E1(e))NS.call(e,r)&&$h(t,r,e[r]);return t},_r=(t,e)=>$S(t,OS(e)),J=(t,e,r)=>$h(t,typeof e!="symbol"?e+"":e,r);class CS extends Vb{constructor(e){super(e),J(this,"name",_S),J(this,"events",new er.exports),J(this,"initialized",!1),J(this,"requestQueue",{state:Di.idle,queue:[]}),J(this,"sessionRequestQueue",{state:Di.idle,queue:[]}),J(this,"requestQueueDelay",Z.ONE_SECOND),J(this,"expectedPairingMethodMap",new Map),J(this,"recentlyDeletedMap",new Map),J(this,"recentlyDeletedLimit",200),J(this,"relayMessageCache",[]),J(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(zt)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},Z.toMiliseconds(this.requestQueueDelay)))}),J(this,"connect",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const i=_r(mt({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(i);const{pairingTopic:n,requiredNamespaces:s,optionalNamespaces:o,sessionProperties:a,relays:h}=i;let u=n,p,b=!1;try{if(u){const L=this.client.core.pairing.pairings.get(u);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),b=L.active}}catch(L){throw this.client.logger.error(`connect() -> pairing.get(${u}) failed`),L}if(!u||!b){const{topic:L,uri:z}=await this.client.core.pairing.create();u=L,p=z}if(!u){const{message:L}=Q("NO_MATCHING_KEY",`connect() pairing topic: ${u}`);throw new Error(L)}const S=await this.client.core.crypto.generateKeyPair(),A=zt.wc_sessionPropose.req.ttl||Z.FIVE_MINUTES,I=Nt(A),P=mt({requiredNamespaces:s,optionalNamespaces:o,relays:h??[{protocol:jp}],proposer:{publicKey:S,metadata:this.client.metadata},expiryTimestamp:I,pairingTopic:u},a&&{sessionProperties:a}),{reject:R,resolve:O,done:N}=qn(A,_1);this.events.once(Ie("session_connect"),async({error:L,session:z})=>{if(L)R(L);else if(z){z.self.publicKey=S;const k=_r(mt({},z),{pairingTopic:P.pairingTopic,requiredNamespaces:P.requiredNamespaces,optionalNamespaces:P.optionalNamespaces,transportType:gt.relay});await this.client.session.set(z.topic,k),await this.setExpiry(z.topic,z.expiry),u&&await this.client.core.pairing.updateMetadata({topic:u,metadata:z.peer.metadata}),this.cleanupDuplicatePairings(k),O(k)}});const F=await this.sendRequest({topic:u,method:"wc_sessionPropose",params:P,throwOnFailedPublish:!0});return await this.setProposal(F,mt({id:F},P)),{uri:p,approval:N}}),J(this,"pair",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(r)}catch(i){throw this.client.logger.error("pair() failed"),i}}),J(this,"approve",async r=>{var i,n,s;const o=this.client.core.eventClient.createEvent({properties:{topic:(i=r?.id)==null?void 0:i.toString(),trace:[oi.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(K){throw o.setError(Hn.no_internet_connection),K}try{await this.isValidProposalId(r?.id)}catch(K){throw this.client.logger.error(`approve() -> proposal.get(${r?.id}) failed`),o.setError(Hn.proposal_not_found),K}try{await this.isValidApprove(r)}catch(K){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(Hn.session_approve_namespace_validation_failure),K}const{id:a,relayProtocol:h,namespaces:u,sessionProperties:p,sessionConfig:b}=r,S=this.client.proposal.get(a);this.client.core.eventClient.deleteEvent({eventId:o.eventId});const{pairingTopic:A,proposer:I,requiredNamespaces:P,optionalNamespaces:R}=S;let O=(n=this.client.core.eventClient)==null?void 0:n.getEvent({topic:A});O||(O=(s=this.client.core.eventClient)==null?void 0:s.createEvent({type:oi.session_approve_started,properties:{topic:A,trace:[oi.session_approve_started,oi.session_namespaces_validation_success]}}));const N=await this.client.core.crypto.generateKeyPair(),F=I.publicKey,L=await this.client.core.crypto.generateSharedKey(N,F),z=mt(mt({relay:{protocol:h??"irn"},namespaces:u,controller:{publicKey:N,metadata:this.client.metadata},expiry:Nt(Ds)},p&&{sessionProperties:p}),b&&{sessionConfig:b}),k=gt.relay;O.addTrace(oi.subscribing_session_topic);try{await this.client.core.relayer.subscribe(L,{transportType:k})}catch(K){throw O.setError(Hn.subscribe_session_topic_failure),K}O.addTrace(oi.subscribe_session_topic_success);const G=_r(mt({},z),{topic:L,requiredNamespaces:P,optionalNamespaces:R,pairingTopic:A,acknowledged:!1,self:z.controller,peer:{publicKey:I.publicKey,metadata:I.metadata},controller:N,transportType:gt.relay});await this.client.session.set(L,G),O.addTrace(oi.store_session);try{O.addTrace(oi.publishing_session_settle),await this.sendRequest({topic:L,method:"wc_sessionSettle",params:z,throwOnFailedPublish:!0}).catch(K=>{throw O?.setError(Hn.session_settle_publish_failure),K}),O.addTrace(oi.session_settle_publish_success),O.addTrace(oi.publishing_session_approve),await this.sendResult({id:a,topic:A,result:{relay:{protocol:h??"irn"},responderPublicKey:N},throwOnFailedPublish:!0}).catch(K=>{throw O?.setError(Hn.session_approve_publish_failure),K}),O.addTrace(oi.session_approve_publish_success)}catch(K){throw this.client.logger.error(K),this.client.session.delete(L,dt("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(L),K}return this.client.core.eventClient.deleteEvent({eventId:O.eventId}),await this.client.core.pairing.updateMetadata({topic:A,metadata:I.metadata}),await this.client.proposal.delete(a,dt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:A}),await this.setExpiry(L,Nt(Ds)),{topic:L,acknowledged:()=>Promise.resolve(this.client.session.get(L))}}),J(this,"reject",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(r)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}const{id:i,reason:n}=r;let s;try{s=this.client.proposal.get(i).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${i}) failed`),o}s&&(await this.sendError({id:i,topic:s,error:n,rpcOpts:zt.wc_sessionPropose.reject}),await this.client.proposal.delete(i,dt("USER_DISCONNECTED")))}),J(this,"update",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(r)}catch(b){throw this.client.logger.error("update() -> isValidUpdate() failed"),b}const{topic:i,namespaces:n}=r,{done:s,resolve:o,reject:a}=qn(),h=ki(),u=zn().toString(),p=this.client.session.get(i).namespaces;return this.events.once(Ie("session_update",h),({error:b})=>{b?a(b):o()}),await this.client.session.update(i,{namespaces:n}),await this.sendRequest({topic:i,method:"wc_sessionUpdate",params:{namespaces:n},throwOnFailedPublish:!0,clientRpcId:h,relayRpcId:u}).catch(b=>{this.client.logger.error(b),this.client.session.update(i,{namespaces:p}),a(b)}),{acknowledged:s}}),J(this,"extend",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(r)}catch(h){throw this.client.logger.error("extend() -> isValidExtend() failed"),h}const{topic:i}=r,n=ki(),{done:s,resolve:o,reject:a}=qn();return this.events.once(Ie("session_extend",n),({error:h})=>{h?a(h):o()}),await this.setExpiry(i,Nt(Ds)),this.sendRequest({topic:i,method:"wc_sessionExtend",params:{},clientRpcId:n,throwOnFailedPublish:!0}).catch(h=>{a(h)}),{acknowledged:s}}),J(this,"request",async r=>{this.isInitialized();try{await this.isValidRequest(r)}catch(O){throw this.client.logger.error("request() -> isValidRequest() failed"),O}const{chainId:i,request:n,topic:s,expiry:o=zt.wc_sessionRequest.req.ttl}=r,a=this.client.session.get(s);a?.transportType===gt.relay&&await this.confirmOnlineStateOrThrow();const h=ki(),u=zn().toString(),{done:p,resolve:b,reject:S}=qn(o,"Request expired. Please try again.");this.events.once(Ie("session_request",h),({error:O,result:N})=>{O?S(O):b(N)});const A="wc_sessionRequest",I=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(I)return await this.sendRequest({clientRpcId:h,relayRpcId:u,topic:s,method:A,params:{request:_r(mt({},n),{expiryTimestamp:Nt(o)}),chainId:i},expiry:o,throwOnFailedPublish:!0,appLink:I}).catch(O=>S(O)),this.client.events.emit("session_request_sent",{topic:s,request:n,chainId:i,id:h}),await p();const P={request:_r(mt({},n),{expiryTimestamp:Nt(o)}),chainId:i},R=this.shouldSetTVF(A,P);return await Promise.all([new Promise(async O=>{await this.sendRequest(mt({clientRpcId:h,relayRpcId:u,topic:s,method:A,params:P,expiry:o,throwOnFailedPublish:!0},R&&{tvf:this.getTVFParams(h,P)})).catch(N=>S(N)),this.client.events.emit("session_request_sent",{topic:s,request:n,chainId:i,id:h}),O()}),new Promise(async O=>{var N;if(!((N=a.sessionConfig)!=null&&N.disableDeepLink)){const F=await j8(this.client.core.storage,w1);await q8({id:h,topic:s,wcDeepLink:F})}O()}),p()]).then(O=>O[2])}),J(this,"respond",async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:i,response:n}=r,{id:s}=n,o=this.client.session.get(i);o.transportType===gt.relay&&await this.confirmOnlineStateOrThrow();const a=this.getAppLinkIfEnabled(o.peer.metadata,o.transportType);Si(n)?await this.sendResult({id:s,topic:i,result:n.result,throwOnFailedPublish:!0,appLink:a}):Hr(n)&&await this.sendError({id:s,topic:i,error:n.error,appLink:a}),this.cleanupAfterResponse(r)}),J(this,"ping",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(r)}catch(n){throw this.client.logger.error("ping() -> isValidPing() failed"),n}const{topic:i}=r;if(this.client.session.keys.includes(i)){const n=ki(),s=zn().toString(),{done:o,resolve:a,reject:h}=qn();this.events.once(Ie("session_ping",n),({error:u})=>{u?h(u):a()}),await Promise.all([this.sendRequest({topic:i,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:n,relayRpcId:s}),o()])}else this.client.core.pairing.pairings.keys.includes(i)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:i}))}),J(this,"emit",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(r);const{topic:i,event:n,chainId:s}=r,o=zn().toString(),a=ki();await this.sendRequest({topic:i,method:"wc_sessionEvent",params:{event:n,chainId:s},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:a})}),J(this,"disconnect",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(r);const{topic:i}=r;if(this.client.session.keys.includes(i))await this.sendRequest({topic:i,method:"wc_sessionDelete",params:dt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:i,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(i))await this.client.core.pairing.disconnect({topic:i});else{const{message:n}=Q("MISMATCHED_TOPIC",`Session or pairing topic not found: ${i}`);throw new Error(n)}}),J(this,"find",r=>(this.isInitialized(),this.client.session.getAll().filter(i=>Y_(i,r)))),J(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),J(this,"authenticate",async(r,i)=>{var n;this.isInitialized(),this.isValidAuthenticate(r);const s=i&&this.client.core.linkModeSupportedApps.includes(i)&&((n=this.client.metadata.redirect)==null?void 0:n.linkMode),o=s?gt.link_mode:gt.relay;o===gt.relay&&await this.confirmOnlineStateOrThrow();const{chains:a,statement:h="",uri:u,domain:p,nonce:b,type:S,exp:A,nbf:I,methods:P=[],expiry:R}=r,O=[...r.resources||[]],{topic:N,uri:F}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:N,uri:F}});const L=await this.client.core.crypto.generateKeyPair(),z=Ha(L);if(await Promise.all([this.client.auth.authKeys.set(tc,{responseTopic:z,publicKey:L}),this.client.auth.pairingTopics.set(z,{topic:z,pairingTopic:N})]),await this.client.core.relayer.subscribe(z,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${N}`),P.length>0){const{namespace:x}=ws(a[0]);let y=$5(x,"request",P);Ua(O)&&(y=R5(y,O.pop())),O.push(y)}const k=R&&R>zt.wc_sessionAuthenticate.req.ttl?R:zt.wc_sessionAuthenticate.req.ttl,G={authPayload:{type:S??"caip122",chains:a,statement:h,aud:u,domain:p,version:"1",nonce:b,iat:new Date().toISOString(),exp:A,nbf:I,resources:O},requester:{publicKey:L,metadata:this.client.metadata},expiryTimestamp:Nt(k)},K={eip155:{chains:a,methods:[...new Set(["personal_sign",...P])],events:["chainChanged","accountsChanged"]}},H={requiredNamespaces:{},optionalNamespaces:K,relays:[{protocol:"irn"}],pairingTopic:N,proposer:{publicKey:L,metadata:this.client.metadata},expiryTimestamp:Nt(zt.wc_sessionPropose.req.ttl)},{done:ie,resolve:D,reject:g}=qn(k,"Request expired"),v=async({error:x,session:y})=>{if(this.events.off(Ie("session_request",f),c),x)g(x);else if(y){y.self.publicKey=L,await this.client.session.set(y.topic,y),await this.setExpiry(y.topic,y.expiry),N&&await this.client.core.pairing.updateMetadata({topic:N,metadata:y.peer.metadata});const d=this.client.session.get(y.topic);await this.deleteProposal(l),D({session:d})}},c=async x=>{var y,d,w;if(await this.deletePendingAuthRequest(f,{message:"fulfilled",code:0}),x.error){const U=dt("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return x.error.code===U.code?void 0:(this.events.off(Ie("session_connect"),v),g(x.error.message))}await this.deleteProposal(l),this.events.off(Ie("session_connect"),v);const{cacaos:m,responder:M}=x.result,B=[],E=[];for(const U of m){await $0({cacao:U,projectId:this.client.core.projectId})||(this.client.logger.error(U,"Signature verification failed"),g(dt("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:j}=U,Y=Ua(j.resources),X=[Hf(j.iss)],W=La(j.iss);if(Y){const se=N0(Y),ee=C0(Y);B.push(...se),X.push(...ee)}for(const se of X)E.push(`${se}:${W}`)}const C=await this.client.core.crypto.generateSharedKey(L,M.publicKey);let q;B.length>0&&(q={topic:C,acknowledged:!0,self:{publicKey:L,metadata:this.client.metadata},peer:M,controller:M.publicKey,expiry:Nt(Ds),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:N,namespaces:lp([...new Set(B)],[...new Set(E)]),transportType:o},await this.client.core.relayer.subscribe(C,{transportType:o}),await this.client.session.set(C,q),N&&await this.client.core.pairing.updateMetadata({topic:N,metadata:M.metadata}),q=this.client.session.get(C)),(y=this.client.metadata.redirect)!=null&&y.linkMode&&(d=M.metadata.redirect)!=null&&d.linkMode&&(w=M.metadata.redirect)!=null&&w.universal&&i&&(this.client.core.addLinkModeSupportedApp(M.metadata.redirect.universal),this.client.session.update(C,{transportType:gt.link_mode})),D({auths:m,session:q})},f=ki(),l=ki();this.events.once(Ie("session_connect"),v),this.events.once(Ie("session_request",f),c);let _;try{if(s){const x=yn("wc_sessionAuthenticate",G,f);this.client.core.history.set(N,x);const y=await this.client.core.crypto.encode("",x,{type:So,encoding:xo});_=Va(i,N,y)}else await Promise.all([this.sendRequest({topic:N,method:"wc_sessionAuthenticate",params:G,expiry:r.expiry,throwOnFailedPublish:!0,clientRpcId:f}),this.sendRequest({topic:N,method:"wc_sessionPropose",params:H,expiry:zt.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:l})])}catch(x){throw this.events.off(Ie("session_connect"),v),this.events.off(Ie("session_request",f),c),x}return await this.setProposal(l,mt({id:l},H)),await this.setAuthRequest(f,{request:_r(mt({},G),{verifyContext:{}}),pairingTopic:N,transportType:o}),{uri:_??F,response:ie}}),J(this,"approveSessionAuthenticate",async r=>{const{id:i,auths:n}=r,s=this.client.core.eventClient.createEvent({properties:{topic:i.toString(),trace:[Kn.authenticated_session_approve_started]}});try{this.isInitialized()}catch(R){throw s.setError(To.no_internet_connection),R}const o=this.getPendingAuthRequest(i);if(!o)throw s.setError(To.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${i}`);const a=o.transportType||gt.relay;a===gt.relay&&await this.confirmOnlineStateOrThrow();const h=o.requester.publicKey,u=await this.client.core.crypto.generateKeyPair(),p=Ha(h),b={type:Li,receiverPublicKey:h,senderPublicKey:u},S=[],A=[];for(const R of n){if(!await $0({cacao:R,projectId:this.client.core.projectId})){s.setError(To.invalid_cacao);const z=dt("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:i,topic:p,error:z,encodeOpts:b}),new Error(z.message)}s.addTrace(Kn.cacaos_verified);const{p:O}=R,N=Ua(O.resources),F=[Hf(O.iss)],L=La(O.iss);if(N){const z=N0(N),k=C0(N);S.push(...z),F.push(...k)}for(const z of F)A.push(`${z}:${L}`)}const I=await this.client.core.crypto.generateSharedKey(u,h);s.addTrace(Kn.create_authenticated_session_topic);let P;if(S?.length>0){P={topic:I,acknowledged:!0,self:{publicKey:u,metadata:this.client.metadata},peer:{publicKey:h,metadata:o.requester.metadata},controller:h,expiry:Nt(Ds),authentication:n,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:lp([...new Set(S)],[...new Set(A)]),transportType:a},s.addTrace(Kn.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(I,{transportType:a})}catch(R){throw s.setError(To.subscribe_authenticated_session_topic_failure),R}s.addTrace(Kn.subscribe_authenticated_session_topic_success),await this.client.session.set(I,P),s.addTrace(Kn.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}s.addTrace(Kn.publishing_authenticated_session_approve);try{await this.sendResult({topic:p,id:i,result:{cacaos:n,responder:{publicKey:u,metadata:this.client.metadata}},encodeOpts:b,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,a)})}catch(R){throw s.setError(To.authenticated_session_approve_publish_failure),R}return await this.client.auth.requests.delete(i,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:s.eventId}),{session:P}}),J(this,"rejectSessionAuthenticate",async r=>{this.isInitialized();const{id:i,reason:n}=r,s=this.getPendingAuthRequest(i);if(!s)throw new Error(`Could not find pending auth request with id ${i}`);s.transportType===gt.relay&&await this.confirmOnlineStateOrThrow();const o=s.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),h=Ha(o),u={type:Li,receiverPublicKey:o,senderPublicKey:a};await this.sendError({id:i,topic:h,error:n,encodeOpts:u,rpcOpts:zt.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(s.requester.metadata,s.transportType)}),await this.client.auth.requests.delete(i,{message:"rejected",code:0}),await this.client.proposal.delete(i,dt("USER_DISCONNECTED"))}),J(this,"formatAuthMessage",r=>{this.isInitialized();const{request:i,iss:n}=r;return O0(i,n)}),J(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const r=this.relayMessageCache.shift();r&&await this.onRelayMessage(r)}catch(r){this.client.logger.error(r)}},50)}),J(this,"cleanupDuplicatePairings",async r=>{if(r.pairingTopic)try{const i=this.client.core.pairing.pairings.get(r.pairingTopic),n=this.client.core.pairing.pairings.getAll().filter(s=>{var o,a;return((o=s.peerMetadata)==null?void 0:o.url)&&((a=s.peerMetadata)==null?void 0:a.url)===r.peer.metadata.url&&s.topic&&s.topic!==i.topic});if(n.length===0)return;this.client.logger.info(`Cleaning up ${n.length} duplicate pairing(s)`),await Promise.all(n.map(s=>this.client.core.pairing.disconnect({topic:s.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(i){this.client.logger.error(i)}}),J(this,"deleteSession",async r=>{var i;const{topic:n,expirerHasDeleted:s=!1,emitEvent:o=!0,id:a=0}=r,{self:h}=this.client.session.get(n);await this.client.core.relayer.unsubscribe(n),await this.client.session.delete(n,dt("USER_DISCONNECTED")),this.addToRecentlyDeleted(n,"session"),this.client.core.crypto.keychain.has(h.publicKey)&&await this.client.core.crypto.deleteKeyPair(h.publicKey),this.client.core.crypto.keychain.has(n)&&await this.client.core.crypto.deleteSymKey(n),s||this.client.core.expirer.del(n),this.client.core.storage.removeItem(w1).catch(u=>this.client.logger.warn(u)),this.getPendingSessionRequests().forEach(u=>{u.topic===n&&this.deletePendingSessionRequest(u.id,dt("USER_DISCONNECTED"))}),n===((i=this.sessionRequestQueue.queue[0])==null?void 0:i.topic)&&(this.sessionRequestQueue.state=Di.idle),o&&this.client.events.emit("session_delete",{id:a,topic:n})}),J(this,"deleteProposal",async(r,i)=>{if(i)try{const n=this.client.proposal.get(r),s=this.client.core.eventClient.getEvent({topic:n.pairingTopic});s?.setError(Hn.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(r,dt("USER_DISCONNECTED")),i?Promise.resolve():this.client.core.expirer.del(r)]),this.addToRecentlyDeleted(r,"proposal")}),J(this,"deletePendingSessionRequest",async(r,i,n=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,i),n?Promise.resolve():this.client.core.expirer.del(r)]),this.addToRecentlyDeleted(r,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(s=>s.id!==r),n&&(this.sessionRequestQueue.state=Di.idle,this.client.events.emit("session_request_expire",{id:r}))}),J(this,"deletePendingAuthRequest",async(r,i,n=!1)=>{await Promise.all([this.client.auth.requests.delete(r,i),n?Promise.resolve():this.client.core.expirer.del(r)])}),J(this,"setExpiry",async(r,i)=>{this.client.session.keys.includes(r)&&(this.client.core.expirer.set(r,i),await this.client.session.update(r,{expiry:i}))}),J(this,"setProposal",async(r,i)=>{this.client.core.expirer.set(r,Nt(zt.wc_sessionPropose.req.ttl)),await this.client.proposal.set(r,i)}),J(this,"setAuthRequest",async(r,i)=>{const{request:n,pairingTopic:s,transportType:o=gt.relay}=i;this.client.core.expirer.set(r,n.expiryTimestamp),await this.client.auth.requests.set(r,{authPayload:n.authPayload,requester:n.requester,expiryTimestamp:n.expiryTimestamp,id:r,pairingTopic:s,verifyContext:n.verifyContext,transportType:o})}),J(this,"setPendingSessionRequest",async r=>{const{id:i,topic:n,params:s,verifyContext:o}=r,a=s.request.expiryTimestamp||Nt(zt.wc_sessionRequest.req.ttl);this.client.core.expirer.set(i,a),await this.client.pendingRequest.set(i,{id:i,topic:n,params:s,verifyContext:o})}),J(this,"sendRequest",async r=>{const{topic:i,method:n,params:s,expiry:o,relayRpcId:a,clientRpcId:h,throwOnFailedPublish:u,appLink:p,tvf:b}=r,S=yn(n,s,h);let A;const I=!!p;try{const O=I?xo:mn;A=await this.client.core.crypto.encode(i,S,{encoding:O})}catch(O){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${i} failed`),O}let P;if(ES.includes(n)){const O=Ui(JSON.stringify(S)),N=Ui(A);P=await this.client.core.verify.register({id:N,decryptedId:O})}const R=zt[n].req;if(R.attestation=P,o&&(R.ttl=o),a&&(R.id=a),this.client.core.history.set(i,S),I){const O=Va(p,i,A);await global.Linking.openURL(O,this.client.name)}else{const O=zt[n].req;o&&(O.ttl=o),a&&(O.id=a),O.tvf=_r(mt({},b),{correlationId:S.id}),u?(O.internal=_r(mt({},O.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(i,A,O)):this.client.core.relayer.publish(i,A,O).catch(N=>this.client.logger.error(N))}return S.id}),J(this,"sendResult",async r=>{const{id:i,topic:n,result:s,throwOnFailedPublish:o,encodeOpts:a,appLink:h}=r,u=Wa(i,s);let p;const b=h&&typeof(global==null?void 0:global.Linking)<"u";try{const I=b?xo:mn;p=await this.client.core.crypto.encode(n,u,_r(mt({},a||{}),{encoding:I}))}catch(I){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${n} failed`),I}let S,A;try{S=await this.client.core.history.get(n,i);const I=S.request;try{this.shouldSetTVF(I.method,I.params)&&(A=this.getTVFParams(i,I.params,s))}catch(P){this.client.logger.warn("sendResult() -> getTVFParams() failed",P)}}catch(I){throw this.client.logger.error(`sendResult() -> history.get(${n}, ${i}) failed`),I}if(b){const I=Va(h,n,p);await global.Linking.openURL(I,this.client.name)}else{const I=zt[S.request.method].res;I.tvf=_r(mt({},A),{correlationId:i}),o?(I.internal=_r(mt({},I.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,p,I)):this.client.core.relayer.publish(n,p,I).catch(P=>this.client.logger.error(P))}await this.client.core.history.resolve(u)}),J(this,"sendError",async r=>{const{id:i,topic:n,error:s,encodeOpts:o,rpcOpts:a,appLink:h}=r,u=Ja(i,s);let p;const b=h&&typeof(global==null?void 0:global.Linking)<"u";try{const A=b?xo:mn;p=await this.client.core.crypto.encode(n,u,_r(mt({},o||{}),{encoding:A}))}catch(A){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${n} failed`),A}let S;try{S=await this.client.core.history.get(n,i)}catch(A){throw this.client.logger.error(`sendError() -> history.get(${n}, ${i}) failed`),A}if(b){const A=Va(h,n,p);await global.Linking.openURL(A,this.client.name)}else{const A=a||zt[S.request.method].res;this.client.core.relayer.publish(n,p,A)}await this.client.core.history.resolve(u)}),J(this,"cleanup",async()=>{const r=[],i=[];this.client.session.getAll().forEach(n=>{let s=!1;pn(n.expiry)&&(s=!0),this.client.core.crypto.keychain.has(n.topic)||(s=!0),s&&r.push(n.topic)}),this.client.proposal.getAll().forEach(n=>{pn(n.expiryTimestamp)&&i.push(n.id)}),await Promise.all([...r.map(n=>this.deleteSession({topic:n})),...i.map(n=>this.deleteProposal(n))])}),J(this,"onRelayEventRequest",async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()}),J(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===Di.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Di.active;const r=this.requestQueue.queue.shift();if(r)try{await this.processRequest(r)}catch(i){this.client.logger.warn(i)}}this.requestQueue.state=Di.idle}),J(this,"processRequest",async r=>{const{topic:i,payload:n,attestation:s,transportType:o,encryptedId:a}=r,h=n.method;if(!this.shouldIgnorePairingRequest({topic:i,requestMethod:h}))switch(h){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:i,payload:n,attestation:s,encryptedId:a});case"wc_sessionSettle":return await this.onSessionSettleRequest(i,n);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(i,n);case"wc_sessionExtend":return await this.onSessionExtendRequest(i,n);case"wc_sessionPing":return await this.onSessionPingRequest(i,n);case"wc_sessionDelete":return await this.onSessionDeleteRequest(i,n);case"wc_sessionRequest":return await this.onSessionRequest({topic:i,payload:n,attestation:s,encryptedId:a,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(i,n);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:i,payload:n,attestation:s,encryptedId:a,transportType:o});default:return this.client.logger.info(`Unsupported request method ${h}`)}}),J(this,"onRelayEventResponse",async r=>{const{topic:i,payload:n,transportType:s}=r,o=(await this.client.core.history.get(i,n.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(i,n,s);case"wc_sessionSettle":return this.onSessionSettleResponse(i,n);case"wc_sessionUpdate":return this.onSessionUpdateResponse(i,n);case"wc_sessionExtend":return this.onSessionExtendResponse(i,n);case"wc_sessionPing":return this.onSessionPingResponse(i,n);case"wc_sessionRequest":return this.onSessionRequestResponse(i,n);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(i,n);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),J(this,"onRelayEventUnknownPayload",r=>{const{topic:i}=r,{message:n}=Q("MISSING_OR_INVALID",`Decoded payload on topic ${i} is not identifiable as a JSON-RPC request or a response.`);throw new Error(n)}),J(this,"shouldIgnorePairingRequest",r=>{const{topic:i,requestMethod:n}=r,s=this.expectedPairingMethodMap.get(i);return!s||s.includes(n)?!1:!!(s.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),J(this,"onSessionProposeRequest",async r=>{const{topic:i,payload:n,attestation:s,encryptedId:o}=r,{params:a,id:h}=n;try{const u=this.client.core.eventClient.getEvent({topic:i});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),u?.setError(Hi.proposal_listener_not_found)),this.isValidConnect(mt({},n.params));const p=a.expiryTimestamp||Nt(zt.wc_sessionPropose.req.ttl),b=mt({id:h,pairingTopic:i,expiryTimestamp:p},a);await this.setProposal(h,b);const S=await this.getVerifyContext({attestationId:s,hash:Ui(JSON.stringify(n)),encryptedId:o,metadata:b.proposer.metadata});u?.addTrace(Ai.emit_session_proposal),this.client.events.emit("session_proposal",{id:h,params:b,verifyContext:S})}catch(u){await this.sendError({id:h,topic:i,error:u,rpcOpts:zt.wc_sessionPropose.autoReject}),this.client.logger.error(u)}}),J(this,"onSessionProposeResponse",async(r,i,n)=>{const{id:s}=i;if(Si(i)){const{result:o}=i;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});const a=this.client.proposal.get(s);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const h=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:h});const u=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:u});const p=await this.client.core.crypto.generateSharedKey(h,u);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:p});const b=await this.client.core.relayer.subscribe(p,{transportType:n});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:b}),await this.client.core.pairing.activate({topic:r})}else if(Hr(i)){await this.client.proposal.delete(s,dt("USER_DISCONNECTED"));const o=Ie("session_connect");if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(Ie("session_connect"),{error:i.error})}}),J(this,"onSessionSettleRequest",async(r,i)=>{const{id:n,params:s}=i;try{this.isValidSessionSettleRequest(s);const{relay:o,controller:a,expiry:h,namespaces:u,sessionProperties:p,sessionConfig:b}=i.params,S=_r(mt(mt({topic:r,relay:o,expiry:h,namespaces:u,acknowledged:!0,pairingTopic:"",requiredNamespaces:{},optionalNamespaces:{},controller:a.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},p&&{sessionProperties:p}),b&&{sessionConfig:b}),{transportType:gt.relay}),A=Ie("session_connect");if(this.events.listenerCount(A)===0)throw new Error(`emitting ${A} without any listeners 997`);this.events.emit(Ie("session_connect"),{session:S}),await this.sendResult({id:i.id,topic:r,result:!0,throwOnFailedPublish:!0})}catch(o){await this.sendError({id:n,topic:r,error:o}),this.client.logger.error(o)}}),J(this,"onSessionSettleResponse",async(r,i)=>{const{id:n}=i;Si(i)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Ie("session_approve",n),{})):Hr(i)&&(await this.client.session.delete(r,dt("USER_DISCONNECTED")),this.events.emit(Ie("session_approve",n),{error:i.error}))}),J(this,"onSessionUpdateRequest",async(r,i)=>{const{params:n,id:s}=i;try{const o=`${r}_session_update`,a=$o.get(o);if(a&&this.isRequestOutOfSync(a,s)){this.client.logger.warn(`Discarding out of sync request - ${s}`),this.sendError({id:s,topic:r,error:dt("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(mt({topic:r},n));try{$o.set(o,s),await this.client.session.update(r,{namespaces:n.namespaces}),await this.sendResult({id:s,topic:r,result:!0,throwOnFailedPublish:!0})}catch(h){throw $o.delete(o),h}this.client.events.emit("session_update",{id:s,topic:r,params:n})}catch(o){await this.sendError({id:s,topic:r,error:o}),this.client.logger.error(o)}}),J(this,"isRequestOutOfSync",(r,i)=>i.toString().slice(0,-3)<r.toString().slice(0,-3)),J(this,"onSessionUpdateResponse",(r,i)=>{const{id:n}=i,s=Ie("session_update",n);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);Si(i)?this.events.emit(Ie("session_update",n),{}):Hr(i)&&this.events.emit(Ie("session_update",n),{error:i.error})}),J(this,"onSessionExtendRequest",async(r,i)=>{const{id:n}=i;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Nt(Ds)),await this.sendResult({id:n,topic:r,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_extend",{id:n,topic:r})}catch(s){await this.sendError({id:n,topic:r,error:s}),this.client.logger.error(s)}}),J(this,"onSessionExtendResponse",(r,i)=>{const{id:n}=i,s=Ie("session_extend",n);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);Si(i)?this.events.emit(Ie("session_extend",n),{}):Hr(i)&&this.events.emit(Ie("session_extend",n),{error:i.error})}),J(this,"onSessionPingRequest",async(r,i)=>{const{id:n}=i;try{this.isValidPing({topic:r}),await this.sendResult({id:n,topic:r,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:n,topic:r})}catch(s){await this.sendError({id:n,topic:r,error:s}),this.client.logger.error(s)}}),J(this,"onSessionPingResponse",(r,i)=>{const{id:n}=i,s=Ie("session_ping",n);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);setTimeout(()=>{Si(i)?this.events.emit(Ie("session_ping",n),{}):Hr(i)&&this.events.emit(Ie("session_ping",n),{error:i.error})},500)}),J(this,"onSessionDeleteRequest",async(r,i)=>{const{id:n}=i;try{this.isValidDisconnect({topic:r,reason:i.params}),Promise.all([new Promise(s=>{this.client.core.relayer.once(Ut.publish,async()=>{s(await this.deleteSession({topic:r,id:n}))})}),this.sendResult({id:n,topic:r,result:!0,throwOnFailedPublish:!0}),this.cleanupPendingSentRequestsForTopic({topic:r,error:dt("USER_DISCONNECTED")})]).catch(s=>this.client.logger.error(s))}catch(s){this.client.logger.error(s)}}),J(this,"onSessionRequest",async r=>{var i,n,s;const{topic:o,payload:a,attestation:h,encryptedId:u,transportType:p}=r,{id:b,params:S}=a;try{await this.isValidRequest(mt({topic:o},S));const A=this.client.session.get(o),I=await this.getVerifyContext({attestationId:h,hash:Ui(JSON.stringify(yn("wc_sessionRequest",S,b))),encryptedId:u,metadata:A.peer.metadata,transportType:p}),P={id:b,topic:o,params:S,verifyContext:I};await this.setPendingSessionRequest(P),p===gt.link_mode&&(i=A.peer.metadata.redirect)!=null&&i.universal&&this.client.core.addLinkModeSupportedApp((n=A.peer.metadata.redirect)==null?void 0:n.universal),(s=this.client.signConfig)!=null&&s.disableRequestQueue?this.emitSessionRequest(P):(this.addSessionRequestToSessionRequestQueue(P),this.processSessionRequestQueue())}catch(A){await this.sendError({id:b,topic:o,error:A}),this.client.logger.error(A)}}),J(this,"onSessionRequestResponse",(r,i)=>{const{id:n}=i,s=Ie("session_request",n);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);Si(i)?this.events.emit(Ie("session_request",n),{result:i.result}):Hr(i)&&this.events.emit(Ie("session_request",n),{error:i.error})}),J(this,"onSessionEventRequest",async(r,i)=>{const{id:n,params:s}=i;try{const o=`${r}_session_event_${s.event.name}`,a=$o.get(o);if(a&&this.isRequestOutOfSync(a,n)){this.client.logger.info(`Discarding out of sync request - ${n}`);return}this.isValidEmit(mt({topic:r},s)),this.client.events.emit("session_event",{id:n,topic:r,params:s}),$o.set(o,n)}catch(o){await this.sendError({id:n,topic:r,error:o}),this.client.logger.error(o)}}),J(this,"onSessionAuthenticateResponse",(r,i)=>{const{id:n}=i;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:r,payload:i}),Si(i)?this.events.emit(Ie("session_request",n),{result:i.result}):Hr(i)&&this.events.emit(Ie("session_request",n),{error:i.error})}),J(this,"onSessionAuthenticateRequest",async r=>{var i;const{topic:n,payload:s,attestation:o,encryptedId:a,transportType:h}=r;try{const{requester:u,authPayload:p,expiryTimestamp:b}=s.params,S=await this.getVerifyContext({attestationId:o,hash:Ui(JSON.stringify(s)),encryptedId:a,metadata:u.metadata,transportType:h}),A={requester:u,pairingTopic:n,id:s.id,authPayload:p,verifyContext:S,expiryTimestamp:b};await this.setAuthRequest(s.id,{request:A,pairingTopic:n,transportType:h}),h===gt.link_mode&&(i=u.metadata.redirect)!=null&&i.universal&&this.client.core.addLinkModeSupportedApp(u.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:n,params:s.params,id:s.id,verifyContext:S})}catch(u){this.client.logger.error(u);const p=s.params.requester.publicKey,b=await this.client.core.crypto.generateKeyPair(),S=this.getAppLinkIfEnabled(s.params.requester.metadata,h),A={type:Li,receiverPublicKey:p,senderPublicKey:b};await this.sendError({id:s.id,topic:n,error:u,encodeOpts:A,rpcOpts:zt.wc_sessionAuthenticate.autoReject,appLink:S})}}),J(this,"addSessionRequestToSessionRequestQueue",r=>{this.sessionRequestQueue.queue.push(r)}),J(this,"cleanupAfterResponse",r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Di.idle,this.processSessionRequestQueue()},Z.toMiliseconds(this.requestQueueDelay))}),J(this,"cleanupPendingSentRequestsForTopic",({topic:r,error:i})=>{const n=this.client.core.history.pending;n.length>0&&n.filter(s=>s.topic===r&&s.request.method==="wc_sessionRequest").forEach(s=>{const o=s.request.id,a=Ie("session_request",o);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);this.events.emit(Ie("session_request",s.request.id),{error:i})})}),J(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===Di.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=Di.active,this.emitSessionRequest(r)}catch(i){this.client.logger.error(i)}}),J(this,"emitSessionRequest",r=>{this.client.events.emit("session_request",r)}),J(this,"onPairingCreated",r=>{if(r.methods&&this.expectedPairingMethodMap.set(r.topic,r.methods),r.active)return;const i=this.client.proposal.getAll().find(n=>n.pairingTopic===r.topic);i&&this.onSessionProposeRequest({topic:r.topic,payload:yn("wc_sessionPropose",{requiredNamespaces:i.requiredNamespaces,optionalNamespaces:i.optionalNamespaces,relays:i.relays,proposer:i.proposer,sessionProperties:i.sessionProperties},i.id)})}),J(this,"isValidConnect",async r=>{if(!yr(r)){const{message:h}=Q("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(h)}const{pairingTopic:i,requiredNamespaces:n,optionalNamespaces:s,sessionProperties:o,relays:a}=r;if(ur(i)||await this.isValidPairingTopic(i),!c9(a,!0)){const{message:h}=Q("MISSING_OR_INVALID",`connect() relays: ${a}`);throw new Error(h)}!ur(n)&&Do(n)!==0&&this.validateNamespaces(n,"requiredNamespaces"),!ur(s)&&Do(s)!==0&&this.validateNamespaces(s,"optionalNamespaces"),ur(o)||this.validateSessionProps(o,"sessionProperties")}),J(this,"validateNamespaces",(r,i)=>{const n=a9(r,"connect()",i);if(n)throw new Error(n.message)}),J(this,"isValidApprove",async r=>{if(!yr(r))throw new Error(Q("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:i,namespaces:n,relayProtocol:s,sessionProperties:o}=r;this.checkRecentlyDeleted(i),await this.isValidProposalId(i);const a=this.client.proposal.get(i),h=oh(n,"approve()");if(h)throw new Error(h.message);const u=mp(a.requiredNamespaces,n,"approve()");if(u)throw new Error(u.message);if(!Pt(s,!0)){const{message:p}=Q("MISSING_OR_INVALID",`approve() relayProtocol: ${s}`);throw new Error(p)}ur(o)||this.validateSessionProps(o,"sessionProperties")}),J(this,"isValidReject",async r=>{if(!yr(r)){const{message:s}=Q("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(s)}const{id:i,reason:n}=r;if(this.checkRecentlyDeleted(i),await this.isValidProposalId(i),!h9(n)){const{message:s}=Q("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(n)}`);throw new Error(s)}}),J(this,"isValidSessionSettleRequest",r=>{if(!yr(r)){const{message:u}=Q("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(u)}const{relay:i,controller:n,namespaces:s,expiry:o}=r;if(!gp(i)){const{message:u}=Q("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(u)}const a=t9(n,"onSessionSettleRequest()");if(a)throw new Error(a.message);const h=oh(s,"onSessionSettleRequest()");if(h)throw new Error(h.message);if(pn(o)){const{message:u}=Q("EXPIRED","onSessionSettleRequest()");throw new Error(u)}}),J(this,"isValidUpdate",async r=>{if(!yr(r)){const{message:h}=Q("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(h)}const{topic:i,namespaces:n}=r;this.checkRecentlyDeleted(i),await this.isValidSessionTopic(i);const s=this.client.session.get(i),o=oh(n,"update()");if(o)throw new Error(o.message);const a=mp(s.requiredNamespaces,n,"update()");if(a)throw new Error(a.message)}),J(this,"isValidExtend",async r=>{if(!yr(r)){const{message:n}=Q("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(n)}const{topic:i}=r;this.checkRecentlyDeleted(i),await this.isValidSessionTopic(i)}),J(this,"isValidRequest",async r=>{if(!yr(r)){const{message:h}=Q("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(h)}const{topic:i,request:n,chainId:s,expiry:o}=r;this.checkRecentlyDeleted(i),await this.isValidSessionTopic(i);const{namespaces:a}=this.client.session.get(i);if(!bp(a,s)){const{message:h}=Q("MISSING_OR_INVALID",`request() chainId: ${s}`);throw new Error(h)}if(!u9(n)){const{message:h}=Q("MISSING_OR_INVALID",`request() ${JSON.stringify(n)}`);throw new Error(h)}if(!p9(a,s,n.method)){const{message:h}=Q("MISSING_OR_INVALID",`request() method: ${n.method}`);throw new Error(h)}if(o&&!m9(o,Dh)){const{message:h}=Q("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${Dh.min} and ${Dh.max}`);throw new Error(h)}}),J(this,"isValidRespond",async r=>{var i;if(!yr(r)){const{message:o}=Q("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(o)}const{topic:n,response:s}=r;try{await this.isValidSessionTopic(n)}catch(o){throw(i=r?.response)!=null&&i.id&&this.cleanupAfterResponse(r),o}if(!d9(s)){const{message:o}=Q("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(s)}`);throw new Error(o)}}),J(this,"isValidPing",async r=>{if(!yr(r)){const{message:n}=Q("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)}),J(this,"isValidEmit",async r=>{if(!yr(r)){const{message:a}=Q("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(a)}const{topic:i,event:n,chainId:s}=r;await this.isValidSessionTopic(i);const{namespaces:o}=this.client.session.get(i);if(!bp(o,s)){const{message:a}=Q("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw new Error(a)}if(!l9(n)){const{message:a}=Q("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(a)}if(!v9(o,s,n.name)){const{message:a}=Q("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(a)}}),J(this,"isValidDisconnect",async r=>{if(!yr(r)){const{message:n}=Q("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)}),J(this,"isValidAuthenticate",r=>{const{chains:i,uri:n,domain:s,nonce:o}=r;if(!Array.isArray(i)||i.length===0)throw new Error("chains is required and must be a non-empty array");if(!Pt(n,!1))throw new Error("uri is required parameter");if(!Pt(s,!1))throw new Error("domain is required parameter");if(!Pt(o,!1))throw new Error("nonce is required parameter");if([...new Set(i.map(h=>ws(h).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:a}=ws(i[0]);if(a!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),J(this,"getVerifyContext",async r=>{const{attestationId:i,hash:n,encryptedId:s,metadata:o,transportType:a}=r,h={verified:{verifyUrl:o.verifyUrl||Co,validation:"UNKNOWN",origin:o.url||""}};try{if(a===gt.link_mode){const p=this.getAppLinkIfEnabled(o,a);return h.verified.validation=p&&new URL(p).origin===new URL(o.url).origin?"VALID":"INVALID",h}const u=await this.client.core.verify.resolve({attestationId:i,hash:n,encryptedId:s,verifyUrl:o.verifyUrl});u&&(h.verified.origin=u.origin,h.verified.isScam=u.isScam,h.verified.validation=u.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(u){this.client.logger.warn(u)}return this.client.logger.debug(`Verify context: ${JSON.stringify(h)}`),h}),J(this,"validateSessionProps",(r,i)=>{Object.values(r).forEach(n=>{if(!Pt(n,!1)){const{message:s}=Q("MISSING_OR_INVALID",`${i} must be in Record<string, string> format. Received: ${JSON.stringify(n)}`);throw new Error(s)}})}),J(this,"getPendingAuthRequest",r=>{const i=this.client.auth.requests.get(r);return typeof i=="object"?i:void 0}),J(this,"addToRecentlyDeleted",(r,i)=>{if(this.recentlyDeletedMap.set(r,i),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let n=0;const s=this.recentlyDeletedLimit/2;for(const o of this.recentlyDeletedMap.keys()){if(n++>=s)break;this.recentlyDeletedMap.delete(o)}}}),J(this,"checkRecentlyDeleted",r=>{const i=this.recentlyDeletedMap.get(r);if(i){const{message:n}=Q("MISSING_OR_INVALID",`Record was recently deleted - ${i}: ${r}`);throw new Error(n)}}),J(this,"isLinkModeEnabled",(r,i)=>{var n,s,o,a,h,u,p,b,S;return!r||i!==gt.link_mode?!1:((s=(n=this.client.metadata)==null?void 0:n.redirect)==null?void 0:s.linkMode)===!0&&((a=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:a.universal)!==void 0&&((u=(h=this.client.metadata)==null?void 0:h.redirect)==null?void 0:u.universal)!==""&&((p=r?.redirect)==null?void 0:p.universal)!==void 0&&((b=r?.redirect)==null?void 0:b.universal)!==""&&((S=r?.redirect)==null?void 0:S.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(r.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"}),J(this,"getAppLinkIfEnabled",(r,i)=>{var n;return this.isLinkModeEnabled(r,i)?(n=r?.redirect)==null?void 0:n.universal:void 0}),J(this,"handleLinkModeMessage",({url:r})=>{if(!r||!r.includes("wc_ev")||!r.includes("topic"))return;const i=p0(r,"topic")||"",n=decodeURIComponent(p0(r,"wc_ev")||""),s=this.client.session.keys.includes(i);s&&this.client.session.update(i,{transportType:gt.link_mode}),this.client.core.dispatchEnvelope({topic:i,message:n,sessionExists:s})}),J(this,"registerLinkModeListeners",async()=>{var r;if(qf()||dn()&&(r=this.client.metadata.redirect)!=null&&r.linkMode){const i=global==null?void 0:global.Linking;if(typeof i<"u"){i.addEventListener("url",this.handleLinkModeMessage,this.client.name);const n=await i.getInitialURL();n&&setTimeout(()=>{this.handleLinkModeMessage({url:n})},50)}}}),J(this,"shouldSetTVF",(r,i)=>{if(!i||r!=="wc_sessionRequest")return!1;const{request:n}=i;return Object.keys(x1).includes(n.method)}),J(this,"getTVFParams",(r,i,n)=>{var s,o;try{const a=i.request.method,h=this.extractTxHashesFromResult(a,n);return _r(mt({correlationId:r,rpcMethods:[a],chainId:i.chainId},this.isValidContractData(i.request.params)&&{contractAddresses:[(o=(s=i.request.params)==null?void 0:s[0])==null?void 0:o.to]}),{txHashes:h})}catch(a){this.client.logger.warn("Error getting TVF params",a)}return{}}),J(this,"isValidContractData",r=>{var i;if(!r)return!1;try{const n=r?.data||((i=r?.[0])==null?void 0:i.data);if(!n.startsWith("0x"))return!1;const s=n.slice(2);return/^[0-9a-fA-F]*$/.test(s)?s.length%2===0:!1}catch{}return!1}),J(this,"extractTxHashesFromResult",(r,i)=>{try{const n=x1[r];if(typeof i=="string")return[i];const s=i[n.key];if(jn(s))return s;if(typeof s=="string")return[s]}catch(n){this.client.logger.warn("Error extracting tx hashes from result",n)}return[]})}isInitialized(){if(!this.initialized){const{message:e}=Q("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Ut.message,e=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(e):this.onRelayMessage(e)})}async onRelayMessage(e){const{topic:r,message:i,attestation:n,transportType:s}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(tc)?this.client.auth.authKeys.get(tc):{responseTopic:void 0,publicKey:void 0},a=await this.client.core.crypto.decode(r,i,{receiverPublicKey:o,encoding:s===gt.link_mode?xo:mn});try{dh(a)?(this.client.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a,attestation:n,transportType:s,encryptedId:Ui(i)})):Ya(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a,transportType:s}),this.client.core.history.delete(r,a.id)):this.onRelayEventUnknownPayload({topic:r,payload:a,transportType:s})}catch(h){this.client.logger.error(h)}}registerExpirerEvents(){this.client.core.expirer.on(Gr.expired,async e=>{const{topic:r,id:i}=l0(e.target);if(i&&this.client.pendingRequest.keys.includes(i))return await this.deletePendingSessionRequest(i,Q("EXPIRED"),!0);if(i&&this.client.auth.requests.keys.includes(i))return await this.deletePendingAuthRequest(i,Q("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession({topic:r,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:r})):i&&(await this.deleteProposal(i,!0),this.client.events.emit("proposal_expire",{id:i}))})}registerPairingEvents(){this.client.core.pairing.events.on(kn.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(kn.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!Pt(e,!1)){const{message:r}=Q("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=Q("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(pn(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=Q("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!Pt(e,!1)){const{message:r}=Q("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:r}=Q("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(pn(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:r}=Q("EXPIRED",`session topic: ${e}`);throw new Error(r)}if(!this.client.core.crypto.keychain.has(e)){const{message:r}=Q("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Pt(e,!1)){const{message:r}=Q("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=Q("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!f9(e)){const{message:r}=Q("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=Q("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(pn(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:r}=Q("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}}class TS extends Vn{constructor(e,r){super(e,r,yS,Mh),this.core=e,this.logger=r}}class FS extends Vn{constructor(e,r){super(e,r,wS,Mh),this.core=e,this.logger=r}}class BS extends Vn{constructor(e,r){super(e,r,xS,Mh,i=>i.id),this.core=e,this.logger=r}}class qS extends Vn{constructor(e,r){super(e,r,AS,ec,()=>tc),this.core=e,this.logger=r}}class LS extends Vn{constructor(e,r){super(e,r,MS,ec),this.core=e,this.logger=r}}class US extends Vn{constructor(e,r){super(e,r,PS,ec,i=>i.id),this.core=e,this.logger=r}}var jS=Object.defineProperty,zS=(t,e,r)=>e in t?jS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Oh=(t,e,r)=>zS(t,typeof e!="symbol"?e+"":e,r);class kS{constructor(e,r){this.core=e,this.logger=r,Oh(this,"authKeys"),Oh(this,"pairingTopics"),Oh(this,"requests"),this.authKeys=new qS(this.core,this.logger),this.pairingTopics=new LS(this.core,this.logger),this.requests=new US(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var HS=Object.defineProperty,KS=(t,e,r)=>e in t?HS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,$e=(t,e,r)=>KS(t,typeof e!="symbol"?e+"":e,r);class Rh extends Kb{constructor(e){super(e),$e(this,"protocol",b1),$e(this,"version",m1),$e(this,"name",Ph.name),$e(this,"metadata"),$e(this,"core"),$e(this,"logger"),$e(this,"events",new er.exports.EventEmitter),$e(this,"engine"),$e(this,"session"),$e(this,"proposal"),$e(this,"pendingRequest"),$e(this,"auth"),$e(this,"signConfig"),$e(this,"on",(i,n)=>this.events.on(i,n)),$e(this,"once",(i,n)=>this.events.once(i,n)),$e(this,"off",(i,n)=>this.events.off(i,n)),$e(this,"removeListener",(i,n)=>this.events.removeListener(i,n)),$e(this,"removeAllListeners",i=>this.events.removeAllListeners(i)),$e(this,"connect",async i=>{try{return await this.engine.connect(i)}catch(n){throw this.logger.error(n.message),n}}),$e(this,"pair",async i=>{try{return await this.engine.pair(i)}catch(n){throw this.logger.error(n.message),n}}),$e(this,"approve",async i=>{try{return await this.engine.approve(i)}catch(n){throw this.logger.error(n.message),n}}),$e(this,"reject",async i=>{try{return await this.engine.reject(i)}catch(n){throw this.logger.error(n.message),n}}),$e(this,"update",async i=>{try{return await this.engine.update(i)}catch(n){throw this.logger.error(n.message),n}}),$e(this,"extend",async i=>{try{return await this.engine.extend(i)}catch(n){throw this.logger.error(n.message),n}}),$e(this,"request",async i=>{try{return await this.engine.request(i)}catch(n){throw this.logger.error(n.message),n}}),$e(this,"respond",async i=>{try{return await this.engine.respond(i)}catch(n){throw this.logger.error(n.message),n}}),$e(this,"ping",async i=>{try{return await this.engine.ping(i)}catch(n){throw this.logger.error(n.message),n}}),$e(this,"emit",async i=>{try{return await this.engine.emit(i)}catch(n){throw this.logger.error(n.message),n}}),$e(this,"disconnect",async i=>{try{return await this.engine.disconnect(i)}catch(n){throw this.logger.error(n.message),n}}),$e(this,"find",i=>{try{return this.engine.find(i)}catch(n){throw this.logger.error(n.message),n}}),$e(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(i){throw this.logger.error(i.message),i}}),$e(this,"authenticate",async(i,n)=>{try{return await this.engine.authenticate(i,n)}catch(s){throw this.logger.error(s.message),s}}),$e(this,"formatAuthMessage",i=>{try{return this.engine.formatAuthMessage(i)}catch(n){throw this.logger.error(n.message),n}}),$e(this,"approveSessionAuthenticate",async i=>{try{return await this.engine.approveSessionAuthenticate(i)}catch(n){throw this.logger.error(n.message),n}}),$e(this,"rejectSessionAuthenticate",async i=>{try{return await this.engine.rejectSessionAuthenticate(i)}catch(n){throw this.logger.error(n.message),n}}),this.name=e?.name||Ph.name,this.metadata=e?.metadata||c0(),this.signConfig=e?.signConfig;const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:hi(ra({level:e?.logger||Ph.logger}));this.core=e?.core||new mS(e),this.logger=ar(r,this.name),this.session=new FS(this.core,this.logger),this.proposal=new TS(this.core,this.logger),this.pendingRequest=new BS(this.core,this.logger),this.engine=new CS(this),this.auth=new kS(this.core,this.logger)}static async init(e){const r=new Rh(e);return await r.initialize(),r}get context(){return pr(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success"),setTimeout(()=>{this.engine.processRelayMessageCache()},Z.toMiliseconds(Z.ONE_SECOND))}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}const S1="error",VS="wss://relay.walletconnect.org",GS="wc",WS="universal_provider",I1=`${GS}@2:${WS}:`,A1="https://rpc.walletconnect.org/v1/",$s="generic",JS=`${A1}bundler`,Wr={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};function YS(){this.__data__=[],this.size=0}var ZS=YS;function XS(t,e){return t===e||t!==t&&e!==e}var rc=XS,QS=rc;function eI(t,e){for(var r=t.length;r--;)if(QS(t[r][0],e))return r;return-1}var ic=eI,tI=ic,rI=Array.prototype,iI=rI.splice;function nI(t){var e=this.__data__,r=tI(e,t);if(r<0)return!1;var i=e.length-1;return r==i?e.pop():iI.call(e,r,1),--this.size,!0}var sI=nI,oI=ic;function aI(t){var e=this.__data__,r=oI(e,t);return r<0?void 0:e[r][1]}var cI=aI,fI=ic;function hI(t){return fI(this.__data__,t)>-1}var uI=hI,dI=ic;function lI(t,e){var r=this.__data__,i=dI(r,t);return i<0?(++this.size,r.push([t,e])):r[i][1]=e,this}var pI=lI,vI=ZS,gI=sI,bI=cI,mI=uI,yI=pI;function Os(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}Os.prototype.clear=vI,Os.prototype.delete=gI,Os.prototype.get=bI,Os.prototype.has=mI,Os.prototype.set=yI;var nc=Os,wI=nc;function _I(){this.__data__=new wI,this.size=0}var xI=_I;function EI(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}var SI=EI;function II(t){return this.__data__.get(t)}var AI=II;function MI(t){return this.__data__.has(t)}var PI=MI,DI=typeof yt=="object"&&yt&&yt.Object===Object&&yt,M1=DI,$I=M1,OI=typeof self=="object"&&self&&self.Object===Object&&self,RI=$I||OI||Function("return this")(),Rs=RI,NI=Rs,CI=NI.Symbol,P1=CI,D1=P1,$1=Object.prototype,TI=$1.hasOwnProperty,FI=$1.toString,Lo=D1?D1.toStringTag:void 0;function BI(t){var e=TI.call(t,Lo),r=t[Lo];try{t[Lo]=void 0;var i=!0}catch{}var n=FI.call(t);return i&&(e?t[Lo]=r:delete t[Lo]),n}var qI=BI,LI=Object.prototype,UI=LI.toString;function jI(t){return UI.call(t)}var zI=jI,O1=P1,kI=qI,HI=zI,KI="[object Null]",VI="[object Undefined]",R1=O1?O1.toStringTag:void 0;function GI(t){return t==null?t===void 0?VI:KI:R1&&R1 in Object(t)?kI(t):HI(t)}var sc=GI;function WI(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Gn=WI,JI=sc,YI=Gn,ZI="[object AsyncFunction]",XI="[object Function]",QI="[object GeneratorFunction]",eA="[object Proxy]";function tA(t){if(!YI(t))return!1;var e=JI(t);return e==XI||e==QI||e==ZI||e==eA}var Nh=tA,rA=Rs,iA=rA["__core-js_shared__"],nA=iA,Ch=nA,N1=function(){var t=/[^.]+$/.exec(Ch&&Ch.keys&&Ch.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function sA(t){return!!N1&&N1 in t}var oA=sA,aA=Function.prototype,cA=aA.toString;function fA(t){if(t!=null){try{return cA.call(t)}catch{}try{return t+""}catch{}}return""}var hA=fA,uA=Nh,dA=oA,lA=Gn,pA=hA,vA=/[\\^$.*+?()[\]{}|]/g,gA=/^\[object .+?Constructor\]$/,bA=Function.prototype,mA=Object.prototype,yA=bA.toString,wA=mA.hasOwnProperty,_A=RegExp("^"+yA.call(wA).replace(vA,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function xA(t){if(!lA(t)||dA(t))return!1;var e=uA(t)?_A:gA;return e.test(pA(t))}var EA=xA;function SA(t,e){return t?.[e]}var IA=SA,AA=EA,MA=IA;function PA(t,e){var r=MA(t,e);return AA(r)?r:void 0}var Th=PA,DA=Th,$A=Rs,OA=DA($A,"Map"),C1=OA,RA=Th,NA=RA(Object,"create"),oc=NA,T1=oc;function CA(){this.__data__=T1?T1(null):{},this.size=0}var TA=CA;function FA(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var BA=FA,qA=oc,LA="__lodash_hash_undefined__",UA=Object.prototype,jA=UA.hasOwnProperty;function zA(t){var e=this.__data__;if(qA){var r=e[t];return r===LA?void 0:r}return jA.call(e,t)?e[t]:void 0}var kA=zA,HA=oc,KA=Object.prototype,VA=KA.hasOwnProperty;function GA(t){var e=this.__data__;return HA?e[t]!==void 0:VA.call(e,t)}var WA=GA,JA=oc,YA="__lodash_hash_undefined__";function ZA(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=JA&&e===void 0?YA:e,this}var XA=ZA,QA=TA,eM=BA,tM=kA,rM=WA,iM=XA;function Ns(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}Ns.prototype.clear=QA,Ns.prototype.delete=eM,Ns.prototype.get=tM,Ns.prototype.has=rM,Ns.prototype.set=iM;var nM=Ns,F1=nM,sM=nc,oM=C1;function aM(){this.size=0,this.__data__={hash:new F1,map:new(oM||sM),string:new F1}}var cM=aM;function fM(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var hM=fM,uM=hM;function dM(t,e){var r=t.__data__;return uM(e)?r[typeof e=="string"?"string":"hash"]:r.map}var ac=dM,lM=ac;function pM(t){var e=lM(this,t).delete(t);return this.size-=e?1:0,e}var vM=pM,gM=ac;function bM(t){return gM(this,t).get(t)}var mM=bM,yM=ac;function wM(t){return yM(this,t).has(t)}var _M=wM,xM=ac;function EM(t,e){var r=xM(this,t),i=r.size;return r.set(t,e),this.size+=r.size==i?0:1,this}var SM=EM,IM=cM,AM=vM,MM=mM,PM=_M,DM=SM;function Cs(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}Cs.prototype.clear=IM,Cs.prototype.delete=AM,Cs.prototype.get=MM,Cs.prototype.has=PM,Cs.prototype.set=DM;var $M=Cs,OM=nc,RM=C1,NM=$M,CM=200;function TM(t,e){var r=this.__data__;if(r instanceof OM){var i=r.__data__;if(!RM||i.length<CM-1)return i.push([t,e]),this.size=++r.size,this;r=this.__data__=new NM(i)}return r.set(t,e),this.size=r.size,this}var FM=TM,BM=nc,qM=xI,LM=SI,UM=AI,jM=PI,zM=FM;function Ts(t){var e=this.__data__=new BM(t);this.size=e.size}Ts.prototype.clear=qM,Ts.prototype.delete=LM,Ts.prototype.get=UM,Ts.prototype.has=jM,Ts.prototype.set=zM;var kM=Ts,HM=Th,KM=function(){try{var t=HM(Object,"defineProperty");return t({},"",{}),t}catch{}}(),B1=KM,q1=B1;function VM(t,e,r){e=="__proto__"&&q1?q1(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var Fh=VM,GM=Fh,WM=rc;function JM(t,e,r){(r!==void 0&&!WM(t[e],r)||r===void 0&&!(e in t))&&GM(t,e,r)}var L1=JM;function YM(t){return function(e,r,i){for(var n=-1,s=Object(e),o=i(e),a=o.length;a--;){var h=o[t?a:++n];if(r(s[h],h,s)===!1)break}return e}}var ZM=YM,XM=ZM,QM=XM(),eP=QM,Bh={exports:{}};(function(t,e){var r=Rs,i=e&&!e.nodeType&&e,n=i&&!0&&t&&!t.nodeType&&t,s=n&&n.exports===i,o=s?r.Buffer:void 0,a=o?o.allocUnsafe:void 0;function h(u,p){if(p)return u.slice();var b=u.length,S=a?a(b):new u.constructor(b);return u.copy(S),S}t.exports=h})(Bh,Bh.exports);var tP=Rs,rP=tP.Uint8Array,iP=rP,U1=iP;function nP(t){var e=new t.constructor(t.byteLength);return new U1(e).set(new U1(t)),e}var sP=nP,oP=sP;function aP(t,e){var r=e?oP(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var cP=aP;function fP(t,e){var r=-1,i=t.length;for(e||(e=Array(i));++r<i;)e[r]=t[r];return e}var hP=fP,uP=Gn,j1=Object.create,dP=function(){function t(){}return function(e){if(!uP(e))return{};if(j1)return j1(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}(),lP=dP;function pP(t,e){return function(r){return t(e(r))}}var vP=pP,gP=vP,bP=gP(Object.getPrototypeOf,Object),z1=bP,mP=Object.prototype;function yP(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||mP;return t===r}var k1=yP,wP=lP,_P=z1,xP=k1;function EP(t){return typeof t.constructor=="function"&&!xP(t)?wP(_P(t)):{}}var SP=EP;function IP(t){return t!=null&&typeof t=="object"}var Uo=IP,AP=sc,MP=Uo,PP="[object Arguments]";function DP(t){return MP(t)&&AP(t)==PP}var $P=DP,H1=$P,OP=Uo,K1=Object.prototype,RP=K1.hasOwnProperty,NP=K1.propertyIsEnumerable,CP=H1(function(){return arguments}())?H1:function(t){return OP(t)&&RP.call(t,"callee")&&!NP.call(t,"callee")},V1=CP,TP=Array.isArray,G1=TP,FP=9007199254740991;function BP(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=FP}var W1=BP,qP=Nh,LP=W1;function UP(t){return t!=null&&LP(t.length)&&!qP(t)}var qh=UP,jP=qh,zP=Uo;function kP(t){return zP(t)&&jP(t)}var HP=kP,cc={exports:{}};function KP(){return!1}var VP=KP;(function(t,e){var r=Rs,i=VP,n=e&&!e.nodeType&&e,s=n&&!0&&t&&!t.nodeType&&t,o=s&&s.exports===n,a=o?r.Buffer:void 0,h=a?a.isBuffer:void 0,u=h||i;t.exports=u})(cc,cc.exports);var GP=sc,WP=z1,JP=Uo,YP="[object Object]",ZP=Function.prototype,XP=Object.prototype,J1=ZP.toString,QP=XP.hasOwnProperty,eD=J1.call(Object);function tD(t){if(!JP(t)||GP(t)!=YP)return!1;var e=WP(t);if(e===null)return!0;var r=QP.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&J1.call(r)==eD}var rD=tD,iD=sc,nD=W1,sD=Uo,oD="[object Arguments]",aD="[object Array]",cD="[object Boolean]",fD="[object Date]",hD="[object Error]",uD="[object Function]",dD="[object Map]",lD="[object Number]",pD="[object Object]",vD="[object RegExp]",gD="[object Set]",bD="[object String]",mD="[object WeakMap]",yD="[object ArrayBuffer]",wD="[object DataView]",_D="[object Float32Array]",xD="[object Float64Array]",ED="[object Int8Array]",SD="[object Int16Array]",ID="[object Int32Array]",AD="[object Uint8Array]",MD="[object Uint8ClampedArray]",PD="[object Uint16Array]",DD="[object Uint32Array]",wt={};wt[_D]=wt[xD]=wt[ED]=wt[SD]=wt[ID]=wt[AD]=wt[MD]=wt[PD]=wt[DD]=!0,wt[oD]=wt[aD]=wt[yD]=wt[cD]=wt[wD]=wt[fD]=wt[hD]=wt[uD]=wt[dD]=wt[lD]=wt[pD]=wt[vD]=wt[gD]=wt[bD]=wt[mD]=!1;function $D(t){return sD(t)&&nD(t.length)&&!!wt[iD(t)]}var OD=$D;function RD(t){return function(e){return t(e)}}var ND=RD,Lh={exports:{}};(function(t,e){var r=M1,i=e&&!e.nodeType&&e,n=i&&!0&&t&&!t.nodeType&&t,s=n&&n.exports===i,o=s&&r.process,a=function(){try{var h=n&&n.require&&n.require("util").types;return h||o&&o.binding&&o.binding("util")}catch{}}();t.exports=a})(Lh,Lh.exports);var CD=OD,TD=ND,Y1=Lh.exports,Z1=Y1&&Y1.isTypedArray,FD=Z1?TD(Z1):CD,X1=FD;function BD(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}var Q1=BD,qD=Fh,LD=rc,UD=Object.prototype,jD=UD.hasOwnProperty;function zD(t,e,r){var i=t[e];(!(jD.call(t,e)&&LD(i,r))||r===void 0&&!(e in t))&&qD(t,e,r)}var kD=zD,HD=kD,KD=Fh;function VD(t,e,r,i){var n=!r;r||(r={});for(var s=-1,o=e.length;++s<o;){var a=e[s],h=i?i(r[a],t[a],a,r,t):void 0;h===void 0&&(h=t[a]),n?KD(r,a,h):HD(r,a,h)}return r}var GD=VD;function WD(t,e){for(var r=-1,i=Array(t);++r<t;)i[r]=e(r);return i}var JD=WD,YD=9007199254740991,ZD=/^(?:0|[1-9]\d*)$/;function XD(t,e){var r=typeof t;return e=e??YD,!!e&&(r=="number"||r!="symbol"&&ZD.test(t))&&t>-1&&t%1==0&&t<e}var ev=XD,QD=JD,e$=V1,t$=G1,r$=cc.exports,i$=ev,n$=X1,s$=Object.prototype,o$=s$.hasOwnProperty;function a$(t,e){var r=t$(t),i=!r&&e$(t),n=!r&&!i&&r$(t),s=!r&&!i&&!n&&n$(t),o=r||i||n||s,a=o?QD(t.length,String):[],h=a.length;for(var u in t)(e||o$.call(t,u))&&!(o&&(u=="length"||n&&(u=="offset"||u=="parent")||s&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||i$(u,h)))&&a.push(u);return a}var c$=a$;function f$(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var h$=f$,u$=Gn,d$=k1,l$=h$,p$=Object.prototype,v$=p$.hasOwnProperty;function g$(t){if(!u$(t))return l$(t);var e=d$(t),r=[];for(var i in t)i=="constructor"&&(e||!v$.call(t,i))||r.push(i);return r}var b$=g$,m$=c$,y$=b$,w$=qh;function _$(t){return w$(t)?m$(t,!0):y$(t)}var tv=_$,x$=GD,E$=tv;function S$(t){return x$(t,E$(t))}var I$=S$,rv=L1,A$=Bh.exports,M$=cP,P$=hP,D$=SP,iv=V1,nv=G1,$$=HP,O$=cc.exports,R$=Nh,N$=Gn,C$=rD,T$=X1,sv=Q1,F$=I$;function B$(t,e,r,i,n,s,o){var a=sv(t,r),h=sv(e,r),u=o.get(h);if(u){rv(t,r,u);return}var p=s?s(a,h,r+"",t,e,o):void 0,b=p===void 0;if(b){var S=nv(h),A=!S&&O$(h),I=!S&&!A&&T$(h);p=h,S||A||I?nv(a)?p=a:$$(a)?p=P$(a):A?(b=!1,p=A$(h,!0)):I?(b=!1,p=M$(h,!0)):p=[]:C$(h)||iv(h)?(p=a,iv(a)?p=F$(a):(!N$(a)||R$(a))&&(p=D$(h))):b=!1}b&&(o.set(h,p),n(p,h,i,s,o),o.delete(h)),rv(t,r,p)}var q$=B$,L$=kM,U$=L1,j$=eP,z$=q$,k$=Gn,H$=tv,K$=Q1;function ov(t,e,r,i,n){t!==e&&j$(e,function(s,o){if(n||(n=new L$),k$(s))z$(t,e,o,r,ov,i,n);else{var a=i?i(K$(t,o),s,o+"",t,e,n):void 0;a===void 0&&(a=s),U$(t,o,a)}},H$)}var V$=ov;function G$(t){return t}var av=G$;function W$(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}var J$=W$,Y$=J$,cv=Math.max;function Z$(t,e,r){return e=cv(e===void 0?t.length-1:e,0),function(){for(var i=arguments,n=-1,s=cv(i.length-e,0),o=Array(s);++n<s;)o[n]=i[e+n];n=-1;for(var a=Array(e+1);++n<e;)a[n]=i[n];return a[e]=r(o),Y$(t,this,a)}}var X$=Z$;function Q$(t){return function(){return t}}var eO=Q$,tO=eO,fv=B1,rO=av,iO=fv?function(t,e){return fv(t,"toString",{configurable:!0,enumerable:!1,value:tO(e),writable:!0})}:rO,nO=iO,sO=800,oO=16,aO=Date.now;function cO(t){var e=0,r=0;return function(){var i=aO(),n=oO-(i-r);if(r=i,n>0){if(++e>=sO)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var fO=cO,hO=nO,uO=fO,dO=uO(hO),lO=dO,pO=av,vO=X$,gO=lO;function bO(t,e){return gO(vO(t,e,pO),t+"")}var mO=bO,yO=rc,wO=qh,_O=ev,xO=Gn;function EO(t,e,r){if(!xO(r))return!1;var i=typeof e;return(i=="number"?wO(r)&&_O(e,r.length):i=="string"&&e in r)?yO(r[e],t):!1}var SO=EO,IO=mO,AO=SO;function MO(t){return IO(function(e,r){var i=-1,n=r.length,s=n>1?r[n-1]:void 0,o=n>2?r[2]:void 0;for(s=t.length>3&&typeof s=="function"?(n--,s):void 0,o&&AO(r[0],r[1],o)&&(s=n<3?void 0:s,n=1),e=Object(e);++i<n;){var a=r[i];a&&t(e,a,i,s)}return e})}var PO=MO,DO=V$,$O=PO,OO=$O(function(t,e,r){DO(t,e,r)}),RO=OO,NO=Object.defineProperty,CO=Object.defineProperties,TO=Object.getOwnPropertyDescriptors,hv=Object.getOwnPropertySymbols,FO=Object.prototype.hasOwnProperty,BO=Object.prototype.propertyIsEnumerable,uv=(t,e,r)=>e in t?NO(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,fc=(t,e)=>{for(var r in e||(e={}))FO.call(e,r)&&uv(t,r,e[r]);if(hv)for(var r of hv(e))BO.call(e,r)&&uv(t,r,e[r]);return t},qO=(t,e)=>CO(t,TO(e));function Nr(t,e,r){var i;const n=ws(t);return((i=e.rpcMap)==null?void 0:i[n.reference])||`${A1}?chainId=${n.namespace}:${n.reference}&projectId=${r}`}function Wn(t){return t.includes(":")?t.split(":")[1]:t}function dv(t){return t.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function LO(t,e){const r=Object.keys(e.namespaces).filter(n=>n.includes(t));if(!r.length)return[];const i=[];return r.forEach(n=>{const s=e.namespaces[n].accounts;i.push(...s)}),i}function Uh(t={},e={}){const r=lv(t),i=lv(e);return RO(r,i)}function lv(t){var e,r,i,n;const s={};if(!Do(t))return s;for(const[o,a]of Object.entries(t)){const h=nh(o)?[o]:a.chains,u=a.methods||[],p=a.events||[],b=a.rpcMap||{},S=Po(o);s[S]=qO(fc(fc({},s[S]),a),{chains:Fa(h,(e=s[S])==null?void 0:e.chains),methods:Fa(u,(r=s[S])==null?void 0:r.methods),events:Fa(p,(i=s[S])==null?void 0:i.events),rpcMap:fc(fc({},b),(n=s[S])==null?void 0:n.rpcMap)})}return s}function UO(t){return t.includes(":")?t.split(":")[2]:t}function pv(t){const e={};for(const[r,i]of Object.entries(t)){const n=i.methods||[],s=i.events||[],o=i.accounts||[],a=nh(r)?[r]:i.chains?i.chains:dv(i.accounts);e[r]={chains:a,methods:n,events:s,accounts:o}}return e}function jh(t){return typeof t=="number"?t:t.includes("0x")?parseInt(t,16):(t=t.includes(":")?t.split(":")[1]:t,isNaN(Number(t))?t:Number(t))}const vv={},ze=t=>vv[t],zh=(t,e)=>{vv[t]=e};var kh={exports:{}};(function(t,e){var r=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof yt<"u"&&yt,i=function(){function s(){this.fetch=!1,this.DOMException=r.DOMException}return s.prototype=r,new s}();(function(s){(function(o){var a=typeof s<"u"&&s||typeof self<"u"&&self||typeof yt<"u"&&yt||{},h={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function u(f){return f&&DataView.prototype.isPrototypeOf(f)}if(h.arrayBuffer)var p=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],b=ArrayBuffer.isView||function(f){return f&&p.indexOf(Object.prototype.toString.call(f))>-1};function S(f){if(typeof f!="string"&&(f=String(f)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(f)||f==="")throw new TypeError('Invalid character in header field name: "'+f+'"');return f.toLowerCase()}function A(f){return typeof f!="string"&&(f=String(f)),f}function I(f){var l={next:function(){var _=f.shift();return{done:_===void 0,value:_}}};return h.iterable&&(l[Symbol.iterator]=function(){return l}),l}function P(f){this.map={},f instanceof P?f.forEach(function(l,_){this.append(_,l)},this):Array.isArray(f)?f.forEach(function(l){if(l.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+l.length);this.append(l[0],l[1])},this):f&&Object.getOwnPropertyNames(f).forEach(function(l){this.append(l,f[l])},this)}P.prototype.append=function(f,l){f=S(f),l=A(l);var _=this.map[f];this.map[f]=_?_+", "+l:l},P.prototype.delete=function(f){delete this.map[S(f)]},P.prototype.get=function(f){return f=S(f),this.has(f)?this.map[f]:null},P.prototype.has=function(f){return this.map.hasOwnProperty(S(f))},P.prototype.set=function(f,l){this.map[S(f)]=A(l)},P.prototype.forEach=function(f,l){for(var _ in this.map)this.map.hasOwnProperty(_)&&f.call(l,this.map[_],_,this)},P.prototype.keys=function(){var f=[];return this.forEach(function(l,_){f.push(_)}),I(f)},P.prototype.values=function(){var f=[];return this.forEach(function(l){f.push(l)}),I(f)},P.prototype.entries=function(){var f=[];return this.forEach(function(l,_){f.push([_,l])}),I(f)},h.iterable&&(P.prototype[Symbol.iterator]=P.prototype.entries);function R(f){if(!f._noBody){if(f.bodyUsed)return Promise.reject(new TypeError("Already read"));f.bodyUsed=!0}}function O(f){return new Promise(function(l,_){f.onload=function(){l(f.result)},f.onerror=function(){_(f.error)}})}function N(f){var l=new FileReader,_=O(l);return l.readAsArrayBuffer(f),_}function F(f){var l=new FileReader,_=O(l),x=/charset=([A-Za-z0-9_-]+)/.exec(f.type),y=x?x[1]:"utf-8";return l.readAsText(f,y),_}function L(f){for(var l=new Uint8Array(f),_=new Array(l.length),x=0;x<l.length;x++)_[x]=String.fromCharCode(l[x]);return _.join("")}function z(f){if(f.slice)return f.slice(0);var l=new Uint8Array(f.byteLength);return l.set(new Uint8Array(f)),l.buffer}function k(){return this.bodyUsed=!1,this._initBody=function(f){this.bodyUsed=this.bodyUsed,this._bodyInit=f,f?typeof f=="string"?this._bodyText=f:h.blob&&Blob.prototype.isPrototypeOf(f)?this._bodyBlob=f:h.formData&&FormData.prototype.isPrototypeOf(f)?this._bodyFormData=f:h.searchParams&&URLSearchParams.prototype.isPrototypeOf(f)?this._bodyText=f.toString():h.arrayBuffer&&h.blob&&u(f)?(this._bodyArrayBuffer=z(f.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):h.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(f)||b(f))?this._bodyArrayBuffer=z(f):this._bodyText=f=Object.prototype.toString.call(f):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof f=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):h.searchParams&&URLSearchParams.prototype.isPrototypeOf(f)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},h.blob&&(this.blob=function(){var f=R(this);if(f)return f;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var f=R(this);return f||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(h.blob)return this.blob().then(N);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var f=R(this);if(f)return f;if(this._bodyBlob)return F(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(L(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},h.formData&&(this.formData=function(){return this.text().then(ie)}),this.json=function(){return this.text().then(JSON.parse)},this}var G=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function K(f){var l=f.toUpperCase();return G.indexOf(l)>-1?l:f}function H(f,l){if(!(this instanceof H))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');l=l||{};var _=l.body;if(f instanceof H){if(f.bodyUsed)throw new TypeError("Already read");this.url=f.url,this.credentials=f.credentials,l.headers||(this.headers=new P(f.headers)),this.method=f.method,this.mode=f.mode,this.signal=f.signal,!_&&f._bodyInit!=null&&(_=f._bodyInit,f.bodyUsed=!0)}else this.url=String(f);if(this.credentials=l.credentials||this.credentials||"same-origin",(l.headers||!this.headers)&&(this.headers=new P(l.headers)),this.method=K(l.method||this.method||"GET"),this.mode=l.mode||this.mode||null,this.signal=l.signal||this.signal||function(){if("AbortController"in a){var d=new AbortController;return d.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&_)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(_),(this.method==="GET"||this.method==="HEAD")&&(l.cache==="no-store"||l.cache==="no-cache")){var x=/([?&])_=[^&]*/;if(x.test(this.url))this.url=this.url.replace(x,"$1_="+new Date().getTime());else{var y=/\?/;this.url+=(y.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}H.prototype.clone=function(){return new H(this,{body:this._bodyInit})};function ie(f){var l=new FormData;return f.trim().split("&").forEach(function(_){if(_){var x=_.split("="),y=x.shift().replace(/\+/g," "),d=x.join("=").replace(/\+/g," ");l.append(decodeURIComponent(y),decodeURIComponent(d))}}),l}function D(f){var l=new P,_=f.replace(/\r?\n[\t ]+/g," ");return _.split("\r").map(function(x){return x.indexOf(`
`)===0?x.substr(1,x.length):x}).forEach(function(x){var y=x.split(":"),d=y.shift().trim();if(d){var w=y.join(":").trim();try{l.append(d,w)}catch(m){console.warn("Response "+m.message)}}}),l}k.call(H.prototype);function g(f,l){if(!(this instanceof g))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(l||(l={}),this.type="default",this.status=l.status===void 0?200:l.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=l.statusText===void 0?"":""+l.statusText,this.headers=new P(l.headers),this.url=l.url||"",this._initBody(f)}k.call(g.prototype),g.prototype.clone=function(){return new g(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new P(this.headers),url:this.url})},g.error=function(){var f=new g(null,{status:200,statusText:""});return f.ok=!1,f.status=0,f.type="error",f};var v=[301,302,303,307,308];g.redirect=function(f,l){if(v.indexOf(l)===-1)throw new RangeError("Invalid status code");return new g(null,{status:l,headers:{location:f}})},o.DOMException=a.DOMException;try{new o.DOMException}catch{o.DOMException=function(l,_){this.message=l,this.name=_;var x=Error(l);this.stack=x.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function c(f,l){return new Promise(function(_,x){var y=new H(f,l);if(y.signal&&y.signal.aborted)return x(new o.DOMException("Aborted","AbortError"));var d=new XMLHttpRequest;function w(){d.abort()}d.onload=function(){var B={statusText:d.statusText,headers:D(d.getAllResponseHeaders()||"")};y.url.indexOf("file://")===0&&(d.status<200||d.status>599)?B.status=200:B.status=d.status,B.url="responseURL"in d?d.responseURL:B.headers.get("X-Request-URL");var E="response"in d?d.response:d.responseText;setTimeout(function(){_(new g(E,B))},0)},d.onerror=function(){setTimeout(function(){x(new TypeError("Network request failed"))},0)},d.ontimeout=function(){setTimeout(function(){x(new TypeError("Network request timed out"))},0)},d.onabort=function(){setTimeout(function(){x(new o.DOMException("Aborted","AbortError"))},0)};function m(B){try{return B===""&&a.location.href?a.location.href:B}catch{return B}}if(d.open(y.method,m(y.url),!0),y.credentials==="include"?d.withCredentials=!0:y.credentials==="omit"&&(d.withCredentials=!1),"responseType"in d&&(h.blob?d.responseType="blob":h.arrayBuffer&&(d.responseType="arraybuffer")),l&&typeof l.headers=="object"&&!(l.headers instanceof P||a.Headers&&l.headers instanceof a.Headers)){var M=[];Object.getOwnPropertyNames(l.headers).forEach(function(B){M.push(S(B)),d.setRequestHeader(B,A(l.headers[B]))}),y.headers.forEach(function(B,E){M.indexOf(E)===-1&&d.setRequestHeader(E,B)})}else y.headers.forEach(function(B,E){d.setRequestHeader(E,B)});y.signal&&(y.signal.addEventListener("abort",w),d.onreadystatechange=function(){d.readyState===4&&y.signal.removeEventListener("abort",w)}),d.send(typeof y._bodyInit>"u"?null:y._bodyInit)})}return c.polyfill=!0,a.fetch||(a.fetch=c,a.Headers=P,a.Request=H,a.Response=g),o.Headers=P,o.Request=H,o.Response=g,o.fetch=c,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(i),i.fetch.ponyfill=!0,delete i.fetch.polyfill;var n=r.fetch?r:i;e=n.fetch,e.default=n.fetch,e.fetch=n.fetch,e.Headers=n.Headers,e.Request=n.Request,e.Response=n.Response,t.exports=e})(kh,kh.exports);var gv=Bv(kh.exports),jO=Object.defineProperty,zO=Object.defineProperties,kO=Object.getOwnPropertyDescriptors,bv=Object.getOwnPropertySymbols,HO=Object.prototype.hasOwnProperty,KO=Object.prototype.propertyIsEnumerable,mv=(t,e,r)=>e in t?jO(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,yv=(t,e)=>{for(var r in e||(e={}))HO.call(e,r)&&mv(t,r,e[r]);if(bv)for(var r of bv(e))KO.call(e,r)&&mv(t,r,e[r]);return t},wv=(t,e)=>zO(t,kO(e));const VO={Accept:"application/json","Content-Type":"application/json"},GO="POST",_v={headers:VO,method:GO},xv=10;class ci{constructor(e,r=!1){if(this.url=e,this.disableProviderPing=r,this.events=new er.exports.EventEmitter,this.isAvailable=!1,this.registering=!1,!$p(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const r=$i(e),i=await(await gv(this.url,wv(yv({},_v),{body:r}))).json();this.onPayload({data:i})}catch(r){this.onError(e.id,r)}}async register(e=this.url){if(!$p(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((i,n)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),n(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return n(new Error("HTTP connection is missing or invalid"));i()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const r=$i({id:1,jsonrpc:"2.0",method:"test",params:[]});await gv(e,wv(yv({},_v),{body:r}))}this.onOpen()}catch(r){const i=this.parseError(r);throw this.events.emit("register_error",i),this.onClose(),i}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?Mn(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const i=this.parseError(r),n=i.message||i.toString(),s=Ja(e,n);this.events.emit("payload",s)}parseError(e,r=this.url){return Sp(e,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>xv&&this.events.setMaxListeners(xv)}}var WO=Object.defineProperty,JO=(t,e,r)=>e in t?WO(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Fs=(t,e,r)=>JO(t,typeof e!="symbol"?e+"":e,r);class YO{constructor(e){Fs(this,"name","polkadot"),Fs(this,"client"),Fs(this,"httpProviders"),Fs(this,"events"),Fs(this,"namespace"),Fs(this,"chainId"),this.namespace=e.namespace,this.events=ze("events"),this.client=ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Wr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var i;const n=Wn(r);e[n]=this.createHttpProvider(n,(i=this.namespace.rpcMap)==null?void 0:i[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||Nr(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new Kr(new ci(i,ze("disableProviderPing")))}}var ZO=Object.defineProperty,XO=Object.defineProperties,QO=Object.getOwnPropertyDescriptors,Ev=Object.getOwnPropertySymbols,eR=Object.prototype.hasOwnProperty,tR=Object.prototype.propertyIsEnumerable,Hh=(t,e,r)=>e in t?ZO(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Sv=(t,e)=>{for(var r in e||(e={}))eR.call(e,r)&&Hh(t,r,e[r]);if(Ev)for(var r of Ev(e))tR.call(e,r)&&Hh(t,r,e[r]);return t},Iv=(t,e)=>XO(t,QO(e)),Bs=(t,e,r)=>Hh(t,typeof e!="symbol"?e+"":e,r);class rR{constructor(e){Bs(this,"name","eip155"),Bs(this,"client"),Bs(this,"chainId"),Bs(this,"namespace"),Bs(this,"httpProviders"),Bs(this,"events"),this.namespace=e.namespace,this.events=ze("events"),this.client=ze("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(parseInt(e),r),this.chainId=parseInt(e),this.events.emit(Wr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,r){const i=r||Nr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new Kr(new ci(i,ze("disableProviderPing")))}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var i;const n=parseInt(Wn(r));e[n]=this.createHttpProvider(n,(i=this.namespace.rpcMap)==null?void 0:i[r])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}async handleSwitchChain(e){var r,i;let n=e.request.params?(r=e.request.params[0])==null?void 0:r.chainId:"0x0";n=n.startsWith("0x")?n:`0x${n}`;const s=parseInt(n,16);if(this.isChainApproved(s))this.setDefaultChain(`${s}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:n}]},chainId:(i=this.namespace.chains)==null?void 0:i[0]}),this.setDefaultChain(`${s}`);else throw new Error(`Failed to switch to chain 'eip155:${s}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var r,i,n;const s=(i=(r=e.request)==null?void 0:r.params)==null?void 0:i[0];if(!s)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const o=this.client.session.get(e.topic),a=((n=o?.sessionProperties)==null?void 0:n.capabilities)||{};if(a!=null&&a[s])return a?.[s];const h=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:Iv(Sv({},o.sessionProperties||{}),{capabilities:Iv(Sv({},a||{}),{[s]:h})})})}catch(u){console.warn("Failed to update session with capabilities",u)}return h}async getCallStatus(e){var r,i;const n=this.client.session.get(e.topic),s=(r=n.sessionProperties)==null?void 0:r.bundler_name;if(s){const a=this.getBundlerUrl(e.chainId,s);try{return await this.getUserOperationReceipt(a,e)}catch(h){console.warn("Failed to fetch call status from bundler",h,a)}}const o=(i=n.sessionProperties)==null?void 0:i.bundler_url;if(o)try{return await this.getUserOperationReceipt(o,e)}catch(a){console.warn("Failed to fetch call status from custom bundler",a,o)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,r){var i;const n=new URL(e),s=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(yn("eth_getUserOperationReceipt",[(i=r.request.params)==null?void 0:i[0]]))});if(!s.ok)throw new Error(`Failed to fetch user operation receipt - ${s.status}`);return await s.json()}getBundlerUrl(e,r){return`${JS}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${r}`}}var iR=Object.defineProperty,nR=(t,e,r)=>e in t?iR(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,qs=(t,e,r)=>nR(t,typeof e!="symbol"?e+"":e,r);class sR{constructor(e){qs(this,"name","solana"),qs(this,"client"),qs(this,"httpProviders"),qs(this,"events"),qs(this,"namespace"),qs(this,"chainId"),this.namespace=e.namespace,this.events=ze("events"),this.client=ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Wr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var i;const n=Wn(r);e[n]=this.createHttpProvider(n,(i=this.namespace.rpcMap)==null?void 0:i[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||Nr(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new Kr(new ci(i,ze("disableProviderPing")))}}var oR=Object.defineProperty,aR=(t,e,r)=>e in t?oR(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ls=(t,e,r)=>aR(t,typeof e!="symbol"?e+"":e,r);class cR{constructor(e){Ls(this,"name","cosmos"),Ls(this,"client"),Ls(this,"httpProviders"),Ls(this,"events"),Ls(this,"namespace"),Ls(this,"chainId"),this.namespace=e.namespace,this.events=ze("events"),this.client=ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Wr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var i;const n=Wn(r);e[n]=this.createHttpProvider(n,(i=this.namespace.rpcMap)==null?void 0:i[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||Nr(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new Kr(new ci(i,ze("disableProviderPing")))}}var fR=Object.defineProperty,hR=(t,e,r)=>e in t?fR(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Us=(t,e,r)=>hR(t,typeof e!="symbol"?e+"":e,r);class uR{constructor(e){Us(this,"name","algorand"),Us(this,"client"),Us(this,"httpProviders"),Us(this,"events"),Us(this,"namespace"),Us(this,"chainId"),this.namespace=e.namespace,this.events=ze("events"),this.client=ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(!this.httpProviders[e]){const i=r||Nr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.chainId=e,this.events.emit(Wr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var i;e[r]=this.createHttpProvider(r,(i=this.namespace.rpcMap)==null?void 0:i[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||Nr(e,this.namespace,this.client.core.projectId);return typeof i>"u"?void 0:new Kr(new ci(i,ze("disableProviderPing")))}}var dR=Object.defineProperty,lR=(t,e,r)=>e in t?dR(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,js=(t,e,r)=>lR(t,typeof e!="symbol"?e+"":e,r);class pR{constructor(e){js(this,"name","cip34"),js(this,"client"),js(this,"httpProviders"),js(this,"events"),js(this,"namespace"),js(this,"chainId"),this.namespace=e.namespace,this.events=ze("events"),this.client=ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Wr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{const i=this.getCardanoRPCUrl(r),n=Wn(r);e[n]=this.createHttpProvider(n,i)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}getCardanoRPCUrl(e){const r=this.namespace.rpcMap;if(r)return r[e]}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||this.getCardanoRPCUrl(e);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new Kr(new ci(i,ze("disableProviderPing")))}}var vR=Object.defineProperty,gR=(t,e,r)=>e in t?vR(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,zs=(t,e,r)=>gR(t,typeof e!="symbol"?e+"":e,r);class bR{constructor(e){zs(this,"name","elrond"),zs(this,"client"),zs(this,"httpProviders"),zs(this,"events"),zs(this,"namespace"),zs(this,"chainId"),this.namespace=e.namespace,this.events=ze("events"),this.client=ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Wr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var i;const n=Wn(r);e[n]=this.createHttpProvider(n,(i=this.namespace.rpcMap)==null?void 0:i[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||Nr(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new Kr(new ci(i,ze("disableProviderPing")))}}var mR=Object.defineProperty,yR=(t,e,r)=>e in t?mR(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ks=(t,e,r)=>yR(t,typeof e!="symbol"?e+"":e,r);class wR{constructor(e){ks(this,"name","multiversx"),ks(this,"client"),ks(this,"httpProviders"),ks(this,"events"),ks(this,"namespace"),ks(this,"chainId"),this.namespace=e.namespace,this.events=ze("events"),this.client=ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Wr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var i;const n=Wn(r);e[n]=this.createHttpProvider(n,(i=this.namespace.rpcMap)==null?void 0:i[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||Nr(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new Kr(new ci(i,ze("disableProviderPing")))}}var _R=Object.defineProperty,xR=(t,e,r)=>e in t?_R(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Hs=(t,e,r)=>xR(t,typeof e!="symbol"?e+"":e,r);class ER{constructor(e){Hs(this,"name","near"),Hs(this,"client"),Hs(this,"httpProviders"),Hs(this,"events"),Hs(this,"namespace"),Hs(this,"chainId"),this.namespace=e.namespace,this.events=ze("events"),this.client=ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const i=r||Nr(`${this.name}:${e}`,this.namespace);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit(Wr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var i;e[r]=this.createHttpProvider(r,(i=this.namespace.rpcMap)==null?void 0:i[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||Nr(e,this.namespace);return typeof i>"u"?void 0:new Kr(new ci(i,ze("disableProviderPing")))}}var SR=Object.defineProperty,IR=(t,e,r)=>e in t?SR(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ks=(t,e,r)=>IR(t,typeof e!="symbol"?e+"":e,r);class AR{constructor(e){Ks(this,"name","tezos"),Ks(this,"client"),Ks(this,"httpProviders"),Ks(this,"events"),Ks(this,"namespace"),Ks(this,"chainId"),this.namespace=e.namespace,this.events=ze("events"),this.client=ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const i=r||Nr(`${this.name}:${e}`,this.namespace);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit(Wr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{e[r]=this.createHttpProvider(r)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||Nr(e,this.namespace);return typeof i>"u"?void 0:new Kr(new ci(i))}}var MR=Object.defineProperty,PR=(t,e,r)=>e in t?MR(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Vs=(t,e,r)=>PR(t,typeof e!="symbol"?e+"":e,r);class DR{constructor(e){Vs(this,"name",$s),Vs(this,"client"),Vs(this,"httpProviders"),Vs(this,"events"),Vs(this,"namespace"),Vs(this,"chainId"),this.namespace=e.namespace,this.events=ze("events"),this.client=ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Wr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){var e,r;const i={};return(r=(e=this.namespace)==null?void 0:e.accounts)==null||r.forEach(n=>{const s=ws(n);i[`${s.namespace}:${s.reference}`]=this.createHttpProvider(n)}),i}getHttpProvider(e){const r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||Nr(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new Kr(new ci(i,ze("disableProviderPing")))}}var $R=Object.defineProperty,OR=Object.defineProperties,RR=Object.getOwnPropertyDescriptors,Av=Object.getOwnPropertySymbols,NR=Object.prototype.hasOwnProperty,CR=Object.prototype.propertyIsEnumerable,Kh=(t,e,r)=>e in t?$R(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,hc=(t,e)=>{for(var r in e||(e={}))NR.call(e,r)&&Kh(t,r,e[r]);if(Av)for(var r of Av(e))CR.call(e,r)&&Kh(t,r,e[r]);return t},Vh=(t,e)=>OR(t,RR(e)),Cr=(t,e,r)=>Kh(t,typeof e!="symbol"?e+"":e,r);class uc{constructor(e){Cr(this,"client"),Cr(this,"namespaces"),Cr(this,"optionalNamespaces"),Cr(this,"sessionProperties"),Cr(this,"events",new er.exports),Cr(this,"rpcProviders",{}),Cr(this,"session"),Cr(this,"providerOpts"),Cr(this,"logger"),Cr(this,"uri"),Cr(this,"shouldAbortPairingAttempt",!1),Cr(this,"maxPairingAttempts",10),Cr(this,"disableProviderPing",!1),this.providerOpts=e,this.logger=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:hi(ra({level:e?.logger||S1})),this.disableProviderPing=e?.disableProviderPing||!1}static async init(e){const r=new uc(e);return await r.initialize(),r}async request(e,r,i){const[n,s]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:hc({},e),chainId:`${n}:${s}`,topic:this.session.topic,expiry:i})}sendAsync(e,r,i,n){const s=new Date().getTime();this.request(e,i,n).then(o=>r(null,Wa(s,o))).catch(o=>r(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:dt("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,r){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:i,response:n}=await this.client.authenticate(e,r);i&&(this.uri=i,this.events.emit("display_uri",i));const s=await n();if(this.session=s.session,this.session){const o=pv(this.session.namespaces);this.namespaces=Uh(this.namespaces,o),this.persist("namespaces",this.namespaces),this.onConnect()}return s}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}removeListener(e,r){this.events.removeListener(e,r)}off(e,r){this.events.off(e,r)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:i,approval:n}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});i&&(this.uri=i,this.events.emit("display_uri",i)),await n().then(s=>{this.session=s;const o=pv(s.namespaces);this.namespaces=Uh(this.namespaces,o),this.persist("namespaces",this.namespaces)}).catch(s=>{if(s.message!==_1)throw s;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,r){try{if(!this.session)return;const[i,n]=this.validateChain(e),s=this.getProvider(i);s.name===$s?s.setDefaultChain(`${i}:${n}`,r):s.setDefaultChain(n,r)}catch(i){if(!/Please call connect/.test(i.message))throw i}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(jn(r)){for(const i of r)e.deletePairings?this.client.core.expirer.set(i.topic,0):await this.client.core.relayer.subscriber.unsubscribe(i.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await Rh.init({core:this.providerOpts.core,logger:this.providerOpts.logger||S1,relayUrl:this.providerOpts.relayUrl||VS,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(r=>Po(r)))];zh("client",this.client),zh("events",this.events),zh("disableProviderPing",this.disableProviderPing),e.forEach(r=>{if(!this.session)return;const i=LO(r,this.session),n=dv(i),s=Uh(this.namespaces,this.optionalNamespaces),o=Vh(hc({},s[r]),{accounts:i,chains:n});switch(r){case"eip155":this.rpcProviders[r]=new rR({namespace:o});break;case"algorand":this.rpcProviders[r]=new uR({namespace:o});break;case"solana":this.rpcProviders[r]=new sR({namespace:o});break;case"cosmos":this.rpcProviders[r]=new cR({namespace:o});break;case"polkadot":this.rpcProviders[r]=new YO({namespace:o});break;case"cip34":this.rpcProviders[r]=new pR({namespace:o});break;case"elrond":this.rpcProviders[r]=new bR({namespace:o});break;case"multiversx":this.rpcProviders[r]=new wR({namespace:o});break;case"near":this.rpcProviders[r]=new ER({namespace:o});break;case"tezos":this.rpcProviders[r]=new AR({namespace:o});break;default:this.rpcProviders[$s]?this.rpcProviders[$s].updateNamespace(o):this.rpcProviders[$s]=new DR({namespace:o})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:r}=e,{event:i}=r;if(i.name==="accountsChanged"){const n=i.data;n&&jn(n)&&this.events.emit("accountsChanged",n.map(UO))}else if(i.name==="chainChanged"){const n=r.chainId,s=r.event.data,o=Po(n),a=jh(n)!==jh(s)?`${o}:${jh(s)}`:n;this.onChainChanged(a)}else this.events.emit(i.name,i.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:r})=>{var i;const{namespaces:n}=r,s=(i=this.client)==null?void 0:i.session.get(e);this.session=Vh(hc({},s),{namespaces:n}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:r})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Vh(hc({},dt("USER_DISCONNECTED")),{data:e.topic}))}),this.on(Wr.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[$s]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var r;this.getProvider(e).updateNamespace((r=this.session)==null?void 0:r.namespaces[e])})}setNamespaces(e){const{namespaces:r,optionalNamespaces:i,sessionProperties:n}=e;r&&Object.keys(r).length&&(this.namespaces=r),i&&Object.keys(i).length&&(this.optionalNamespaces=i),this.sessionProperties=n,this.persist("namespaces",r),this.persist("optionalNamespaces",i)}validateChain(e){const[r,i]=e?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,i];if(r&&!Object.keys(this.namespaces||{}).map(o=>Po(o)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&i)return[r,i];const n=Po(Object.keys(this.namespaces)[0]),s=this.rpcProviders[n].getDefaultChain();return[n,s]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,r=!1){if(!this.namespaces)return;const[i,n]=this.validateChain(e);n&&(r||this.getProvider(i).setDefaultChain(n),this.namespaces[i]?this.namespaces[i].defaultChain=n:this.namespaces[`${i}:${n}`]?this.namespaces[`${i}:${n}`].defaultChain=n:this.namespaces[`${i}:${n}`]={defaultChain:n},this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",n))}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(e,r){this.client.core.storage.setItem(`${I1}/${e}`,r)}async getFromStore(e){return await this.client.core.storage.getItem(`${I1}/${e}`)}}const TR=uc;xn.UniversalProvider=TR,xn.default=uc,Object.defineProperty(xn,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map
