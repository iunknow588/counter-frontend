"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.domainResolutionFlow = void 0;
const ledger_1 = __importDefault(require("../../services/ledger"));
/**
 * @ignore for the README
 *
 * This method will execute the pipeline of actions necessary for clear signing domains.
 * Signature is provided by the backend used in @ledgerhq/domain-service
 */
const domainResolutionFlow = async (appBinding, domainDescriptor) => {
    if (!domainDescriptor)
        return;
    const { domain, address, registry, type } = domainDescriptor;
    const challenge = await appBinding.getChallenge();
    const domainAPDU = type === "forward"
        ? await ledger_1.default.signDomainResolution(domain, registry, challenge)
        : await ledger_1.default.signAddressResolution(address, registry, challenge);
    if (domainAPDU) {
        await appBinding.provideDomainName(domainAPDU);
    }
};
exports.domainResolutionFlow = domainResolutionFlow;
//# sourceMappingURL=index.js.map