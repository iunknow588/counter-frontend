"use strict";var Jt=Object.create;var re=Object.defineProperty,Gt=Object.defineProperties,Kt=Object.getOwnPropertyDescriptor,jt=Object.getOwnPropertyDescriptors,Vt=Object.getOwnPropertyNames,at=Object.getOwnPropertySymbols,Bt=Object.getPrototypeOf,lt=Object.prototype.hasOwnProperty,Ht=Object.prototype.propertyIsEnumerable;var ct=(n,t,e)=>t in n?re(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,B=(n,t)=>{for(var e in t||(t={}))lt.call(t,e)&&ct(n,e,t[e]);if(at)for(var e of at(t))Ht.call(t,e)&&ct(n,e,t[e]);return n},H=(n,t)=>Gt(n,jt(t));var Xt=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports),dt=(n,t)=>{for(var e in t)re(n,e,{get:t[e],enumerable:!0})},ut=(n,t,e,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Vt(t))!lt.call(n,o)&&o!==e&&re(n,o,{get:()=>t[o],enumerable:!(r=Kt(t,o))||r.enumerable});return n};var zt=(n,t,e)=>(e=n!=null?Jt(Bt(n)):{},ut(t||!n||!n.__esModule?re(e,"default",{value:n,enumerable:!0}):e,n)),Yt=n=>ut(re({},"__esModule",{value:!0}),n);var f=(n,t,e)=>new Promise((r,o)=>{var s=c=>{try{a(e.next(c))}catch(d){o(d)}},i=c=>{try{a(e.throw(c))}catch(d){o(d)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(s,i);a((e=e.apply(n,t)).next())});var At=Xt(($r,Xe)=>{"use strict";var Vn=Object.prototype.hasOwnProperty,M="~";function ce(){}Object.create&&(ce.prototype=Object.create(null),new ce().__proto__||(M=!1));function Bn(n,t,e){this.fn=n,this.context=t,this.once=e||!1}function Ct(n,t,e,r,o){if(typeof e!="function")throw new TypeError("The listener must be a function");var s=new Bn(e,r||n,o),i=M?M+t:t;return n._events[i]?n._events[i].fn?n._events[i]=[n._events[i],s]:n._events[i].push(s):(n._events[i]=s,n._eventsCount++),n}function ve(n,t){--n._eventsCount===0?n._events=new ce:delete n._events[t]}function w(){this._events=new ce,this._eventsCount=0}w.prototype.eventNames=function(){var t=[],e,r;if(this._eventsCount===0)return t;for(r in e=this._events)Vn.call(e,r)&&t.push(M?r.slice(1):r);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(e)):t};w.prototype.listeners=function(t){var e=M?M+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var o=0,s=r.length,i=new Array(s);o<s;o++)i[o]=r[o].fn;return i};w.prototype.listenerCount=function(t){var e=M?M+t:t,r=this._events[e];return r?r.fn?1:r.length:0};w.prototype.emit=function(t,e,r,o,s,i){var a=M?M+t:t;if(!this._events[a])return!1;var c=this._events[a],d=arguments.length,u,m;if(c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,e),!0;case 3:return c.fn.call(c.context,e,r),!0;case 4:return c.fn.call(c.context,e,r,o),!0;case 5:return c.fn.call(c.context,e,r,o,s),!0;case 6:return c.fn.call(c.context,e,r,o,s,i),!0}for(m=1,u=new Array(d-1);m<d;m++)u[m-1]=arguments[m];c.fn.apply(c.context,u)}else{var A=c.length,T;for(m=0;m<A;m++)switch(c[m].once&&this.removeListener(t,c[m].fn,void 0,!0),d){case 1:c[m].fn.call(c[m].context);break;case 2:c[m].fn.call(c[m].context,e);break;case 3:c[m].fn.call(c[m].context,e,r);break;case 4:c[m].fn.call(c[m].context,e,r,o);break;default:if(!u)for(T=1,u=new Array(d-1);T<d;T++)u[T-1]=arguments[T];c[m].fn.apply(c[m].context,u)}}return!0};w.prototype.on=function(t,e,r){return Ct(this,t,e,r,!1)};w.prototype.once=function(t,e,r){return Ct(this,t,e,r,!0)};w.prototype.removeListener=function(t,e,r,o){var s=M?M+t:t;if(!this._events[s])return this;if(!e)return ve(this,s),this;var i=this._events[s];if(i.fn)i.fn===e&&(!o||i.once)&&(!r||i.context===r)&&ve(this,s);else{for(var a=0,c=[],d=i.length;a<d;a++)(i[a].fn!==e||o&&!i[a].once||r&&i[a].context!==r)&&c.push(i[a]);c.length?this._events[s]=c.length===1?c[0]:c:ve(this,s)}return this};w.prototype.removeAllListeners=function(t){var e;return t?(e=M?M+t:t,this._events[e]&&ve(this,e)):(this._events=new ce,this._eventsCount=0),this};w.prototype.off=w.prototype.removeListener;w.prototype.addListener=w.prototype.on;w.prefixed=M;w.EventEmitter=w;typeof Xe<"u"&&(Xe.exports=w)});var fr={};dt(fr,{Extension:()=>_,MagicExtensionError:()=>K,MagicExtensionWarning:()=>Y,MagicRPCError:()=>L,MagicSDKError:()=>$,MagicSDKWarning:()=>q,SDKBase:()=>pe,STORE_KEY_PRIVATE_KEY:()=>Me,STORE_KEY_PUBLIC_JWK:()=>de,TypedEmitter:()=>Ie,ViewController:()=>_e,clearKeys:()=>er,createDeprecationWarning:()=>U,createDuplicateIframeWarning:()=>Jn,createExtensionNotInitializedError:()=>Ke,createIncompatibleExtensionsError:()=>je,createInvalidArgumentError:()=>Ve,createJwt:()=>et,createMalformedResponseError:()=>Ge,createMissingApiKeyError:()=>Fe,createModalNotReadyError:()=>Je,createPromiEvent:()=>O,createPromise:()=>be,createReactNativeEndpointConfigurationWarning:()=>He,createSDK:()=>wt,createSynchronousWeb3MethodWarning:()=>Be,createTypedEmitter:()=>le,createURL:()=>xe,decodeJSON:()=>qe,encodeJSON:()=>ae,getPayloadId:()=>Re,isEmpty:()=>z,isJsonRpcErrorCode:()=>We,isJsonRpcRequestPayload:()=>Wn,isJsonRpcResponsePayload:()=>Ue,isMagicPayloadMethod:()=>Fn,isMajorVersionAtLeast:()=>Ye,isPromiEvent:()=>ze,isWebCryptoSupported:()=>ee,storage:()=>Z,uuid:()=>Ze});module.exports=Yt(fr);function Qt(n){let t={exports:{}};return n(t,t.exports),t.exports}var Zt=Number.MAX_SAFE_INTEGER||9007199254740991;var De={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:Zt,MAX_SAFE_COMPONENT_LENGTH:16},en=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...n)=>console.error("SEMVER",...n):()=>{},y=en,ie=Qt(function(n,t){let{MAX_SAFE_COMPONENT_LENGTH:e}=De,r=(t=n.exports={}).re=[],o=t.src=[],s=t.t={},i=0,a=(c,d,u)=>{let m=i++;y(m,d),s[c]=m,o[m]=d,r[m]=new RegExp(d,u?"g":void 0)};a("NUMERICIDENTIFIER","0|[1-9]\\d*"),a("NUMERICIDENTIFIERLOOSE","[0-9]+"),a("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),a("MAINVERSION",`(${o[s.NUMERICIDENTIFIER]})\\.(${o[s.NUMERICIDENTIFIER]})\\.(${o[s.NUMERICIDENTIFIER]})`),a("MAINVERSIONLOOSE",`(${o[s.NUMERICIDENTIFIERLOOSE]})\\.(${o[s.NUMERICIDENTIFIERLOOSE]})\\.(${o[s.NUMERICIDENTIFIERLOOSE]})`),a("PRERELEASEIDENTIFIER",`(?:${o[s.NUMERICIDENTIFIER]}|${o[s.NONNUMERICIDENTIFIER]})`),a("PRERELEASEIDENTIFIERLOOSE",`(?:${o[s.NUMERICIDENTIFIERLOOSE]}|${o[s.NONNUMERICIDENTIFIER]})`),a("PRERELEASE",`(?:-(${o[s.PRERELEASEIDENTIFIER]}(?:\\.${o[s.PRERELEASEIDENTIFIER]})*))`),a("PRERELEASELOOSE",`(?:-?(${o[s.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${o[s.PRERELEASEIDENTIFIERLOOSE]})*))`),a("BUILDIDENTIFIER","[0-9A-Za-z-]+"),a("BUILD",`(?:\\+(${o[s.BUILDIDENTIFIER]}(?:\\.${o[s.BUILDIDENTIFIER]})*))`),a("FULLPLAIN",`v?${o[s.MAINVERSION]}${o[s.PRERELEASE]}?${o[s.BUILD]}?`),a("FULL",`^${o[s.FULLPLAIN]}$`),a("LOOSEPLAIN",`[v=\\s]*${o[s.MAINVERSIONLOOSE]}${o[s.PRERELEASELOOSE]}?${o[s.BUILD]}?`),a("LOOSE",`^${o[s.LOOSEPLAIN]}$`),a("GTLT","((?:<|>)?=?)"),a("XRANGEIDENTIFIERLOOSE",`${o[s.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),a("XRANGEIDENTIFIER",`${o[s.NUMERICIDENTIFIER]}|x|X|\\*`),a("XRANGEPLAIN",`[v=\\s]*(${o[s.XRANGEIDENTIFIER]})(?:\\.(${o[s.XRANGEIDENTIFIER]})(?:\\.(${o[s.XRANGEIDENTIFIER]})(?:${o[s.PRERELEASE]})?${o[s.BUILD]}?)?)?`),a("XRANGEPLAINLOOSE",`[v=\\s]*(${o[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[s.XRANGEIDENTIFIERLOOSE]})(?:${o[s.PRERELEASELOOSE]})?${o[s.BUILD]}?)?)?`),a("XRANGE",`^${o[s.GTLT]}\\s*${o[s.XRANGEPLAIN]}$`),a("XRANGELOOSE",`^${o[s.GTLT]}\\s*${o[s.XRANGEPLAINLOOSE]}$`),a("COERCE",`(^|[^\\d])(\\d{1,${e}})(?:\\.(\\d{1,${e}}))?(?:\\.(\\d{1,${e}}))?(?:$|[^\\d])`),a("COERCERTL",o[s.COERCE],!0),a("LONETILDE","(?:~>?)"),a("TILDETRIM",`(\\s*)${o[s.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",a("TILDE",`^${o[s.LONETILDE]}${o[s.XRANGEPLAIN]}$`),a("TILDELOOSE",`^${o[s.LONETILDE]}${o[s.XRANGEPLAINLOOSE]}$`),a("LONECARET","(?:\\^)"),a("CARETTRIM",`(\\s*)${o[s.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",a("CARET",`^${o[s.LONECARET]}${o[s.XRANGEPLAIN]}$`),a("CARETLOOSE",`^${o[s.LONECARET]}${o[s.XRANGEPLAINLOOSE]}$`),a("COMPARATORLOOSE",`^${o[s.GTLT]}\\s*(${o[s.LOOSEPLAIN]})$|^$`),a("COMPARATOR",`^${o[s.GTLT]}\\s*(${o[s.FULLPLAIN]})$|^$`),a("COMPARATORTRIM",`(\\s*)${o[s.GTLT]}\\s*(${o[s.LOOSEPLAIN]}|${o[s.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",a("HYPHENRANGE",`^\\s*(${o[s.XRANGEPLAIN]})\\s+-\\s+(${o[s.XRANGEPLAIN]})\\s*$`),a("HYPHENRANGELOOSE",`^\\s*(${o[s.XRANGEPLAINLOOSE]})\\s+-\\s+(${o[s.XRANGEPLAINLOOSE]})\\s*$`),a("STAR","(<|>)?=?\\s*\\*"),a("GTE0","^\\s*>=\\s*0.0.0\\s*$"),a("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")}),pt=/^[0-9]+$/,It=(n,t)=>{let e=pt.test(n),r=pt.test(t);return e&&r&&(n=+n,t=+t),n===t?0:e&&!r?-1:r&&!e?1:n<t?-1:1},tn=(n,t)=>It(t,n),nn={compareIdentifiers:It,rcompareIdentifiers:tn},{MAX_LENGTH:ht,MAX_SAFE_INTEGER:me}=De,{re:mt,t:Et}=ie,{compareIdentifiers:se}=nn,R=class{constructor(t,e){if(e&&typeof e=="object"||(e={loose:!!e,includePrerelease:!1}),t instanceof R){if(t.loose===!!e.loose&&t.includePrerelease===!!e.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid Version: ${t}`);if(t.length>ht)throw new TypeError(`version is longer than ${ht} characters`);y("SemVer",t,e),this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease;let r=t.trim().match(e.loose?mt[Et.LOOSE]:mt[Et.FULL]);if(!r)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>me||this.major<0)throw new TypeError("Invalid major version");if(this.minor>me||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>me||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(o=>{if(/^[0-9]+$/.test(o)){let s=+o;if(s>=0&&s<me)return s}return o}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(y("SemVer.compare",this.version,this.options,t),!(t instanceof R)){if(typeof t=="string"&&t===this.version)return 0;t=new R(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof R||(t=new R(t,this.options)),se(this.major,t.major)||se(this.minor,t.minor)||se(this.patch,t.patch)}comparePre(t){if(t instanceof R||(t=new R(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let e=0;do{let r=this.prerelease[e],o=t.prerelease[e];if(y("prerelease compare",e,r,o),r===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(r===void 0)return-1;if(r!==o)return se(r,o)}while(++e)}compareBuild(t){t instanceof R||(t=new R(t,this.options));let e=0;do{let r=this.build[e],o=t.build[e];if(y("prerelease compare",e,r,o),r===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(r===void 0)return-1;if(r!==o)return se(r,o)}while(++e)}inc(t,e){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",e),this.inc("pre",e);break;case"major":this.minor===0&&this.patch===0&&this.prerelease.length!==0||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":this.patch===0&&this.prerelease.length!==0||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{let r=this.prerelease.length;for(;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}e&&(this.prerelease[0]===e?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error(`invalid increment argument: ${t}`)}return this.format(),this.raw=this.version,this}},rn=(n,t,e)=>new R(n,e).compare(new R(t,e)),X=rn,sn=(n,t,e)=>X(n,t,e)===0,on=sn,an=(n,t,e)=>X(n,t,e)!==0,cn=an,ln=(n,t,e)=>X(n,t,e)>0,dn=ln,un=(n,t,e)=>X(n,t,e)>=0,pn=un,hn=(n,t,e)=>X(n,t,e)<0,mn=hn,En=(n,t,e)=>X(n,t,e)<=0,fn=En,yn=(n,t,e,r)=>{switch(t){case"===":return typeof n=="object"&&(n=n.version),typeof e=="object"&&(e=e.version),n===e;case"!==":return typeof n=="object"&&(n=n.version),typeof e=="object"&&(e=e.version),n!==e;case"":case"=":case"==":return on(n,e,r);case"!=":return cn(n,e,r);case">":return dn(n,e,r);case">=":return pn(n,e,r);case"<":return mn(n,e,r);case"<=":return fn(n,e,r);default:throw new TypeError(`Invalid operator: ${t}`)}},ke=yn,oe=Symbol("SemVer ANY"),W=class{static get ANY(){return oe}constructor(t,e){if(e&&typeof e=="object"||(e={loose:!!e,includePrerelease:!1}),t instanceof W){if(t.loose===!!e.loose)return t;t=t.value}y("comparator",t,e),this.options=e,this.loose=!!e.loose,this.parse(t),this.semver===oe?this.value="":this.value=this.operator+this.semver.version,y("comp",this)}parse(t){let e=this.options.loose?ft[yt.COMPARATORLOOSE]:ft[yt.COMPARATOR],r=t.match(e);if(!r)throw new TypeError(`Invalid comparator: ${t}`);this.operator=r[1]!==void 0?r[1]:"",this.operator==="="&&(this.operator=""),r[2]?this.semver=new R(r[2],this.options.loose):this.semver=oe}toString(){return this.value}test(t){if(y("Comparator.test",t,this.options.loose),this.semver===oe||t===oe)return!0;if(typeof t=="string")try{t=new R(t,this.options)}catch(e){return!1}return ke(t,this.operator,this.semver,this.options)}intersects(t,e){if(!(t instanceof W))throw new TypeError("a Comparator is required");if(e&&typeof e=="object"||(e={loose:!!e,includePrerelease:!1}),this.operator==="")return this.value===""||new k(t.value,e).test(this.value);if(t.operator==="")return t.value===""||new k(this.value,e).test(t.semver);let r=!(this.operator!==">="&&this.operator!==">"||t.operator!==">="&&t.operator!==">"),o=!(this.operator!=="<="&&this.operator!=="<"||t.operator!=="<="&&t.operator!=="<"),s=this.semver.version===t.semver.version,i=!(this.operator!==">="&&this.operator!=="<="||t.operator!==">="&&t.operator!=="<="),a=ke(this.semver,"<",t.semver,e)&&(this.operator===">="||this.operator===">")&&(t.operator==="<="||t.operator==="<"),c=ke(this.semver,">",t.semver,e)&&(this.operator==="<="||this.operator==="<")&&(t.operator===">="||t.operator===">");return r||o||s&&i||a||c}},{re:ft,t:yt}=ie,k=class{constructor(t,e){if(e&&typeof e=="object"||(e={loose:!!e,includePrerelease:!1}),t instanceof k)return t.loose===!!e.loose&&t.includePrerelease===!!e.includePrerelease?t:new k(t.raw,e);if(t instanceof W)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease,this.raw=t,this.set=t.split(/\s*\|\|\s*/).map(r=>this.parseRange(r.trim())).filter(r=>r.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${t}`);this.format()}format(){return this.range=this.set.map(t=>t.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(t){let{loose:e}=this.options;t=t.trim();let r=e?b[I.HYPHENRANGELOOSE]:b[I.HYPHENRANGE];t=t.replace(r,Nn(this.options.includePrerelease)),y("hyphen replace",t),t=t.replace(b[I.COMPARATORTRIM],gn),y("comparator trim",t,b[I.COMPARATORTRIM]),t=(t=(t=t.replace(b[I.TILDETRIM],Rn)).replace(b[I.CARETTRIM],vn)).split(/\s+/).join(" ");let o=e?b[I.COMPARATORLOOSE]:b[I.COMPARATOR];return t.split(" ").map(s=>In(s,this.options)).join(" ").split(/\s+/).map(s=>An(s,this.options)).filter(this.options.loose?s=>!!s.match(o):()=>!0).map(s=>new W(s,this.options))}intersects(t,e){if(!(t instanceof k))throw new TypeError("a Range is required");return this.set.some(r=>gt(r,e)&&t.set.some(o=>gt(o,e)&&r.every(s=>o.every(i=>s.intersects(i,e)))))}test(t){if(!t)return!1;if(typeof t=="string")try{t=new R(t,this.options)}catch(e){return!1}for(let e=0;e<this.set.length;e++)if(Sn(this.set[e],t,this.options))return!0;return!1}},{re:b,t:I,comparatorTrimReplace:gn,tildeTrimReplace:Rn,caretTrimReplace:vn}=ie,gt=(n,t)=>{let e=!0,r=n.slice(),o=r.pop();for(;e&&r.length;)e=r.every(s=>o.intersects(s,t)),o=r.pop();return e},In=(n,t)=>(y("comp",n,t),n=wn(n,t),y("caret",n),n=Tn(n,t),y("tildes",n),n=Mn(n,t),y("xrange",n),n=Cn(n,t),y("stars",n),n),P=n=>!n||n.toLowerCase()==="x"||n==="*",Tn=(n,t)=>n.trim().split(/\s+/).map(e=>bn(e,t)).join(" "),bn=(n,t)=>{let e=t.loose?b[I.TILDELOOSE]:b[I.TILDE];return n.replace(e,(r,o,s,i,a)=>{let c;return y("tilde",n,r,o,s,i,a),P(o)?c="":P(s)?c=`>=${o}.0.0 <${+o+1}.0.0-0`:P(i)?c=`>=${o}.${s}.0 <${o}.${+s+1}.0-0`:a?(y("replaceTilde pr",a),c=`>=${o}.${s}.${i}-${a} <${o}.${+s+1}.0-0`):c=`>=${o}.${s}.${i} <${o}.${+s+1}.0-0`,y("tilde return",c),c})},wn=(n,t)=>n.trim().split(/\s+/).map(e=>Pn(e,t)).join(" "),Pn=(n,t)=>{y("caret",n,t);let e=t.loose?b[I.CARETLOOSE]:b[I.CARET],r=t.includePrerelease?"-0":"";return n.replace(e,(o,s,i,a,c)=>{let d;return y("caret",n,o,s,i,a,c),P(s)?d="":P(i)?d=`>=${s}.0.0${r} <${+s+1}.0.0-0`:P(a)?d=s==="0"?`>=${s}.${i}.0${r} <${s}.${+i+1}.0-0`:`>=${s}.${i}.0${r} <${+s+1}.0.0-0`:c?(y("replaceCaret pr",c),d=s==="0"?i==="0"?`>=${s}.${i}.${a}-${c} <${s}.${i}.${+a+1}-0`:`>=${s}.${i}.${a}-${c} <${s}.${+i+1}.0-0`:`>=${s}.${i}.${a}-${c} <${+s+1}.0.0-0`):(y("no pr"),d=s==="0"?i==="0"?`>=${s}.${i}.${a}${r} <${s}.${i}.${+a+1}-0`:`>=${s}.${i}.${a}${r} <${s}.${+i+1}.0-0`:`>=${s}.${i}.${a} <${+s+1}.0.0-0`),y("caret return",d),d})},Mn=(n,t)=>(y("replaceXRanges",n,t),n.split(/\s+/).map(e=>xn(e,t)).join(" ")),xn=(n,t)=>{n=n.trim();let e=t.loose?b[I.XRANGELOOSE]:b[I.XRANGE];return n.replace(e,(r,o,s,i,a,c)=>{y("xRange",n,r,o,s,i,a,c);let d=P(s),u=d||P(i),m=u||P(a),A=m;return o==="="&&A&&(o=""),c=t.includePrerelease?"-0":"",d?r=o===">"||o==="<"?"<0.0.0-0":"*":o&&A?(u&&(i=0),a=0,o===">"?(o=">=",u?(s=+s+1,i=0,a=0):(i=+i+1,a=0)):o==="<="&&(o="<",u?s=+s+1:i=+i+1),o==="<"&&(c="-0"),r=`${o+s}.${i}.${a}${c}`):u?r=`>=${s}.0.0${c} <${+s+1}.0.0-0`:m&&(r=`>=${s}.${i}.0${c} <${s}.${+i+1}.0-0`),y("xRange return",r),r})},Cn=(n,t)=>(y("replaceStars",n,t),n.trim().replace(b[I.STAR],"")),An=(n,t)=>(y("replaceGTE0",n,t),n.trim().replace(b[t.includePrerelease?I.GTE0PRE:I.GTE0],"")),Nn=n=>(t,e,r,o,s,i,a,c,d,u,m,A,T)=>`${e=P(r)?"":P(o)?`>=${r}.0.0${n?"-0":""}`:P(s)?`>=${r}.${o}.0${n?"-0":""}`:i?`>=${e}`:`>=${e}${n?"-0":""}`} ${c=P(d)?"":P(u)?`<${+d+1}.0.0-0`:P(m)?`<${d}.${+u+1}.0-0`:A?`<=${d}.${u}.${m}-${A}`:n?`<${d}.${u}.${+m+1}-0`:`<=${c}`}`.trim(),Sn=(n,t,e)=>{for(let r=0;r<n.length;r++)if(!n[r].test(t))return!1;if(t.prerelease.length&&!e.includePrerelease){for(let r=0;r<n.length;r++)if(y(n[r].semver),n[r].semver!==W.ANY&&n[r].semver.prerelease.length>0){let o=n[r].semver;if(o.major===t.major&&o.minor===t.minor&&o.patch===t.patch)return!0}return!1}return!0},Tt=(n,t,e)=>{try{t=new k(t,e)}catch(r){return!1}return t.test(n)};var{MAX_LENGTH:$n}=De,{re:Rt,t:vt}=ie,Ln=(n,t)=>{if(t&&typeof t=="object"||(t={loose:!!t,includePrerelease:!1}),n instanceof R)return n;if(typeof n!="string"||n.length>$n||!(t.loose?Rt[vt.LOOSE]:Rt[vt.FULL]).test(n))return null;try{return new R(n,t)}catch(e){return null}},On=Ln,{re:Ee,t:fe}=ie,bt=(n,t)=>{if(n instanceof R)return n;if(typeof n=="number"&&(n=String(n)),typeof n!="string")return null;let e=null;if((t=t||{}).rtl){let r;for(;(r=Ee[fe.COERCERTL].exec(n))&&(!e||e.index+e[0].length!==n.length);)e&&r.index+r[0].length===e.index+e[0].length||(e=r),Ee[fe.COERCERTL].lastIndex=r.index+r[1].length+r[2].length;Ee[fe.COERCERTL].lastIndex=-1}else e=n.match(Ee[fe.COERCE]);return e===null?null:On(`${e[2]}.${e[3]||"0"}.${e[4]||"0"}`,t)};function _n(n){return String.fromCharCode(parseInt(n.slice(1),16))}function kn(n){return`%${`00${n.charCodeAt(0).toString(16)}`.slice(-2)}`}function Dn(n){return btoa(encodeURIComponent(n).replace(/%[0-9A-F]{2}/g,_n))}function qn(n){return decodeURIComponent(Array.from(atob(n),kn).join(""))}function ae(n){return Dn(JSON.stringify(n))}function qe(n){return JSON.parse(qn(n))}var N=require("@magic-sdk/types");var ye=require("@magic-sdk/types");function D(n){return typeof n=="undefined"}function Un(n){return n===null}function ge(n){return Un(n)||D(n)}function Wn(n){return ge(n)?!1:!D(n.jsonrpc)&&!D(n.id)&&!D(n.method)&&!D(n.params)}function Ue(n){return ge(n)?!1:!D(n.jsonrpc)&&!D(n.id)&&(!D(n.result)||!D(n.error))}function Fn(n){return ge(n)?!1:typeof n=="string"&&Object.values(ye.MagicPayloadMethod).includes(n)}function We(n){return ge(n)?!1:typeof n=="number"&&Object.values(ye.RPCErrorCode).includes(n)}function z(n){if(!n)return!0;for(let t in n)if(Object.hasOwnProperty.call(n,t))return!1;return!0}var E={};function wt(n,t){return Object.assign(E,t),n}var Pt={"magic-sdk":"magic-sdk","@magic-sdk/react-native":"magic-sdk-rn","@magic-sdk/react-native-bare":"magic-sdk-rn-bare","@magic-sdk/react-native-expo":"magic-sdk-rn-expo"};var $=class extends Error{constructor(e,r){super(`Magic SDK Error: [${e}] ${r}`);this.code=e;this.rawMessage=r;this.__proto__=Error;Object.setPrototypeOf(this,$.prototype)}},L=class extends Error{constructor(e){super();this.__proto__=Error;let r=Number(e==null?void 0:e.code);this.rawMessage=(e==null?void 0:e.message)||"Internal error",this.code=We(r)?r:N.RPCErrorCode.InternalError,this.message=`Magic RPC Error: [${this.code}] ${this.rawMessage}`,this.data=(e==null?void 0:e.data)||void 0,Object.setPrototypeOf(this,L.prototype)}},q=class{constructor(t,e){this.code=t;this.rawMessage=e;this.message=`Magic SDK Warning: [${t}] ${e}`}log(){console.warn(this.message)}},K=class extends Error{constructor(e,r,o,s){super(`Magic Extension Error (${e.name}): [${r}] ${o}`);this.code=r;this.rawMessage=o;this.data=s;this.__proto__=Error;Object.setPrototypeOf(this,K.prototype)}},Y=class{constructor(t,e,r){this.code=e;this.rawMessage=r;this.message=`Magic Extension Warning (${t.name}): [${e}] ${r}`}log(){console.warn(this.message)}};function Fe(){return new $(N.SDKErrorCode.MissingApiKey,"Please provide an API key that you acquired from the Magic developer dashboard.")}function Je(){return new $(N.SDKErrorCode.ModalNotReady,"Modal is not ready.")}function Ge(){return new $(N.SDKErrorCode.MalformedResponse,"Response from the Magic iframe is malformed.")}function Ke(n){return new $(N.SDKErrorCode.ExtensionNotInitialized,`Extensions must be initialized with a Magic SDK instance before \`Extension.${n}\` can be accessed. Do not invoke \`Extension.${n}\` inside an extension constructor.`)}function je(n){let t=`Some extensions are incompatible with \`${E.sdkName}@${E.version}\`:`;return n.filter(e=>typeof e.compat!="undefined"&&e.compat!==null).forEach(e=>{let r=e.compat[E.sdkName];typeof r=="string"?t+=`
  - Extension \`${e.name}\` supports version(s) \`${r}\``:r||(t+=`
  - Extension \`${e.name}\` does not support ${E.platform} environments.`)}),new $(N.SDKErrorCode.IncompatibleExtensions,t)}function Ve(n){let t=e=>{let r=e+1,o=r%10,s=r%100;return o===1&&s!==11?`${r}st`:o===2&&s!==12?`${r}nd`:o===3&&s!==13?`${r}rd`:`${r}th`};return new $(N.SDKErrorCode.InvalidArgument,`Invalid ${t(n.argument)} argument given to \`${n.procedure}\`.
  Expected: \`${n.expected}\`
  Received: \`${n.received}\``)}function Jn(){return new q(N.SDKWarningCode.DuplicateIframe,"Duplicate iframes found.")}function Be(){return new q(N.SDKWarningCode.SyncWeb3Method,"Non-async web3 methods are deprecated in web3 > 1.0 and are not supported by the Magic web3 provider. Please use an async method instead.")}function He(){return new q(N.SDKWarningCode.ReactNativeEndpointConfiguration,`CUSTOM DOMAINS ARE NOT SUPPORTED WHEN USING MAGIC SDK WITH REACT NATIVE! The \`endpoint\` parameter SHOULD NOT be provided. The Magic \`<iframe>\` is automatically wrapped by a WebView pointed at \`${E.defaultEndpoint}\`. Changing this default behavior will lead to unexpected results and potentially security-threatening bugs.`)}function U(n){let{method:t,removalVersions:e,useInstead:r}=n,o=e[E.sdkName],s=r?` Use \`${r}\` instead.`:"",i=`\`${t}\` will be removed from \`${E.sdkName}\` in version \`${o}\`.${s}`;return new q(N.SDKWarningCode.DeprecationNotice,i)}var p=require("@magic-sdk/types");var Q=require("@magic-sdk/types");function*Gn(){let n=0;for(;;)n<Number.MAX_SAFE_INTEGER?yield++n:n=0}var Kn=Gn();function Re(){return Kn.next().value}var Mt=Symbol("Payload pre-processed by Magic SDK");function xt(n){return Object.defineProperty(n,Mt,{value:!0,enumerable:!1}),n}function jn(n){return!!n[Mt]}function j(n){var t,e,r;return jn(n)||(n.jsonrpc=(t=n.jsonrpc)!=null?t:"2.0",n.id=Re(),n.method=(e=n.method)!=null?e:"noop",n.params=(r=n.params)!=null?r:[],xt(n)),n}function h(n,t=[]){return xt({params:t,method:n,jsonrpc:"2.0",id:Re()})}var F=class{constructor(t){t instanceof F?(this._jsonrpc=t.payload.jsonrpc,this._id=t.payload.id,this._result=t.payload.result,this._error=t.payload.error):Ue(t)?(this._jsonrpc=t.jsonrpc,this._id=t.id,this._result=t.result,this._error=t.error):(this._jsonrpc=t.jsonrpc,this._id=t.id,this._result=void 0,this._error=void 0)}applyError(t){return this._error=t,this}applyResult(t){return this._result=t,this}get hasError(){return typeof this._error!="undefined"&&this._error!==null}get hasResult(){return typeof this._result!="undefined"}get payload(){return{jsonrpc:this._jsonrpc,id:this._id,result:this._result,error:this._error}}};var Te=require("@magic-sdk/types");var Nt=zt(At()),Ie=class extends Nt.default{};function le(){let n=new Ie;return{emitter:n,createChainingEmitterMethod:(r,o)=>(...s)=>(n[r].apply(n,s),o),createBoundEmitterMethod:r=>(...o)=>n[r].apply(n,o)}}var St=Symbol("isPromiEvent");function ze(n){return!!n[St]}function O(n){let t=be(n),{createBoundEmitterMethod:e,createChainingEmitterMethod:r}=le(),o=Symbol("Promise.then"),s=Symbol("Promise.catch"),i=Symbol("Promise.finally"),a=(u,m)=>(...A)=>{let T=m[u].apply(m,A);return c(T)},c=u=>Object.assign(u,{[St]:!0,[o]:u[o]||u.then,[s]:u[s]||u.catch,[i]:u[i]||u.finally,then:a(o,u),catch:a(s,u),finally:a(i,u),on:r("on",u),once:r("once",u),addListener:r("addListener",u),off:r("off",u),removeListener:r("removeListener",u),removeAllListeners:r("removeAllListeners",u),emit:e("emit"),eventNames:e("eventNames"),listeners:e("listeners"),listenerCount:e("listenerCount")}),d=c(t.then(u=>(d.emit("done",u),d.emit("settled"),u),u=>{throw d.emit("error",u),d.emit("settled"),u}));return d.on(Te.UserEventsOnReceived.ClosedByUser,()=>{d.emit(Te.UserEventsEmit.ClosedByUser)}),d}function be(n){return new Promise((t,e)=>{let r=n(t,e);Promise.resolve(r).catch(e)})}var x=class{constructor(t){this.sdk=t}get overlay(){return this.sdk.overlay}request(t){let e=this.overlay.post(Q.MagicOutgoingWindowMessage.MAGIC_HANDLE_REQUEST,j(t)),r=O((s,i)=>{e.then(a=>{if(o(),a.hasError)i(new L(a.payload.error));else if(a.hasResult)s(a.payload.result);else throw Ge()}).catch(a=>{o(),i(a)})}),o=this.overlay.on(Q.MagicIncomingWindowMessage.MAGIC_HANDLE_EVENT,s=>{var a;let{response:i}=s.data;if(i.id===t.id&&((a=i.result)==null?void 0:a.event)){let{event:c,params:d=[]}=i.result;r.emit(c,...d)}});return r}createIntermediaryEvent(t,e){return o=>{let s=h(Q.MagicPayloadMethod.IntermediaryEvent,[{payloadId:e,eventType:t,args:o}]);this.request(s)}}};function Ye(n,t){let[e]=n.split(".").map(Number);return e>=t}var V={"magic-sdk":"v18.0.0","@magic-sdk/react-native":"v14.0.0","@magic-sdk/react-native-bare":"v19.0.0","@magic-sdk/react-native-expo":"v19.0.0"},we=class extends x{loginWithMagicLink(t){let e=E.sdkName==="@magic-sdk/react-native"||E.sdkName==="@magic-sdk/react-native-bare"||E.sdkName==="@magic-sdk/react-native-expo";if(e&&Ye(E.version,19))throw new Error("loginWithMagicLink() is deprecated for this package, please utlize a passcode method like loginWithSMS or loginWithEmailOTP instead.");e&&U({method:"auth.loginWithMagicLink()",removalVersions:V,useInstead:"auth.loginWithEmailOTP()"}).log();let{email:r,showUI:o=!0,redirectURI:s,overrides:i,lifespan:a}=t,c=h(this.sdk.testMode?p.MagicPayloadMethod.LoginWithMagicLinkTestMode:p.MagicPayloadMethod.LoginWithMagicLink,[{email:r,showUI:o,redirectURI:s,overrides:i,lifespan:a}]);return this.request(c)}loginWithSMS(t){let{phoneNumber:e,showUI:r=!0,lifespan:o}=t,s=h(this.sdk.testMode?p.MagicPayloadMethod.LoginWithSmsTestMode:p.MagicPayloadMethod.LoginWithSms,[{phoneNumber:e,showUI:r,lifespan:o}]),i=this.request(s);return!r&&i&&(i.on(p.LoginWithSmsOTPEventEmit.VerifySmsOtp,a=>{this.createIntermediaryEvent(p.LoginWithSmsOTPEventEmit.VerifySmsOtp,s.id)(a)}),i.on(p.LoginWithSmsOTPEventEmit.Cancel,()=>{this.createIntermediaryEvent(p.LoginWithSmsOTPEventEmit.Cancel,s.id)()})),i}loginWithEmailOTP(t){let{email:e,showUI:r,deviceCheckUI:o,overrides:s,lifespan:i}=t,a=h(this.sdk.testMode?p.MagicPayloadMethod.LoginWithEmailOTPTestMode:p.MagicPayloadMethod.LoginWithEmailOTP,[{email:e,showUI:r,deviceCheckUI:o,overrides:s,lifespan:i}]),c=this.request(a);return!o&&c&&c.on(p.DeviceVerificationEventEmit.Retry,()=>{this.createIntermediaryEvent(p.DeviceVerificationEventEmit.Retry,a.id)()}),!r&&c&&(c.on(p.LoginWithEmailOTPEventEmit.VerifyEmailOtp,d=>{this.createIntermediaryEvent(p.LoginWithEmailOTPEventEmit.VerifyEmailOtp,a.id)(d)}),c.on(p.LoginWithEmailOTPEventEmit.VerifyMFACode,d=>{this.createIntermediaryEvent(p.LoginWithEmailOTPEventEmit.VerifyMFACode,a.id)(d)}),c.on(p.LoginWithEmailOTPEventEmit.LostDevice,()=>{this.createIntermediaryEvent(p.LoginWithEmailOTPEventEmit.LostDevice,a.id)()}),c.on(p.LoginWithEmailOTPEventEmit.VerifyRecoveryCode,d=>{this.createIntermediaryEvent(p.LoginWithEmailOTPEventEmit.VerifyRecoveryCode,a.id)(d)}),c.on(p.LoginWithEmailOTPEventEmit.Cancel,()=>{this.createIntermediaryEvent(p.LoginWithEmailOTPEventEmit.Cancel,a.id)()})),c}loginWithCredential(t){let{credentialOrQueryString:e,lifespan:r}=t||{},o=e!=null?e:"";if(!e&&E.platform==="web"){o=window.location.search;let i=window.location.origin+window.location.pathname;window.history.replaceState(null,"",i)}let s=h(this.sdk.testMode?p.MagicPayloadMethod.LoginWithCredentialTestMode:p.MagicPayloadMethod.LoginWithCredential,[o,r]);return this.request(s)}setAuthorizationToken(t){let e=h(p.MagicPayloadMethod.SetAuthorizationToken,[{jwt:t}]);return this.request(e)}updateEmailWithUI(t){let{email:e,showUI:r=!0}=t,o=h(this.sdk.testMode?p.MagicPayloadMethod.UpdateEmailTestMode:p.MagicPayloadMethod.UpdateEmail,[{email:e,showUI:r}]),s=this.request(o);return r||(s.on(p.RecencyCheckEventEmit.Retry,()=>{this.createIntermediaryEvent(p.RecencyCheckEventEmit.Retry,o.id)()}),s.on(p.RecencyCheckEventEmit.Cancel,()=>{this.createIntermediaryEvent(p.RecencyCheckEventEmit.Cancel,o.id)()}),s.on(p.RecencyCheckEventEmit.VerifyEmailOtp,i=>{this.createIntermediaryEvent(p.RecencyCheckEventEmit.VerifyEmailOtp,o.id)(i)}),s.on(p.RecencyCheckEventEmit.VerifyMFACode,i=>{this.createIntermediaryEvent(p.RecencyCheckEventEmit.VerifyMFACode,o.id)(i)}),s.on(p.UpdateEmailEventEmit.RetryWithNewEmail,i=>{this.createIntermediaryEvent(p.UpdateEmailEventEmit.RetryWithNewEmail,o.id)(i)}),s.on(p.UpdateEmailEventEmit.Cancel,()=>{this.createIntermediaryEvent(p.UpdateEmailEventEmit.Cancel,o.id)()}),s.on(p.UpdateEmailEventEmit.VerifyEmailOtp,i=>{this.createIntermediaryEvent(p.UpdateEmailEventEmit.VerifyEmailOtp,o.id)(i)})),s}};var l=require("@magic-sdk/types");var Z={};dt(Z,{clear:()=>Hn,getItem:()=>v,iterate:()=>Qe,key:()=>zn,keys:()=>Yn,length:()=>Xn,removeItem:()=>S,setItem:()=>C});var Pe;function J(n){return(...t)=>f(this,null,function*(){return Pe||(Pe=yield E.configureStorage()),yield Pe.ready(),Pe[n](...t)})}var v=J("getItem"),C=J("setItem"),S=J("removeItem"),Hn=J("clear"),Xn=J("length"),zn=J("key"),Yn=J("keys"),Qe=J("iterate");function Ze(){let n=window.crypto.getRandomValues(new Uint8Array(16));n[6]=n[6]&15|64,n[8]=n[8]&191|128;let t="";return t+=n[0].toString(16),t+=n[1].toString(16),t+=n[2].toString(16),t+=n[3].toString(16),t+="-",t+=n[4].toString(16),t+=n[5].toString(16),t+="-",t+=n[6].toString(16),t+=n[7].toString(16),t+="-",t+=n[8].toString(16),t+=n[9].toString(16),t+="-",t+=n[10].toString(16),t+=n[11].toString(16),t+=n[12].toString(16),t+=n[13].toString(16),t+=n[14].toString(16),t+=n[15].toString(16),t}var Me="STORE_KEY_PRIVATE_KEY",de="STORE_KEY_PUBLIC_JWK",Lt="ECDSA",Qn="P-256",Zn={name:Lt,namedCurve:Qn};function ee(){let n=typeof window!="undefined"&&!!window.crypto,t=n&&!!window.crypto.subtle;return n&&t}function er(){S(de),S(Me)}function et(){return f(this,null,function*(){let n=yield tr();if(!n){console.info("unable to create public key or webcrypto is unsupported");return}let{subtle:t}=window.crypto,e=yield v(Me);if(!e||!t){console.info("unable to find private key or webcrypto unsupported");return}let r={iat:Math.floor(new Date().getTime()/1e3),jti:Ze()},o={typ:"dpop+jwt",alg:"ES256",jwk:n},s={protected:$t(JSON.stringify(o)),claims:$t(JSON.stringify(r))},i=rr(`${s.protected}.${s.claims}`),a={name:Lt,hash:{name:"SHA-256"}},c=or(new Uint8Array(yield t.sign(a,e,i)));return`${s.protected}.${s.claims}.${c}`})}function tr(){return f(this,null,function*(){if(!ee()){console.info("webcrypto is not supported");return}return(yield v(de))||(yield nr()),v(de)})}function nr(){return f(this,null,function*(){let{subtle:n}=window.crypto,t=yield n.generateKey(Zn,!1,["sign"]),e=yield n.exportKey("jwk",t.publicKey);yield C(Me,t.privateKey),yield C(de,e)})}function $t(n){return Ot(sr(n))}function rr(n){return new TextEncoder().encode(n)}function Ot(n){return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+/g,"")}function sr(n){return encodeURIComponent(n).replace(/%([0-9A-F]{2})/g,(e,r)=>String.fromCharCode(parseInt(r,16)))}function or(n){let t="";return n.forEach(e=>{t+=String.fromCharCode(e)}),Ot(t)}var tt="ds",nt="ek",rt="iv",st="AES-GCM",ir=256;function te(){return f(this,null,function*(){let n=[];yield Qe((t,e,r)=>{e.startsWith(`${tt}_`)&&n.push(e)});for(let t of n)yield S(t)})}function _t(n){let t="",e=new Uint8Array(n),r=e.byteLength;for(let o=0;o<r;o++)t+=String.fromCharCode(e[o]);return window.btoa(t)}function kt(n){let t=window.atob(n),e=t.length,r=new Uint8Array(e);for(let o=0;o<e;o++)r[o]=t.charCodeAt(o);return r.buffer}function ar(){return f(this,null,function*(){if(!ee()){console.info("webcrypto is not supported");return}let{crypto:n}=window,t=yield v(rt);return t||n.getRandomValues(new Uint8Array(12))})}function cr(){return f(this,null,function*(){if(!ee()){console.info("webcrypto is not supported");return}let{subtle:n}=window.crypto,t=yield v(nt);return t||(yield n.generateKey({name:st,length:ir},!1,["encrypt","decrypt"]))})}function Dt(n,t){return f(this,null,function*(){let e=yield ar(),r=yield cr();if(!e||!r||!n)return;let o=kt(n),{subtle:s}=window.crypto,i=yield s.encrypt({name:st,iv:e},r,o),a=_t(i);yield C(`${tt}_${t}`,a),yield C(nt,r),yield C(rt,e)})}function qt(n){return f(this,null,function*(){let t=yield v(`${tt}_${n}`),e=yield v(rt),r=yield v(nt);if(!e||!t||!r||!ee())return;let{subtle:o}=window.crypto,s=yield o.decrypt({name:st,iv:e},r,kt(t));return _t(s)})}function xe(n,t){return t?new URL(n,t):new URL(n)}var Ce=class extends x{constructor(){super(...arguments);this.localForageKey="mc_active_wallet";this.localForageIsLoggedInKey="magic_auth_is_logged_in";this.userLoggedOutCallbacks=[]}getIdToken(e){let r=h(this.sdk.testMode?l.MagicPayloadMethod.GetIdTokenTestMode:l.MagicPayloadMethod.GetIdToken,[e]);return this.request(r)}generateIdToken(e){let r=h(this.sdk.testMode?l.MagicPayloadMethod.GenerateIdTokenTestMode:l.MagicPayloadMethod.GenerateIdToken,[e]);return this.request(r)}getInfo(){return f(this,null,function*(){let e=yield v(this.localForageKey),r=h(l.MagicPayloadMethod.GetInfo,[{walletType:e}]);return this.request(r)})}isLoggedIn(){return O((e,r)=>f(this,null,function*(){try{let o=!1;this.sdk.useStorageCache&&(o=(yield v(this.localForageIsLoggedInKey))==="true",o&&e(!0));let s=h(this.sdk.testMode?l.MagicPayloadMethod.IsLoggedInTestMode:l.MagicPayloadMethod.IsLoggedIn),i=yield this.request(s);this.sdk.useStorageCache&&(i?C(this.localForageIsLoggedInKey,!0):S(this.localForageIsLoggedInKey),o&&!i&&this.emitUserLoggedOut(!0)),e(i)}catch(o){r(o)}}))}logout(){return S(this.localForageKey),S(this.localForageIsLoggedInKey),te(),O((e,r)=>f(this,null,function*(){try{let o=h(this.sdk.testMode?l.MagicPayloadMethod.LogoutTestMode:l.MagicPayloadMethod.Logout),s=yield this.request(o);this.sdk.useStorageCache&&this.emitUserLoggedOut(s),e(s)}catch(o){r(o)}}))}requestInfoWithUI(e){let r=h(l.MagicPayloadMethod.RequestUserInfoWithUI,e?[e]:[]);return this.request(r)}showSettings(e){let{showUI:r=!0}=e||{},o=h(this.sdk.testMode?l.MagicPayloadMethod.UserSettingsTestMode:l.MagicPayloadMethod.UserSettings,[e]),s=this.request(o);return!r&&s&&(s.on(l.RecoveryFactorEventEmit.SendNewPhoneNumber,i=>{this.createIntermediaryEvent(l.RecoveryFactorEventEmit.SendNewPhoneNumber,o.id)(i)}),s.on(l.RecoveryFactorEventEmit.SendOtpCode,i=>{this.createIntermediaryEvent(l.RecoveryFactorEventEmit.SendOtpCode,o.id)(i)}),s.on(l.RecoveryFactorEventEmit.StartEditPhoneNumber,()=>{this.createIntermediaryEvent(l.RecoveryFactorEventEmit.StartEditPhoneNumber,o.id)()}),s.on(l.RecoveryFactorEventEmit.Cancel,()=>{this.createIntermediaryEvent(l.RecoveryFactorEventEmit.Cancel,o.id)()}),s.on(l.RecencyCheckEventEmit.VerifyEmailOtp,i=>{this.createIntermediaryEvent(l.RecencyCheckEventEmit.VerifyEmailOtp,o.id)(i)})),s}recoverAccount(e){let{email:r,showUI:o}=e,s=h(this.sdk.testMode?l.MagicPayloadMethod.RecoverAccountTestMode:l.MagicPayloadMethod.RecoverAccount,[{email:r,showUI:o}]),i=this.request(s);return!o&&i&&(i.on(l.RecoverAccountEventEmit.Cancel,()=>{this.createIntermediaryEvent(l.RecoverAccountEventEmit.Cancel,s.id)()}),i.on(l.RecoverAccountEventEmit.ResendSms,()=>{this.createIntermediaryEvent(l.RecoverAccountEventEmit.ResendSms,s.id)()}),i.on(l.RecoverAccountEventEmit.VerifyOtp,a=>{this.createIntermediaryEvent(l.RecoverAccountEventEmit.VerifyOtp,s.id)(a)}),i.on(l.RecoverAccountEventEmit.UpdateEmail,a=>{this.createIntermediaryEvent(l.RecoverAccountEventEmit.UpdateEmail,s.id)(a)}),i.on(l.UpdateEmailEventEmit.Cancel,()=>{this.createIntermediaryEvent(l.UpdateEmailEventEmit.Cancel,s.id)()}),i.on(l.UpdateEmailEventEmit.RetryWithNewEmail,a=>{this.createIntermediaryEvent(l.UpdateEmailEventEmit.RetryWithNewEmail,s.id)(a)}),i.on(l.UpdateEmailEventEmit.VerifyEmailOtp,a=>{this.createIntermediaryEvent(l.UpdateEmailEventEmit.VerifyEmailOtp,s.id)(a)})),i}revealPrivateKey(){let e=h(l.MagicPayloadMethod.RevealPK);return this.request(e)}getMetadata(){U({method:"user.getMetadata()",removalVersions:V,useInstead:"user.getInfo()"}).log();let e=h(this.sdk.testMode?l.MagicPayloadMethod.GetMetadataTestMode:l.MagicPayloadMethod.GetMetadata);return this.request(e)}onUserLoggedOut(e){this.userLoggedOutCallbacks.push(e)}enableMFA(e){let{showUI:r=!0}=e,o=h(l.MagicPayloadMethod.EnableMFA,[{showUI:r}]),s=this.request(o);return!r&&s&&(s.on(l.EnableMFAEventEmit.VerifyMFACode,i=>{this.createIntermediaryEvent(l.EnableMFAEventEmit.VerifyMFACode,o.id)(i)}),s.on(l.EnableMFAEventEmit.Cancel,()=>{this.createIntermediaryEvent(l.EnableMFAEventEmit.Cancel,o.id)()})),s}disableMFA(e){let{showUI:r=!0}=e,o=h(l.MagicPayloadMethod.DisableMFA,[{showUI:r}]),s=this.request(o);return!r&&s&&(s.on(l.DisableMFAEventEmit.VerifyMFACode,i=>{this.createIntermediaryEvent(l.DisableMFAEventEmit.VerifyMFACode,o.id)(i)}),s.on(l.DisableMFAEventEmit.LostDevice,i=>{this.createIntermediaryEvent(l.DisableMFAEventEmit.LostDevice,o.id)(i)}),s.on(l.DisableMFAEventEmit.Cancel,()=>{this.createIntermediaryEvent(l.DisableMFAEventEmit.Cancel,o.id)()})),s}emitUserLoggedOut(e){this.userLoggedOutCallbacks.forEach(r=>{r(e)})}};var g=require("@magic-sdk/types");var Ae=class extends x{constructor(){super(...arguments);this.localForageKey="mc_active_wallet"}connectWithUI(){let e=O((r,o)=>f(this,null,function*(){try{if(this.isMetaMaskBrowser()&&(yield this.isWalletEnabled(g.Wallets.MetaMask))){let d=yield this.autoConnectIfWalletBrowser(g.Wallets.MetaMask);r(d);return}if(this.isCoinbaseWalletBrowser()&&(yield this.isWalletEnabled(g.Wallets.CoinbaseWallet))){let d=yield this.autoConnectIfWalletBrowser(g.Wallets.CoinbaseWallet);r(d);return}let s=this.getUserEnv(),i=h(g.MagicPayloadMethod.Login,[s]),a=this.request(i);a.on(g.Events.WalletSelected,d=>this.handleWalletSelected(H(B({},d),{payloadId:i.id}))),a.on("id-token-created",d=>{e.emit("id-token-created",d)});let c=yield a;c.error&&o(c),r(c)}catch(s){o(s)}}));return e}showUI(e){return this.request(h(g.MagicPayloadMethod.ShowUI,[e]))}showAddress(){return this.request(h(g.MagicPayloadMethod.ShowAddress))}showSendTokensUI(){return this.request(h(g.MagicPayloadMethod.ShowSendTokensUI))}showOnRamp(){return this.request(h(g.MagicPayloadMethod.ShowOnRamp))}showNFTs(){return this.request(h(g.MagicPayloadMethod.ShowNFTs))}showBalances(){return this.request(h(g.MagicPayloadMethod.ShowBalances))}sendGaslessTransaction(e,r){return this.request(h(g.MagicPayloadMethod.SendGaslessTransaction,[e,r]))}getInfo(){return f(this,null,function*(){U({method:"wallet.getInfo()",removalVersions:V,useInstead:"user.getInfo()"}).log();let e=yield v(this.localForageKey),r=h(g.MagicPayloadMethod.GetInfo,[{walletType:e}]);return this.request(r)})}disconnect(){U({method:"wallet.disconnect()",removalVersions:V,useInstead:"user.logout()"}).log(),S(this.localForageKey),te();let e=h(g.MagicPayloadMethod.Disconnect);return this.request(e)}requestUserInfoWithUI(e){U({method:"wallet.requestUserInfoWithUI()",removalVersions:V,useInstead:"user.requestUserInfoWithUI()"}).log();let r=h(g.MagicPayloadMethod.RequestUserInfoWithUI,e?[e]:[]);return this.request(r)}getProvider(){return f(this,null,function*(){switch(yield v(this.localForageKey)){case g.Wallets.MetaMask:return this.getMetaMaskProvider();case g.Wallets.CoinbaseWallet:return this.getCoinbaseProvider();default:return this.sdk.rpcProvider}})}isMetaMaskInstalled(){var e,r,o;return((e=window.ethereum)==null?void 0:e.isMetaMask)||!!((o=(r=window.ethereum)==null?void 0:r.providers)!=null&&o.find(s=>s==null?void 0:s.isMetaMask))}isMetaMaskBrowser(){return this.isMobile()&&this.isMetaMaskInstalled()}getMetaMaskProvider(){var e,r;return((r=(e=window.ethereum)==null?void 0:e.providers)==null?void 0:r.find(o=>o==null?void 0:o.isMetaMask))||window.ethereum}connectToMetaMask(){if(this.isMobile()&&!this.isMetaMaskInstalled()){let e=`https://metamask.app.link/dapp/${window.location.href.replace(/(^\w+:|^)\/\//,"")}`;window.location.href=e}return this.getMetaMaskProvider().request({method:"eth_requestAccounts"})}isCoinbaseWalletInstalled(){var e,r,o;return((e=window.ethereum)==null?void 0:e.isCoinbaseWallet)||!!((o=(r=window.ethereum)==null?void 0:r.providers)!=null&&o.find(s=>s==null?void 0:s.isCoinbaseWallet))}isCoinbaseWalletBrowser(){var e;return!!((e=window.ethereum)!=null&&e.isCoinbaseBrowser)}getCoinbaseProvider(){var e,r;return((r=(e=window.ethereum)==null?void 0:e.providers)==null?void 0:r.find(o=>o==null?void 0:o.isCoinbaseWallet))||window.ethereum}connectToCoinbaseWallet(){if(this.isMobile()&&!this.isCoinbaseWalletBrowser()){let r=`https://go.cb-w.com/dapp?cb_url=${encodeURIComponent(window.location.href)}`;window.location.href=r}return this.getCoinbaseProvider().request({method:"eth_requestAccounts"})}isMobile(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Silk|Opera Mini/i.test(navigator.userAgent)}getUserEnv(){return{env:{isMetaMaskInstalled:this.isMetaMaskInstalled(),isCoinbaseWalletInstalled:this.isCoinbaseWalletInstalled()}}}connectToThirdPartyWallet(e){switch(e){case g.Wallets.MetaMask:return this.connectToMetaMask();case g.Wallets.CoinbaseWallet:return this.connectToCoinbaseWallet();default:throw new Error(`Invalid provider: ${e}. Must be one of "metamask" or "coinbase_wallet".`)}}isWalletEnabled(e){let r=h("mc_is_wallet_enabled",[{wallet:e}]);return this.request(r)}handleWalletSelected(e){return f(this,null,function*(){try{let r=yield this.connectToThirdPartyWallet(e.wallet);yield C(this.localForageKey,e.wallet),this.createIntermediaryEvent(g.Events.WalletConnected,e.payloadId)(r)}catch(r){console.error(r),this.createIntermediaryEvent(g.Events.WalletRejected,e.payloadId)()}})}autoConnectIfWalletBrowser(e){return f(this,null,function*(){let r;e===g.Wallets.MetaMask&&(r=yield this.getMetaMaskProvider().request({method:"eth_requestAccounts"})),e===g.Wallets.CoinbaseWallet&&(r=yield this.getCoinbaseProvider().request({method:"eth_requestAccounts"})),yield C(this.localForageKey,e);let o=h(g.MagicPayloadMethod.AutoConnect,[{wallet:e,address:r}]);return this.request(o)})}};var ue=require("@magic-sdk/types");var{createBoundEmitterMethod:Ne,createChainingEmitterMethod:ne}=le(),Se=class extends x{constructor(){super(...arguments);this.isMagic=!0;this.on=ne("on",this);this.once=ne("once",this);this.addListener=ne("addListener",this);this.off=ne("off",this);this.removeListener=ne("removeListener",this);this.removeAllListeners=ne("removeAllListeners",this);this.emit=Ne("emit");this.eventNames=Ne("eventNames");this.listeners=Ne("listeners");this.listenerCount=Ne("listenerCount")}sendAsync(e,r){if(!r)throw Ve({procedure:"Magic.rpcProvider.sendAsync",argument:1,expected:"function",received:r===null?"null":typeof r});if(Array.isArray(e))this.overlay.post(ue.MagicOutgoingWindowMessage.MAGIC_HANDLE_REQUEST,e.map(o=>{let s=j(o);return this.prefixPayloadMethodForTestMode(s),s})).then(o=>{r(null,o.map(s=>H(B({},s.payload),{error:s.hasError?new L(s.payload.error):null})))});else{let o=j(e);this.prefixPayloadMethodForTestMode(o),this.overlay.post(ue.MagicOutgoingWindowMessage.MAGIC_HANDLE_REQUEST,o).then(s=>{r(s.hasError?new L(s.payload.error):null,s.payload)})}}send(e,r){if(typeof e=="string"){let s=h(e,Array.isArray(r)?r:[]);return this.request(s)}if(Array.isArray(e)||!!r){this.sendAsync(e,r);return}let o=Be();return o.log(),new F(e).applyError({code:-32603,message:o.rawMessage}).payload}enable(){let e=h(ue.MagicPayloadMethod.Login);return this.request(e)}request(e){return this.prefixPayloadMethodForTestMode(e),super.request(e)}prefixPayloadMethodForTestMode(e){let r="testMode/eth/";this.sdk.testMode&&(e.method=`${r}${e.method}`)}};var Ut=["request","overlay","sdk"];function lr(n){let t=Object.getPrototypeOf(n),e=[t];for(;t!==x.prototype;)t=Object.getPrototypeOf(t),e.push(t);return e}var $e=class extends x{constructor(){super(void 0);this.__sdk_access_field_descriptors__=new Map;this.__is_initialized__=!1;this.utils={createPromiEvent:O,isPromiEvent:ze,encodeJSON:ae,decodeJSON:qe,createJsonRpcRequestPayload:h,standardizeJsonRpcRequestPayload:j,storage:Z};let e=[this,...lr(this)];Ut.forEach(r=>{let o=e.map(c=>Object.getOwnPropertyDescriptor(c,r)),s=o.findIndex(c=>!!c),i=s>0,a=o[s];a&&(this.__sdk_access_field_descriptors__.set(r,{descriptor:a,isPrototypeField:i}),Object.defineProperty(this,r,{configurable:!0,get:()=>{throw Ke(r)}}))})}init(e){this.__is_initialized__||(Ut.forEach(r=>{if(this.__sdk_access_field_descriptors__.has(r)){let{descriptor:o,isPrototypeField:s}=this.__sdk_access_field_descriptors__.get(r);s?delete this[r]:Object.defineProperty(this,r,o)}}),this.sdk=e,this.__is_initialized__=!0)}createDeprecationWarning(e){let{method:r,removalVersion:o,useInstead:s}=e,i=s?` Use \`${s}\` instead.`:"",a=`\`${r}\` will be removed from this Extension in version \`${o}\`.${i}`;return new Y(this,"DEPRECATION_NOTICE",a)}createWarning(e,r){return new Y(this,e,r)}createError(e,r,o){return new K(this,e,r,o)}},ot=class extends $e{},_=class extends $e{};_.Internal=ot,_.Anonymous="anonymous extension";var Le=require("@magic-sdk/types");var Oe=class extends x{purchase(t){let e=h(Le.MagicPayloadMethod.NFTPurchase,[t]);return this.request(e)}checkout(t){let e=h(Le.MagicPayloadMethod.NFTCheckout,[t]);return this.request(e)}transfer(t){let e=h(Le.MagicPayloadMethod.NFTTransfer,[t]);return this.request(e)}};function Wt(n){return n.compat&&n.compat[E.sdkName]!=null?typeof n.compat[E.sdkName]=="string"?Tt(bt(E.version),n.compat[E.sdkName]):!!n.compat[E.sdkName]:!0}function dr(n,t,e){return!t&&!e?`${n}_eth_mainnet`:e?`${n}_${JSON.stringify(e)}`:t?typeof t=="string"?`${n}_eth_${t}`:`${n}_${t.rpcUrl}_${t.chainId}_${t.chainType}`:`${n}_unknown`}function ur(n){var o;let t=(o=n==null?void 0:n.extensions)!=null?o:[],e={},r=[];if(Array.isArray(t)?t.forEach(s=>{Wt(s)?(s.init(this),(s.name||s.name!==_.Anonymous)&&(this[s.name]=s),s instanceof _.Internal&&(z(s.config)||(e[s.name]=s.config))):r.push(s)}):Object.keys(t).forEach(s=>{if(Wt(t[s])){t[s].init(this);let i=t[s];this[s]=i,i instanceof _.Internal&&(z(i.config)||(e[t[s].name]=i.config))}else r.push(t[s])}),r.length)throw je(r);return e}var he=class{constructor(t,e){this.apiKey=t;var i;if(!t)throw Fe();E.platform==="react-native"&&(e==null?void 0:e.endpoint)&&He().log();let{defaultEndpoint:r,version:o}=E;this.testMode=!!(e!=null&&e.testMode),this.useStorageCache=!!(e!=null&&e.useStorageCache),this.endpoint=xe((i=e==null?void 0:e.endpoint)!=null?i:r).origin,this.auth=new we(this),this.user=new Ce(this),this.wallet=new Ae(this),this.nft=new Oe(this),this.rpcProvider=new Se(this);let s=ur.call(this,e);this.parameters=ae(H(B({API_KEY:this.apiKey,DOMAIN_ORIGIN:window.location?window.location.origin:"",ETH_NETWORK:e==null?void 0:e.network,host:xe(this.endpoint).host,sdk:Pt[E.sdkName],version:o,ext:z(s)?void 0:s,locale:(e==null?void 0:e.locale)||"en_US"},E.bundleId?{bundleId:E.bundleId}:{}),{meta:e==null?void 0:e.meta})),this.networkHash=dr(this.apiKey,e==null?void 0:e.network,z(s)?void 0:s),e!=null&&e.deferPreload||this.preload()}get overlay(){if(!he.__overlays__.has(this.parameters)){let t=new E.ViewController(this.endpoint,this.parameters,this.networkHash);t.init(),he.__overlays__.set(this.parameters,t)}return he.__overlays__.get(this.parameters)}preload(){return f(this,null,function*(){yield this.overlay.checkIsReadyForRequest})}},pe=he;pe.__overlays__=new Map;var G=require("@magic-sdk/types");function pr(n,t){return t&&Array.isArray(n)?n.find(e=>e.id===t):n}function hr(n,t){var o;let e=(o=t.data.response)==null?void 0:o.id,r=pr(n,e);if(e&&r){let s=new F(r).applyResult(t.data.response.result).applyError(t.data.response.error);return{id:e,response:s}}return{}}function mr(n,t,e){return f(this,null,function*(){var a;let r=yield v("rt"),o;if(E.platform==="web")try{o=(a=yield v("jwt"))!=null?a:yield et()}catch(c){console.error("webcrypto error",c)}let s={msgType:n,payload:t};o&&(s.jwt=o),o&&r&&(s.rt=r);let i=yield qt(e);return i&&(s.deviceShare=i),s})}function Er(n){return f(this,null,function*(){!n.data.rt||(yield C("rt",n.data.rt))})}var _e=class{constructor(t,e,r){this.endpoint=t;this.parameters=e;this.networkHash=r;this.messageHandlers=new Set;this.isConnectedToInternet=!0;this.checkIsReadyForRequest=this.waitForReady(),this.isReadyForRequest=!1,this.listen()}post(t,e){return f(this,null,function*(){return be((r,o)=>f(this,null,function*(){if(!this.isConnectedToInternet){let u=Je();o(u)}this.isReadyForRequest||(yield this.waitForReady());let s=[],i=Array.isArray(e)?e.map(u=>u.id):[],a=yield mr(`${t}-${this.parameters}`,e,this.networkHash);yield this._post(a);let c=u=>m=>{var it;let{id:A,response:T}=hr(e,m);if(Er(m),((it=T==null?void 0:T.payload.error)==null?void 0:it.message)==="User denied account access.")te();else if(m.data.deviceShare){let{deviceShare:Ft}=m.data;Dt(Ft,this.networkHash)}A&&T&&Array.isArray(e)&&i.includes(A)?(s.push(T),s.length===e.length&&(u(),r(s))):A&&T&&!Array.isArray(e)&&A===e.id&&(u(),r(T))},d=this.on(G.MagicIncomingWindowMessage.MAGIC_HANDLE_RESPONSE,c(()=>d()))}))})}on(t,e){let r=e.bind(window),o=s=>{s.data.msgType===`${t}-${this.parameters}`&&r(s)};return this.messageHandlers.add(o),()=>this.messageHandlers.delete(o)}waitForReady(){return new Promise(t=>{let e=this.on(G.MagicIncomingWindowMessage.MAGIC_OVERLAY_READY,()=>{this.isReadyForRequest=!0,t(),e()});setTimeout(()=>{this.isReadyForRequest=!0,t(),e()},15e3)})}listen(){this.on(G.MagicIncomingWindowMessage.MAGIC_HIDE_OVERLAY,()=>{this.hideOverlay()}),this.on(G.MagicIncomingWindowMessage.MAGIC_SHOW_OVERLAY,()=>{this.showOverlay()}),this.on(G.MagicIncomingWindowMessage.MAGIC_SEND_PRODUCT_ANNOUNCEMENT,t=>{t.data.response.result.product_announcement&&new q(G.SDKWarningCode.ProductAnnouncement,t.data.response.result.product_announcement).log()})}};
//# sourceMappingURL=index.js.map
